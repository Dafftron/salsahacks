const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/tag-BSjDyQEr.js","assets/index-CkiEKLiW.js","assets/index-D5-qQo4z.css","assets/jszip.min-DupR5p5E.js"])))=>i.map(i=>d[i]);
var ga=Object.defineProperty;var Cs=a=>{throw TypeError(a)};var pa=(a,r,t)=>r in a?ga(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t;var Oe=(a,r,t)=>pa(a,typeof r!="symbol"?r+"":r,t),$s=(a,r,t)=>r.has(a)||Cs("Cannot "+t);var ee=(a,r,t)=>($s(a,r,"read from private field"),t?t.call(a):r.get(a)),xt=(a,r,t)=>r.has(a)?Cs("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(a):r.set(a,t),$t=(a,r,t,n)=>($s(a,r,"write to private field"),n?n.call(a,t):r.set(a,t),t);import{m as ds,n as ct,s as dt,o as St,p as Wt,q as _s,t as fa,a as ge,r as l,j as e,u as Jt,v as ba,w as ya,x as _t,_ as pt,y as wa,z as Hs,A as es,C as va,D as ja,E as Na,F as Ws,G as us,I as ka,J as Sa,K as Ea,N as Gs,M as Ht,H as Tt,O as ms,P as bs,Q as Ca,b as Ts,T as $a,V as Ta,W as La,X as Ra,Y as Ls,Z as Da,$ as Ma,a0 as Aa,a1 as Pa}from"./index-CkiEKLiW.js";import{X as ot,P as Gt}from"./x-CMoftRNo.js";import{C as Kt,A as Rt}from"./check-circle-wADKJhCE.js";import{U as hs}from"./upload-DbiANlji.js";import{T as vt}from"./trash-2-DC4BlpCy.js";import{C as Xt}from"./chevron-down-D91_91Fm.js";import{T as Rs}from"./tag-BSjDyQEr.js";import{V as Fa}from"./video-BVxHrLWW.js";import{P as Zt,S as Ds}from"./star-Bx0e0EwP.js";import{S as Ia}from"./save-LHxT1yfh.js";import{U as Ms}from"./users-BM0tak_W.js";import{Z as Ua}from"./zap-DgL5-OIo.js";import{E as za}from"./eye-off-DyZ3uslh.js";import{E as Oa}from"./eye-PtIJDsQe.js";const Va=async a=>{try{const r=URL.createObjectURL(a),t=document.createElement("video");t.crossOrigin="anonymous",t.muted=!0,t.playsInline=!0;const n=document.createElement("canvas"),o=n.getContext("2d");return new Promise((c,h)=>{t.onloadedmetadata=()=>{const m=t.videoWidth/t.videoHeight;let y,p;m>1?(y=1280,p=1280/m):(p=720,y=720*m),n.width=y,n.height=p;const R=t.duration;t.currentTime=Math.min(R*.5,1),t.onseeked=()=>{try{o.drawImage(t,0,0,n.width,n.height),n.toBlob(N=>{if(N){const f=URL.createObjectURL(N);URL.revokeObjectURL(r),t.remove(),n.remove(),c({success:!0,thumbnailURL:f,blob:N,error:null})}else h(new Error("No se pudo generar el thumbnail"))},"image/jpeg",.95)}catch(N){h(new Error(`Error al capturar frame: ${N.message}`))}},t.onerror=()=>{h(new Error("Error al cargar el video para thumbnail"))}},t.onerror=()=>{URL.revokeObjectURL(r),t.remove(),n.remove(),h(new Error("Error al cargar el video"))},t.src=r})}catch(r){return{success:!1,thumbnailURL:"https://via.placeholder.com/300x200/1a1a1a/ffffff?text=VIDEO",blob:null,error:r.message}}},kt=async(a,r,t)=>{try{const n=ct(dt,r),o={contentType:a.type,customMetadata:{uploadedAt:new Date().toISOString(),originalName:a.name,fileSize:a.size.toString()}},c=await _s(n,a,o);return{success:!0,url:await Wt(c.ref),path:c.ref.fullPath,error:null}}catch(n){return console.error("Error uploading file:",n),{success:!1,url:null,path:null,error:n.message}}},As=async a=>{try{const r=ct(dt,a);return await St(r),{success:!0,error:null}}catch(r){return{success:!1,error:r.message}}},Ba=async(a,r,t)=>{try{if(!a.type.startsWith("video/"))throw new Error("El archivo debe ser un video");const n=100*1024*1024;if(a.size>n)throw new Error("El video es demasiado grande. M√°ximo 100MB");console.log("Subiendo video a Firebase Storage...");const o={contentType:a.type,customMetadata:{uploadedAt:new Date().toISOString(),originalName:a.name,fileSize:a.size.toString(),fileType:"video"}},c=ct(dt,r);try{const h=await _s(c,a,o),x=await Wt(h.ref);return console.log("Video subido exitosamente a Firebase Storage:",x),{success:!0,url:x,path:h.ref.fullPath,error:null,simulated:!1}}catch(h){console.error("Error con uploadBytes, intentando con uploadBytesResumable:",h);const x=fa(c,a,o);return new Promise((i,m)=>{x.on("state_changed",y=>{const p=y.bytesTransferred/y.totalBytes*100;t&&t(p)},y=>{console.error("Error uploading video:",y);let p="Error al subir el video";y.code==="storage/unauthorized"?p="No tienes permisos para subir videos":y.code==="storage/quota-exceeded"?p="Se ha excedido la cuota de almacenamiento":y.code==="storage/retry-limit-exceeded"?p="Error de conexi√≥n. Intenta de nuevo":y.code==="storage/canceled"?p="Upload cancelado":y.message&&(p=y.message),i({success:!1,url:null,path:null,error:p,simulated:!1})},async()=>{try{const y=await Wt(x.snapshot.ref);console.log("Video subido exitosamente a Firebase Storage:",y),i({success:!0,url:y,path:x.snapshot.ref.fullPath,error:null,simulated:!1})}catch{i({success:!1,url:null,path:null,error:"Error al obtener la URL del video",simulated:!1})}})})}}catch(n){console.error("Error uploading video:",n);let o="Error al subir el video";return n.code==="storage/unauthorized"?o="No tienes permisos para subir videos":n.code==="storage/quota-exceeded"?o="Se ha excedido la cuota de almacenamiento":n.code==="storage/retry-limit-exceeded"?o="Error de conexi√≥n. Intenta de nuevo":n.message&&(o=n.message),{success:!1,url:null,path:null,error:o,simulated:!1}}},Ps=async(a,r)=>{try{console.log("üóëÔ∏è Iniciando eliminaci√≥n de archivos:"),console.log("üìÅ Video path:",a),console.log("üñºÔ∏è Thumbnail path:",r);const t=[];if(a){console.log("üé¨ Eliminando video:",a);const n=ct(dt,a);t.push(St(n))}else console.log("‚ö†Ô∏è No hay ruta de video para eliminar");if(r&&r!==null&&r!==""){console.log("üñºÔ∏è Eliminando thumbnail:",r);const n=ct(dt,r);t.push(St(n))}else console.log("‚ö†Ô∏è No hay ruta de thumbnail para eliminar (thumbnailPath:",r,")");return console.log(`üìä Archivos a eliminar: ${t.length}`),t.length===0?(console.log("‚ö†Ô∏è No hay archivos para eliminar"),{success:!0,error:null,deletedCount:0}):(await Promise.all(t),console.log("‚úÖ Archivos eliminados exitosamente"),{success:!0,error:null,deletedCount:t.length})}catch(t){return console.error("‚ùå Error deleting video:",t),{success:!1,error:t.message,deletedCount:0}}},qa=async()=>{try{console.log("üóëÔ∏è Iniciando eliminaci√≥n de todos los archivos de videos...");const a=await Fs("videos");console.log(`‚úÖ Archivos de videos eliminados: ${a.deletedCount}`);const r=await Fs("thumbnails");return console.log(`‚úÖ Archivos de thumbnails eliminados: ${r.deletedCount}`),{success:!0,videosDeleted:a.deletedCount,thumbnailsDeleted:r.deletedCount,error:null}}catch(a){return console.error("‚ùå Error al eliminar archivos de videos:",a),{success:!1,videosDeleted:0,thumbnailsDeleted:0,error:a.message}}},Fs=async a=>{try{console.log(`üóëÔ∏è Eliminando archivos en carpeta: ${a}`);const r=ct(dt,a),t=await ds(r);if(t.items.length===0)return console.log(`‚úÖ No hay archivos en ${a}`),{success:!0,deletedCount:0,error:null};console.log(`üìä Archivos a eliminar en ${a}: ${t.items.length}`);const n=t.items.map(async x=>{try{return await St(x),{success:!0,path:x.fullPath}}catch(i){return console.error(`‚ùå Error eliminando ${x.fullPath}:`,i),{success:!1,path:x.fullPath,error:i.message}}}),o=await Promise.all(n),c=o.filter(x=>x.success).length,h=o.filter(x=>!x.success).length;return console.log(`‚úÖ ${c} archivos eliminados exitosamente en ${a}`),h>0&&console.log(`‚ö†Ô∏è ${h} archivos fallaron al eliminar en ${a}`),{success:!0,deletedCount:c,failedCount:h,error:null}}catch(r){return console.error(`‚ùå Error al eliminar archivos en ${a}:`,r),{success:!1,deletedCount:0,failedCount:0,error:r.message}}},_a=async a=>{try{console.log("üßπ Iniciando limpieza de archivos hu√©rfanos...");const r=await ds(ct(dt,"videos")),t=await ds(ct(dt,"thumbnails")),n=new Set(a.map(i=>i.videoPath).filter(Boolean)),o=new Set(a.map(i=>i.thumbnailPath).filter(Boolean)),c=r.items.filter(i=>!n.has(i.fullPath)),h=t.items.filter(i=>!o.has(i.fullPath));console.log(`üìä Archivos hu√©rfanos encontrados: ${c.length} videos, ${h.length} thumbnails`);const x=[...c.map(i=>St(i)),...h.map(i=>St(i))];return x.length>0?(await Promise.all(x),console.log(`‚úÖ ${x.length} archivos hu√©rfanos eliminados`)):console.log("‚úÖ No se encontraron archivos hu√©rfanos"),{success:!0,orphanedVideosDeleted:c.length,orphanedThumbnailsDeleted:h.length,error:null}}catch(r){return console.error("‚ùå Error en limpieza de archivos hu√©rfanos:",r),{success:!1,orphanedVideosDeleted:0,orphanedThumbnailsDeleted:0,error:r.message}}},Is=async a=>{try{const r=ct(dt,a),t=await Wt(r),n=await fetch(t);if(!n.ok)throw new Error(`Error al descargar archivo: ${n.status}`);return await n.blob()}catch(r){throw console.error(`Error descargando archivo ${a}:`,r),r}},Us=(a,r)=>new File([a],r,{type:a.type}),Ha=async a=>{try{console.log("üîÑ Iniciando migraci√≥n de videos a estructura organizada...");const r=[];for(const c of a)try{if(c.videoPath&&c.videoPath.includes("/figuras/")||c.videoPath&&c.videoPath.includes("/escuela/")||c.videoPath&&c.videoPath.includes("/eventos/")){console.log(`‚è≠Ô∏è Video ${c.title} ya est√° en estructura organizada`),r.push({videoId:c.id,title:c.title,status:"already_organized",error:null});continue}const h=c.style||"salsa",x="figuras",i=c.videoPath,m=c.thumbnailPath,y=`videos/${x}/${h}/${i.split("/").pop()}`,p=m?`thumbnails/${x}/${h}/${m.split("/").pop()}`:null;console.log(`üîÑ Migrando video: ${c.title}`),console.log(`   De: ${i}`),console.log(`   A: ${y}`);let R=!1,N=!1;try{console.log(`üì• Descargando video: ${i}`);const f=await Is(i),V=Us(f,i.split("/").pop());console.log(`üì§ Subiendo video a nueva ubicaci√≥n: ${y}`),await kt(V,y),R=!0,console.log("‚úÖ Video migrado exitosamente"),console.log(`üóëÔ∏è Eliminando archivo original: ${i}`),await As(i)}catch(f){throw console.error(`‚ùå Error migrando video ${c.title}:`,f),new Error(`Error migrando video: ${f.message}`)}if(m&&p)try{console.log(`üì• Descargando thumbnail: ${m}`);const f=await Is(m),V=Us(f,m.split("/").pop());console.log(`üì§ Subiendo thumbnail a nueva ubicaci√≥n: ${p}`),await kt(V,p),N=!0,console.log("‚úÖ Thumbnail migrado exitosamente"),console.log(`üóëÔ∏è Eliminando thumbnail original: ${m}`),await As(m)}catch(f){console.error(`‚ùå Error migrando thumbnail ${c.title}:`,f)}r.push({videoId:c.id,title:c.title,oldVideoPath:i,newVideoPath:y,oldThumbnailPath:m,newThumbnailPath:p,status:"migrated",videoMigrated:R,thumbnailMigrated:N,error:null})}catch(h){console.error(`‚ùå Error migrando video ${c.title}:`,h),r.push({videoId:c.id,title:c.title,status:"error",error:h.message})}const t=r.filter(c=>c.status==="migrated").length,n=r.filter(c=>c.status==="already_organized").length,o=r.filter(c=>c.status==="error").length;return console.log(`‚úÖ Migraci√≥n completada: ${t} migrados, ${n} ya organizados, ${o} fallidos`),{success:!0,totalVideos:a.length,successfulMigrations:t,alreadyOrganized:n,failedMigrations:o,results:r,error:null}}catch(r){return console.error("‚ùå Error en migraci√≥n de videos:",r),{success:!1,totalVideos:0,successfulMigrations:0,alreadyOrganized:0,failedMigrations:0,results:[],error:r.message}}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=ge("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=ge("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=ge("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=ge("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=ge("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=ge("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=ge("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=ge("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=ge("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=ge("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=ge("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=ge("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=ge("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=ge("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=ge("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=ge("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=ge("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=ge("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=ge("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=ge("Shuffle",[["path",{d:"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22",key:"1wmou1"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 6h1.9c1.5 0 2.9.9 3.6 2.2",key:"10bdb2"}],["path",{d:"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8",key:"vgxac0"}],["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=ge("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=ge("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=ge("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=ge("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=ge("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=ge("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),qt={figuras:{name:"FIGURAS",icon:"Music",styles:{salsa:{name:"SALSA",icon:"Music",color:"salsa",categories:{estilo:{name:"ESTILO",color:"pink",tags:["Salsa","Salsa en l√≠nea On1","Salsa cubana","Estilo LA","Estilo NY","Estilo show"]},subestilo:{name:"SUBESTILO/T√âCNICA",color:"orange",tags:["Pasitos libres","Parejas","Footwork On1","Footwork On2","Shines","Fusionado con afro","Body movement"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Cross Body Lead","Copa","Sombrero","Dile que no","Setenta","Vacilala","Enchufla"]},manos:{name:"MANOS/T√âCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos paralelas","Cruzadas","Entrelazadas","Cambio de manos","Manos abiertas","Sin contacto"]}}},bachata:{name:"BACHATA",icon:"Heart",color:"bachata",categories:{estilo:{name:"ESTILO",color:"red",tags:["Bachata dominicana","Bachata moderna","Bachata sensual","Bachata urbana"]},subestilo:{name:"SUBESTILO/T√âCNICA",color:"orange",tags:["Body rolls","Hip movement","Footwork b√°sico","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Dile que no","Setenta","Vacilala","Sombrero","Copa"]},manos:{name:"MANOS/T√âCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Entrelazadas"]}}},kizomba:{name:"KIZOMBA",icon:"Zap",color:"kizomba",categories:{estilo:{name:"ESTILO",color:"yellow",tags:["Kizomba tradicional","Kizomba urbana","Tarraxinha","Semba"]},subestilo:{name:"SUBESTILO/T√âCNICA",color:"orange",tags:["Body movement","Hip rolls","Footwork","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Sa√≠da","Volta","Tarraxinha","Semba step"]},manos:{name:"MANOS/T√âCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Sin contacto"]}}},zouk:{name:"ZOUK",icon:"Star",color:"zouk",categories:{estilo:{name:"ESTILO",color:"purple",tags:["Zouk brasile√±o","Zouk flow","Zouk neofusion","Zouk tradicional"]},subestilo:{name:"SUBESTILO/T√âCNICA",color:"orange",tags:["Body rolls","Head movement","Footwork","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Lateral","Tranca","Pi√£o","Balan√ßo"]},manos:{name:"MANOS/T√âCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Entrelazadas"]}}},merengue:{name:"MERENGUE",icon:"Sun",color:"merengue",categories:{estilo:{name:"ESTILO",color:"orange",tags:["Merengue dominicano","Merengue tradicional","Merengue moderno"]},subestilo:{name:"SUBESTILO/T√âCNICA",color:"orange",tags:["Hip movement","Footwork b√°sico","Turns simples"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Giros simples","Cambios de direcci√≥n","Pasos b√°sicos"]},manos:{name:"MANOS/T√âCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Sin contacto"]}}}}},escuela:{name:"ESCUELA",icon:"GraduationCap",styles:{salsa:{name:"SALSA",icon:"Music",color:"pink",categories:{nivel:{name:"NIVEL",color:"green",tags:["Principiante","Intermedio","Avanzado","Experto"]},tipo:{name:"TIPO DE CURSO",color:"blue",tags:["B√°sico","T√©cnica","Coreograf√≠a","Ritmo","Musicalidad"]},duracion:{name:"DURACI√ìN",color:"orange",tags:["5-15 min","10-25 min","15-45 min","20-60 min"]},instructor:{name:"INSTRUCTOR",color:"purple",tags:["Carlos Rodr√≠guez","Mar√≠a Gonz√°lez","Juan P√©rez","Ana L√≥pez"]}}}}},eventos:{name:"EVENTOS",icon:"Calendar",styles:{salsa:{name:"SALSA",icon:"Music",color:"pink",categories:{tipo:{name:"TIPO DE EVENTO",color:"green",tags:["Competici√≥n","Encuentro","Congreso","Workshop","Fiesta"]},ubicacion:{name:"UBICACI√ìN",color:"blue",tags:["Madrid","Barcelona","Valencia","Sevilla","Bilbao"]},nivel:{name:"NIVEL",color:"orange",tags:["Todos los niveles","Intermedio-Avanzado","Solo avanzado"]},fecha:{name:"FECHA",color:"purple",tags:["Este mes","Pr√≥ximo mes","Este trimestre","Este a√±o"]}}}}}},Mt=(a="figuras",r="salsa")=>{const[t,n]=l.useState(a),[o,c]=l.useState(r);l.useEffect(()=>{c(r)},[r]),l.useEffect(()=>{n(a)},[a]);const h=l.useMemo(()=>{const N=qt[t];if(!N)return null;const f=N.styles[o];return f?f.categories:null},[t,o]),x=l.useMemo(()=>{if(!h)return[];const N=[];return Object.entries(h).forEach(([f,V])=>{V.tags.forEach(W=>{N.push({tag:W,category:f,categoryName:V.name,color:V.color})})}),N},[h]),i=l.useMemo(()=>h?Object.entries(h).map(([N,f])=>({key:N,name:f.name,color:f.color,tags:f.tags})):[],[h]),m=l.useMemo(()=>{const N=qt[t];return N?Object.entries(N.styles).map(([f,V])=>({key:f,name:V.name,color:V.color,icon:V.icon})):[]},[t]),y=l.useMemo(()=>Object.entries(qt).map(([N,f])=>({key:N,name:f.name,icon:f.icon})),[]);return{selectedPage:t,selectedStyle:o,setSelectedPage:n,setSelectedStyle:c,currentCategories:h,availableTags:x,categoriesList:i,availableStyles:m,availablePages:y,categoryStructure:qt,getColorClasses:N=>({salsa:"bg-orange-100 text-orange-800 border-orange-200",bachata:"bg-emerald-100 text-emerald-800 border-emerald-200",merengue:"bg-cyan-100 text-cyan-800 border-cyan-200",zouk:"bg-violet-100 text-violet-800 border-violet-200",kizomba:"bg-amber-100 text-amber-800 border-amber-200",pink:"bg-pink-100 text-pink-800 border-pink-200",red:"bg-red-100 text-red-800 border-red-200",orange:"bg-orange-100 text-orange-800 border-orange-200",yellow:"bg-yellow-100 text-yellow-800 border-yellow-200",green:"bg-green-100 text-green-800 border-green-200",blue:"bg-blue-100 text-blue-800 border-blue-200",purple:"bg-purple-100 text-purple-800 border-purple-200"})[N]||"bg-gray-100 text-gray-800 border-gray-200",getGradientClasses:N=>({salsa:"from-orange-400 to-pink-500",bachata:"from-emerald-400 to-teal-600",merengue:"from-cyan-400 to-blue-600",zouk:"from-violet-400 to-indigo-600",kizomba:"from-amber-400 to-orange-600",pink:"from-pink-500 to-rose-500",red:"from-red-500 to-pink-500",orange:"from-orange-500 to-red-500",yellow:"from-yellow-500 to-orange-500",green:"from-green-500 to-emerald-500",blue:"from-blue-500 to-cyan-500",purple:"from-purple-500 to-pink-500"})[N]||"from-gray-500 to-gray-600"}},At=({message:a,type:r="success",duration:t=5e3,onClose:n})=>{const[o,c]=l.useState(!0);l.useEffect(()=>{const i=setTimeout(()=>{c(!1),setTimeout(()=>{n==null||n()},300)},t);return()=>clearTimeout(i)},[t,n]);const h=()=>{switch(r){case"success":return e.jsx(Kt,{className:"w-5 h-5"});case"error":return e.jsx(sr,{className:"w-5 h-5"});case"warning":return e.jsx(Rt,{className:"w-5 h-5"});default:return e.jsx(Kt,{className:"w-5 h-5"})}},x=()=>{switch(r){case"success":return"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-green-400";case"error":return"bg-gradient-to-r from-red-500 to-pink-500 text-white border-red-400";case"warning":return"bg-gradient-to-r from-orange-500 to-red-500 text-white border-orange-400";default:return"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-green-400"}};return e.jsx("div",{className:`
        fixed top-4 right-4 z-50 max-w-sm w-full
        transform transition-all duration-300 ease-in-out
        ${o?"translate-x-0 opacity-100":"translate-x-full opacity-0"}
      `,children:e.jsxs("div",{className:`
        flex items-center justify-between p-4 rounded-lg shadow-lg border
        ${x()}
      `,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[h(),e.jsx("span",{className:"font-medium",children:a})]}),e.jsx("button",{onClick:()=>{c(!1),setTimeout(()=>n==null?void 0:n(),300)},className:"ml-4 text-white hover:text-gray-200 transition-colors",children:e.jsx(ot,{className:"w-4 h-4"})})]})})},Dt=({src:a,size:r="medium",loop:t=!1,loopSegment:n=null,showControls:o=!0,autoplay:c=!1,muted:h=!1,onTimeUpdate:x=null,onEnded:i=null,className:m="",resolutions:y=null,currentResolution:p=null,onResolutionChange:R=null,videoTitle:N="video"})=>{const f=l.useRef(null),V=l.useRef(null),[W,w]=l.useState(!1),[T,B]=l.useState(0),[j,z]=l.useState(0),[q,J]=l.useState(1),[re,he]=l.useState(h),[Ne,ne]=l.useState(!1),[ze,ke]=l.useState(null),[Re,De]=l.useState(!1),[je,Fe]=l.useState(!1),[Me,O]=l.useState((n==null?void 0:n.start)||0),[ve,pe]=l.useState((n==null?void 0:n.end)||0),[S,F]=l.useState(!!n),[U,K]=l.useState(!1),[G,Q]=l.useState(!1),[ue,d]=l.useState(0),[A,D]=l.useState(0),[_,I]=l.useState(o),[Y,se]=l.useState(null),[xe,M]=l.useState(!1),[te,ie]=l.useState(p||"auto"),[ce,Ie]=l.useState(null),[Se,Ae]=l.useState(null),[be,Ee]=l.useState(!1),[Ce,de]=l.useState(1),[Te,tt]=l.useState("horizontal"),Be=[.25,.5,.75,1,1.25,1.5,2];l.useEffect(()=>{if(f.current&&S&&W&&U&&G){const b=f.current,H=()=>{b.currentTime>=ve&&(b.currentTime=Me)};return b.addEventListener("timeupdate",H),()=>b.removeEventListener("timeupdate",H)}},[S,Me,ve,W,U,G]),l.useEffect(()=>{const b=H=>{if(!f.current)return;const we=document.activeElement;if(!(we&&(we.tagName==="INPUT"||we.tagName==="TEXTAREA"||we.contentEditable==="true"||we.classList.contains("ql-editor"))))switch(H.code){case"Space":H.preventDefault(),L();break;case"ArrowLeft":H.preventDefault(),X(-10);break;case"ArrowRight":H.preventDefault(),X(10);break;case"KeyA":H.preventDefault(),O(T);break;case"KeyB":H.preventDefault(),pe(T);break;case"KeyL":H.preventDefault(),Fe(!je);break;case"KeyS":H.preventDefault();const at=(Be.indexOf(Ce)+1)%Be.length;jt(Be[at]);break}};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[T,je,Ce]),l.useEffect(()=>{if(_&&W){const b=setTimeout(()=>{I(!1)},4e3);return se(b),()=>clearTimeout(b)}},[_,W]),l.useEffect(()=>()=>{Y&&clearTimeout(Y),ze&&clearTimeout(ze)},[]),l.useEffect(()=>{f.current&&(f.current.volume=q,f.current.muted=re,f.current.playbackRate=Ce)},[q,re,Ce]),l.useEffect(()=>{te==="auto"&&ce&&Ae(ce)},[te,ce]),l.useEffect(()=>{const b=H=>{xe&&M(!1),be&&Ee(!1)};return document.addEventListener("click",b),()=>document.removeEventListener("click",b)},[xe,be]);const k=()=>{I(!0),Y&&clearTimeout(Y)},Ge=()=>{k()},[Ke,oe]=l.useState(0),[Xe,st]=l.useState(0),mt=b=>{const H=Date.now();if(H-Ke<300){const $e=b.currentTarget.getBoundingClientRect(),at=b.clientX-$e.left,Ye=$e.width;at<Ye/2?X(-10):X(10),st(0),oe(0)}else st(1),oe(H)},L=()=>{console.log("Toggle play clicked!"),f.current&&(W?f.current.pause():f.current.play(),w(!W))},X=b=>{if(f.current){const H=Math.max(0,Math.min(j,T+b));f.current.currentTime=H,B(H)}},Ze=()=>{f.current&&(B(f.current.currentTime),x==null||x(f.current.currentTime))},Pe=()=>{if(f.current){z(f.current.duration);const b=f.current,H=b.videoWidth,we=b.videoHeight;if(H&&we){const $e=we>H;tt($e?"vertical":"horizontal"),console.log(`Orientaci√≥n del video: ${$e?"vertical":"horizontal"} (${H}x${we})`),console.log(`Aspect ratio: ${H}:${we} = ${(H/we).toFixed(2)}`);const at=Math.max(H,we);let Ye="480p";at>=3840?Ye="4k":at>=1920?Ye="1080p":at>=1280?Ye="720p":at>=854?Ye="480p":Ye="360p",Ie(Ye),console.log(`Resoluci√≥n m√°xima del video: ${Ye} (${H}x${we})`)}c&&(b.play(),w(!0))}},g=()=>{je&&!S?f.current&&(f.current.currentTime=0,f.current.play()):S?f.current&&(f.current.currentTime=Me,f.current.play()):w(!1),i==null||i()},C=b=>{if(f.current){const H=b.currentTarget.getBoundingClientRect(),$e=(b.clientX-H.left)/H.width*j;f.current.currentTime=$e,B($e)}},$=()=>{if(console.log("Toggle mute clicked!"),f.current){const b=!re;f.current.muted=b,he(b),b?f.current.volume=0:f.current.volume=q}},v=b=>{const H=parseFloat(b.target.value);console.log("Volume changed to:",H),f.current&&(f.current.volume=H,J(H),H===0?(f.current.muted=!0,he(!0)):(f.current.muted=!1,he(!1)))},ye=()=>{try{document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),De(!1)):(V.current.requestFullscreen?V.current.requestFullscreen():V.current.webkitRequestFullscreen?V.current.webkitRequestFullscreen():V.current.msRequestFullscreen&&V.current.msRequestFullscreen(),De(!0))}catch(b){console.error("Error toggling fullscreen:",b)}},_e=b=>{b==="start"?U?(K(!1),O(0),console.log("Punto A eliminado")):(K(!0),O(T),d(T),console.log(`Punto A establecido en: ${Qe(T)}`)):G?(Q(!1),pe(0),console.log("Punto B eliminado")):(Q(!0),pe(T),D(T),console.log(`Punto B establecido en: ${Qe(T)}`))},Qe=b=>{const H=Math.floor(b/60),we=Math.floor(b%60);return`${H}:${we.toString().padStart(2,"0")}`},ft=b=>{ie(b),M(!1),b==="auto"&&ce?Ae(ce):b!=="auto"&&Ae(null),R==null||R(b)},jt=b=>{f.current&&(f.current.playbackRate=b,de(b)),Ee(!1)},Et=b=>b===1?"Normal":`${b}x`,Nt=b=>{switch(b){case"auto":return Se?`Auto (${Se})`:"Auto";case"4k":return"4K";case"1080p":return"1080p";case"720p":return"720p";case"480p":return"480p";case"360p":return"360p";default:return b}},as=b=>{if(!ce)return!0;const H=["360p","480p","720p","1080p","4k"],we=H.indexOf(ce);return H.indexOf(b)<=we},Pt=()=>{let b="";switch(r){case"small":b="max-w-xs";break;case"medium":b="max-w-md";break;case"large":b="max-w-2xl";break;case"fullscreen":return"w-full h-full";default:b="max-w-md"}return r==="fullscreen"?b:`${b} ${Te==="vertical"?"aspect-[9/16]":"aspect-video"}`},Ft=async()=>{try{if(console.log("Iniciando descarga de video:",N),a&&(a.includes("firebase")||a.includes("googleapis"))){console.log("Detectada URL de Firebase Storage, descargando...");const b=await fetch(a);if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const H=await b.blob();console.log("Blob descargado:",H.size,"bytes");const we=URL.createObjectURL(H),$e=document.createElement("a");$e.href=we,$e.download=N||"video.mp4",$e.style.display="none",document.body.appendChild($e),$e.click(),document.body.removeChild($e),setTimeout(()=>{URL.revokeObjectURL(we)},1e3),console.log("Descarga completada exitosamente")}else{console.log("Usando m√©todo de descarga directa para URL no-Firebase");const b=document.createElement("a");b.href=a,b.download=N||"video.mp4",b.style.display="none",document.body.appendChild(b),b.click(),document.body.removeChild(b)}}catch(b){console.error("Error en descarga:",b),alert(`Error al descargar el video: ${b.message}`)}};return e.jsxs("div",{ref:V,className:`relative bg-black rounded-lg overflow-hidden video-player-container ${Pt()} ${m} ${Te==="vertical"?"video-player-vertical":""}`,onMouseMove:k,onMouseLeave:()=>{if(W){const b=setTimeout(()=>{I(!1)},4e3);se(b)}},onTouchStart:k,onTouchMove:k,onClick:Ge,onDoubleClick:mt,children:[e.jsx("video",{ref:f,src:a,className:`w-full h-full cursor-pointer ${r==="fullscreen"?"object-contain":"object-cover"}`,muted:re,loop:je&&!S,onTimeUpdate:Ze,onLoadedMetadata:Pe,onEnded:g,onPlay:()=>w(!0),onPause:()=>w(!1),onClick:Ge,onDoubleClick:mt,onTouchStart:k,onTouchMove:k}),_&&e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent",onMouseMove:k,onTouchStart:k,onTouchMove:k,children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-end items-center",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:ye,onTouchStart:k,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:Re?e.jsx(Zs,{className:"w-4 h-4"}):e.jsx(Xs,{className:"w-4 h-4"})})})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>X(-10),onTouchStart:k,className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(gs,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm font-medium",children:"10"})]})}),e.jsx("button",{onClick:L,onTouchStart:k,className:"p-4 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:W?e.jsx(Qs,{className:"w-8 h-8"}):e.jsx(et,{className:"w-8 h-8"})}),e.jsx("button",{onClick:()=>X(10),onTouchStart:k,className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"10"}),e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(ps,{className:"w-3 h-3"})})]})})]})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[e.jsxs("div",{className:"flex justify-end mb-2 space-x-2",children:[e.jsx("button",{onClick:()=>Fe(!je),onTouchStart:k,className:`p-2 rounded-full transition-colors z-10 ${je?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Bucle",children:e.jsx(Ys,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{const b=!S;F(b),b?(ue>0&&(K(!0),O(ue)),A>0&&(Q(!0),pe(A))):(K(!1),Q(!1),O(0),pe(0)),console.log(`Modo A-B ${b?"activado":"desactivado"}`)},onTouchStart:k,className:`p-2 rounded-full transition-colors z-10 ${S?"bg-green-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Segmento A-B",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:"A-B"})}),y&&y.length>0&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>M(!xe),onTouchStart:k,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Resoluci√≥n",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:Nt(te)})}),xe&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",onTouchStart:k,onTouchMove:k,children:y.map(b=>{const H=as(b);return e.jsxs("button",{onClick:()=>H&&ft(b),className:`w-full text-left px-3 py-1 rounded text-xs transition-colors ${H?te===b?"bg-blue-500 text-white":"text-white hover:bg-white/20":"text-gray-500 cursor-not-allowed opacity-50"}`,disabled:!H,children:[Nt(b),!H&&e.jsx("span",{className:"ml-1 text-[10px] opacity-75",children:"(no disponible)"})]},b)})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>Ee(!be),onTouchStart:k,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Velocidad de reproducci√≥n",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:Ce===1?"1x":`${Ce}x`})}),be&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",onTouchStart:k,onTouchMove:k,children:Be.map(b=>e.jsx("button",{onClick:()=>jt(b),className:`w-full text-left px-3 py-1 rounded text-xs transition-colors ${Ce===b?"bg-blue-500 text-white":"text-white hover:bg-white/20"}`,children:Et(b)},b))})]}),e.jsx("button",{onClick:Ft,onTouchStart:k,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Descargar video",children:e.jsx(ut,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:$,onTouchStart:k,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",onMouseEnter:()=>ne(!0),onMouseLeave:()=>{const b=setTimeout(()=>ne(!1),1e3);ke(b)},children:re?e.jsx(ea,{className:"w-4 h-4"}):e.jsx(Js,{className:"w-4 h-4"})}),Ne&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/80 rounded-lg p-3 z-20",onMouseEnter:()=>{ze&&(clearTimeout(ze),ke(null))},onMouseLeave:()=>{const b=setTimeout(()=>ne(!1),1e3);ke(b)},onTouchStart:k,onTouchMove:k,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:q,onChange:v,onTouchStart:k,onTouchMove:k,className:"w-2 h-20 bg-gray-600 rounded-lg appearance-none cursor-pointer slider-vertical",style:{background:`linear-gradient(to top, #3b82f6 0%, #3b82f6 ${q*100}%, #4b5563 ${q*100}%, #4b5563 100%)`},orient:"vertical"}),e.jsxs("span",{className:"text-white text-xs",children:[Math.round(q*100),"%"]})]})})]})]}),e.jsx("div",{className:"relative mb-4",children:e.jsxs("div",{className:"w-full h-2 bg-white/20 rounded-full cursor-pointer relative",onClick:C,onTouchStart:k,onTouchMove:k,children:[e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${T/j*100}%`}}),S&&U&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-green-500 z-10",style:{left:`${Me/j*100}%`}}),S&&G&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-red-500 z-10",style:{left:`${ve/j*100}%`}})]})}),e.jsxs("div",{className:"flex items-center justify-between text-white text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:[Qe(T)," / ",Qe(j)]}),Ce!==1&&e.jsxs("span",{className:"text-blue-400 font-medium",children:[Ce,"x"]}),S&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>_e("start"),onTouchStart:k,className:`px-2 py-1 rounded text-xs transition-colors ${U?"bg-green-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["A: ",U?Qe(Me):"--:--"]}),e.jsxs("button",{onClick:()=>_e("end"),onTouchStart:k,className:`px-2 py-1 rounded text-xs transition-colors ${G?"bg-red-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["B: ",G?Qe(ve):"--:--"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("div",{className:"text-xs opacity-75",children:je&&(S&&U&&G?"Bucle A-B":"Bucle completo")})})]})]})]})]})},ar=async a=>{try{console.log("üéµ Iniciando detecci√≥n de BPM para:",a.name);const r=new(window.AudioContext||window.webkitAudioContext),t=await a.arrayBuffer(),n=await r.decodeAudioData(t);if(!rr(n))return console.log("üéµ Video sin audio significativo, usando BPM por defecto"),{success:!1,bpm:null,originalBPM:null,error:"Video sin audio significativo"};console.log("üéµ Audio decodificado, detectando BPM...");const c=await nr(n),h=Math.round(c);return console.log(`‚úÖ BPM detectado: ${h} para ${a.name}`),{success:!0,bpm:h,originalBPM:c,error:null}}catch(r){return console.error("‚ùå Error al detectar BPM:",r),{success:!1,bpm:null,originalBPM:null,error:r.message}}},rr=a=>{const r=a.getChannelData(0),t=a.sampleRate,n=Math.min(5*t,r.length),o=r.slice(0,n),c=Math.sqrt(o.reduce((h,x)=>h+x*x,0)/o.length);return console.log(`üéµ Nivel de audio RMS: ${c.toFixed(4)}`),c>.01},nr=async a=>{const r=a.sampleRate,t=a.getChannelData(0),n=Math.min(10*r,t.length),o=t.slice(0,n),c=or(o,r),h=[];for(let x=1;x<c.length;x++)h.push(c[x]-c[x-1]);if(h.length>0){const x=h.reduce((y,p)=>y+p,0)/h.length,i=60*r/x;if(console.log(`üéµ BPM calculado: ${i}, intervalos: ${h.length}, promedio: ${x}`),i>300)return console.log(`üéµ BPM demasiado alto (${i}), probablemente error de detecci√≥n`),120;const m=Math.max(80,Math.min(180,i));return i!==m&&console.log(`üéµ BPM ajustado de ${i} a ${m}`),m>=175&&(console.log(`üéµ BPM muy alto (${m}), verificando si es real...`),h.filter(p=>Math.abs(p-x)<x*.3).length<h.length*.7)?(console.log("üéµ BPM alto pero intervalos inconsistentes, usando BPM por defecto"),120):m}return console.log("üéµ No se detectaron intervalos, usando BPM por defecto: 120"),120},or=(a,r)=>{const t=[],n=a.map(i=>i*i),o=n.reduce((i,m)=>i+m,0)/n.length,c=Math.max(.01,Math.min(.5,o*3)),h=r*.5;console.log(`üéµ Detectando picos con umbral: ${c.toFixed(4)}, energ√≠a promedio: ${o.toFixed(4)}`);const x=Math.floor(r*.1);for(let i=x;i<a.length-x;i++){const m=a.slice(i-x,i+x),y=Math.max(...m);a[i]===y&&a[i]>c&&(t.length===0||i-t[t.length-1]>h)&&t.push(i)}if(console.log(`üéµ Picos detectados: ${t.length}`),t.length<3){console.log("üéµ Pocos picos detectados, reduciendo umbral...");const i=c*.5;t.length=0;for(let m=x;m<a.length-x;m++){const y=a.slice(m-x,m+x),p=Math.max(...y);a[m]===p&&a[m]>i&&(t.length===0||m-t[t.length-1]>h)&&t.push(m)}console.log(`üéµ Picos detectados con umbral reducido: ${t.length}`)}return t},lr=a=>a<80||a>180?(console.warn(`‚ö†Ô∏è BPM fuera de rango para salsa: ${a} (rango esperado: 80-180)`),!1):!0,ir=({isOpen:a,onClose:r,onVideoUploaded:t,page:n="figuras",style:o="salsa"})=>{const{user:c}=Jt(),{currentCategories:h,categoriesList:x}=Mt(n,o),i=l.useRef(null),[m,y]=l.useState([]),[p,R]=l.useState(!1),[N,f]=l.useState({}),[V,W]=l.useState(1),[w,T]=l.useState({}),[B,j]=l.useState([]),[z,q]=l.useState({}),J=l.useRef({}),[re,he]=l.useState(new Set);l.useEffect(()=>{a?W(1):Ne()},[a]),l.useEffect(()=>{if(h){const d={};Object.keys(h).forEach(A=>{d[A]=[]}),q(d)}},[h]);const Ne=()=>{Object.values(w).forEach(d=>{d.videoPreview&&URL.revokeObjectURL(d.videoPreview),d.thumbnailPreview&&URL.revokeObjectURL(d.thumbnailPreview)}),y([]),T({}),he(new Set),f({}),R(!1),W(1),i.current&&(i.current.value="")},ne=(d,A="success")=>{const D=Date.now();j(_=>[..._,{id:D,message:d,type:A}])},ze=d=>{j(A=>A.filter(D=>D.id!==d))},ke=d=>{he(A=>{const D=new Set(A);return D.has(d)?D.delete(d):D.add(d),D})},Re=d=>{he(d?new Set(m.map(A=>A.name)):new Set)},De=d=>{const D=Array.from(d.target.files).filter(I=>I.type.startsWith("video/"));if(D.length===0){ne("Por favor selecciona archivos de video v√°lidos","error");return}const _=D.filter(I=>!m.some(Y=>Y.name===I.name));if(_.length===0){ne("Algunos archivos ya est√°n seleccionados","warning");return}y(I=>[...I,..._]),_.forEach(async I=>{const Y=URL.createObjectURL(I);try{const se=await O(I),xe=URL.createObjectURL(se);T(M=>({...M,[I.name]:{...M[I.name],videoPreview:Y,thumbnailPreview:xe}}))}catch(se){console.warn("Error generando thumbnail para vista previa:",se),T(xe=>({...xe,[I.name]:{...xe[I.name],videoPreview:Y}}))}}),ne(`${_.length} video(s) agregado(s)`,"success")},je=d=>{const A=m[d];A&&w[A.name]&&(w[A.name].videoPreview&&URL.revokeObjectURL(w[A.name].videoPreview),w[A.name].thumbnailPreview&&URL.revokeObjectURL(w[A.name].thumbnailPreview)),y(D=>D.filter((_,I)=>I!==d)),T(D=>{const _={...D};return delete _[A.name],_}),he(D=>{const _=new Set(D);return _.delete(A.name),_})},Fe=(d,A)=>{q(D=>{const _=D[d]||[];if(_.includes(A))return{...D,[d]:_.filter(Y=>Y!==A)};{const Y=[...new Set([..._,A])];return{...D,[d]:Y}}})},Me=async d=>{var A;try{if((A=w[d.name])!=null&&A.customThumbnailFile){const D=w[d.name].customThumbnailFile,_=`thumbnails/${n}/${o}/${Date.now()}_${d.name.replace(/\.[^/.]+$/,".jpg")}`,I=await kt(D,_);if(I.success)return{url:I.url,path:I.path}}try{const D=await Promise.race([Va(d),new Promise((_,I)=>setTimeout(()=>I(new Error("Timeout")),15e3))]);if(D.success&&D.blob){const _=`thumbnails/${n}/${o}/${Date.now()}_${d.name.replace(/\.[^/.]+$/,".jpg")}`,I=await kt(D.blob,_);if(I.success)return D.thumbnailURL&&URL.revokeObjectURL(D.thumbnailURL),{url:I.url,path:I.path}}}catch(D){console.warn("Error generando thumbnail autom√°tico:",D)}try{const D=await O(d);if(D){const _=`thumbnails/${n}/${o}/${Date.now()}_${d.name.replace(/\.[^/.]+$/,".jpg")}`,I=await kt(D,_);if(I.success)return{url:I.url,path:I.path}}}catch(D){console.warn("Error generando thumbnail por defecto:",D)}return{url:null,path:null}}catch(D){return console.error("Error en generateThumbnail:",D),{url:null,path:null}}},O=async d=>new Promise((A,D)=>{try{const _=URL.createObjectURL(d),I=document.createElement("video");I.crossOrigin="anonymous",I.muted=!0,I.playsInline=!0;const Y=document.createElement("canvas"),se=Y.getContext("2d");Y.width=1280,Y.height=720,I.onloadedmetadata=()=>{try{I.currentTime=.1,I.onseeked=()=>{try{se.drawImage(I,0,0,Y.width,Y.height),Y.toBlob(xe=>{xe?(URL.revokeObjectURL(_),I.remove(),Y.remove(),A(xe)):D(new Error("No se pudo generar el thumbnail por defecto"))},"image/jpeg",.95)}catch(xe){D(new Error(`Error al capturar frame por defecto: ${xe.message}`))}},I.onerror=()=>{D(new Error("Error al cargar el video para thumbnail por defecto"))}}catch(xe){D(new Error(`Error al procesar metadata por defecto: ${xe.message}`))}},I.onerror=()=>{URL.revokeObjectURL(_),I.remove(),Y.remove(),D(new Error("Error al cargar el video por defecto"))},I.src=_}catch(_){D(new Error(`Error al generar thumbnail por defecto: ${_.message}`))}}),ve=async(d,A)=>{var D,_,I,Y;try{if((await ba(d.name)).isDuplicate)return ne(`Video "${d.name}" ya existe en la base de datos`,"warning"),null;const xe=await Me(d),M=`videos/${n}/${o}/${Date.now()}_${d.name}`,te=await Ba(d,M,k=>{f(Ge=>({...Ge,[A]:k}))});if(!te.success)return ne(`Error al subir ${d.name}: ${te.error}`,"error"),null;const ie={...z,estilo:z.estilo||[]},ce=J.current[`${d.name}-title`],Ie=J.current[`${d.name}-description`],Se=((D=ce==null?void 0:ce.value)==null?void 0:D.trim())||((_=w[d.name])==null?void 0:_.title)||d.name.replace(/\.[^/.]+$/,""),Ae=((I=Ie==null?void 0:Ie.value)==null?void 0:I.trim())||((Y=w[d.name])==null?void 0:Y.description)||"";let be=null,Ee=null,Ce=null;try{const k=document.createElement("video");k.src=URL.createObjectURL(d),await new Promise((Ge,Ke)=>{k.onloadedmetadata=()=>{Ee=k.videoWidth,Ce=k.videoHeight;const oe=Math.max(Ee,Ce);oe>=3840?be="4K":oe>=1920?be="1080p":oe>=1280?be="720p":oe>=854?be="480p":be="360p",URL.revokeObjectURL(k.src),Ge()},k.onerror=Ke})}catch(k){console.warn("No se pudo detectar la resoluci√≥n del video:",k),be="Unknown"}let de=null,Te=!1;try{console.log("üéµ Detectando BPM para:",d.name);const k=await ar(d);k.success&&lr(k.bpm)?(de=k.bpm,Te=!0,console.log(`‚úÖ BPM detectado: ${de} para ${d.name}`)):console.warn(`‚ö†Ô∏è No se pudo detectar BPM v√°lido para ${d.name}`)}catch(k){console.error("‚ùå Error al detectar BPM:",k)}const tt={title:Se,originalTitle:d.name,description:Ae,videoUrl:te.url,thumbnailUrl:xe.url||null,videoPath:te.path,thumbnailPath:xe.path||null,fileSize:d.size,fileType:d.type,duration:0,resolution:be,videoWidth:Ee,videoHeight:Ce,style:o,tags:ie,uploadedBy:(c==null?void 0:c.uid)||"anonymous",uploadedAt:new Date().toISOString(),views:0,likes:0,likedBy:[],bpm:de,bpmDetected:Te},Be=await ya(tt);return Be.success?(ne(`${d.name} subido exitosamente`,"success"),{...tt,id:Be.id}):(ne(`Error al guardar metadatos de ${d.name}`,"error"),null)}catch(se){return console.error("Error uploading video:",se),ne(`Error inesperado al subir ${d.name}`,"error"),null}},pe=async()=>{if(m.length===0){ne("Selecciona al menos un video","error");return}R(!0);const d=[];for(let A=0;A<m.length;A++){const D=m[A],_=await ve(D,A);_&&d.push(_)}R(!1),d.length>0&&(ne(`${d.length} video(s) subido(s) correctamente`,"success"),d.forEach(A=>t(A)),r())},S=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Seleccionar Videos"}),e.jsx("p",{className:"text-gray-600",children:"Selecciona uno o varios videos para subir"})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-pink-400 transition-colors duration-200",children:[e.jsx("input",{ref:i,type:"file",multiple:!0,accept:"video/*",onChange:De,className:"hidden"}),e.jsxs("button",{onClick:()=>{var d;return(d=i.current)==null?void 0:d.click()},className:"w-full flex flex-col items-center justify-center space-y-2 text-gray-600 hover:text-pink-500 transition-colors duration-200",children:[e.jsx(hs,{className:"h-12 w-12"}),e.jsx("span",{className:"font-medium text-center",children:"Haz clic para seleccionar videos"}),e.jsx("span",{className:"text-sm text-center",children:"MP4, AVI, MOV, etc. (m√°x. 100MB cada uno)"})]})]}),m.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Videos seleccionados (",m.length,")"]}),m.map((d,A)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:d.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(d.size/(1024*1024)).toFixed(2)," MB"]})]}),e.jsx("button",{onClick:()=>je(A),className:"p-1 text-red-500 hover:text-red-700 transition-colors duration-200",children:e.jsx(vt,{className:"h-4 w-4"})})]},A))]})]}),F=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Configurar Videos"}),e.jsx("p",{className:"text-gray-600",children:"Personaliza la informaci√≥n de tus videos antes de subirlos"})]}),m.length>1&&e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsxs("button",{onClick:()=>Re(!0),className:"flex items-center space-x-1 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsx("span",{children:"Plegar Todo"})]}),e.jsxs("button",{onClick:()=>Re(!1),className:"flex items-center space-x-1 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[e.jsx(Ga,{className:"h-4 w-4"}),e.jsx("span",{children:"Desplegar Todo"})]})]}),m.map((d,A)=>{var _,I,Y,se,xe;const D=re.has(d.name);return e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"w-12 h-9 bg-gray-100 rounded flex items-center justify-center relative overflow-hidden",children:[(_=w[d.name])!=null&&_.thumbnailPreview?e.jsx("img",{src:w[d.name].thumbnailPreview,alt:"Vista previa del video",className:"w-full h-full object-cover",onError:M=>{M.target.style.display="none",M.target.nextSibling.style.display="flex"}}):null,e.jsx("span",{className:"text-xs text-gray-500",style:{display:(I=w[d.name])!=null&&I.thumbnailPreview?"none":"flex"},children:"VIDEO"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:d.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(d.size/(1024*1024)).toFixed(2)," MB"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>ke(d.name),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",title:D?"Desplegar":"Plegar",children:D?e.jsx(Xt,{className:"h-4 w-4"}):e.jsx(Qt,{className:"h-4 w-4"})})})]}),!D&&e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Vista previa del video"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Dt,{src:((Y=w[d.name])==null?void 0:Y.videoPreview)||URL.createObjectURL(d),size:"medium",loop:!0,showControls:!0,autoplay:!1,muted:!1,className:"w-full max-w-2xl",resolutions:["auto","4k","1080p","720p","480p","360p"],currentResolution:"auto",videoTitle:((se=w[d.name])==null?void 0:se.title)||d.name.replace(/\.[^/.]+$/,""),onResolutionChange:M=>{console.log(`Resoluci√≥n cambiada a: ${M}`)}})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{children:d.name}),e.jsxs("span",{children:[(d.size/(1024*1024)).toFixed(2)," MB"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre del video"}),e.jsx("input",{type:"text","data-file":d.name,"data-field":"title",ref:M=>{var te;M&&(J.current[`${d.name}-title`]=M,M.value||(M.value=((te=w[d.name])==null?void 0:te.title)||d.name.replace(/\.[^/.]+$/,"")))},onBlur:M=>{var ie;const te=M.target.value.trim();te!==(((ie=w[d.name])==null?void 0:ie.title)||d.name.replace(/\.[^/.]+$/,""))&&T(ce=>({...ce,[d.name]:{...ce[d.name],title:te}}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"Ingresa un nombre para el video"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descripci√≥n (opcional)"}),e.jsx("textarea",{"data-file":d.name,"data-field":"description",ref:M=>{var te;M&&(J.current[`${d.name}-description`]=M,M.value||(M.value=((te=w[d.name])==null?void 0:te.description)||""))},onBlur:M=>{var ie;const te=M.target.value.trim();te!==(((ie=w[d.name])==null?void 0:ie.description)||"")&&T(ce=>({...ce,[d.name]:{...ce[d.name],description:te}}))},rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"Describe brevemente el contenido del video..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Thumbnail personalizado (opcional)"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-40 h-24 bg-gray-100 rounded border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden",children:(xe=w[d.name])!=null&&xe.customThumbnail?e.jsx("img",{src:w[d.name].customThumbnail,alt:"Thumbnail personalizado",className:"w-full h-full object-cover rounded"}):e.jsx("span",{className:"text-xs text-gray-500",children:"IMG"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:M=>{const te=M.target.files[0];if(te){const ie=new FileReader;ie.onload=ce=>{T(Ie=>({...Ie,[d.name]:{...Ie[d.name],customThumbnail:ce.target.result,customThumbnailFile:te}}))},ie.readAsDataURL(te)}},className:"flex-1 text-sm text-gray-500 file:mr-4 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-sm file:font-medium file:bg-pink-50 file:text-pink-700 hover:file:bg-pink-100"})]})]})]})]},A)}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Etiquetas para todos los videos"}),x.map(d=>e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("h5",{className:"font-medium text-gray-700 capitalize",children:d.name}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.tags.map(A=>{var D;return e.jsx("button",{onClick:()=>Fe(d.key,A),className:`px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 ${(D=z[d.key])!=null&&D.includes(A)?"bg-gradient-to-r from-pink-500 to-orange-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:A},A)})})]},d.key))]}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Rt,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Informaci√≥n"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Personaliza cada video individualmente y aplica etiquetas que se usar√°n para todos los videos seleccionados."})]})]})})]}),U=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Subiendo Videos"}),e.jsxs("p",{className:"text-gray-600",children:["Procesando ",m.length," video(s)..."]})]}),m.map((d,A)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:d.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:[N[A]||0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-pink-500 to-orange-500 h-2 rounded-full transition-all duration-300",style:{width:`${N[A]||0}%`}})})]},A))]}),K=()=>{switch(V){case 1:return e.jsx(S,{});case 2:return e.jsx(F,{});case 3:return e.jsx(U,{});default:return e.jsx(S,{})}},G=()=>{switch(V){case 1:return m.length>0;case 2:return!0;case 3:return!1;default:return!1}},Q=()=>{V===2?pe():(W(d=>d+1),V===1&&he(new Set(m.map(d=>d.name))))},ue=()=>{W(d=>Math.max(1,d-1))};return a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full",children:e.jsx(hs,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Subir Videos"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Paso ",V," de 3"]})]})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:e.jsx(ot,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:K()}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:ue,disabled:V===1||p,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Atr√°s"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:r,disabled:p,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),V<3&&e.jsx("button",{onClick:Q,disabled:!G()||p,className:"px-6 py-2 bg-gradient-to-r from-pink-500 to-orange-500 text-white rounded-lg font-medium hover:shadow-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:V===2?"Subir Videos":"Siguiente"})]})]})]})}),B.map(d=>e.jsx(At,{message:d.message,type:d.type,onClose:()=>ze(d.id)},d.id))]}):null},cr=({isOpen:a,onClose:r,video:t,onVideoUpdated:n,page:o="figuras",style:c="salsa"})=>{const{user:h}=Jt(),{currentCategories:x,categoriesList:i}=Mt(o,c),[m,y]=l.useState(!1),[p,R]=l.useState([]),[N,f]=l.useState(""),[V,W]=l.useState(""),[w,T]=l.useState(null),[B,j]=l.useState(null),[z,q]=l.useState({}),[J,re]=l.useState({}),[he,Ne]=l.useState({}),[ne,ze]=l.useState(new Set(["tags-iniciales","tags-finales"]));l.useEffect(()=>{if(!(!a||!t)&&(f(t.title||""),W(t.description||""),T(t.thumbnailUrl||null),j(null),x)){const S={},F={},U={};Object.keys(x).forEach(K=>{var G,Q,ue;S[K]=((G=t.tags)==null?void 0:G[K])||[],F[K]=((Q=t.tagsIniciales)==null?void 0:Q[K])||[],U[K]=((ue=t.tagsFinales)==null?void 0:ue[K])||[]}),q(S),re(F),Ne(U)}},[a,t,x]),l.useEffect(()=>{a||(f(""),W(""),T(null),j(null),q({}),re({}),Ne({}))},[a]);const ke=(S,F="success")=>{const U=Date.now();R(K=>[...K,{id:U,message:S,type:F}])},Re=S=>{R(F=>F.filter(U=>U.id!==S))},De=S=>{ze(F=>{const U=new Set(F);return U.has(S)?U.delete(S):U.add(S),U})},je=(S,F)=>{q(U=>{const K=U[S]||[];if(K.includes(F))return{...U,[S]:K.filter(Q=>Q!==F)};{const Q=[...new Set([...K,F])];return{...U,[S]:Q}}})},Fe=(S,F)=>{re(U=>{const K=U[S]||[];if(K.includes(F))return{...U,[S]:K.filter(Q=>Q!==F)};{const Q=[...new Set([...K,F])];return{...U,[S]:Q}}})},Me=(S,F)=>{Ne(U=>{const K=U[S]||[];if(K.includes(F))return{...U,[S]:K.filter(Q=>Q!==F)};{const Q=[...new Set([...K,F])];return{...U,[S]:Q}}})},O=S=>{const F=S.target.files[0];if(F){const U=new FileReader;U.onload=K=>{T(K.target.result),j(F)},U.readAsDataURL(F)}},ve=async S=>{try{const F=document.createElement("video");F.src=S,await new Promise((U,K)=>{F.onloadedmetadata=()=>{const G=F.videoWidth,Q=F.videoHeight,ue=Math.max(G,Q);let d="Unknown";ue>=3840?d="4K":ue>=1920?d="1080p":ue>=1280?d="720p":ue>=854?d="480p":d="360p",U({resolution:d,videoWidth:G,videoHeight:Q})},F.onerror=K,setTimeout(()=>K(new Error("Timeout")),1e4)})}catch(F){return console.warn("No se pudo detectar la resoluci√≥n del video:",F),{resolution:"Unknown",videoWidth:null,videoHeight:null}}},pe=async()=>{if(t){y(!0);try{let S=t.thumbnailUrl,F=t.thumbnailPath;if(B){const A=`thumbnails/${Date.now()}_${t.originalTitle.replace(/\.[^/.]+$/,".jpg")}`,D=await kt(B,A);if(D.success)S=D.url,F=D.path;else{ke("Error al subir el nuevo thumbnail","error"),y(!1);return}}const U={...z,estilo:z.estilo||[]};let K=t.resolution,G=t.videoWidth,Q=t.videoHeight;if(!K||K==="Unknown")try{const A=await ve(t.videoUrl);K=A.resolution,G=A.videoWidth,Q=A.videoHeight,console.log(`Resoluci√≥n detectada: ${K} (${G}x${Q})`)}catch(A){console.warn("No se pudo detectar la resoluci√≥n:",A),K="Unknown"}const ue={title:N.trim(),description:V.trim(),thumbnailUrl:S,thumbnailPath:F,resolution:K,videoWidth:G,videoHeight:Q,tags:U,tagsIniciales:J,tagsFinales:he,updatedBy:(h==null?void 0:h.uid)||"anonymous",updatedAt:new Date().toISOString()},d=await _t(t.id,ue);d.success?(ke("Video actualizado exitosamente","success"),n({...t,...ue}),r()):ke(`Error al actualizar video: ${d.error}`,"error")}catch(S){console.error("Error updating video:",S),ke("Error inesperado al actualizar video","error")}y(!1)}};return!a||!t?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full",children:e.jsx(Gt,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Editar Video"}),e.jsx("p",{className:"text-sm text-gray-500",children:t.title})]})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:e.jsx(ot,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Vista previa del video"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Dt,{src:t.videoUrl,size:"medium",loop:!0,showControls:!0,autoplay:!1,muted:!1,className:"w-full max-w-2xl",resolutions:["auto","4k","1080p","720p","480p","360p"],currentResolution:"auto",videoTitle:t.title||"video",onResolutionChange:S=>{console.log(`Resoluci√≥n cambiada a: ${S}`)}})}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:t.originalTitle}),e.jsx("span",{className:"text-gray-400",children:"‚Ä¢"}),e.jsxs("span",{children:[(t.fileSize/(1024*1024)).toFixed(2)," MB"]}),t.resolution&&t.resolution!=="Unknown"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"‚Ä¢"}),e.jsx("span",{children:t.resolution})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"T√≠tulo del video"}),e.jsx("input",{type:"text",value:N,onChange:S=>f(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 placeholder-gray-500",placeholder:"Ingresa un t√≠tulo para el video"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descripci√≥n"}),e.jsx("textarea",{value:V,onChange:S=>W(S.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 placeholder-gray-500",placeholder:"Describe brevemente el contenido del video..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Thumbnail personalizado"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-40 h-24 bg-gray-100 rounded border-2 border-dashed border-gray-300 flex items-center justify-center",children:w?e.jsx("img",{src:w,alt:"Thumbnail",className:"w-full h-full object-cover rounded"}):e.jsx("span",{className:"text-xs text-gray-500",children:"IMG"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:O,className:"flex-1 text-sm text-gray-500 file:mr-4 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Tags Normales"}),i.map(S=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-700 capitalize",children:S.name}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S.tags.map(F=>{var U;return e.jsx("button",{onClick:()=>je(S.key,F),className:`px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 ${(U=z[S.key])!=null&&U.includes(F)?"bg-gradient-to-r from-pink-500 to-orange-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:F},F)})})]},S.key))]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("button",{onClick:()=>De("tags-iniciales"),className:"flex items-center justify-between w-full p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg hover:from-blue-100 hover:to-purple-100 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-blue-600"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Tags Iniciales (c√≥mo empieza la figura)"})]}),ne.has("tags-iniciales")?e.jsx(Xt,{className:"h-5 w-5 text-gray-500"}):e.jsx(Qt,{className:"h-5 w-5 text-gray-500"})]}),e.jsx("div",{className:`mt-4 transition-all duration-300 ease-in-out overflow-hidden ${ne.has("tags-iniciales")?"max-h-0 opacity-0":"max-h-96 opacity-100"}`,children:e.jsx("div",{className:"space-y-4 bg-blue-50 rounded-lg p-4",children:i.map(S=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h6",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:S.name}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S.tags.map(F=>{var U;return e.jsx("button",{onClick:()=>Fe(S.key,F),className:`px-2 py-1 rounded-full text-xs font-medium transition-all duration-200 ${(U=J[S.key])!=null&&U.includes(F)?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"bg-white text-gray-700 hover:bg-blue-100"}`,children:F},`inicial-${F}`)})})]},`inicial-${S.key}`))})})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("button",{onClick:()=>De("tags-finales"),className:"flex items-center justify-between w-full p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-lg hover:from-green-100 hover:to-teal-100 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-green-600"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Tags Finales (c√≥mo termina la figura)"})]}),ne.has("tags-finales")?e.jsx(Xt,{className:"h-5 w-5 text-gray-500"}):e.jsx(Qt,{className:"h-5 w-5 text-gray-500"})]}),e.jsx("div",{className:`mt-4 transition-all duration-300 ease-in-out overflow-hidden ${ne.has("tags-finales")?"max-h-0 opacity-0":"max-h-96 opacity-100"}`,children:e.jsx("div",{className:"space-y-4 bg-green-50 rounded-lg p-4",children:i.map(S=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h6",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:S.name}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S.tags.map(F=>{var U;return e.jsx("button",{onClick:()=>Me(S.key,F),className:`px-2 py-1 rounded-full text-xs font-medium transition-all duration-200 ${(U=he[S.key])!=null&&U.includes(F)?"bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-lg":"bg-white text-gray-700 hover:bg-green-100"}`,children:F},`final-${F}`)})})]},`final-${S.key}`))})})]}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Rt,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Informaci√≥n"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Los tags iniciales y finales ayudar√°n a crear secuencias l√≥gicas conectando figuras."})]})]})})]})}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:r,disabled:m,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),e.jsx("button",{onClick:pe,disabled:m||!N.trim(),className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg font-medium hover:shadow-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:m?"Guardando...":"Guardar Cambios"})]})]})}),p.map(S=>e.jsx(At,{message:S.message,type:S.type,onClose:()=>Re(S.id)},S.id))]})};var le;(function(a){a.LOAD="LOAD",a.EXEC="EXEC",a.FFPROBE="FFPROBE",a.WRITE_FILE="WRITE_FILE",a.READ_FILE="READ_FILE",a.DELETE_FILE="DELETE_FILE",a.RENAME="RENAME",a.CREATE_DIR="CREATE_DIR",a.LIST_DIR="LIST_DIR",a.DELETE_DIR="DELETE_DIR",a.ERROR="ERROR",a.DOWNLOAD="DOWNLOAD",a.PROGRESS="PROGRESS",a.LOG="LOG",a.MOUNT="MOUNT",a.UNMOUNT="UNMOUNT"})(le||(le={}));const dr=(()=>{let a=0;return()=>a++})(),ur=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),mr=new Error("called FFmpeg.terminate()");var We,gt,it,yt,wt,Yt,Ve;class hr{constructor(){xt(this,We,null);xt(this,gt,{});xt(this,it,{});xt(this,yt,[]);xt(this,wt,[]);Oe(this,"loaded",!1);xt(this,Yt,()=>{ee(this,We)&&(ee(this,We).onmessage=({data:{id:r,type:t,data:n}})=>{switch(t){case le.LOAD:this.loaded=!0,ee(this,gt)[r](n);break;case le.MOUNT:case le.UNMOUNT:case le.EXEC:case le.FFPROBE:case le.WRITE_FILE:case le.READ_FILE:case le.DELETE_FILE:case le.RENAME:case le.CREATE_DIR:case le.LIST_DIR:case le.DELETE_DIR:ee(this,gt)[r](n);break;case le.LOG:ee(this,yt).forEach(o=>o(n));break;case le.PROGRESS:ee(this,wt).forEach(o=>o(n));break;case le.ERROR:ee(this,it)[r](n);break}delete ee(this,gt)[r],delete ee(this,it)[r]})});xt(this,Ve,({type:r,data:t},n=[],o)=>ee(this,We)?new Promise((c,h)=>{const x=dr();ee(this,We)&&ee(this,We).postMessage({id:x,type:r,data:t},n),ee(this,gt)[x]=c,ee(this,it)[x]=h,o==null||o.addEventListener("abort",()=>{h(new DOMException(`Message # ${x} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(ur));Oe(this,"load",({classWorkerURL:r,...t}={},{signal:n}={})=>(ee(this,We)||($t(this,We,r?new Worker(new URL(r,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),ee(this,Yt).call(this)),ee(this,Ve).call(this,{type:le.LOAD,data:t},void 0,n)));Oe(this,"exec",(r,t=-1,{signal:n}={})=>ee(this,Ve).call(this,{type:le.EXEC,data:{args:r,timeout:t}},void 0,n));Oe(this,"ffprobe",(r,t=-1,{signal:n}={})=>ee(this,Ve).call(this,{type:le.FFPROBE,data:{args:r,timeout:t}},void 0,n));Oe(this,"terminate",()=>{const r=Object.keys(ee(this,it));for(const t of r)ee(this,it)[t](mr),delete ee(this,it)[t],delete ee(this,gt)[t];ee(this,We)&&(ee(this,We).terminate(),$t(this,We,null),this.loaded=!1)});Oe(this,"writeFile",(r,t,{signal:n}={})=>{const o=[];return t instanceof Uint8Array&&o.push(t.buffer),ee(this,Ve).call(this,{type:le.WRITE_FILE,data:{path:r,data:t}},o,n)});Oe(this,"mount",(r,t,n)=>{const o=[];return ee(this,Ve).call(this,{type:le.MOUNT,data:{fsType:r,options:t,mountPoint:n}},o)});Oe(this,"unmount",r=>{const t=[];return ee(this,Ve).call(this,{type:le.UNMOUNT,data:{mountPoint:r}},t)});Oe(this,"readFile",(r,t="binary",{signal:n}={})=>ee(this,Ve).call(this,{type:le.READ_FILE,data:{path:r,encoding:t}},void 0,n));Oe(this,"deleteFile",(r,{signal:t}={})=>ee(this,Ve).call(this,{type:le.DELETE_FILE,data:{path:r}},void 0,t));Oe(this,"rename",(r,t,{signal:n}={})=>ee(this,Ve).call(this,{type:le.RENAME,data:{oldPath:r,newPath:t}},void 0,n));Oe(this,"createDir",(r,{signal:t}={})=>ee(this,Ve).call(this,{type:le.CREATE_DIR,data:{path:r}},void 0,t));Oe(this,"listDir",(r,{signal:t}={})=>ee(this,Ve).call(this,{type:le.LIST_DIR,data:{path:r}},void 0,t));Oe(this,"deleteDir",(r,{signal:t}={})=>ee(this,Ve).call(this,{type:le.DELETE_DIR,data:{path:r}},void 0,t))}on(r,t){r==="log"?ee(this,yt).push(t):r==="progress"&&ee(this,wt).push(t)}off(r,t){r==="log"?$t(this,yt,ee(this,yt).filter(n=>n!==t)):r==="progress"&&$t(this,wt,ee(this,wt).filter(n=>n!==t))}}We=new WeakMap,gt=new WeakMap,it=new WeakMap,yt=new WeakMap,wt=new WeakMap,Yt=new WeakMap,Ve=new WeakMap;var Os;(function(a){a.MEMFS="MEMFS",a.NODEFS="NODEFS",a.NODERAWFS="NODERAWFS",a.IDBFS="IDBFS",a.WORKERFS="WORKERFS",a.PROXYFS="PROXYFS"})(Os||(Os={}));const xr=a=>new Promise((r,t)=>{const n=new FileReader;n.onload=()=>{const{result:o}=n;o instanceof ArrayBuffer?r(new Uint8Array(o)):r(new Uint8Array)},n.onerror=o=>{var c,h;t(Error(`File could not be read! Code=${((h=(c=o==null?void 0:o.target)==null?void 0:c.error)==null?void 0:h.code)||-1}`))},n.readAsArrayBuffer(a)}),ys=async a=>{let r;if(typeof a=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(a)?r=atob(a.split(",")[1]).split("").map(t=>t.charCodeAt(0)):r=await(await fetch(a)).arrayBuffer();else if(a instanceof URL)r=await(await fetch(a)).arrayBuffer();else if(a instanceof File||a instanceof Blob)r=await xr(a);else return new Uint8Array;return new Uint8Array(r)};let bt=null;const ts=async()=>{if(bt&&bt.FS)return console.log("‚úÖ FFmpeg ya inicializado, reutilizando instancia"),bt;console.log("üé¨ Inicializando FFmpeg..."),bt=new hr;try{return await bt.load(),console.log("‚úÖ FFmpeg inicializado correctamente"),bt}catch(a){throw console.error("‚ùå Error al inicializar FFmpeg:",a),bt=null,new Error("No se pudo inicializar FFmpeg")}},gr=async(a,r,t="output.mp4")=>{try{console.log(`üé¨ Ajustando velocidad del video: factor ${r}`);const n=await ts();if(!n||!n.FS)throw new Error("FFmpeg no est√° correctamente inicializado");n.FS("writeFile","input.mp4",await ys(a));try{await n.run("-i","input.mp4","-filter:v",`setpts=${1/r}*PTS`,"-filter:a",`atempo=${r}`,"-c:v","libx264","-c:a","aac","-preset","fast",t)}catch(c){console.log("‚ö†Ô∏è Error con audio, procesando solo video:",c.message),await n.run("-i","input.mp4","-filter:v",`setpts=${1/r}*PTS`,"-c:v","libx264","-an","-preset","fast",t)}const o=n.FS("readFile",t);try{n.FS("unlink","input.mp4"),n.FS("unlink",t)}catch{console.warn("‚ö†Ô∏è No se pudieron limpiar archivos temporales")}return console.log("‚úÖ Velocidad ajustada correctamente"),{success:!0,data:o,error:null}}catch(n){return console.error("‚ùå Error al ajustar velocidad:",n),{success:!1,data:null,error:n.message}}},pr=async(a,r=!1,t=null)=>{try{console.log(`üé¨ Creando preview de secuencia con ${a.length} videos...`),console.log(`üé¨ Control BPM: ${r?"Activado":"Desactivado"}`),r&&t&&console.log(`üé¨ BPM objetivo: ${t}`);const n=await ts(),o=[],c=r&&t;for(let i=0;i<a.length;i++){const m=a[i];let y;if(m.file)y=m.file,console.log(`‚úÖ Video ${i+1}/${a.length}: ${m.title} (archivo local)`);else if(m.videoUrl){console.log(`üì• Descargando video ${i+1}/${a.length} desde URL...`);try{const p=await fetch(m.videoUrl,{mode:"cors",credentials:"omit",headers:{Accept:"video/*,*/*;q=0.9","Cache-Control":"no-cache"}});if(!p.ok)throw new Error(`HTTP ${p.status}: ${p.statusText}`);y=await p.blob(),console.log(`‚úÖ Video ${i+1}/${a.length}: ${m.title} descargado (${y.size} bytes)`)}catch(p){console.warn(`‚ö†Ô∏è Error en fetch directo: ${p.message}`);try{const{getStorage:R,ref:N,getDownloadURL:f}=await pt(async()=>{const{getStorage:j,ref:z,getDownloadURL:q}=await import("./tag-BSjDyQEr.js").then(J=>J.i);return{getStorage:j,ref:z,getDownloadURL:q}},__vite__mapDeps([0,1,2])),V=R();let W=m.videoUrl;if(m.videoUrl.includes("firebasestorage.googleapis.com")){const j=m.videoUrl.split("/o/");j.length>1&&(W=decodeURIComponent(j[1].split("?")[0]))}const w=N(V,W),T=await f(w),B=await fetch(T);if(!B.ok)throw new Error(`HTTP ${B.status}: ${B.statusText}`);y=await B.blob(),console.log(`‚úÖ Video ${i+1}/${a.length}: ${m.title} descargado via Firebase (${y.size} bytes)`)}catch(R){throw new Error(`Error descargando video ${i+1} (${m.title}): ${R.message}`)}}}else throw new Error(`Video ${i+1} (${m.title}) no tiene archivo ni URL asociada`);if(c&&m.bpm){const p=t/m.bpm;console.log(`üé¨ Procesando video ${i+1}/${a.length}: ${m.title} (BPM: ${m.bpm} ‚Üí ${t}, factor: ${p.toFixed(2)}x)`);const R=await gr(y,p,`preview${i}.mp4`);if(!R.success)throw new Error(`Error al procesar video ${i+1} (${m.title}): ${R.error}`);o.push(R.data)}else console.log(`üé¨ Usando video ${i+1}/${a.length}: ${m.title} (sin procesamiento)`),o.push(y)}console.log("üé¨ Concatenando videos para preview...");for(let i=0;i<o.length;i++){const m=o[i],y=m instanceof Blob?await ys(m):m;n.FS("writeFile",`preview${i}.mp4`,y),console.log(`üìù Video ${i+1}/${o.length} escrito al sistema de archivos`)}const h=o.map((i,m)=>`file preview${m}.mp4`).join(`
`);n.FS("writeFile","filelist.txt",h),console.log("üìã Lista de archivos creada"),console.log("üîó Iniciando concatenaci√≥n..."),await n.run("-f","concat","-safe","0","-i","filelist.txt","-c","copy","-avoid_negative_ts","make_zero","sequence_preview.mp4"),console.log("‚úÖ Concatenaci√≥n completada");const x=n.FS("readFile","sequence_preview.mp4");for(let i=0;i<o.length;i++)try{n.FS("unlink",`preview${i}.mp4`)}catch{console.warn(`‚ö†Ô∏è No se pudo limpiar archivo temporal preview${i}.mp4`)}try{n.FS("unlink","filelist.txt"),n.FS("unlink","sequence_preview.mp4")}catch{console.warn("‚ö†Ô∏è No se pudieron limpiar algunos archivos temporales")}return console.log("‚úÖ Preview de secuencia creado correctamente"),{success:!0,data:x,error:null}}catch(n){return console.error("‚ùå Error al crear preview de secuencia:",n),{success:!1,data:null,error:n.message}}},ta=async(a,r="mp4",t="720p")=>{try{console.log(`üé¨ Convirtiendo video a formato ${r} con resoluci√≥n ${t}...`);const n=await ts();n.FS("writeFile","input.mp4",await ys(a));let o=[],c=[];switch(t){case"360p":o=["-vf","scale=-1:360"],c=["-crf","28","-preset","ultrafast"];break;case"480p":o=["-vf","scale=-1:480"],c=["-crf","25","-preset","fast"];break;case"720p":o=["-vf","scale=-1:720"],c=["-crf","23","-preset","fast"];break;case"1080p":o=["-vf","scale=-1:1080"],c=["-crf","20","-preset","medium"];break;case"4k":o=["-vf","scale=-1:2160"],c=["-crf","18","-preset","medium"];break;default:o=["-vf","scale=-1:720"],c=["-crf","23","-preset","fast"]}await n.run("-i","input.mp4",...o,...c,`output.${r}`);const h=n.FS("readFile",`output.${r}`);return n.FS("unlink","input.mp4"),n.FS("unlink",`output.${r}`),console.log("‚úÖ Video convertido correctamente"),{success:!0,data:h,format:r,error:null}}catch(n){return console.error("‚ùå Error al convertir video:",n),{success:!1,data:null,format:null,error:n.message}}},Vs=async a=>{try{if(console.log(`üì• Descarga directa de secuencia: ${a.name}`),!a.videos||a.videos.length===0)throw new Error("La secuencia no tiene videos");if(a.videos.length===1){const c=a.videos[0];if(c.file)return{success:!0,data:c.file,format:"mp4",error:null};if(c.videoUrl){const h=await fetch(c.videoUrl);if(!h.ok)throw new Error("Error descargando video");return{success:!0,data:await h.blob(),format:"mp4",error:null}}}const r=await pt(()=>import("./jszip.min-DupR5p5E.js").then(c=>c.j),__vite__mapDeps([3,1,2])),t=new r.default,n=(a.name||a.title||"secuencia").replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_").toLowerCase();for(let c=0;c<a.videos.length;c++){const h=a.videos[c];let x;if(h.file)x=h.file;else if(h.videoUrl){const m=await fetch(h.videoUrl);if(!m.ok)throw new Error(`Error descargando video ${c+1}`);x=await m.blob()}else throw new Error(`Video ${c+1} no tiene archivo ni URL`);const i=`${n}_${c+1}.mp4`;t.file(i,x),console.log(`üìÅ Agregando al ZIP: ${i}`)}return{success:!0,data:await t.generateAsync({type:"blob"}),format:"zip",error:null}}catch(r){return console.error("‚ùå Error en descarga directa:",r),{success:!1,data:null,format:null,error:r.message}}},fr=async(a,r="mp4",t="720p")=>{try{if(console.log(`üé¨ Generando video de secuencia: ${a.name}`),console.log(`üìπ Formato: ${r}, Resoluci√≥n: ${t}`),!a.videos||a.videos.length===0)throw new Error("La secuencia no tiene videos");const n=a.useBPMControl||!1,o=a.targetBPM||null;if(console.log(`üéµ Configuraci√≥n BPM: ${n?"Activado":"Desactivado"}, BPM: ${o}`),!n||!o)return console.log("üöÄ Usando descarga directa (sin FFmpeg)"),await Vs(a);console.log("üé¨ Intentando inicializar FFmpeg...");const c=ts(),h=new Promise((i,m)=>setTimeout(()=>m(new Error("Timeout inicializando FFmpeg")),1e4));try{await Promise.race([c,h])}catch{return console.warn("‚ö†Ô∏è FFmpeg no pudo inicializarse, usando descarga directa"),await Vs(a)}const x=await pr(a.videos,n,o);if(!x.success)throw new Error(`Error generando video: ${x.error}`);if(r!=="mp4"||t!=="720p"){console.log(`üîÑ Convirtiendo a formato ${r} con resoluci√≥n ${t}...`);const i=await ta(new Blob([x.data],{type:"video/mp4"}),r,t);if(!i.success)throw new Error(`Error convirtiendo formato: ${i.error}`);return{success:!0,data:i.data,format:r,error:null}}return{success:!0,data:x.data,format:"mp4",error:null}}catch(n){return console.error("‚ùå Error generando video de secuencia:",n),{success:!1,data:null,format:null,error:n.message}}},br=({isOpen:a,onClose:r,video:t,onDownloadComplete:n})=>{const[o,c]=l.useState("mp4"),[h,x]=l.useState("720p"),[i,m]=l.useState(!1),[y,p]=l.useState(0),R=[{value:"mp4",label:"MP4",description:"Formato est√°ndar, compatible con todo"},{value:"avi",label:"AVI",description:"Formato cl√°sico, buena calidad"},{value:"mov",label:"MOV",description:"Formato Apple, alta calidad"},{value:"webm",label:"WebM",description:"Formato web, archivos peque√±os"}],N=[{value:"360p",label:"360p",description:"Calidad baja, archivo peque√±o"},{value:"480p",label:"480p",description:"Calidad est√°ndar, balance"},{value:"720p",label:"720p",description:"HD, buena calidad"},{value:"1080p",label:"1080p",description:"Full HD, alta calidad"},{value:"4k",label:"4K",description:"Ultra HD, m√°xima calidad"}],f=async()=>{if(!t){console.error("No hay video para descargar");return}m(!0),p(0);try{console.log(`üé¨ Iniciando descarga: ${o}, resoluci√≥n: ${h}`);const w=setInterval(()=>{p(B=>B>=90?(clearInterval(w),90):B+10)},500);let T;try{if(t.videos&&Array.isArray(t.videos))console.log("üé¨ Procesando secuencia..."),T=await fr(t,o,h);else if(t.file)console.log("üé¨ Procesando video individual..."),T=await ta(t.file,o,h);else throw new Error("Formato de video no v√°lido");clearInterval(w),p(100),await new Promise(B=>setTimeout(B,200))}catch(B){throw clearInterval(w),B}if(T.success){const B=T.format==="zip"?"application/zip":`video/${T.format||o}`,j=new Blob([T.data],{type:B});try{const z=await V();if(z){const q=T.format==="zip"?"zip":T.format||o,J=`${t.title||t.name}_${h}.${q}`,he=await(await z.getFileHandle(J,{create:!0})).createWritable();await he.write(j),await he.close(),console.log("‚úÖ Archivo guardado en carpeta seleccionada")}else{const q=URL.createObjectURL(j),J=document.createElement("a");J.href=q;const re=T.format==="zip"?"zip":T.format||o;J.download=`${t.title||t.name}_${h}.${re}`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(q),console.log("‚úÖ Archivo descargado correctamente")}n&&n(),r()}catch(z){throw console.error("Error al guardar archivo:",z),new Error("Error al guardar el archivo")}}else throw new Error(T.error)}catch(w){console.error("‚ùå Error al descargar video:",w),alert(`Error al procesar video: ${w.message}`)}finally{m(!1),p(0)}},V=async()=>{try{return"showDirectoryPicker"in window?await window.showDirectoryPicker():(console.log("API de File System Access no disponible, usando descarga normal"),null)}catch(w){return console.log("Usuario cancel√≥ la selecci√≥n de carpeta o error:",w),null}},W=async()=>{if(!t||!t.file){console.error("No hay video para descargar");return}try{const w=await V();if(w){const T=`${t.title||t.name}.mp4`,j=await(await w.getFileHandle(T,{create:!0})).createWritable();await j.write(t.file),await j.close(),console.log("‚úÖ Archivo guardado en carpeta seleccionada")}else{const T=URL.createObjectURL(t.file),B=document.createElement("a");B.href=T,B.download=t.title||"video",document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(T)}r()}catch(w){console.error("Error en descarga directa:",w),alert("Error al descargar el archivo")}};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ut,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:t!=null&&t.videos?"Descargar Secuencia":"Descargar Video"})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ot,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Fa,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-800 truncate",children:(t==null?void 0:t.title)||(t==null?void 0:t.name)||"Sin t√≠tulo"}),t!=null&&t.videos?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[t.videos.length," videos ‚Ä¢ Duraci√≥n aproximada: ",Math.floor(t.videos.length*30/60),":",(t.videos.length*30%60).toString().padStart(2,"0")]}),t.useBPMControl&&t.targetBPM&&e.jsxs("p",{className:"text-sm text-purple-600",children:["BPM ajustado: ",t.targetBPM]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600",children:t.description})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:t!=null&&t.fileSize?`${(t.fileSize/(1024*1024)).toFixed(2)} MB`:"Tama√±o desconocido"}),(t==null?void 0:t.bpm)&&e.jsxs("p",{className:"text-sm text-purple-600",children:["BPM: ",t.bpm]})]})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Formato de salida"}),e.jsx("div",{className:"space-y-2",children:R.map(w=>e.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${o===w.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"format",value:w.value,checked:o===w.value,onChange:T=>c(T.target.value),className:"sr-only"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${o===w.value?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:o===w.value&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:w.label}),e.jsx("div",{className:"text-sm text-gray-500",children:w.description})]})]})]},w.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Resoluci√≥n"}),e.jsx("div",{className:"space-y-2",children:N.map(w=>e.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${h===w.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"resolution",value:w.value,checked:h===w.value,onChange:T=>x(T.target.value),className:"sr-only"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${h===w.value?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:h===w.value&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:w.label}),e.jsx("div",{className:"text-sm text-gray-500",children:w.description})]})]})]},w.value))})]}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Procesando video..."}),e.jsxs("span",{children:[y,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${y}%`}})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:W,disabled:i,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",children:"Descargar original"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:r,disabled:i,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:f,disabled:i,className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${i?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:i?"Procesando...":"Descargar"})]})]})]})}):null},Lt=({isOpen:a,onClose:r,onConfirm:t,title:n="Confirmar acci√≥n",message:o="¬øEst√°s seguro de que quieres realizar esta acci√≥n?",confirmText:c="Confirmar",cancelText:h="Cancelar",type:x="warning"})=>{if(!a)return null;const i=()=>{switch(x){case"danger":return e.jsx(Bt,{className:"w-8 h-8 text-red-500"});case"warning":return e.jsx(Bt,{className:"w-8 h-8 text-orange-500"});case"info":return e.jsx(Bt,{className:"w-8 h-8 text-blue-500"});default:return e.jsx(Bt,{className:"w-8 h-8 text-orange-500"})}},m=()=>{switch(x){case"danger":return"bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600";case"warning":return"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600";case"info":return"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600";default:return"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600"}};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[i(),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ot,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"text-gray-600 leading-relaxed whitespace-pre-line",children:o})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors font-medium",children:h}),e.jsx("button",{onClick:()=>{t(),r()},className:`px-4 py-2 text-white rounded-lg transition-all font-medium ${m()}`,children:c})]})]})]})},ss="sequences",yr=async a=>{console.log("üî• Firebase: Creando secuencia..."),console.log("üì¶ Datos de secuencia:",a);try{const r={...a,createdAt:us(),updatedAt:us()};console.log("‚è∞ Secuencia con timestamps:",r);const t=await Sa(Hs(es,ss),r);console.log("üìÑ Documento creado con ID:",t.id);const n={id:t.id,...a,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return console.log("‚úÖ Secuencia creada exitosamente:",n),n}catch(r){throw console.error("‚ùå Error al crear secuencia:",r),new Error("No se pudo crear la secuencia")}},wr=async(a,r)=>{try{const t=Ws(es,ss,a),n={...r,updatedAt:us()};return await ka(t,n),{id:a,...r,updatedAt:new Date().toISOString()}}catch(t){throw console.error("Error al actualizar secuencia:",t),new Error("No se pudo actualizar la secuencia")}},vr=async a=>{try{const r=Ws(es,ss,a);return await Ea(r),{success:!0}}catch(r){throw console.error("Error al eliminar secuencia:",r),new Error("No se pudo eliminar la secuencia")}},Bs=(a,r)=>{console.log("üé¨ Firebase: Suscribi√©ndose a secuencias para estilo:",a);try{const t=wa(Hs(es,ss),va("style","==",a),ja("createdAt","desc"));return Na(t,n=>{console.log(`üé¨ Firebase: Actualizaci√≥n recibida - ${n.size} secuencias para ${a}`);const o=[];n.forEach(c=>{var i,m,y,p,R,N,f;const h=c.data(),x={id:c.id,...h,createdAt:((y=(m=(i=h.createdAt)==null?void 0:i.toDate)==null?void 0:m.call(i))==null?void 0:y.toISOString())||h.createdAt,updatedAt:((N=(R=(p=h.updatedAt)==null?void 0:p.toDate)==null?void 0:R.call(p))==null?void 0:N.toISOString())||h.updatedAt};o.push(x),console.log(`üìã Secuencia cargada: ${x.name} (${((f=x.videos)==null?void 0:f.length)||0} videos)`)}),console.log(`üéâ Total de secuencias cargadas: ${o.length}`),r(o)})}catch(t){throw console.error("‚ùå Error al suscribirse a secuencias por estilo:",t),new Error("No se pudo suscribir a las secuencias")}},jr=a=>{const[r,t]=l.useState(null),[n,o]=l.useState(null),c=l.useCallback(R=>{t(R)},[]),h=l.useCallback((R,N)=>{R.preventDefault(),o(N)},[]),x=l.useCallback((R,N)=>{R.preventDefault(),o(N)},[]),i=l.useCallback(R=>{R.preventDefault(),o(null)},[]),m=l.useCallback((R,N)=>{R.preventDefault(),r!==null&&r!==N&&a(r,N),t(null),o(null)},[r,a]),y=l.useCallback(()=>{t(null),o(null)},[]),p=l.useCallback(R=>{const N={cursor:"grab",transition:"all 0.2s ease",transform:"scale(1)",opacity:1};return r===R&&(N.cursor="grabbing",N.transform="scale(1.05) rotate(2deg)",N.opacity=.7,N.zIndex=1e3),n===R&&r!==R&&(N.transform="scale(1.02)",N.borderLeft="4px solid #3b82f6",N.backgroundColor="#f0f9ff"),N},[r,n]);return{draggedIndex:r,dragOverIndex:n,handleDragStart:c,handleDragOver:h,handleDragEnter:x,handleDragLeave:i,handleDrop:m,handleDragEnd:y,getDragStyles:p}},fs=({videos:a,currentBPM:r=null,className:t="",showControls:n=!0,autoplay:o=!1,loop:c=!1,muted:h=!1})=>{const[x,i]=l.useState(0),[m,y]=l.useState(!1),[p,R]=l.useState(h),[N,f]=l.useState(!1),[V,W]=l.useState(n),[w,T]=l.useState(0),[B,j]=l.useState(0),[z,q]=l.useState(1),[J,re]=l.useState(1),[he,Ne]=l.useState(!1),[ne,ze]=l.useState(null),[ke,Re]=l.useState(!1),[De,je]=l.useState(0),[Fe,Me]=l.useState(0),[O,ve]=l.useState(!1),[pe,S]=l.useState(!1),[F,U]=l.useState(!1),[K,G]=l.useState(0),[Q,ue]=l.useState(0),[d,A]=l.useState(null),[D,_]=l.useState(!1),[I,Y]=l.useState(1),[se,xe]=l.useState(!0),M=l.useRef(null),te=l.useRef(null),ie=a[x],ce=[.25,.5,.75,1,1.25,1.5,2];l.useEffect(()=>{q(1),M.current&&(M.current.playbackRate=1)},[x]),l.useEffect(()=>{if(M.current&&O&&m&&pe&&F){const L=M.current,X=()=>{L.currentTime>=Fe&&(L.currentTime=De)};return L.addEventListener("timeupdate",X),()=>L.removeEventListener("timeupdate",X)}},[O,De,Fe,m,pe,F]),l.useEffect(()=>{if(n&&m){d&&clearTimeout(d);const L=setTimeout(()=>{W(!1)},4e3);A(L)}return()=>{d&&clearTimeout(d)}},[m,n]),l.useEffect(()=>()=>{d&&clearTimeout(d),ne&&clearTimeout(ne)},[]),l.useEffect(()=>{const L=X=>{D&&_(!1)};return document.addEventListener("click",L),()=>document.removeEventListener("click",L)},[D]);const Ie=()=>{W(!0),d&&clearTimeout(d)},Se=()=>{ke&&!O?M.current&&(M.current.currentTime=0,M.current.play()):O&&pe&&F?M.current&&(M.current.currentTime=De,M.current.play()):y(!1)},Ae=()=>{M.current&&T(M.current.currentTime)},be=()=>{M.current&&(j(M.current.duration),M.current.playbackRate=I,q(I))},Ee=()=>{M.current&&(m?M.current.pause():M.current.play(),y(!m))},Ce=()=>{x>0&&(i(L=>L-1),T(0),M.current&&(M.current.currentTime=0))},de=()=>{x<a.length-1&&(i(L=>L+1),T(0),M.current&&(M.current.currentTime=0))},Te=L=>{if(M.current){const X=Math.max(0,Math.min(B,w+L));M.current.currentTime=X,T(X)}},tt=()=>{if(M.current){const L=!p;M.current.muted=L,R(L),L?M.current.volume=0:M.current.volume=J}},Be=L=>{const X=parseFloat(L.target.value);M.current&&(M.current.volume=X,re(X),X===0?(M.current.muted=!0,R(!0)):(M.current.muted=!1,R(!1)))},k=()=>{try{document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),f(!1)):(te.current.requestFullscreen?te.current.requestFullscreen():te.current.webkitRequestFullscreen?te.current.webkitRequestFullscreen():te.current.msRequestFullscreen&&te.current.msRequestFullscreen(),f(!0))}catch(L){console.error("Error toggling fullscreen:",L)}},Ge=L=>{if(M.current){const X=L.currentTarget.getBoundingClientRect(),g=(L.clientX-X.left)/X.width*B;M.current.currentTime=g,T(g)}},Ke=L=>{L==="start"?pe?(S(!1),je(0),console.log("Punto A eliminado")):(S(!0),je(w),G(w),console.log(`Punto A establecido en: ${oe(w)}`)):F?(U(!1),Me(0),console.log("Punto B eliminado")):(U(!0),Me(w),ue(w),console.log(`Punto B establecido en: ${oe(w)}`))},oe=L=>{const X=Math.floor(L/60),Ze=Math.floor(L%60);return`${X}:${Ze.toString().padStart(2,"0")}`},Xe=L=>{Y(L),M.current&&(M.current.playbackRate=L,q(L)),_(!1)},st=L=>L===1?"Normal":`${L}x`,mt=async()=>{try{if(console.log("Iniciando descarga de video:",ie.title),ie.videoUrl&&(ie.videoUrl.includes("firebase")||ie.videoUrl.includes("googleapis"))){console.log("Detectada URL de Firebase Storage, descargando...");const L=await fetch(ie.videoUrl);if(!L.ok)throw new Error(`HTTP error! status: ${L.status}`);const X=await L.blob();console.log("Blob descargado:",X.size,"bytes");const Ze=URL.createObjectURL(X),Pe=document.createElement("a");Pe.href=Ze,Pe.download=ie.title||"video.mp4",Pe.style.display="none",document.body.appendChild(Pe),Pe.click(),document.body.removeChild(Pe),setTimeout(()=>{URL.revokeObjectURL(Ze)},1e3),console.log("Descarga completada exitosamente")}else{console.log("Usando m√©todo de descarga directa para URL no-Firebase");const L=document.createElement("a");L.href=ie.videoUrl,L.download=ie.title||"video.mp4",L.style.display="none",document.body.appendChild(L),L.click(),document.body.removeChild(L)}}catch(L){console.error("Error en descarga:",L),alert(`Error al descargar el video: ${L.message}`)}};return l.useEffect(()=>{const L=X=>{if(X.target.tagName!=="INPUT")switch(X.code){case"Space":X.preventDefault(),Ee();break;case"KeyF":X.preventDefault(),k();break;case"KeyM":X.preventDefault(),tt();break;case"ArrowLeft":X.preventDefault(),X.ctrlKey||X.metaKey?Ce():Te(-10);break;case"ArrowRight":X.preventDefault(),X.ctrlKey||X.metaKey?de():Te(10);break;case"KeyA":X.preventDefault(),Ke("start");break;case"KeyB":X.preventDefault(),Ke("end");break;case"KeyL":X.preventDefault(),Re(!ke);break;case"KeyS":X.preventDefault();const Pe=(ce.indexOf(I)+1)%ce.length;Xe(ce[Pe]);break}};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[w,B,x,ke,I]),ie?e.jsxs("div",{ref:te,className:`relative bg-black rounded-lg overflow-hidden ${t}`,onMouseEnter:Ie,onMouseLeave:()=>{if(m){const L=setTimeout(()=>{W(!1)},4e3);A(L)}},onTouchStart:Ie,onTouchMove:Ie,children:[e.jsx("video",{ref:M,src:ie.videoUrl,className:"w-full h-full object-contain cursor-pointer",onEnded:Se,onTimeUpdate:Ae,onLoadedMetadata:be,onPlay:()=>y(!0),onPause:()=>y(!1),muted:p,autoPlay:o,loop:!1,onClick:Ie}),e.jsxs("div",{className:"absolute top-2 left-2 bg-black bg-opacity-75 text-white px-3 py-2 rounded-lg text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"font-medium",children:[x+1," / ",a.length]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsx("span",{className:"max-w-xs truncate",children:ie.title}),z!==1&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{className:"text-blue-400 font-medium",children:[z.toFixed(2),"x"]})]})]}),a.length>1&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Usa Ctrl+‚Üê/‚Üí para cambiar de video"})]}),V&&e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent flex flex-col justify-end",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-end items-center",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:k,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:N?e.jsx(Zs,{className:"w-4 h-4"}):e.jsx(Xs,{className:"w-4 h-4"})})})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:Ce,disabled:x===0,className:`p-2 rounded-full transition-colors z-10 ${x===0?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-black/60 text-white hover:bg-black/80"}`,title:"Video anterior (Ctrl+‚Üê)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-current flex items-center justify-center",children:e.jsx(gs,{className:"w-1.5 h-1.5"})}),e.jsx("span",{className:"text-xs font-medium",children:"Anterior"})]})}),e.jsx("button",{onClick:()=>Te(-10),className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",title:"Retroceder 10s (‚Üê)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(gs,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm font-medium",children:"10"})]})}),e.jsx("button",{onClick:Ee,className:"p-4 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Play/Pause (Espacio)",children:m?e.jsx(Qs,{className:"w-8 h-8"}):e.jsx(et,{className:"w-8 h-8"})}),e.jsx("button",{onClick:()=>Te(10),className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",title:"Adelantar 10s (‚Üí)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"10"}),e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(ps,{className:"w-3 h-3"})})]})}),e.jsx("button",{onClick:de,disabled:x===a.length-1,className:`p-2 rounded-full transition-colors z-10 ${x===a.length-1?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-black/60 text-white hover:bg-black/80"}`,title:"Siguiente video (Ctrl+‚Üí)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs font-medium",children:"Siguiente"}),e.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-current flex items-center justify-center",children:e.jsx(ps,{className:"w-1.5 h-1.5"})})]})})]})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[e.jsxs("div",{className:"flex justify-end mb-2 space-x-2",children:[e.jsx("button",{onClick:()=>Re(!ke),className:`p-2 rounded-full transition-colors z-10 ${ke?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Bucle",children:e.jsx(Ys,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{const L=!O;ve(L),L?(K>0&&(S(!0),je(K)),Q>0&&(U(!0),Me(Q))):(S(!1),U(!1),je(0),Me(0))},className:`p-2 rounded-full transition-colors z-10 ${O?"bg-green-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Segmento A-B",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:"A-B"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>_(!D),className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Velocidad de reproducci√≥n",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:I===1?"1x":`${I}x`})}),D&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",children:ce.map(L=>e.jsx("button",{onClick:()=>Xe(L),className:`w-full text-left px-3 py-1 rounded text-xs transition-colors ${I===L?"bg-blue-500 text-white":"text-white hover:bg-white/20"}`,children:st(L)},L))})]}),e.jsx("button",{onClick:mt,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Descargar video",children:e.jsx(ut,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:tt,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",onMouseEnter:()=>Ne(!0),onMouseLeave:()=>{const L=setTimeout(()=>Ne(!1),1e3);ze(L)},children:p?e.jsx(ea,{className:"w-4 h-4"}):e.jsx(Js,{className:"w-4 h-4"})}),he&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/80 rounded-lg p-3 z-20",onMouseEnter:()=>{ne&&(clearTimeout(ne),ze(null))},onMouseLeave:()=>{const L=setTimeout(()=>Ne(!1),1e3);ze(L)},children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:J,onChange:Be,className:"w-2 h-20 bg-gray-600 rounded-lg appearance-none cursor-pointer slider-vertical",style:{background:`linear-gradient(to top, #3b82f6 0%, #3b82f6 ${J*100}%, #4b5563 ${J*100}%, #4b5563 100%)`},orient:"vertical"}),e.jsxs("span",{className:"text-white text-xs",children:[Math.round(J*100),"%"]})]})})]})]}),e.jsx("div",{className:"relative mb-4",children:e.jsxs("div",{className:"w-full h-2 bg-white/20 rounded-full cursor-pointer relative",onClick:Ge,children:[e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${w/B*100}%`}}),O&&pe&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-green-500 z-10",style:{left:`${De/B*100}%`}}),O&&F&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-red-500 z-10",style:{left:`${Fe/B*100}%`}})]})}),e.jsxs("div",{className:"flex items-center justify-between text-white text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:[oe(w)," / ",oe(B)]}),z!==1&&e.jsxs("span",{className:"text-blue-400 font-medium",children:[z.toFixed(2),"x"]}),O&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>Ke("start"),className:`px-2 py-1 rounded text-xs transition-colors ${pe?"bg-green-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["A: ",pe?oe(De):"--:--"]}),e.jsxs("button",{onClick:()=>Ke("end"),className:`px-2 py-1 rounded text-xs transition-colors ${F?"bg-red-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["B: ",F?oe(Fe):"--:--"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("div",{className:"text-xs opacity-75",children:ke&&(O&&pe&&F?"Bucle A-B":"Bucle completo")})})]}),a.length>1&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-300 mb-1",children:[e.jsx("span",{children:"Progreso de la secuencia"}),e.jsxs("span",{children:[x+1," de ",a.length]})]}),e.jsx("div",{className:"w-full h-1 bg-gray-600 rounded-full",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300",style:{width:`${(x+1)/a.length*100}%`}})})]})]})]})]}):e.jsx("div",{className:`bg-black rounded-lg flex items-center justify-center ${t}`,children:e.jsx("div",{className:"text-white text-center",children:e.jsx("p",{children:"No hay videos en la secuencia"})})})};class Nr{constructor(){this.isLoaded=!0}async load(){return Promise.resolve()}async combineVideos(r,t){try{console.log("Iniciando combinaci√≥n con MediaRecorder optimizado..."),t&&t({stage:"init",current:0,total:100,message:"Iniciando MediaRecorder..."});const n=[];for(let c=0;c<r.length;c++){const h=r[c];console.log(`Descargando video ${c+1}/${r.length}: ${h.title}`),t&&t({stage:"download",current:(c+1)/r.length*50,total:100,message:`Descargando: ${h.title}`});try{const{ref:x,getDownloadURL:i}=await pt(async()=>{const{ref:f,getDownloadURL:V}=await import("./tag-BSjDyQEr.js").then(W=>W.i);return{ref:f,getDownloadURL:V}},__vite__mapDeps([0,1,2])),{storage:m}=await pt(async()=>{const{storage:f}=await import("./index-CkiEKLiW.js").then(V=>V.ae);return{storage:f}},__vite__mapDeps([1,2])),y=x(m,h.videoPath),p=await i(y);console.log(`URL de descarga obtenida para ${h.title}:`,p);const R=await fetch(p);if(!R.ok)throw new Error(`Error descargando video: ${R.statusText}`);const N=await R.blob();n.push(N),console.log(`Video ${c+1} descargado: ${h.title}`)}catch(x){throw console.error(`Error con video ${h.title}:`,x),new Error(`Error procesando video ${h.title}: ${x.message}`)}}t&&t({stage:"combine",current:50,total:100,message:"Combinando videos..."});const o=await this.combineVideoBlobs(n);return t&&t({stage:"complete",current:100,total:100,message:"¬°Combinaci√≥n completada!"}),console.log("Combinaci√≥n completada, archivo creado"),o}catch(n){throw console.error("Error combinando videos:",n),new Error(`Error combinando videos: ${n.message}`)}}async combineVideoBlobs(r){return new Promise((t,n)=>{try{const o=document.createElement("canvas"),c=o.getContext("2d");o.width=1920,o.height=1080;const h=o.captureStream(60),x=new MediaRecorder(h,{mimeType:"video/webm;codecs=vp9",videoBitsPerSecond:3e7}),i=[];x.ondataavailable=p=>{p.data.size>0&&i.push(p.data)},x.onstop=()=>{const p=new Blob(i,{type:"video/webm"});t(p)},x.onerror=p=>{n(p)},x.start();let m=0;const y=()=>{if(m>=r.length){x.stop();return}const p=r[m],R=URL.createObjectURL(p),N=document.createElement("video");N.onloadedmetadata=()=>{N.currentTime=0,N.muted=!1,N.volume=1,N.play()},N.ontimeupdate=()=>{c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high",c.clearRect(0,0,o.width,o.height);const f=N.videoWidth/N.videoHeight,V=o.width/o.height;let W,w,T,B;f>V?(W=o.width,w=o.width/f,T=0,B=(o.height-w)/2):(w=o.height,W=o.height*f,T=(o.width-W)/2,B=0),c.drawImage(N,T,B,W,w)},N.onplay=()=>{const f=()=>{if(!N.paused&&!N.ended){c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high",c.clearRect(0,0,o.width,o.height);const V=N.videoWidth/N.videoHeight,W=o.width/o.height;let w,T,B,j;V>W?(w=o.width,T=o.width/V,B=0,j=(o.height-T)/2):(T=o.height,w=o.height*V,B=(o.width-w)/2,j=0),c.drawImage(N,B,j,w,T),requestAnimationFrame(f)}};requestAnimationFrame(f)},N.onended=()=>{URL.revokeObjectURL(R),m++,setTimeout(y,100)},N.src=R};y()}catch(o){n(o)}})}async combineVideosSimple(r,t){return this.combineVideos(r,t)}async cleanup(r){try{console.log("Limpiando archivos temporales...");for(const t of r)await this.ffmpeg.deleteFile(t);await this.ffmpeg.deleteFile("filelist.txt"),await this.ffmpeg.deleteFile("output.mp4"),console.log("Archivos temporales eliminados")}catch(t){console.warn("Error limpiando archivos temporales:",t)}}async getVideoInfo(r){try{const n=await(await fetch(r)).blob();return{size:n.size,type:n.type,duration:null}}catch(t){return console.error("Error obteniendo informaci√≥n del video:",t),null}}}const kr=({isOpen:a,onClose:r,videos:t,sequenceName:n="Secuencia"})=>{const[o,c]=l.useState(null),[h,x]=l.useState(!1),[i,m]=l.useState(null),[y,p]=l.useState(null),[R,N]=l.useState("fast"),f=new Nr;l.useEffect(()=>{a&&(c(null),m(null),p(null),x(!1))},[a]);const V=async()=>{if(!t||t.length===0){m("No hay videos para combinar");return}x(!0),m(null),c({stage:"init",current:0,total:100,message:"Iniciando FFmpeg.wasm..."});try{console.log("Iniciando combinaci√≥n con FFmpeg.wasm...");const z=await f.combineVideos(t,c),q=URL.createObjectURL(z);p(q),c({stage:"complete",current:100,total:100,message:"¬°Videos combinados exitosamente!"})}catch(z){console.error("Error en descarga:",z),m(`Error combinando videos: ${z.message}`),c(null)}finally{x(!1)}},W=()=>{if(y){const z=document.createElement("a");z.href=y,z.download=`${n}.webm`,document.body.appendChild(z),z.click(),document.body.removeChild(z)}},w=()=>i?"text-red-500":(o==null?void 0:o.stage)==="complete"?"text-green-500":"text-blue-500",T=()=>i?e.jsx(Rt,{className:"h-5 w-5"}):(o==null?void 0:o.stage)==="complete"?e.jsx(Kt,{className:"h-5 w-5"}):e.jsx(Qa,{className:"h-5 w-5 animate-spin"}),B=()=>i?"bg-red-500":(o==null?void 0:o.stage)==="complete"?"bg-green-500":"bg-blue-500",j=()=>{switch(o==null?void 0:o.stage){case"init":return"Inicializando FFmpeg.wasm...";case"download":return"Descargando videos...";case"combine":return"Combinando videos con FFmpeg...";case"finalize":return"Finalizando archivo...";case"complete":return"¬°Proceso completado!";default:return"Preparando..."}};return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Descargar Secuencia"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:h,children:e.jsx(ot,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("strong",{children:[(t==null?void 0:t.length)||0," videos"]})," ser√°n combinados en uno solo"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Duraci√≥n total: ",t==null?void 0:t.reduce((z,q)=>z+(q.duration||0),0).toFixed(1),"s",(t==null?void 0:t.some(z=>!z.duration))&&" (calculando...)"]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Formato: WebM (calidad optimizada con MediaRecorder)"})]}),o&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[T(),e.jsx("span",{className:`text-sm font-medium ${w()}`,children:o.message})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${B()}`,style:{width:`${o.current}%`}})}),e.jsx("p",{className:"text-xs text-gray-500",children:j()})]}),i&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"text-sm text-red-700",children:i})]})}),y&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kt,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-sm text-green-700",children:"¬°Videos combinados exitosamente!"})]})})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[!h&&!y&&e.jsxs("button",{onClick:V,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(ut,{className:"h-4 w-4"}),e.jsx("span",{children:"Combinar Videos"})]}),y&&e.jsxs("button",{onClick:W,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(ut,{className:"h-4 w-4"}),e.jsx("span",{children:"Descargar WebM"})]}),e.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:h,children:y?"Cerrar":"Cancelar"})]})]})}):null},Sr=({isOpen:a,onClose:r,videos:t,onSaveSequence:n,onToggleShowAll:o,showAllVideos:c,style:h="salsa",isIntegrated:x=!1,onToggleBuilder:i})=>{const{categoriesList:m,getColorClasses:y}=Mt("figuras",h),{user:p}=Jt(),[R,N]=l.useState(null),[f,V]=l.useState(!1),[W,w]=l.useState(!1),[T,B]=l.useState(null),[j,z]=l.useState(null),[q,J]=l.useState(null),[re,he]=l.useState({}),[Ne,ne]=l.useState(!0),[ze,ke]=l.useState(!1),[Re,De]=l.useState(null),je=g=>{if(console.log("üè∑Ô∏è getOrderedTags - video:",g.title,"tags:",g.tags),!g.tags||Object.keys(g.tags).length===0)return console.log("‚ùå No hay tags en el video"),[];const C=[];return m.forEach($=>{const v=g.tags[$.key];Array.isArray(v)&&(console.log(`üìã Categor√≠a ${$.key}:`,v),v.forEach(ye=>{C.push({tag:ye,categoryKey:$.key,color:$.color})}))}),console.log("‚úÖ Tags ordenados:",C),C},Fe=g=>{if(console.log("üè∑Ô∏è getOrderedTagsIniciales - video:",g.title,"tagsIniciales:",g.tagsIniciales),!g.tagsIniciales||Object.keys(g.tagsIniciales).length===0)return console.log("‚ùå No hay tagsIniciales en el video"),[];const C=[];return m.forEach($=>{const v=g.tagsIniciales[$.key];Array.isArray(v)&&(console.log(`üìã Categor√≠a inicial ${$.key}:`,v),v.forEach(ye=>{C.push({tag:ye,categoryKey:$.key,color:$.color,type:"inicial"})}))}),console.log("‚úÖ Tags iniciales ordenados:",C),C},Me=g=>{if(console.log("üè∑Ô∏è getOrderedTagsFinales - video:",g.title,"tagsFinales:",g.tagsFinales),!g.tagsFinales||Object.keys(g.tagsFinales).length===0)return console.log("‚ùå No hay tagsFinales en el video"),[];const C=[];return m.forEach($=>{const v=g.tagsFinales[$.key];Array.isArray(v)&&(console.log(`üìã Categor√≠a final ${$.key}:`,v),v.forEach(ye=>{C.push({tag:ye,categoryKey:$.key,color:$.color,type:"final"})}))}),console.log("‚úÖ Tags finales ordenados:",C),C},{sequence:O,sequenceName:ve,sequenceDescription:pe,editingSequenceId:S,addVideoToSequence:F,removeVideoFromSequence:U,reorderSequence:K,generateRandomSequence:G,clearSequence:Q,setSequenceName:ue,setSequenceDescription:d,isVideoCompatible:A,isVideoInSequence:D,toggleBuilder:_,checkCompatibility:I}=Gs();l.useEffect(()=>{const g=O.filter(C=>C.bpm);if(g.length>0){const C=g.map(v=>v.bpm),$=C.reduce((v,ye)=>v+ye,0)/C.length;De(Math.round($))}else De(null)},[O]);const{handleDragStart:Y,handleDragOver:se,handleDragEnter:xe,handleDragLeave:M,handleDrop:te,handleDragEnd:ie,getDragStyles:ce}=jr(K),[Ie,Se]=l.useState([]),[Ae,be]=l.useState({isOpen:!1,type:null}),[Ee,Ce]=l.useState(5),de=(g,C="success")=>{const $=Date.now();Se(v=>[...v,{id:$,message:g,type:C}])},Te=g=>{Se(C=>C.filter($=>$.id!==g))},tt=async g=>{if(!p){de("Debes iniciar sesi√≥n para dar like","error");return}try{const C=await ms(g.id,p.uid);C.success?de(`Has ${C.userLiked?"dado like a":"quitado like de"} "${g.title}"`,"success"):de("Error al actualizar like","error")}catch(C){console.error("Error al manejar like:",C),de("Error al actualizar like","error")}},Be=()=>{const g=Ee-O.length;if(g<=0){de("La secuencia ya tiene suficientes videos","info");return}if(O.length>0){const C=O[O.length-1],$=t.filter(v=>!O.some(ye=>ye.id===v.id)&&I(C,v));if($.length===0){de("No hay videos compatibles disponibles para continuar la secuencia","warning");return}if($.length<g){de(`Solo hay ${$.length} videos compatibles disponibles de los ${g} necesarios`,"info"),G(t,O.length+$.length),de(`Secuencia completada con ${$.length} videos adicionales`);return}}G(t,Ee),de(`Secuencia completada hasta ${Ee} videos`)},k=async()=>{if(console.log("üíæ Intentando guardar secuencia..."),console.log("üìù Nombre:",ve),console.log("üìã Videos en secuencia:",O.length),console.log("üé® Estilo:",h),console.log("üîÑ Editando secuencia ID:",S),!ve.trim()){de("Por favor, a√±ade un nombre a la secuencia","error");return}if(O.length===0){de("La secuencia debe tener al menos un video","error");return}try{const g=await Pe(),C={name:ve,description:pe,videos:O,style:h,tags:re,thumbnailUrl:g,resolution:O.length>0?O[0].resolution:"HD",createdAt:new Date().toISOString()};S?(C.id=S,console.log("üîÑ Guardando como EDICI√ìN de secuencia existente:",S)):console.log("üÜï Guardando como NUEVA secuencia"),console.log("üì¶ Datos de secuencia a guardar:",C),await n(C),de(S?"‚úÖ Secuencia actualizada exitosamente":'‚úÖ Secuencia guardada exitosamente. Ve a "GALER√çA DE SECUENCIAS" para verla.'),Q(),i&&i()}catch(g){console.error("‚ùå Error al guardar secuencia:",g),de("Error al guardar la secuencia","error")}},Ge=()=>{O.length>0||ve.trim()||pe.trim()?be({isOpen:!0,type:"cancel"}):i&&i()},Ke=()=>{be({isOpen:!0,type:"clear"})},oe=()=>{Ae.type==="cancel"?(Q(),i&&i()):Ae.type==="clear"&&Q(),be({isOpen:!1,type:null})};l.useEffect(()=>{const g=setTimeout(()=>{mt()},500);return()=>clearTimeout(g)},[O]),l.useEffect(()=>()=>{T&&URL.revokeObjectURL(T)},[T]);const Xe=g=>{if(!g||!g.resolution)return["auto","360p","480p","720p","1080p"];const C=g.resolution.toLowerCase(),$=["auto"];return C.includes("4k")||C.includes("2160p")?$.push("360p","480p","720p","1080p","4k"):C.includes("1080p")||C.includes("1920")?$.push("360p","480p","720p","1080p"):C.includes("720p")||C.includes("1280")?$.push("360p","480p","720p"):C.includes("480p")||C.includes("854")?$.push("360p","480p"):$.push("360p"),$},st=g=>{console.log("üé¨ Reproduciendo video individual:",g.title),N(g),V(!0),de(`üé¨ Reproduciendo: ${g.title}`,"info")},mt=async()=>{if(!O||O.length===0){B(null),z(null);return}const g=JSON.stringify({videos:O.map(C=>C.id),sequenceLength:O.length});if(!(q===g&&T)){w(!0),z(null);try{if(console.log("üé¨ Generando preview en tiempo real..."),O.filter($=>$.videoUrl).length===0)throw new Error("No hay videos v√°lidos en la secuencia");B("sequence-timeline"),J(g),console.log("‚úÖ Preview en tiempo real generado (modo timeline)")}catch(C){console.error("‚ùå Error al generar preview en tiempo real:",C),z(C.message)}finally{w(!1)}}},L=(g,C)=>{he($=>{const v=$[g]||[];if(v.includes(C)){const _e=v.filter(Qe=>Qe!==C);if(_e.length===0){const{[g]:Qe,...ft}=$;return ft}else return{...$,[g]:_e}}else return{...$,[g]:[...v,C]}})},X=(g,C)=>{var $;return(($=re[g])==null?void 0:$.includes(C))||!1},Ze=()=>{const g=[];return m.forEach(C=>{const $=re[C.key];Array.isArray($)&&$.forEach(v=>{g.push({tag:v,categoryKey:C.key,color:C.color})})}),g},Pe=async()=>{if(O.length===0)return null;try{const g=O[0];if(g.thumbnailUrl)return g.thumbnailUrl;const{getStorage:C,ref:$,getDownloadURL:v}=await pt(async()=>{const{getStorage:ft,ref:jt,getDownloadURL:Et}=await import("./tag-BSjDyQEr.js").then(Nt=>Nt.i);return{getStorage:ft,ref:jt,getDownloadURL:Et}},__vite__mapDeps([0,1,2])),ye=C(),_e=$(ye,g.videoUrl);return await v(_e)}catch(g){return console.error("Error al generar thumbnail:",g),null}};return a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Constructor de Secuencias"}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:[O.length," videos"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ot,{className:"w-5 h-5"})})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{type:"text",placeholder:"Nombre de la secuencia...",value:ve,onChange:g=>ue(g.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),!ve.trim()&&O.length>0&&e.jsx("p",{className:"text-xs text-orange-600",children:"‚ö†Ô∏è A√±ade un nombre para poder guardar la secuencia"})]}),e.jsx("textarea",{placeholder:"Descripci√≥n (opcional)...",value:pe,onChange:g=>d(g.target.value),rows:"2",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"N√∫mero de videos:"}),e.jsx("input",{type:"number",value:Ee,onChange:g=>Ce(Math.max(1,parseInt(g.target.value)||5)),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center text-sm",placeholder:"5"}),O.length>0&&e.jsx("div",{className:"text-xs text-gray-500 text-center",children:(()=>{const g=O[O.length-1],C=t.filter(v=>!O.some(ye=>ye.id===v.id)&&I(g,v)),$=Ee-O.length;return`${C.length} compatibles disponibles (necesitas ${$})`})()})]}),e.jsxs("button",{onClick:Be,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors",children:[e.jsx(xs,{className:"w-4 h-4"}),e.jsxs("span",{children:["Completar hasta ",Ee]})]}),e.jsxs("button",{onClick:Ke,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:[e.jsx(vt,{className:"w-4 h-4"}),e.jsx("span",{children:"Limpiar"})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[e.jsx(et,{className:"h-5 w-5 text-blue-600 mr-2"}),"Preview en Tiempo Real"]}),W&&e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Generando preview..."})]}),j&&e.jsx("div",{className:"flex items-center justify-center py-8 text-red-600",children:e.jsxs("span",{children:["‚ùå Error: ",j]})}),!W&&!j&&T&&e.jsx("div",{className:"space-y-4",children:T==="sequence-timeline"?e.jsx(fs,{videos:O,currentBPM:Re,className:"w-full h-96",showControls:!0,autoplay:!1,loop:!1,muted:!1}):e.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:e.jsx(Dt,{src:T,className:"w-full h-96 object-contain",showControls:!0,autoplay:!1,loop:!1,muted:!1,size:"medium",videoTitle:"Preview de Secuencia"})})}),!W&&!j&&O.length===0&&e.jsx("div",{className:"flex items-center justify-center py-8 text-gray-500",children:e.jsx("span",{children:"A√±ade videos a la secuencia para ver el preview"})})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-700",children:["Secuencia Actual (",O.length," videos)"]})}),O.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[e.jsx(Zt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No hay videos en la secuencia"}),e.jsx("p",{className:"text-sm",children:"Selecciona videos de la galer√≠a para comenzar"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map((g,C)=>e.jsxs("div",{draggable:!0,onDragStart:()=>Y(C),onDragOver:$=>se($,C),onDragEnter:$=>xe($,C),onDragLeave:M,onDrop:$=>te($,C),onDragEnd:ie,style:ce(C),className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] relative",children:[e.jsxs("div",{className:"absolute top-2 left-2 z-10 flex items-center space-x-2",children:[e.jsxs("div",{className:"bg-purple-500 text-white px-2 py-1 rounded-full text-sm font-bold shadow-lg",children:["#",C+1]}),e.jsx("button",{onClick:()=>U(C),className:"bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition-colors shadow-lg",title:"Eliminar de la secuencia",children:e.jsx(vt,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsx(Xa,{className:"w-5 h-5 text-gray-400 cursor-grab hover:text-gray-600 transition-colors"})}),e.jsx("div",{className:"relative group",children:e.jsxs("div",{className:"w-full aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center",children:[g.thumbnailUrl&&g.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?e.jsx("img",{src:g.thumbnailUrl,alt:g.title,className:"w-full h-full object-cover",loading:"lazy",onError:$=>{$.target.style.display="none",$.target.nextSibling.style.display="flex"}}):null,e.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${g.thumbnailUrl&&g.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?"hidden":"flex"}`,children:[e.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),e.jsx("span",{className:"text-sm font-medium",children:g.title})]}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:g.resolution&&g.resolution!=="Unknown"?g.resolution:"HD"}),e.jsx("button",{onClick:()=>st(g),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-800 text-lg truncate",children:g.title}),e.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map($=>{const v=(g.rating||0)>=$;return e.jsx("svg",{className:`h-4 w-4 ${v?"text-yellow-400 fill-current":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},$)}),e.jsxs("span",{className:"text-xs font-medium text-gray-500 ml-1",children:["(",g.rating||0,")"]})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:g.description||"Sin descripci√≥n"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const $=je(g);return $.length>0?$.map(({tag:v,categoryKey:ye,color:_e})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y(_e)}`,children:v},`${ye}-${v}`)):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),(()=>{const $=Fe(g);return $.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:"Iniciales:"})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$.map(({tag:v,categoryKey:ye,color:_e})=>e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-sm",children:v},`inicial-${ye}-${v}`))})]}):null})(),(()=>{const $=Me(g);return $.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-green-600 uppercase tracking-wide",children:"Finales:"})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$.map(({tag:v,categoryKey:ye,color:_e})=>e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-sm",children:v},`final-${ye}-${v}`))})]}):null})(),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-2 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"font-medium",children:[(g.fileSize/(1024*1024)).toFixed(2)," MB"]}),e.jsx("span",{className:"text-gray-400",children:"‚Ä¢"}),e.jsx("span",{className:"text-gray-600",children:g.resolution&&g.resolution!=="Unknown"?g.resolution:"HD"}),e.jsx("span",{className:"text-gray-400",children:"‚Ä¢"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ht,{className:"h-3 w-3 text-purple-500"}),e.jsxs("span",{className:"font-medium text-purple-600",children:[g.bpm||"N/A"," BPM"]})]})]}),e.jsxs("button",{onClick:()=>tt(g),className:`flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 ${g.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"}`,title:g.userLiked?"Quitar like":"Dar like",children:[e.jsx(Tt,{className:`h-4 w-4 ${g.userLiked?"fill-current":""}`}),e.jsx("span",{className:"font-medium",children:g.likes||0})]})]})]})]},`${g.id}-${C}`))})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"h-5 w-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Tags de Secuencia"})]}),e.jsx("button",{onClick:()=>ne(!Ne),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",title:Ne?"Expandir tags":"Colapsar tags",children:e.jsx("svg",{className:`w-4 h-4 transform transition-transform ${Ne?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(()=>{const g=Ze();return g.length>0?e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(({tag:C,categoryKey:$,color:v})=>e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${y(v)} flex items-center space-x-1`,children:[e.jsx("span",{children:C}),e.jsx("button",{onClick:()=>L($,C),className:"ml-1 hover:bg-black hover:bg-opacity-20 rounded-full p-0.5",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},`${$}-${C}`))})}):null})(),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${Ne?"max-h-0 opacity-0":"max-h-96 opacity-100"}`,children:e.jsx("div",{className:"space-y-4",children:m.map(g=>e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center space-x-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${y(g.color).replace("text-","bg-")}`}),e.jsx("span",{children:g.name})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.tags.map(C=>e.jsx("button",{onClick:()=>L(g.key,C),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${X(g.key,C)?y(g.color):"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:C},C))})]},g.key))})})]})}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[e.jsxs("button",{onClick:k,disabled:O.length===0||!ve.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:[e.jsx(Ia,{className:"w-4 h-4"}),e.jsx("span",{children:S?"Actualizar Secuencia":"Guardar Secuencia"})]}),e.jsx("button",{onClick:Ge,className:"px-6 py-2 border border-gray-300 hover:bg-gray-50 rounded-lg transition-colors",children:"Cancelar"})]})]})]}),f&&R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-95 flex items-center justify-center z-50 p-4",onClick:()=>V(!1),children:e.jsxs("div",{className:"bg-black rounded-lg overflow-hidden w-full max-w-6xl max-h-[95vh] flex flex-col",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-900",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:R.title}),e.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-white text-2xl font-bold p-2 hover:bg-gray-800 rounded transition-colors",children:"√ó"})]}),e.jsx("div",{className:"flex-1 bg-black flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Dt,{src:R.videoUrl,className:"max-w-full max-h-full object-contain",showControls:!0,autoplay:!1,loop:!1,muted:!1,resolutions:Xe(R),currentResolution:"auto",videoTitle:R.title,size:"fullscreen"})})})]})}),e.jsx(Lt,{isOpen:Ae.isOpen,onClose:()=>be({isOpen:!1,type:null}),onConfirm:oe,title:Ae.type==="cancel"?"¬øCancelar secuencia?":"¬øLimpiar secuencia?",message:Ae.type==="cancel"?"¬øEst√°s seguro de que quieres cancelar? Se perder√°n todos los cambios.":"¬øEst√°s seguro de que quieres limpiar la secuencia actual?",confirmText:"Confirmar",cancelText:"Cancelar"}),Ie.map(g=>e.jsx(At,{message:g.message,type:g.type,onClose:()=>Te(g.id)},g.id)),e.jsx(kr,{isOpen:ze,onClose:()=>ke(!1),videos:O,sequenceName:ve||"Secuencia"})]}):null},Er=({src:a,alt:r,className:t="",fallbackSrc:n="/placeholder-video.svg",showPlayIcon:o=!1,...c})=>{const[h,x]=l.useState(!1),[i,m]=l.useState(!0),y=()=>{m(!1),x(!1)},p=()=>{m(!1),x(!0)},R=!a||a===null||a===void 0||a==="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"||a==="https://via.placeholder.com/300x200/1a1a1a/ffffff?text=EVENTO",N=R||h?n:a;return e.jsxs("div",{className:`relative ${t}`,...c,children:[i&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 animate-pulse flex items-center justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-8 h-8 border-3 border-gray-300 border-t-pink-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-8 h-8 border-3 border-transparent border-t-pink-300 rounded-full animate-spin",style:{animationDelay:"-0.5s"}})]})}),e.jsx("img",{src:N,alt:r,className:`w-full h-full object-cover transition-all duration-300 ${i?"opacity-0 scale-95":"opacity-100 scale-100"}`,onLoad:y,onError:p,loading:"lazy",decoding:"async",fetchPriority:"high"}),o&&!i&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 bg-white bg-opacity-90 rounded-full flex items-center justify-center",children:e.jsx(et,{className:"w-4 h-4 text-gray-800 fill-current"})})}),(h||R)&&!i&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ks,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Sin miniatura"}),o&&e.jsx("div",{className:"mt-2 w-6 h-6 bg-white bg-opacity-90 rounded-full flex items-center justify-center mx-auto",children:e.jsx(et,{className:"w-3 h-3 text-gray-600 fill-current"})})]})})]})},Cr=({sequences:a,onDeleteSequence:r,onPlaySequence:t,onEditSequence:n,onEditThumbnail:o,onDownloadSequence:c})=>{var B;const[h,x]=l.useState([]),[i,m]=l.useState({isOpen:!1,sequence:null}),{getColorClasses:y}=Mt("figuras","salsa"),{getSequenceConfig:p}=bs(),R=(j,z="success")=>{const q=Date.now();x(J=>[...J,{id:q,message:j,type:z}])},N=j=>{x(z=>z.filter(q=>q.id!==j))},f=j=>{m({isOpen:!0,sequence:j})},V=async()=>{try{await r(i.sequence.id),R("Secuencia eliminada exitosamente")}catch{R("Error al eliminar la secuencia","error")}m({isOpen:!1,sequence:null})},W=j=>{try{t(j),R("Reproduciendo secuencia")}catch{R("Error al reproducir la secuencia","error")}},w=j=>{try{c?(c(j),R("Abriendo opciones de descarga")):R("Funcionalidad de descarga no disponible","warning")}catch{R("Error al abrir descarga","error")}},T=j=>{if(!j.tags||Object.keys(j.tags).length===0)return[];const z=[];return[{key:"dificultad",color:"red"},{key:"estilo",color:"blue"},{key:"nivel",color:"green"},{key:"figura",color:"purple"},{key:"posicion",color:"orange"},{key:"transicion",color:"teal"}].forEach(J=>{const re=j.tags[J.key];Array.isArray(re)&&re.forEach(he=>{z.push({tag:he,categoryKey:J.key,color:J.color})})}),z};return a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(et,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay secuencias guardadas"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primera secuencia usando el constructor de secuencias"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"¬øC√≥mo crear una secuencia?"}),e.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 text-left",children:[e.jsx("li",{children:'1. Haz clic en "CREAR SECUENCIA"'}),e.jsx("li",{children:'2. A√±ade videos con el bot√≥n "+" de la galer√≠a'}),e.jsx("li",{children:"3. Escribe un nombre para la secuencia"}),e.jsx("li",{children:'4. Haz clic en "Guardar Secuencia"'}),e.jsx("li",{children:"5. ¬°Listo! Aparecer√° aqu√≠ autom√°ticamente"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`grid gap-6 ${p().grid}`,children:a.map(j=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02]",children:[e.jsx("div",{className:"relative group",children:e.jsxs("div",{className:`w-full ${p().aspect} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[j.thumbnailUrl?e.jsx(Er,{src:j.thumbnailUrl,alt:j.name,className:"w-full h-full object-cover"}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500",children:[e.jsx(et,{className:"w-12 h-12 mb-2 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:j.name})]}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:j.resolution&&j.resolution!=="Unknown"?j.resolution:"HD"}),e.jsx("button",{onClick:z=>{z.stopPropagation(),o&&o(j)},className:"absolute top-2 right-2 bg-black bg-opacity-75 text-white p-1 rounded hover:bg-opacity-90 transition-colors",title:"Editar thumbnail",children:e.jsx(Ks,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>W(j),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx(et,{className:"w-12 h-12 text-white"})})]})}),e.jsxs("div",{className:`${p().compact?"p-2":"p-4"}`,children:[e.jsxs("div",{className:`flex items-center justify-between ${p().compact?"mb-1":"mb-2"}`,children:[e.jsx("h3",{className:`font-semibold text-gray-800 ${p().titleSize} truncate`,children:j.name}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("span",{className:`bg-blue-100 text-blue-800 px-2 py-1 rounded-full ${p().compact,"text-xs"} font-medium`,children:[j.videos.length," videos"]})})]}),p().showIcons?e.jsx("div",{className:"flex items-center justify-center text-gray-500 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ms,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-xs font-medium",children:[j.videos.length," videos"]})]})}):e.jsx("p",{className:`text-gray-600 text-sm ${p().compact?"mb-2":"mb-3"} ${p().descriptionLines===1?"line-clamp-1":p().descriptionLines===2?"line-clamp-2":p().descriptionLines===3?"line-clamp-3":"line-clamp-4"}`,children:j.description||"Sin descripci√≥n"}),p().showTags&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const z=T(j);return z.length>0?z.map(({tag:q,categoryKey:J,color:re})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y(re)}`,children:q},`${J}-${q}`)):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),p().showStats&&e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-2 border-t border-gray-100",children:[!p().compact&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ms,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-medium",children:[j.videos.length," videos"]}),e.jsx("span",{className:"text-gray-400",children:"‚Ä¢"}),e.jsx("span",{className:"text-gray-600",children:j.resolution&&j.resolution!=="Unknown"?j.resolution:"HD"})]}),e.jsxs("div",{className:`flex items-center space-x-2 ${p().compact?"w-full justify-center":""}`,children:[e.jsx("button",{onClick:()=>w(j),className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar secuencia",children:e.jsx(ut,{className:`${p().compact?"h-3 w-3":"h-4 w-4"}`})}),e.jsx("button",{onClick:()=>n(j),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar secuencia",children:e.jsx(er,{className:`${p().compact?"h-3 w-3":"h-4 w-4"}`})}),e.jsx("button",{onClick:()=>f(j),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar secuencia",children:e.jsx(vt,{className:`${p().compact?"h-3 w-3":"h-4 w-4"}`})})]})]})]})]},j.id))}),e.jsx(Lt,{isOpen:i.isOpen,onClose:()=>m({isOpen:!1,sequence:null}),onConfirm:V,title:"¬øEliminar secuencia?",message:`¬øEst√°s seguro de que quieres eliminar la secuencia "${(B=i.sequence)==null?void 0:B.name}"? Esta acci√≥n no se puede deshacer.`,confirmText:"Eliminar",cancelText:"Cancelar",confirmClassName:"bg-red-500 hover:bg-red-600"}),h.map(j=>e.jsx(At,{message:j.message,type:j.type,onClose:()=>N(j.id)},j.id))]})},qs=({type:a="video"})=>{const{videoCardSize:r,sequenceCardSize:t,setVideoCardSize:n,setSequenceCardSize:o,availableSizes:c,sizeLabels:h}=bs(),x=a==="video"?r:t,i=a==="video"?n:o,m={small:e.jsx(Za,{className:"h-4 w-4"}),medium:e.jsx(zs,{className:"h-4 w-4"}),large:e.jsx(zs,{className:"h-4 w-4"}),"extra-large":e.jsx(tr,{className:"h-4 w-4"})},y={small:"from-gray-400 to-gray-500",medium:"from-blue-400 to-blue-500",large:"from-purple-400 to-purple-500","extra-large":"from-pink-400 to-pink-500"};return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Tama√±o:"}),e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:c.map(p=>e.jsxs("button",{onClick:()=>i(p),className:`flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${x===p?`bg-gradient-to-r ${y[p]} text-white shadow-lg transform scale-105`:"text-gray-600 hover:text-gray-800 hover:bg-white"}`,title:`${h[p]} - ${p} cards`,children:[m[p],e.jsx("span",{className:"hidden sm:inline",children:h[p]})]},p))})]})},$r=({video:a,onLike:r,onEdit:t,onDelete:n,onAddToSequence:o,onDownload:c,onPlay:h,isVideoInSequence:x,isBuilderOpen:i,isVideoCompatible:m,type:y="video"})=>y==="video"?e.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-2",children:[e.jsx("button",{onClick:h,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Reproducir",children:e.jsx(et,{className:"h-3 w-3"})}),e.jsx("button",{onClick:r,className:`p-1 transition-colors rounded ${a.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"}`,title:a.userLiked?"Quitar like":"Dar like",children:e.jsx(Tt,{className:`h-3 w-3 ${a.userLiked?"fill-current":""}`})}),e.jsx("button",{onClick:o,disabled:x,className:`p-1 transition-colors rounded ${x?"text-gray-300 cursor-not-allowed":i&&!m?"text-red-400 hover:text-red-500":"text-gray-400 hover:text-purple-500"}`,title:x?"Ya en secuencia":i&&!m?"A√±adir forzadamente":"A√±adir a secuencia",children:e.jsx(Zt,{className:"h-3 w-3"})}),e.jsx("button",{onClick:c,className:"p-1 text-gray-400 hover:text-green-500 transition-colors rounded",title:"Descargar",children:e.jsx(ut,{className:"h-3 w-3"})}),e.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Editar",children:e.jsx(Gt,{className:"h-3 w-3"})}),e.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-red-500 transition-colors rounded",title:"Eliminar",children:e.jsx(vt,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-2",children:[e.jsx("button",{onClick:h,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Reproducir secuencia",children:e.jsx(et,{className:"h-3 w-3"})}),e.jsx("button",{onClick:c,className:"p-1 text-gray-400 hover:text-green-500 transition-colors rounded",title:"Descargar secuencia",children:e.jsx(ut,{className:"h-3 w-3"})}),e.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Editar secuencia",children:e.jsx(Gt,{className:"h-3 w-3"})}),e.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-red-500 transition-colors rounded",title:"Eliminar secuencia",children:e.jsx(vt,{className:"h-3 w-3"})})]}),_r=()=>{var ks,Ss;const[a,r]=l.useState(!1),[t,n]=l.useState({isOpen:!1,video:null}),[o,c]=l.useState([]),[h,x]=l.useState(!0),[i,m]=l.useState([]),[y,p]=l.useState({isOpen:!1,video:null}),[R,N]=l.useState([]),[f,V]=l.useState(""),[W,w]=l.useState(!1),[T,B]=l.useState("videos"),[j,z]=l.useState("idle"),[q,J]=l.useState({isOpen:!1,type:null}),[re,he]=l.useState({isOpen:!1,sequence:null}),[Ne,ne]=l.useState({isOpen:!1,sequence:null}),[ze,ke]=l.useState({isOpen:!1}),[Re,De]=l.useState(!1),[je,Fe]=l.useState(null),[Me,O]=l.useState(!1),[ve,pe]=l.useState(null),[S,F]=l.useState(!1),[U,K]=l.useState([]),[G,Q]=l.useState("none"),[ue,d]=l.useState(!1),[A,D]=l.useState([]),[_,I]=l.useState(!0),{user:Y}=Jt(),{getVideoConfig:se,getSequenceConfig:xe}=bs(),{addVideoToSequence:M,removeVideoFromSequence:te,sequence:ie,sequenceName:ce,clearSequence:Ie,isBuilderOpen:Se,toggleBuilder:Ae,showAllVideos:be,toggleShowAllVideos:Ee,getFilteredVideos:Ce,isVideoInSequence:de,isVideoCompatible:Te,checkCompatibility:tt,loadSequence:Be}=Gs(),[k,Ge]=l.useState("salsa"),{availableStyles:Ke,getGradientClasses:oe,categoriesList:Xe,getColorClasses:st}=Mt("figuras",k),mt=s=>{K(u=>u.includes(s)?u.filter(E=>E!==s):[...u,s])},L=s=>{M(s),Se||Ae()},X={Music:Ht,Heart:Tt,Star:Ds,Zap:Ua};l.useEffect(()=>{console.log("üîÑ Iniciando sincronizaci√≥n en tiempo real para:",k),z("syncing");const s=Ca(k,u=>{console.log(`üîÑ Actualizaci√≥n en tiempo real recibida: ${u.length} videos para ${k}`),c(u),x(!1),z("idle")});return()=>{console.log("üîÑ Desuscribiendo de sincronizaci√≥n en tiempo real"),s()}},[k]),l.useEffect(()=>{o.length>0&&Y&&(console.log("‚ù§Ô∏è Verificando estado de likes y favoritos del usuario para",o.length,"videos"),(async()=>{const u=await Promise.all(o.map(async E=>{try{const[P,Z]=await Promise.all([Ta(E.id,Y.uid),La(E.id,Y.uid)]);return{...E,userLiked:P.userLiked,isFavorite:Z.isFavorite}}catch(P){return console.error("Error al verificar like/favorito para video:",E.id,P),{...E,userLiked:!1,isFavorite:!1}}}));c(u)})())},[o.length,Y]),l.useEffect(()=>{if(console.log("üé¨ FigurasPage: useEffect de secuencias ejecut√°ndose"),console.log("üé¨ selectedStyle actual:",k),console.log("üé¨ subscribeToSequencesByStyle disponible:",typeof Bs),!k){console.log("‚ö†Ô∏è No hay selectedStyle, saltando suscripci√≥n");return}console.log("üé¨ Iniciando sincronizaci√≥n de secuencias para:",k),I(!0);try{const s=Bs(k,u=>{console.log(`üé¨ Actualizaci√≥n de secuencias recibida: ${u.length} secuencias para ${k}`),D(u),I(!1)});return()=>{console.log("üé¨ Desuscribiendo de sincronizaci√≥n de secuencias"),s()}}catch(s){console.error("‚ùå Error al suscribirse a secuencias:",s),I(!1)}},[k]);const Ze=async s=>{console.log("Video subido:",s),v(`${s.title} subido exitosamente`,"success")},Pe=s=>{n({isOpen:!0,video:s})},g=()=>{n({isOpen:!1,video:null})},C=s=>{c(u=>u.map(E=>E.id===s.id?s:E)),v(`${s.title} actualizado exitosamente`,"success")},$=async s=>{if(!Y){v("Debes iniciar sesi√≥n para dar like","error");return}try{const u=await ms(s.id,Y.uid);if(u.success){c(Z=>Z.map(fe=>fe.id===s.id?{...fe,likes:u.likes,likedBy:u.likedBy,userLiked:u.userLiked,isFavorite:u.isFavorite}:fe));const E=u.userLiked?"dado like a":"quitado like de",P=u.isFavorite?"y agregado a favoritos":"y removido de favoritos";v(`Has ${E} "${s.title}" ${P}`,"success")}else v("Error al actualizar like","error")}catch(u){console.error("Error al manejar like:",u),v("Error al actualizar like","error")}},v=(s,u="success")=>{const E=Date.now();m(P=>[...P,{id:E,message:s,type:u}])},ye=s=>{m(u=>u.filter(E=>E.id!==s))},_e=async s=>{console.log("üé¨ FigurasPage: Recibida solicitud de guardar secuencia"),console.log("üì¶ Datos recibidos:",s);try{const u={...s,style:k};if(console.log("üé® Secuencia con estilo:",u),s.id){console.log("üîÑ Actualizando secuencia existente:",s.id);const E=await wr(s.id,u);console.log("‚úÖ Secuencia actualizada exitosamente:",E),v("‚úÖ Secuencia actualizada exitosamente")}else{console.log("üÜï Creando nueva secuencia");const E=await yr(u);console.log("‚úÖ Secuencia creada exitosamente:",E),v('‚úÖ Secuencia guardada exitosamente. Ve a "GALER√çA DE SECUENCIAS" para verla.')}}catch(u){throw console.error("‚ùå Error al guardar secuencia:",u),v("Error al guardar la secuencia","error"),u}},Qe=async s=>{try{await vr(s),v("Secuencia eliminada exitosamente")}catch(u){throw console.error("Error al eliminar secuencia:",u),v("Error al eliminar la secuencia","error"),u}},ft=s=>{console.log("üé¨ Reproduciendo secuencia:",s.name),pe(s),F(!0),v(`üé¨ Reproduciendo secuencia: ${s.name}`,"info")},jt=s=>{console.log("üé¨ Editando secuencia:",s),ie.length>0||ce.trim()?he({isOpen:!0,sequence:s}):(Be(s),v(`Secuencia "${s.name}" cargada para edici√≥n`))},Et=()=>{const s=re.sequence;s&&(Be(s),v(`Secuencia "${s.name}" cargada para edici√≥n`)),he({isOpen:!1,sequence:null})},Nt=()=>{console.log("‚ùå Usuario cancel√≥ la carga de secuencia"),he({isOpen:!1,sequence:null})},as=s=>{console.log("üì• Abriendo descarga de secuencia:",s),ne({isOpen:!0,sequence:s})},Pt=()=>{ne({isOpen:!1,sequence:null})},Ft=s=>{console.log("üé¨ Reproduciendo video individual:",s.title),Fe(s),O(!0),v(`üé¨ Reproduciendo: ${s.title}`,"info")},b=()=>{O(!1),Fe(null)},H=()=>{F(!1),pe(null)},we=async s=>{try{console.log("üóëÔ∏è Iniciando eliminaci√≥n de video:",s),console.log("üìÅ Video path:",s.videoPath),console.log("üñºÔ∏è Thumbnail path:",s.thumbnailPath),console.log("üÜî Video ID:",s.id);const u=await Ps(s.videoPath,s.thumbnailPath);if(console.log("üì¶ Resultado eliminaci√≥n Storage:",u),!u.success)if(console.log("‚ö†Ô∏è Error eliminando archivos, intentando solo eliminar video..."),u.error&&u.error.includes("thumbnails")){if(!(await Ps(s.videoPath,null)).success){v(`Error al eliminar archivos: ${u.error}`,"error");return}}else{v(`Error al eliminar archivos: ${u.error}`,"error");return}console.log("üî• Intentando eliminar documento de Firestore con ID:",s.id);const E=await Pa(s.id);if(console.log("üî• Resultado eliminaci√≥n Firestore:",E),!E.success){v(`Error al eliminar metadatos: ${E.error}`,"error");return}console.log("üîÑ Actualizando lista local, eliminando video con ID:",s.id),c(P=>{const Z=P.filter(fe=>fe.id!==s.id);return console.log(`üìä Lista actualizada: ${P.length} -> ${Z.length} videos`),Z}),v(`${s.title} eliminado correctamente`,"success"),console.log("‚úÖ Eliminaci√≥n completada exitosamente")}catch(u){console.error("‚ùå Error deleting video:",u),v("Error inesperado al eliminar video","error")}},$e=s=>{console.log("üîò Bot√≥n eliminar clickeado para video:",s),p({isOpen:!0,video:s})},at=()=>{p({isOpen:!1,video:null})},Ye=async s=>{try{if(z("syncing"),v("Iniciando limpieza de datos...","info"),s==="update"){const u=await Da();u.success?v(`‚úÖ ${u.updatedCount} videos actualizados`,"success"):v(`‚ùå Error: ${u.error}`,"error")}else if(s==="cleanup"){const u=await Ls(),E=await _a(u);E.success?v(`üßπ ${E.orphanedVideosDeleted} videos y ${E.orphanedThumbnailsDeleted} thumbnails hu√©rfanos eliminados`,"success"):v(`‚ùå Error: ${E.error}`,"error")}else if(s==="cleanup-tags"){const u=await Ma();u.success?v(`üè∑Ô∏è ${u.updatedCount} videos actualizados con tags limpios`,"success"):v(`‚ùå Error: ${u.error}`,"error")}else if(s==="delete-all"){if(!window.confirm("¬øEst√°s seguro de que quieres eliminar TODOS los videos? Esta acci√≥n no se puede deshacer.")){z("idle");return}const E=await Aa();if(!E.success){v(`‚ùå Error eliminando documentos: ${E.error}`,"error"),z("idle");return}const P=await qa();if(!P.success){v(`‚ùå Error eliminando archivos: ${P.error}`,"error"),z("idle");return}v(`üóëÔ∏è ${E.deletedCount} videos eliminados completamente`,"success")}z("idle"),J({isOpen:!1,type:null})}catch(u){console.error("Error en limpieza:",u),v(`‚ùå Error inesperado: ${u.message}`,"error"),z("idle")}},It=s=>{J({isOpen:!0,type:s})},sa=()=>{J({isOpen:!1,type:null})},aa=async()=>{try{v("Ejecutando diagn√≥stico de videos...","info");const s=await Ra();if(s.success){console.log("üîç Resultado del diagn√≥stico:",s);let u=`Diagn√≥stico: ${s.totalVideos} videos total, ${s.salsaVideos} de salsa`;s.fig003Found?u+=" ‚úÖ Fig003 encontrado":u+=" ‚ùå Fig003 NO encontrado",s.videosWithoutResolution>0&&(u+=` ‚ö†Ô∏è ${s.videosWithoutResolution} sin resoluci√≥n`),v(u,"success")}else v(`Error en diagn√≥stico: ${s.error}`,"error")}catch(s){console.error("Error ejecutando diagn√≥stico:",s),v("Error al ejecutar diagn√≥stico","error")}},ra=async()=>{try{v("üîÑ Actualizando resoluciones de videos...","info");const u=(await Ls()).filter(P=>!P.resolution||P.resolution==="Unknown");if(u.length===0){v("‚úÖ Todos los videos ya tienen resoluci√≥n detectada","success");return}let E=0;for(const P of u)try{const Z=document.createElement("video");Z.crossOrigin="anonymous",await new Promise((fe,me)=>{Z.onloadedmetadata=()=>{const Le=Z.videoWidth,Je=Z.videoHeight,lt=Math.max(Le,Je);let rt="Unknown";lt>=3840?rt="4K":lt>=1920?rt="1080p":lt>=1280?rt="720p":lt>=854?rt="480p":rt="360p",_t(P.id,{resolution:rt,videoWidth:Le,videoHeight:Je}),E++,fe()},Z.onerror=me,Z.src=P.videoUrl}),Z.remove()}catch(Z){console.error(`Error actualizando resoluci√≥n para video ${P.id}:`,Z)}v(`‚úÖ Resoluciones actualizadas: ${E} videos`,"success")}catch(s){console.error("Error al actualizar resoluciones:",s),v("Error al actualizar resoluciones","error")}},na=async()=>{try{v("üîÑ Iniciando migraci√≥n REAL de videos a estructura organizada...","info");const s=await Ha(o);if(s.success){let u=`‚úÖ Migraci√≥n REAL completada: ${s.successfulMigrations} videos movidos f√≠sicamente`;s.alreadyOrganized>0&&(u+=`, ${s.alreadyOrganized} ya organizados`),s.failedMigrations>0&&(u+=`, ${s.failedMigrations} fallidos`),v(u,"success"),console.log("üìä Resultados de migraci√≥n REAL:",s.results),window.location.reload()}else v(`‚ùå Error en migraci√≥n: ${s.error}`,"error")}catch(s){console.error("Error ejecutando migraci√≥n:",s),v("‚ùå Error al ejecutar migraci√≥n","error")}},oa=s=>{N(u=>u.includes(s)?u.filter(P=>P!==s):[...u,s])},la=()=>{N([]),V("")},ws=s=>{Q(s)},ia=(s,u)=>{if(!s.tags||!Xe.find(Z=>Z.key===u))return!1;const P=s.tags[u];return P&&Array.isArray(P)&&P.length>0},ca=s=>{if(G==="none")return s;const u=[...s];switch(G){case"name":return u.sort((E,P)=>E.title.localeCompare(P.title));case"name-desc":return u.sort((E,P)=>P.title.localeCompare(E.title));case"rating":return u.sort((E,P)=>(P.rating||0)-(E.rating||0));case"rating-desc":return u.sort((E,P)=>(E.rating||0)-(P.rating||0));case"likes":return u.sort((E,P)=>(P.likes||0)-(E.likes||0));case"likes-desc":return u.sort((E,P)=>(E.likes||0)-(P.likes||0));default:return u}},vs=s=>{if(!s.tags||Object.keys(s.tags).length===0)return[];const u=[];return Xe.forEach(E=>{const P=s.tags[E.key];Array.isArray(P)&&P.forEach(Z=>{u.push({tag:Z,categoryKey:E.key,color:E.color})})}),u},js=s=>{if(!s.tagsIniciales||Object.keys(s.tagsIniciales).length===0)return[];const u=[];return Xe.forEach(E=>{const P=s.tagsIniciales[E.key];Array.isArray(P)&&P.forEach(Z=>{u.push({tag:Z,categoryKey:E.key,color:E.color,type:"inicial"})})}),u},Ns=s=>{if(!s.tagsFinales||Object.keys(s.tagsFinales).length===0)return[];const u=[];return Xe.forEach(E=>{const P=s.tagsFinales[E.key];Array.isArray(P)&&P.forEach(Z=>{u.push({tag:Z,categoryKey:E.key,color:E.color,type:"final"})})}),u},Ut=s=>s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),da=(s,u)=>{if(!u||u.length===0)return!0;const E=Ut(s.title||""),P=Ut(s.description||""),Z=[];return s.tags&&Object.values(s.tags).forEach(fe=>{Array.isArray(fe)&&fe.forEach(me=>{Z.push(Ut(me))})}),u.every(fe=>{const me=Ut(fe);return!!(E.includes(me)||P.includes(me)||Z.some(Le=>Le.includes(me)))})},ua=o.filter(s=>{const u=f.split(" ").map(me=>me.trim()).filter(me=>me.length>0),E=da(s,u),P=R.length===0||R.every(me=>s.tags?Object.values(s.tags).some(Le=>Array.isArray(Le)&&Le.includes(me)):!1),Z=U.length===0||U.some(me=>ia(s,me)),fe=!ue||s.isFavorite;return E&&P&&Z&&fe}),ma=Ce(ua),zt=ca(ma),rs=async s=>{try{console.log("Iniciando descarga de video individual:",s.title);const{ref:u,getDownloadURL:E}=await pt(async()=>{const{ref:Le,getDownloadURL:Je}=await import("./tag-BSjDyQEr.js").then(lt=>lt.i);return{ref:Le,getDownloadURL:Je}},__vite__mapDeps([0,1,2])),{storage:P}=await pt(async()=>{const{storage:Le}=await import("./index-CkiEKLiW.js").then(Je=>Je.ae);return{storage:Le}},__vite__mapDeps([1,2])),Z=u(P,s.videoPath),fe=await E(Z);console.log("URL de descarga obtenida:",fe);const me=document.createElement("a");me.href=fe,me.download=s.title||"video",me.target="_blank",me.rel="noopener noreferrer",document.body.appendChild(me),me.click(),document.body.removeChild(me),v("Descarga iniciada","success")}catch(u){console.error("Error en descarga:",u),v("Error al descargar el video","error")}};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsxs("div",{className:`${Re?"w-full px-0":"max-w-6xl mx-auto px-6"} py-8`,children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[e.jsx("span",{className:"text-pink-500",children:"FIGURAS"}),e.jsxs("span",{className:`bg-gradient-to-r ${oe(k)} bg-clip-text text-transparent`,children:[" - ",k.toUpperCase()]})]}),e.jsxs("p",{className:"text-gray-600 text-lg",children:["Galer√≠a de videos de figuras de ",k.toLowerCase()]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:Ke.map(s=>{const u=X[s.icon],E=k===s.key,P=oe(s.color);return e.jsxs("button",{onClick:()=>Ge(s.key),className:`relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${E?`bg-gradient-to-r ${P} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[u&&e.jsx(u,{className:"h-4 w-4"}),e.jsx("span",{children:s.name})]},s.name)})}),e.jsxs("div",{className:"max-w-2xl mx-auto mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:`Buscar en ${k.toLowerCase()}... (m√∫ltiples palabras, sin tildes)`,value:f,onChange:s=>V(s.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]}),f.trim()&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(Ts,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{className:"text-sm text-blue-700",children:["Buscando: ",e.jsxs("span",{className:"font-medium",children:['"',f,'"']})]}),e.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded",children:[zt.length," resultado",zt.length!==1?"s":""]})]})})]}),Xe.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>w(!W),className:"flex items-center justify-center space-x-2 mx-auto px-6 py-3 bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[e.jsx(Ka,{className:"h-5 w-5"}),e.jsxs("span",{children:["Filtros Avanzados por Tags - ",k]}),W?e.jsx(Qt,{className:"h-5 w-5"}):e.jsx(Xt,{className:"h-5 w-5"})]}),e.jsx("div",{className:`mt-4 transition-all duration-300 ease-in-out overflow-hidden ${W?"max-h-96 opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("div",{className:"space-y-4 bg-gray-50 rounded-lg p-6 border border-gray-200",children:Xe.map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>mt(s.key),className:`w-full text-center font-medium py-2 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 ${U.includes(s.key)?`bg-gradient-to-r ${oe(k)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:s.name}),U.includes(s.key)&&e.jsx("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:"ACTIVO"})]})}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:s.tags.map(u=>e.jsx("button",{onClick:()=>oa(u),className:`px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 ${R.includes(u)?`bg-gradient-to-r ${oe(k)} text-white shadow-lg`:`${st(s.color)} hover:bg-opacity-80`}`,children:u},u))})]},s.key))})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:[e.jsxs("button",{onClick:()=>r(!0),className:`flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r ${oe(k)} text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105`,children:[e.jsx(hs,{className:"h-5 w-5"}),e.jsxs("span",{children:["SUBIR VIDEO(S) A ",k.toUpperCase()]})]}),e.jsxs("button",{onClick:Ae,className:`flex items-center justify-center space-x-2 px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 ${Se?"bg-gradient-to-r from-red-500 to-pink-500 text-white":`bg-gradient-to-r ${oe(k)} hover:opacity-90 text-white`}`,children:[e.jsx(xs,{className:"h-5 w-5"}),e.jsx("span",{children:Se?"OCULTAR SECUENCIA":"CREAR SECUENCIA"})]})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3 mb-6",children:[e.jsx("button",{onClick:()=>ws(G==="name"?"name-desc":"name"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${G==="name"||G==="name-desc"?`bg-gradient-to-r ${oe(k)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:e.jsx("span",{children:G==="name"?"A-Z":G==="name-desc"?"Z-A":"A-Z"})}),e.jsxs("button",{onClick:()=>ws(G==="rating"?"rating-desc":"rating"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${G==="rating"||G==="rating-desc"?`bg-gradient-to-r ${oe(k)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[e.jsx(Ds,{className:"h-4 w-4"}),e.jsx("span",{children:G==="rating"?"Puntuaci√≥n ‚Üì":G==="rating-desc"?"Puntuaci√≥n ‚Üë":"Puntuaci√≥n"})]}),e.jsxs("button",{onClick:()=>{ue?G==="likes"?Q("likes-desc"):G==="likes-desc"?Q("likes"):(d(!1),Q("none")):(d(!0),Q("likes"))},className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${ue?`bg-gradient-to-r ${oe(k)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[e.jsx(Tt,{className:"h-4 w-4"}),e.jsx("span",{children:ue?G==="likes"?"Favoritos ‚Üì":G==="likes-desc"?"Favoritos ‚Üë":"Ocultar Favoritos":"Mostrar Favoritos"})]})]}),Se&&e.jsx(Sr,{isOpen:!0,videos:o,onSaveSequence:_e,onToggleShowAll:Ee,showAllVideos:be,style:k,onToggleBuilder:Ae}),e.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${j==="idle"?"bg-green-500":j==="syncing"?"bg-yellow-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-gray-600",children:j==="idle"?"‚úÖ Sincronizado con Firebase":j==="syncing"?"üîÑ Sincronizando...":"‚ùå Error de sincronizaci√≥n"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:aa,disabled:j==="syncing",className:"px-3 py-1 text-xs bg-purple-500 text-white rounded hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üîç Diagn√≥stico"}),e.jsx("button",{onClick:ra,disabled:j==="syncing",className:"px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üìê Actualizar Resoluciones"}),e.jsx("button",{onClick:()=>It("update"),disabled:j==="syncing",className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üîß Actualizar Rutas"}),e.jsx("button",{onClick:()=>It("cleanup"),disabled:j==="syncing",className:"px-3 py-1 text-xs bg-yellow-500 text-white rounded hover:bg-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üßπ Limpiar Hu√©rfanos"}),e.jsx("button",{onClick:()=>It("cleanup-tags"),disabled:j==="syncing",className:"px-3 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üè∑Ô∏è Limpiar Tags"}),e.jsx("button",{onClick:na,disabled:j==="syncing",className:"px-3 py-1 text-xs bg-indigo-500 text-white rounded hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",title:"Mover f√≠sicamente videos existentes a estructura organizada (videos/page/style/)",children:"üìÅ Migrar Videos REAL"}),e.jsx("button",{onClick:()=>It("delete-all"),disabled:j==="syncing",className:"px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üóëÔ∏è Eliminar Todo"})]})]})}),e.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[e.jsxs("button",{onClick:()=>B("videos"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${T==="videos"?`bg-gradient-to-r ${oe(k)} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[e.jsx(Ht,{className:"h-6 w-6"}),e.jsx("span",{children:"GALER√çA DE VIDEOS"})]}),e.jsxs("button",{onClick:()=>B("secuencias"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${T==="secuencias"?`bg-gradient-to-r ${oe(k)} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[e.jsx(Zt,{className:"h-6 w-6"}),e.jsxs("span",{children:["GALER√çA DE SECUENCIAS (",A.length,")"]})]})]}),T==="videos"&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Videos de ",k.toLowerCase()," (",zt.length,")"]}),(U.length>0||G!=="none"||ue)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[U.length>0&&`Filtrado por: ${U.join(", ")} `,G!=="none"&&`‚Ä¢ Ordenado por: ${G} `,ue&&"‚Ä¢ Solo favoritos"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(qs,{type:"video"}),e.jsxs("button",{onClick:()=>De(!Re),className:`flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 ${Re?`bg-gradient-to-r ${oe(k)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,title:Re?"Modo compacto":"Modo ancho completo",children:[Re?e.jsx(Ja,{className:"h-4 w-4"}):e.jsx(Ya,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:Re?"Compacto":"Ancho completo"})]}),Se&&e.jsx("button",{onClick:Ee,className:`flex items-center space-x-2 px-3 py-1 rounded-lg text-sm font-medium transition-colors ${be?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,title:be?"Mostrar solo videos compatibles":"Mostrar todos los videos",children:be?e.jsxs(e.Fragment,{children:[e.jsx(za,{className:"h-4 w-4"}),e.jsx("span",{children:"Ocultar Incompatibles"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Oa,{className:"h-4 w-4"}),e.jsx("span",{children:"Mostrar Todos"})]})}),(R.length>0||U.length>0||G!=="none"||ue)&&e.jsxs("button",{onClick:()=>{la(),K([]),Q("none"),d(!1)},className:"text-sm text-gray-500 hover:text-gray-700 transition-colors duration-200",children:["Limpiar todos los filtros ",e.jsx(ot,{className:"h-4 w-4 ml-1"})]})]})]}),h?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando videos..."})]}):o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("p",{className:"text-gray-500 text-lg",children:["No hay videos de ",k.toLowerCase()," a√∫n"]}),e.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Sube tu primer video de ",k.toLowerCase()," usando el bot√≥n de arriba"]})]}):e.jsx("div",{className:`grid gap-6 ${se().grid}`,children:zt.map(s=>e.jsxs("div",{className:`bg-white rounded-lg shadow-md overflow-hidden border hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] ${Se&&!Te(s)?"border-red-200 opacity-75":"border-gray-100"}`,children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:`w-full ${se().aspect} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[s.thumbnailUrl&&s.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"w-full h-full object-cover",loading:"lazy",onError:u=>{u.target.style.display="none",u.target.nextSibling.style.display="flex"}}):null,e.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${s.thumbnailUrl&&s.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?"hidden":"flex"}`,children:[e.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),e.jsx("span",{className:"text-sm font-medium",children:s.title})]}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:s.resolution&&s.resolution!=="Unknown"?s.resolution:"HD"}),Se&&e.jsx("div",{className:`absolute top-2 right-2 p-1 rounded-full text-xs font-bold ${Te(s)?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:Te(s)?"‚úÖ":"‚ùå"})]}),e.jsx("button",{onClick:async()=>{try{const u=document.createElement("div");u.className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50";const E=document.createElement("div");E.className="bg-white rounded-lg p-6 max-w-5xl w-full mx-4 max-h-[95vh] overflow-y-auto",E.onclick=ae=>ae.stopPropagation();const P=document.createElement("div");P.className="flex items-center justify-between mb-4",P.innerHTML=`
                             <h3 class="text-xl font-semibold text-gray-900">${s.title}</h3>
                             <button class="text-gray-400 hover:text-gray-600 transition-colors">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                               </svg>
                             </button>
                           `;const Z=document.createElement("div");Z.id="video-player-container",Z.className="w-full flex justify-center mb-6";const fe=document.createElement("div");fe.className="w-full max-w-3xl mx-auto";const me=document.createElement("div");me.className="mb-4",me.innerHTML=`
                             <p class="text-gray-600 text-sm">${s.description||"Sin descripci√≥n"}</p>
                           `;const Le=document.createElement("div");Le.className="flex items-center justify-between mb-4 p-3 bg-gray-50 rounded-lg",Le.innerHTML=`
                              <div class="flex items-center space-x-4 text-sm text-gray-600">
                                <span class="font-medium">${(s.fileSize/(1024*1024)).toFixed(2)} MB</span>
                                <span class="text-gray-400">‚Ä¢</span>
                                <span class="font-medium">${s.resolution&&s.resolution!=="Unknown"?s.resolution:"HD"}</span>
                                <span class="text-gray-400">‚Ä¢</span>
                                <span class="font-medium">${s.duration?Math.floor(s.duration/60)+":"+String(Math.floor(s.duration%60)).padStart(2,"0"):"N/A"}</span>
                              </div>
                              <div class="flex items-center space-x-2">
                                <div class="flex items-center space-x-1">
                                  <div class="flex items-center space-x-1" title="Puntuaci√≥n: ${s.rating||0}/5">
                                    ${[1,2,3,4,5].map(ae=>`<svg class="w-4 h-4 ${(s.rating||0)>=ae?"text-yellow-400 fill-current":"text-gray-300"}" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                      </svg>`).join("")}
                                    <span class="text-sm font-medium text-gray-600">${s.rating||0}</span>
                                  </div>
                                </div>
                                <button class="flex items-center space-x-1 ${s.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"} transition-colors duration-200 p-2 rounded hover:bg-red-50" title="${s.userLiked?"Quitar like":"Dar like"}">
                                  <svg class="w-5 h-5 ${s.userLiked?"fill-current":""}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                  </svg>
                                  <span class="text-sm font-medium">${s.likes||0}</span>
                                </button>
                                <button class="text-gray-400 hover:text-green-500 transition-colors duration-200 p-2 rounded hover:bg-green-50" title="Descargar video">
                                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                  </svg>
                                </button>
                                <button class="text-gray-400 hover:text-blue-500 transition-colors duration-200 p-2 rounded hover:bg-blue-50" title="Editar video">
                                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                  </svg>
                                </button>
                              </div>
                            `;const Je=document.createElement("div");Je.className="mb-4";const lt=vs(s);if(lt.length>0){const ae=lt.map(({tag:Ue,categoryKey:nt,color:qe})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium ${st(qe)} mr-2 mb-2">${Ue}</span>`).join("");Je.innerHTML=`
                               <h4 class="text-sm font-medium text-gray-700 mb-2">Etiquetas:</h4>
                               <div class="flex flex-wrap">${ae}</div>
                             `}else Je.innerHTML=`
                               <h4 class="text-sm font-medium text-gray-700 mb-2">Etiquetas:</h4>
                               <span class="text-gray-400 text-sm">Sin etiquetas</span>
                             `;const rt=document.createElement("div");rt.className="mb-4";const ns=js(s);if(ns.length>0){const ae=ns.map(({tag:Ue})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white mr-2 mb-2">${Ue}</span>`).join("");rt.innerHTML=`
                               <h4 class="text-sm font-medium text-blue-600 uppercase tracking-wide mb-2">Etiquetas Iniciales:</h4>
                               <div class="flex flex-wrap">${ae}</div>
                             `}const os=document.createElement("div");os.className="mb-4";const ls=Ns(s);if(ls.length>0){const ae=ls.map(({tag:Ue})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white mr-2 mb-2">${Ue}</span>`).join("");os.innerHTML=`
                               <h4 class="text-sm font-medium text-green-600 uppercase tracking-wide mb-2">Etiquetas Finales:</h4>
                               <div class="flex flex-wrap">${ae}</div>
                             `}fe.appendChild(me),fe.appendChild(Le),fe.appendChild(Je),ns.length>0&&fe.appendChild(rt),ls.length>0&&fe.appendChild(os),E.appendChild(P),E.appendChild(Z),E.appendChild(fe),u.appendChild(E),document.body.appendChild(u);const{createRoot:ha}=await pt(async()=>{const{createRoot:ae}=await import("./index-CkiEKLiW.js").then(Ue=>Ue.c);return{createRoot:ae}},__vite__mapDeps([1,2])),Es=ha(Z);Es.render($a.createElement(Dt,{src:s.videoUrl,size:"large",loop:!0,initialShowControls:!0,autoplay:!0,muted:!1,className:"w-full max-w-3xl",resolutions:["auto","4k","1080p","720p","480p","360p"],currentResolution:"auto",videoTitle:s.title||"video",onResolutionChange:ae=>{console.log(`Resoluci√≥n cambiada a: ${ae}`)}})),u._root=Es;const is=()=>{u._root&&u._root.unmount(),document.body.contains(u)&&document.body.removeChild(u)};P.querySelector("button").onclick=is,u.onclick=ae=>{ae.target===u&&is()},Le.querySelector('button[title="Descargar video"]').onclick=()=>{rs(s)},Le.querySelector('button[title="Editar video"]').onclick=()=>{is(),Pe(s)};const cs=Le.querySelector('div[title*="Puntuaci√≥n"]'),Ot=cs.querySelectorAll("svg"),xa=cs.querySelector("span");Ot.forEach((ae,Ue)=>{const nt=Ue+1;ae.addEventListener("mouseenter",()=>{Ot.forEach((qe,He)=>{He<=Ue&&(qe.classList.add("text-yellow-400","fill-current"),qe.classList.remove("text-gray-300"))})}),ae.addEventListener("mouseleave",()=>{Ot.forEach((qe,He)=>{const ht=s.rating||0;He<ht?(qe.classList.add("text-yellow-400","fill-current"),qe.classList.remove("text-gray-300")):(qe.classList.remove("text-yellow-400","fill-current"),qe.classList.add("text-gray-300"))})}),ae.addEventListener("click",async()=>{try{const He=(s.rating||0)>=nt?0:nt;await _t(s.id,{rating:He}),s.rating=He,Ot.forEach((ht,Ct)=>{Ct<He?(ht.classList.add("text-yellow-400","fill-current"),ht.classList.remove("text-gray-300")):(ht.classList.remove("text-yellow-400","fill-current"),ht.classList.add("text-gray-300"))}),xa.textContent=He,cs.title=`Puntuaci√≥n: ${He}/5`,console.log(`Video "${s.title}" puntuado con ${He} estrellas`)}catch(qe){console.error("Error al actualizar puntuaci√≥n:",qe)}})});const Vt=Le.querySelector('button[title*="like"]');Vt.onclick=async()=>{if(!Y){alert("Debes iniciar sesi√≥n para dar like");return}try{const ae=await ms(s.id,Y.uid);if(ae.success){s.likes=ae.likes,s.likedBy=ae.likedBy,s.userLiked=ae.userLiked,c(ht=>ht.map(Ct=>Ct.id===s.id?{...Ct,likes:ae.likes,likedBy:ae.likedBy,userLiked:ae.userLiked}:Ct));const Ue=Vt.querySelector("svg"),nt=Vt,qe=Vt.querySelector("span");ae.userLiked?(Ue.classList.add("fill-current","text-red-500"),Ue.classList.remove("text-gray-400"),nt.classList.add("text-red-500"),nt.classList.remove("text-gray-400"),nt.title="Quitar like"):(Ue.classList.remove("fill-current","text-red-500"),Ue.classList.add("text-gray-400"),nt.classList.remove("text-red-500"),nt.classList.add("text-gray-400"),nt.title="Dar like"),qe.textContent=ae.likes;const He=ae.userLiked?"dado like a":"quitado like de";console.log(`Has ${He} "${s.title}"`)}else console.error("Error al actualizar like")}catch(ae){console.error("Error al actualizar like:",ae)}}}catch(u){console.error("Error al abrir modal de video:",u)}},className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})]}),e.jsxs("div",{className:`${se().compact?"p-2":"p-4"}`,children:[e.jsxs("div",{className:`flex items-center justify-between ${se().compact?"mb-1":"mb-2"}`,children:[e.jsx("h3",{className:`font-semibold text-gray-800 ${se().titleSize}`,children:s.title}),e.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(u=>{const E=(s.rating||0)>=u;return e.jsx("svg",{className:`${se().compact?"h-3 w-3":"h-4 w-4"} ${E?"text-yellow-400 fill-current":"text-gray-300"} cursor-pointer`,fill:"currentColor",viewBox:"0 0 24 24",onClick:async()=>{try{const Z=(s.rating||0)>=u?0:u;await _t(s.id,{rating:Z}),s.rating=Z,console.log(`Video "${s.title}" rated ${Z} stars`)}catch(P){console.error("Error updating rating:",P)}},children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},u)}),e.jsxs("span",{className:`${se().compact,"text-xs"} font-medium text-gray-500 ml-1`,children:["(",s.rating||0,")"]})]})]}),e.jsx("p",{className:`text-gray-600 text-sm ${se().compact?"mb-2":"mb-3"} ${se().descriptionLines===1?"line-clamp-1":se().descriptionLines===2?"line-clamp-2":se().descriptionLines===3?"line-clamp-3":"line-clamp-4"}`,children:s.description||"Sin descripci√≥n"}),se().showTags&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const u=vs(s);return u.length>0?u.map(({tag:E,categoryKey:P,color:Z})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${st(Z)}`,children:E},`${P}-${E}`)):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),se().showTags&&(()=>{const u=js(s);return u.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:"Iniciales:"})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(({tag:E,categoryKey:P,color:Z})=>e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-sm",children:E},`inicial-${P}-${E}`))})]}):null})(),se().showTags&&(()=>{const u=Ns(s);return u.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-green-600 uppercase tracking-wide",children:"Finales:"})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(({tag:E,categoryKey:P,color:Z})=>e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-sm",children:E},`final-${P}-${E}`))})]}):null})(),se().compact?e.jsx($r,{video:s,onLike:()=>$(s),onEdit:()=>Pe(s),onDelete:()=>$e(s),onAddToSequence:()=>L(s),onDownload:()=>rs(s),onPlay:()=>Ft(s),isVideoInSequence:de(s),isBuilderOpen:Se,isVideoCompatible:Te(s),type:"video"}):e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"font-medium",children:[(s.fileSize/(1024*1024)).toFixed(2)," MB"]}),e.jsx("span",{className:"text-gray-400",children:"‚Ä¢"}),e.jsx("span",{className:"text-gray-600",children:s.resolution&&s.resolution!=="Unknown"?s.resolution:"HD"}),s.bpm&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"‚Ä¢"}),e.jsxs("span",{className:"text-purple-600 font-medium flex items-center space-x-1",children:[e.jsx(Ht,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.bpm," BPM"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>Ft(s),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Reproducir video",children:e.jsx(et,{className:"h-4 w-4"})}),e.jsxs("button",{onClick:()=>$(s),className:`flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 ${s.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"}`,title:s.userLiked?"Quitar like":"Dar like",children:[e.jsx(Tt,{className:`h-4 w-4 ${s.userLiked?"fill-current":""}`}),e.jsx("span",{className:"font-medium",children:s.likes||0})]}),e.jsx("button",{onClick:()=>Pe(s),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar video",children:e.jsx(Gt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>$e(s),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar video",children:e.jsx(vt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>L(s),disabled:de(s),className:`transition-colors duration-200 p-1 rounded ${de(s)?"text-gray-300 cursor-not-allowed":Se&&!Te(s)?"text-red-400 hover:text-red-500 hover:bg-red-50":"text-gray-400 hover:text-purple-500 hover:bg-purple-50"}`,title:de(s)?"Ya en secuencia":Se&&!Te(s)?"A√±adir forzadamente (incompatible)":"A√±adir a secuencia",children:e.jsx(Zt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{rs(s)},className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar video",children:e.jsx(ut,{className:"h-4 w-4"})})]})]})]})]},s.id))})]}),T==="secuencias"&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Secuencias de ",k.toLowerCase()," (",A.length,")"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(qs,{type:"sequence"}),e.jsxs("button",{onClick:Ae,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[e.jsx(xs,{className:"h-4 w-4"}),e.jsx("span",{children:"CREAR SECUENCIA"})]})]})]}),_?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando secuencias..."})]}):e.jsx(Cr,{sequences:A,onDeleteSequence:Qe,onPlaySequence:ft,onEditSequence:jt,onDownloadSequence:as})]})]}),e.jsx(ir,{isOpen:a,onClose:()=>r(!1),onVideoUploaded:Ze,page:"figuras",style:k}),e.jsx(cr,{isOpen:t.isOpen,onClose:g,video:t.video,onVideoUpdated:C,page:"figuras",style:k}),e.jsx(Lt,{isOpen:q.isOpen,onClose:sa,onConfirm:()=>Ye(q.type),title:q.type==="update"?"Actualizar Rutas de Thumbnails":q.type==="cleanup"?"Limpiar Archivos Hu√©rfanos":q.type==="cleanup-tags"?"Limpiar Tags Duplicados":"Eliminar Todos los Videos",message:q.type==="update"?"¬øActualizar las rutas de thumbnails de videos existentes? Esto corregir√° problemas de eliminaci√≥n.":q.type==="cleanup"?"¬øLimpiar archivos hu√©rfanos? Esto eliminar√° archivos que no tienen documento en Firestore.":q.type==="cleanup-tags"?"¬øLimpiar tags duplicados? Esto eliminar√° etiquetas repetidas en todos los videos manteniendo solo una instancia de cada tag.":"¬øEliminar TODOS los videos de Firebase y Storage? Esta acci√≥n es IRREVERSIBLE y eliminar√° todos los datos.",confirmText:q.type==="update"?"Actualizar":q.type==="cleanup"?"Limpiar":q.type==="cleanup-tags"?"Limpiar Tags":"Eliminar Todo",cancelText:"Cancelar"}),e.jsx(Lt,{isOpen:re.isOpen,onClose:Nt,onConfirm:Et,title:"üé¨ Cargar Secuencia",message:`¬øDeseas cargar la secuencia "${(ks=re.sequence)==null?void 0:ks.name}"?

Esto reemplazar√° la secuencia actual en construcci√≥n y perder√°s todos los cambios no guardados.

¬øEst√°s seguro de que quieres continuar?`,confirmText:"S√≠, Cargar",cancelText:"Cancelar",type:"warning"}),e.jsx(Lt,{isOpen:y.isOpen,onClose:at,onConfirm:()=>we(y.video),title:"üóëÔ∏è Eliminar Video",message:`¬øEst√°s seguro de que quieres eliminar el video "${(Ss=y.video)==null?void 0:Ss.title}"?

Esta acci√≥n eliminar√° permanentemente:
‚Ä¢ El archivo de video de Firebase Storage
‚Ä¢ El thumbnail del video
‚Ä¢ Los metadatos de Firestore

Esta acci√≥n NO se puede deshacer.`,confirmText:"S√≠, Eliminar",cancelText:"Cancelar",type:"danger"}),Me&&je&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["üé¨ ",je.title]}),e.jsx("button",{onClick:b,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(ot,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 min-h-0 p-4",children:e.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(fs,{videos:[je],className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})]})}),S&&ve&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["üé¨ Secuencia: ",ve.name]}),e.jsx("button",{onClick:H,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(ot,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 min-h-0 p-4",children:e.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(fs,{videos:ve.videos,className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})]})}),e.jsx(br,{isOpen:Ne.isOpen,onClose:Pt,video:Ne.sequence?{...Ne.sequence,title:Ne.sequence.name,file:null}:null,onDownloadComplete:()=>{v("Secuencia descargada correctamente","success"),Pt()}}),i.map(s=>e.jsx(At,{message:s.message,type:s.type,onClose:()=>ye(s.id)},s.id))]})};export{_r as default};
//# sourceMappingURL=FigurasPage-DaVL5K_y.js.map
