import{a as E,u as S,r as o,j as e,R as x,U as u,d as C,e as U,f as R}from"./index-CqYG162O.js";import{Z as A}from"./zap-B0WMon9V.js";import{P as L,X as _}from"./x-DEuKXdch.js";import{S as k}from"./save-BhqO_Yfk.js";import{M}from"./mail-DIVIbxVG.js";import{C as z}from"./calendar-__UAS-dn.js";import{S as D}from"./settings-C2-9pu_i.js";import{C as T}from"./crown-DnHtXF4K.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=E("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),W=()=>{const{user:l,userProfile:a,updateUserProfile:h,getUserUsername:N,getUserPhoto:p}=S(),[r,d]=o.useState(!1),[g,m]=o.useState(!1),b=o.useRef(null),[t,n]=o.useState({displayName:(a==null?void 0:a.displayName)||"",bio:(a==null?void 0:a.bio)||"",location:(a==null?void 0:a.location)||"",phone:(a==null?void 0:a.phone)||"",photoURL:(a==null?void 0:a.photoURL)||"",username:(a==null?void 0:a.username)||""}),j=async s=>{const i=s.target.files[0];if(i){if(!i.type.startsWith("image/")){alert("Por favor selecciona una imagen válida");return}if(i.size>5*1024*1024){alert("La imagen debe ser menor a 5MB");return}m(!0);try{const c=new FileReader;c.onload=w=>{n({...t,photoURL:w.target.result}),m(!1)},c.readAsDataURL(i)}catch(c){console.error("Error al subir foto:",c),m(!1)}}},y=async()=>{try{const s=await h(t);s.success?d(!1):alert("Error al actualizar perfil: "+s.error)}catch(s){console.error("Error al actualizar perfil:",s),alert("Error al actualizar perfil")}},v=()=>{n({displayName:(a==null?void 0:a.displayName)||"",bio:(a==null?void 0:a.bio)||"",location:(a==null?void 0:a.location)||"",phone:(a==null?void 0:a.phone)||"",photoURL:(a==null?void 0:a.photoURL)||"",username:(a==null?void 0:a.username)||""}),d(!1)},f=async()=>{try{const s=await h({...a,role:x.SUPER_ADMIN,permissions:["MANAGE_USERS","MANAGE_SYSTEM","ACCESS_PREMIUM_CONTENT","UPLOAD_VIDEOS","DELETE_CONTENT"]});s.success?(alert("¡Rol actualizado a Super Administrador! Recargando página..."),setTimeout(()=>{window.location.reload()},1e3)):alert("Error al actualizar rol: "+s.error)}catch(s){console.error("Error al actualizar rol:",s),alert("Error al actualizar rol: "+s.message)}};return l?e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"}),e.jsxs("div",{className:"flex space-x-2",children:[l.email==="david_exile_92@hotmail.com"&&e.jsxs("div",{className:"text-xs text-gray-500 mr-4",children:[e.jsxs("p",{children:["Email: ",l.email]}),e.jsxs("p",{children:["Rol actual: ",(a==null?void 0:a.role)||"No definido"]}),e.jsxs("p",{children:["Es Super Admin: ",(a==null?void 0:a.role)===x.SUPER_ADMIN?"SÍ":"NO"]})]}),l.email==="david_exile_92@hotmail.com"&&(a==null?void 0:a.role)!==x.SUPER_ADMIN&&e.jsxs("button",{onClick:f,className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Actualizar a Super Admin"})]}),r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:y,className:"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Guardar"})]}),e.jsxs("button",{onClick:v,className:"flex items-center space-x-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{children:"Cancelar"})]})]}):e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Editar"})]})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"w-32 h-32 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:p()?e.jsx("img",{src:p(),alt:"Foto de perfil",className:"w-32 h-32 object-cover"}):e.jsx(u,{className:"h-16 w-16 text-white"})}),r&&e.jsxs("div",{className:"absolute bottom-0 right-0",children:[e.jsx("button",{onClick:()=>{var s;return(s=b.current)==null?void 0:s.click()},disabled:g,className:"w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors shadow-lg",children:g?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(I,{className:"h-4 w-4"})}),e.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:j,className:"hidden"})]})]}),r?e.jsx("input",{type:"text",value:t.displayName,onChange:s=>n({...t,displayName:s.target.value}),className:"text-2xl font-semibold text-gray-800 mb-2 bg-transparent border-b border-gray-300 focus:border-blue-500 outline-none text-center",placeholder:"Tu nombre"}):e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:(a==null?void 0:a.displayName)||l.displayName||"Usuario"}),e.jsx("p",{className:"text-gray-600 mb-4",children:l.email}),(a==null?void 0:a.role)&&e.jsx("div",{className:"mb-4",children:e.jsxs("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${U[a.role]||"bg-gray-500 text-white"}`,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),C[a.role]||a.role]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Nombre de usuario"}),r?e.jsx("input",{type:"text",value:t.username,onChange:s=>n({...t,username:s.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none text-center",placeholder:"nombreusuario",pattern:"[a-zA-Z0-9_]+",title:"Solo letras, números y guiones bajos"}):e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("span",{className:"text-gray-700 font-medium",children:N()})})]})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(u,{className:"h-5 w-5 mr-2"}),"Información Básica"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(M,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:l.email})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Miembro desde"}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(z,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:a!=null&&a.createdAt?new Date(a.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"Fecha no disponible"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(D,{className:"h-5 w-5 mr-2"}),"Información Adicional"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ubicación"}),r?e.jsx("input",{type:"text",value:t.location,onChange:s=>n({...t,location:s.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu ubicación"}):e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("span",{className:"text-gray-700",children:(a==null?void 0:a.location)||"No especificada"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono"}),r?e.jsx("input",{type:"tel",value:t.phone,onChange:s=>n({...t,phone:s.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu teléfono"}):e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("span",{className:"text-gray-700",children:(a==null?void 0:a.phone)||"No especificado"})})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biografía"}),r?e.jsx("textarea",{value:t.bio,onChange:s=>n({...t,bio:s.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none min-h-[100px] resize-vertical",placeholder:"Cuéntanos sobre ti..."}):e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg min-h-[100px]",children:e.jsx("span",{className:"text-gray-700",children:(a==null?void 0:a.bio)||"No hay biografía disponible"})})]})]}),(a==null?void 0:a.permissions)&&a.permissions.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(T,{className:"h-5 w-5 mr-2"}),"Mis Permisos"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.permissions.map((s,i)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full font-medium",children:s.replace(/_/g," ")},i))})]})]})})]})})]})}):e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Perfil de Usuario"}),e.jsx("p",{className:"text-gray-600",children:"Debes iniciar sesión para ver tu perfil"})]})})};export{W as default};
//# sourceMappingURL=ProfilePage-COyQ1voN.js.map
