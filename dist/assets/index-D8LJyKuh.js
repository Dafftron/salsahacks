var kS=Object.defineProperty;var U0=t=>{throw TypeError(t)};var CS=(t,e,n)=>e in t?kS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Tn=(t,e,n)=>CS(t,typeof e!="symbol"?e+"":e,n),F0=(t,e,n)=>e.has(t)||U0("Cannot "+n);var De=(t,e,n)=>(F0(t,e,"read from private field"),n?n.call(t):e.get(t)),Ms=(t,e,n)=>e.has(t)?U0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Wa=(t,e,n,r)=>(F0(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);function AS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var fO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Bv={exports:{}},Hd={},qv={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hc=Symbol.for("react.element"),RS=Symbol.for("react.portal"),PS=Symbol.for("react.fragment"),DS=Symbol.for("react.strict_mode"),OS=Symbol.for("react.profiler"),LS=Symbol.for("react.provider"),MS=Symbol.for("react.context"),VS=Symbol.for("react.forward_ref"),US=Symbol.for("react.suspense"),FS=Symbol.for("react.memo"),$S=Symbol.for("react.lazy"),$0=Symbol.iterator;function zS(t){return t===null||typeof t!="object"?null:(t=$0&&t[$0]||t["@@iterator"],typeof t=="function"?t:null)}var Hv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Wv=Object.assign,Gv={};function ba(t,e,n){this.props=t,this.context=e,this.refs=Gv,this.updater=n||Hv}ba.prototype.isReactComponent={};ba.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ba.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Kv(){}Kv.prototype=ba.prototype;function lp(t,e,n){this.props=t,this.context=e,this.refs=Gv,this.updater=n||Hv}var cp=lp.prototype=new Kv;cp.constructor=lp;Wv(cp,ba.prototype);cp.isPureReactComponent=!0;var z0=Array.isArray,Qv=Object.prototype.hasOwnProperty,up={current:null},Xv={key:!0,ref:!0,__self:!0,__source:!0};function Yv(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Qv.call(e,r)&&!Xv.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:hc,type:t,key:i,ref:a,props:s,_owner:up.current}}function BS(t,e){return{$$typeof:hc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function dp(t){return typeof t=="object"&&t!==null&&t.$$typeof===hc}function qS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var B0=/\/+/g;function Hh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qS(""+t.key):e.toString(36)}function Tu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case hc:case RS:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Hh(a,0):r,z0(s)?(n="",t!=null&&(n=t.replace(B0,"$&/")+"/"),Tu(s,e,n,"",function(d){return d})):s!=null&&(dp(s)&&(s=BS(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(B0,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",z0(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Hh(i,l);a+=Tu(i,e,n,u,s)}else if(u=zS(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Hh(i,l++),a+=Tu(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Zc(t,e,n){if(t==null)return t;var r=[],s=0;return Tu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function HS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var On={current:null},Iu={transition:null},WS={ReactCurrentDispatcher:On,ReactCurrentBatchConfig:Iu,ReactCurrentOwner:up};function Jv(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:Zc,forEach:function(t,e,n){Zc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Zc(t,function(){e++}),e},toArray:function(t){return Zc(t,function(e){return e})||[]},only:function(t){if(!dp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=ba;Ve.Fragment=PS;Ve.Profiler=OS;Ve.PureComponent=lp;Ve.StrictMode=DS;Ve.Suspense=US;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WS;Ve.act=Jv;Ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Wv({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=up.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Qv.call(e,u)&&!Xv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:hc,type:t.type,key:s,ref:i,props:r,_owner:a}};Ve.createContext=function(t){return t={$$typeof:MS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:LS,_context:t},t.Consumer=t};Ve.createElement=Yv;Ve.createFactory=function(t){var e=Yv.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:VS,render:t}};Ve.isValidElement=dp;Ve.lazy=function(t){return{$$typeof:$S,_payload:{_status:-1,_result:t},_init:HS}};Ve.memo=function(t,e){return{$$typeof:FS,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=Iu.transition;Iu.transition={};try{t()}finally{Iu.transition=e}};Ve.unstable_act=Jv;Ve.useCallback=function(t,e){return On.current.useCallback(t,e)};Ve.useContext=function(t){return On.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return On.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return On.current.useEffect(t,e)};Ve.useId=function(){return On.current.useId()};Ve.useImperativeHandle=function(t,e,n){return On.current.useImperativeHandle(t,e,n)};Ve.useInsertionEffect=function(t,e){return On.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return On.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return On.current.useMemo(t,e)};Ve.useReducer=function(t,e,n){return On.current.useReducer(t,e,n)};Ve.useRef=function(t){return On.current.useRef(t)};Ve.useState=function(t){return On.current.useState(t)};Ve.useSyncExternalStore=function(t,e,n){return On.current.useSyncExternalStore(t,e,n)};Ve.useTransition=function(){return On.current.useTransition()};Ve.version="18.3.1";qv.exports=Ve;var S=qv.exports;const hp=jS(S),GS=AS({__proto__:null,default:hp},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KS=S,QS=Symbol.for("react.element"),XS=Symbol.for("react.fragment"),YS=Object.prototype.hasOwnProperty,JS=KS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZS={key:!0,ref:!0,__self:!0,__source:!0};function Zv(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)YS.call(e,r)&&!ZS.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:QS,type:t,key:i,ref:a,props:s,_owner:JS.current}}Hd.Fragment=XS;Hd.jsx=Zv;Hd.jsxs=Zv;Bv.exports=Hd;var o=Bv.exports,Ku={},ew={exports:{}},er={},tw={exports:{}},nw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,B){var ae=G.length;G.push(B);e:for(;0<ae;){var we=ae-1>>>1,q=G[we];if(0<s(q,B))G[we]=B,G[ae]=q,ae=we;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var B=G[0],ae=G.pop();if(ae!==B){G[0]=ae;e:for(var we=0,q=G.length,Y=q>>>1;we<Y;){var ie=2*(we+1)-1,_e=G[ie],ve=ie+1,Se=G[ve];if(0>s(_e,ae))ve<q&&0>s(Se,_e)?(G[we]=Se,G[ve]=ae,we=ve):(G[we]=_e,G[ie]=ae,we=ie);else if(ve<q&&0>s(Se,ae))G[we]=Se,G[ve]=ae,we=ve;else break e}}return B}function s(G,B){var ae=G.sortIndex-B.sortIndex;return ae!==0?ae:G.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],d=[],f=1,m=null,g=3,x=!1,b=!1,R=!1,T=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(G){for(var B=n(d);B!==null;){if(B.callback===null)r(d);else if(B.startTime<=G)r(d),B.sortIndex=B.expirationTime,e(u,B);else break;B=n(d)}}function A(G){if(R=!1,y(G),!b)if(n(u)!==null)b=!0,me(P);else{var B=n(d);B!==null&&ue(A,B.startTime-G)}}function P(G,B){b=!1,R&&(R=!1,v(w),w=-1),x=!0;var ae=g;try{for(y(B),m=n(u);m!==null&&(!(m.expirationTime>B)||G&&!D());){var we=m.callback;if(typeof we=="function"){m.callback=null,g=m.priorityLevel;var q=we(m.expirationTime<=B);B=t.unstable_now(),typeof q=="function"?m.callback=q:m===n(u)&&r(u),y(B)}else r(u);m=n(u)}if(m!==null)var Y=!0;else{var ie=n(d);ie!==null&&ue(A,ie.startTime-B),Y=!1}return Y}finally{m=null,g=ae,x=!1}}var O=!1,N=null,w=-1,I=5,k=-1;function D(){return!(t.unstable_now()-k<I)}function L(){if(N!==null){var G=t.unstable_now();k=G;var B=!0;try{B=N(!0,G)}finally{B?j():(O=!1,N=null)}}else O=!1}var j;if(typeof _=="function")j=function(){_(L)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,H=ce.port2;ce.port1.onmessage=L,j=function(){H.postMessage(null)}}else j=function(){T(L,0)};function me(G){N=G,O||(O=!0,j())}function ue(G,B){w=T(function(){G(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){b||x||(b=!0,me(P))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(G){switch(g){case 1:case 2:case 3:var B=3;break;default:B=g}var ae=g;g=B;try{return G()}finally{g=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,B){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ae=g;g=G;try{return B()}finally{g=ae}},t.unstable_scheduleCallback=function(G,B,ae){var we=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?we+ae:we):ae=we,G){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ae+q,G={id:f++,callback:B,priorityLevel:G,startTime:ae,expirationTime:q,sortIndex:-1},ae>we?(G.sortIndex=ae,e(d,G),n(u)===null&&G===n(d)&&(R?(v(w),w=-1):R=!0,ue(A,ae-we))):(G.sortIndex=q,e(u,G),b||x||(b=!0,me(P))),G},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(G){var B=g;return function(){var ae=g;g=B;try{return G.apply(this,arguments)}finally{g=ae}}}})(nw);tw.exports=nw;var e2=tw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t2=S,Zn=e2;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rw=new Set,Al={};function so(t,e){na(t,e),na(t+"Capture",e)}function na(t,e){for(Al[t]=e,t=0;t<e.length;t++)rw.add(e[t])}var xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Of=Object.prototype.hasOwnProperty,n2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,q0={},H0={};function r2(t){return Of.call(H0,t)?!0:Of.call(q0,t)?!1:n2.test(t)?H0[t]=!0:(q0[t]=!0,!1)}function s2(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function i2(t,e,n,r){if(e===null||typeof e>"u"||s2(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ln(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sn[t]=new Ln(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sn[e]=new Ln(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sn[t]=new Ln(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sn[t]=new Ln(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sn[t]=new Ln(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sn[t]=new Ln(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sn[t]=new Ln(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sn[t]=new Ln(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sn[t]=new Ln(t,5,!1,t.toLowerCase(),null,!1,!1)});var fp=/[\-:]([a-z])/g;function mp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fp,mp);sn[e]=new Ln(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fp,mp);sn[e]=new Ln(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fp,mp);sn[e]=new Ln(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sn[t]=new Ln(t,1,!1,t.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sn[t]=new Ln(t,1,!1,t.toLowerCase(),null,!0,!0)});function pp(t,e,n,r){var s=sn.hasOwnProperty(e)?sn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(i2(e,n,s,r)&&(n=null),r||s===null?r2(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Cs=t2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,eu=Symbol.for("react.element"),Ro=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),gp=Symbol.for("react.strict_mode"),Lf=Symbol.for("react.profiler"),sw=Symbol.for("react.provider"),iw=Symbol.for("react.context"),yp=Symbol.for("react.forward_ref"),Mf=Symbol.for("react.suspense"),Vf=Symbol.for("react.suspense_list"),xp=Symbol.for("react.memo"),Fs=Symbol.for("react.lazy"),ow=Symbol.for("react.offscreen"),W0=Symbol.iterator;function Ga(t){return t===null||typeof t!="object"?null:(t=W0&&t[W0]||t["@@iterator"],typeof t=="function"?t:null)}var Et=Object.assign,Wh;function sl(t){if(Wh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wh=e&&e[1]||""}return`
`+Wh+t}var Gh=!1;function Kh(t,e){if(!t||Gh)return"";Gh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{Gh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?sl(t):""}function o2(t){switch(t.tag){case 5:return sl(t.type);case 16:return sl("Lazy");case 13:return sl("Suspense");case 19:return sl("SuspenseList");case 0:case 2:case 15:return t=Kh(t.type,!1),t;case 11:return t=Kh(t.type.render,!1),t;case 1:return t=Kh(t.type,!0),t;default:return""}}function Uf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case Ro:return"Portal";case Lf:return"Profiler";case gp:return"StrictMode";case Mf:return"Suspense";case Vf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case iw:return(t.displayName||"Context")+".Consumer";case sw:return(t._context.displayName||"Context")+".Provider";case yp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case xp:return e=t.displayName||null,e!==null?e:Uf(t.type)||"Memo";case Fs:e=t._payload,t=t._init;try{return Uf(t(e))}catch{}}return null}function a2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Uf(e);case 8:return e===gp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function di(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function aw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function l2(t){var e=aw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tu(t){t._valueTracker||(t._valueTracker=l2(t))}function lw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=aw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ff(t,e){var n=e.checked;return Et({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function G0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=di(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cw(t,e){e=e.checked,e!=null&&pp(t,"checked",e,!1)}function $f(t,e){cw(t,e);var n=di(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zf(t,e.type,n):e.hasOwnProperty("defaultValue")&&zf(t,e.type,di(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function K0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function zf(t,e,n){(e!=="number"||Qu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var il=Array.isArray;function Ho(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+di(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Bf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return Et({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Q0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(J(92));if(il(n)){if(1<n.length)throw Error(J(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:di(n)}}function uw(t,e){var n=di(e.value),r=di(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function X0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function dw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?dw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nu,hw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(nu=nu||document.createElement("div"),nu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function jl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ml={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},c2=["Webkit","ms","Moz","O"];Object.keys(ml).forEach(function(t){c2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ml[e]=ml[t]})});function fw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ml.hasOwnProperty(t)&&ml[t]?(""+e).trim():e+"px"}function mw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=fw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var u2=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hf(t,e){if(e){if(u2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function Wf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gf=null;function vp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kf=null,Wo=null,Go=null;function Y0(t){if(t=pc(t)){if(typeof Kf!="function")throw Error(J(280));var e=t.stateNode;e&&(e=Xd(e),Kf(t.stateNode,t.type,e))}}function pw(t){Wo?Go?Go.push(t):Go=[t]:Wo=t}function gw(){if(Wo){var t=Wo,e=Go;if(Go=Wo=null,Y0(t),e)for(t=0;t<e.length;t++)Y0(e[t])}}function yw(t,e){return t(e)}function xw(){}var Qh=!1;function vw(t,e,n){if(Qh)return t(e,n);Qh=!0;try{return yw(t,e,n)}finally{Qh=!1,(Wo!==null||Go!==null)&&(xw(),gw())}}function Rl(t,e){var n=t.stateNode;if(n===null)return null;var r=Xd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(J(231,e,typeof n));return n}var Qf=!1;if(xs)try{var Ka={};Object.defineProperty(Ka,"passive",{get:function(){Qf=!0}}),window.addEventListener("test",Ka,Ka),window.removeEventListener("test",Ka,Ka)}catch{Qf=!1}function d2(t,e,n,r,s,i,a,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var pl=!1,Xu=null,Yu=!1,Xf=null,h2={onError:function(t){pl=!0,Xu=t}};function f2(t,e,n,r,s,i,a,l,u){pl=!1,Xu=null,d2.apply(h2,arguments)}function m2(t,e,n,r,s,i,a,l,u){if(f2.apply(this,arguments),pl){if(pl){var d=Xu;pl=!1,Xu=null}else throw Error(J(198));Yu||(Yu=!0,Xf=d)}}function io(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ww(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function J0(t){if(io(t)!==t)throw Error(J(188))}function p2(t){var e=t.alternate;if(!e){if(e=io(t),e===null)throw Error(J(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return J0(s),t;if(i===r)return J0(s),e;i=i.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?t:e}function _w(t){return t=p2(t),t!==null?bw(t):null}function bw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bw(t);if(e!==null)return e;t=t.sibling}return null}var Ew=Zn.unstable_scheduleCallback,Z0=Zn.unstable_cancelCallback,g2=Zn.unstable_shouldYield,y2=Zn.unstable_requestPaint,jt=Zn.unstable_now,x2=Zn.unstable_getCurrentPriorityLevel,wp=Zn.unstable_ImmediatePriority,Sw=Zn.unstable_UserBlockingPriority,Ju=Zn.unstable_NormalPriority,v2=Zn.unstable_LowPriority,Nw=Zn.unstable_IdlePriority,Wd=null,$r=null;function w2(t){if($r&&typeof $r.onCommitFiberRoot=="function")try{$r.onCommitFiberRoot(Wd,t,void 0,(t.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:E2,_2=Math.log,b2=Math.LN2;function E2(t){return t>>>=0,t===0?32:31-(_2(t)/b2|0)|0}var ru=64,su=4194304;function ol(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=ol(l):(i&=a,i!==0&&(r=ol(i)))}else a=n&~s,a!==0?r=ol(a):i!==0&&(r=ol(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Nr(e),s=1<<n,r|=t[n],e&=~s;return r}function S2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function N2(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Nr(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=S2(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Yf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Tw(){var t=ru;return ru<<=1,!(ru&4194240)&&(ru=64),t}function Xh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Nr(e),t[e]=n}function T2(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Nr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function _p(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Nr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var nt=0;function Iw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kw,bp,Cw,Aw,jw,Jf=!1,iu=[],Js=null,Zs=null,ei=null,Pl=new Map,Dl=new Map,zs=[],I2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ey(t,e){switch(t){case"focusin":case"focusout":Js=null;break;case"dragenter":case"dragleave":Zs=null;break;case"mouseover":case"mouseout":ei=null;break;case"pointerover":case"pointerout":Pl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dl.delete(e.pointerId)}}function Qa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=pc(e),e!==null&&bp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function k2(t,e,n,r,s){switch(e){case"focusin":return Js=Qa(Js,t,e,n,r,s),!0;case"dragenter":return Zs=Qa(Zs,t,e,n,r,s),!0;case"mouseover":return ei=Qa(ei,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Pl.set(i,Qa(Pl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Dl.set(i,Qa(Dl.get(i)||null,t,e,n,r,s)),!0}return!1}function Rw(t){var e=Ri(t.target);if(e!==null){var n=io(e);if(n!==null){if(e=n.tag,e===13){if(e=ww(n),e!==null){t.blockedOn=e,jw(t.priority,function(){Cw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ku(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Zf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Gf=r,n.target.dispatchEvent(r),Gf=null}else return e=pc(n),e!==null&&bp(e),t.blockedOn=n,!1;e.shift()}return!0}function ty(t,e,n){ku(t)&&n.delete(e)}function C2(){Jf=!1,Js!==null&&ku(Js)&&(Js=null),Zs!==null&&ku(Zs)&&(Zs=null),ei!==null&&ku(ei)&&(ei=null),Pl.forEach(ty),Dl.forEach(ty)}function Xa(t,e){t.blockedOn===e&&(t.blockedOn=null,Jf||(Jf=!0,Zn.unstable_scheduleCallback(Zn.unstable_NormalPriority,C2)))}function Ol(t){function e(s){return Xa(s,t)}if(0<iu.length){Xa(iu[0],t);for(var n=1;n<iu.length;n++){var r=iu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Js!==null&&Xa(Js,t),Zs!==null&&Xa(Zs,t),ei!==null&&Xa(ei,t),Pl.forEach(e),Dl.forEach(e),n=0;n<zs.length;n++)r=zs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<zs.length&&(n=zs[0],n.blockedOn===null);)Rw(n),n.blockedOn===null&&zs.shift()}var Ko=Cs.ReactCurrentBatchConfig,ed=!0;function A2(t,e,n,r){var s=nt,i=Ko.transition;Ko.transition=null;try{nt=1,Ep(t,e,n,r)}finally{nt=s,Ko.transition=i}}function j2(t,e,n,r){var s=nt,i=Ko.transition;Ko.transition=null;try{nt=4,Ep(t,e,n,r)}finally{nt=s,Ko.transition=i}}function Ep(t,e,n,r){if(ed){var s=Zf(t,e,n,r);if(s===null)af(t,e,r,td,n),ey(t,r);else if(k2(s,t,e,n,r))r.stopPropagation();else if(ey(t,r),e&4&&-1<I2.indexOf(t)){for(;s!==null;){var i=pc(s);if(i!==null&&kw(i),i=Zf(t,e,n,r),i===null&&af(t,e,r,td,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else af(t,e,r,null,n)}}var td=null;function Zf(t,e,n,r){if(td=null,t=vp(r),t=Ri(t),t!==null)if(e=io(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ww(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return td=t,null}function Pw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(x2()){case wp:return 1;case Sw:return 4;case Ju:case v2:return 16;case Nw:return 536870912;default:return 16}default:return 16}}var Ks=null,Sp=null,Cu=null;function Dw(){if(Cu)return Cu;var t,e=Sp,n=e.length,r,s="value"in Ks?Ks.value:Ks.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Cu=s.slice(t,1<r?1-r:void 0)}function Au(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ou(){return!0}function ny(){return!1}function tr(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ou:ny,this.isPropagationStopped=ny,this}return Et(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ou)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ou)},persist:function(){},isPersistent:ou}),e}var Ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Np=tr(Ea),mc=Et({},Ea,{view:0,detail:0}),R2=tr(mc),Yh,Jh,Ya,Gd=Et({},mc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ya&&(Ya&&t.type==="mousemove"?(Yh=t.screenX-Ya.screenX,Jh=t.screenY-Ya.screenY):Jh=Yh=0,Ya=t),Yh)},movementY:function(t){return"movementY"in t?t.movementY:Jh}}),ry=tr(Gd),P2=Et({},Gd,{dataTransfer:0}),D2=tr(P2),O2=Et({},mc,{relatedTarget:0}),Zh=tr(O2),L2=Et({},Ea,{animationName:0,elapsedTime:0,pseudoElement:0}),M2=tr(L2),V2=Et({},Ea,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),U2=tr(V2),F2=Et({},Ea,{data:0}),sy=tr(F2),$2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=B2[t])?!!e[t]:!1}function Tp(){return q2}var H2=Et({},mc,{key:function(t){if(t.key){var e=$2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Au(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?z2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tp,charCode:function(t){return t.type==="keypress"?Au(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Au(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),W2=tr(H2),G2=Et({},Gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),iy=tr(G2),K2=Et({},mc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tp}),Q2=tr(K2),X2=Et({},Ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y2=tr(X2),J2=Et({},Gd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Z2=tr(J2),eN=[9,13,27,32],Ip=xs&&"CompositionEvent"in window,gl=null;xs&&"documentMode"in document&&(gl=document.documentMode);var tN=xs&&"TextEvent"in window&&!gl,Ow=xs&&(!Ip||gl&&8<gl&&11>=gl),oy=" ",ay=!1;function Lw(t,e){switch(t){case"keyup":return eN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Do=!1;function nN(t,e){switch(t){case"compositionend":return Mw(e);case"keypress":return e.which!==32?null:(ay=!0,oy);case"textInput":return t=e.data,t===oy&&ay?null:t;default:return null}}function rN(t,e){if(Do)return t==="compositionend"||!Ip&&Lw(t,e)?(t=Dw(),Cu=Sp=Ks=null,Do=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ow&&e.locale!=="ko"?null:e.data;default:return null}}var sN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ly(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!sN[t.type]:e==="textarea"}function Vw(t,e,n,r){pw(r),e=nd(e,"onChange"),0<e.length&&(n=new Np("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var yl=null,Ll=null;function iN(t){Qw(t,0)}function Kd(t){var e=Mo(t);if(lw(e))return t}function oN(t,e){if(t==="change")return e}var Uw=!1;if(xs){var ef;if(xs){var tf="oninput"in document;if(!tf){var cy=document.createElement("div");cy.setAttribute("oninput","return;"),tf=typeof cy.oninput=="function"}ef=tf}else ef=!1;Uw=ef&&(!document.documentMode||9<document.documentMode)}function uy(){yl&&(yl.detachEvent("onpropertychange",Fw),Ll=yl=null)}function Fw(t){if(t.propertyName==="value"&&Kd(Ll)){var e=[];Vw(e,Ll,t,vp(t)),vw(iN,e)}}function aN(t,e,n){t==="focusin"?(uy(),yl=e,Ll=n,yl.attachEvent("onpropertychange",Fw)):t==="focusout"&&uy()}function lN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Kd(Ll)}function cN(t,e){if(t==="click")return Kd(e)}function uN(t,e){if(t==="input"||t==="change")return Kd(e)}function dN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ar=typeof Object.is=="function"?Object.is:dN;function Ml(t,e){if(Ar(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Of.call(e,s)||!Ar(t[s],e[s]))return!1}return!0}function dy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hy(t,e){var n=dy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dy(n)}}function $w(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$w(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function zw(){for(var t=window,e=Qu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qu(t.document)}return e}function kp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function hN(t){var e=zw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$w(n.ownerDocument.documentElement,n)){if(r!==null&&kp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=hy(n,i);var a=hy(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fN=xs&&"documentMode"in document&&11>=document.documentMode,Oo=null,em=null,xl=null,tm=!1;function fy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;tm||Oo==null||Oo!==Qu(r)||(r=Oo,"selectionStart"in r&&kp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xl&&Ml(xl,r)||(xl=r,r=nd(em,"onSelect"),0<r.length&&(e=new Np("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Oo)))}function au(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Lo={animationend:au("Animation","AnimationEnd"),animationiteration:au("Animation","AnimationIteration"),animationstart:au("Animation","AnimationStart"),transitionend:au("Transition","TransitionEnd")},nf={},Bw={};xs&&(Bw=document.createElement("div").style,"AnimationEvent"in window||(delete Lo.animationend.animation,delete Lo.animationiteration.animation,delete Lo.animationstart.animation),"TransitionEvent"in window||delete Lo.transitionend.transition);function Qd(t){if(nf[t])return nf[t];if(!Lo[t])return t;var e=Lo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Bw)return nf[t]=e[n];return t}var qw=Qd("animationend"),Hw=Qd("animationiteration"),Ww=Qd("animationstart"),Gw=Qd("transitionend"),Kw=new Map,my="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xi(t,e){Kw.set(t,e),so(e,[t])}for(var rf=0;rf<my.length;rf++){var sf=my[rf],mN=sf.toLowerCase(),pN=sf[0].toUpperCase()+sf.slice(1);xi(mN,"on"+pN)}xi(qw,"onAnimationEnd");xi(Hw,"onAnimationIteration");xi(Ww,"onAnimationStart");xi("dblclick","onDoubleClick");xi("focusin","onFocus");xi("focusout","onBlur");xi(Gw,"onTransitionEnd");na("onMouseEnter",["mouseout","mouseover"]);na("onMouseLeave",["mouseout","mouseover"]);na("onPointerEnter",["pointerout","pointerover"]);na("onPointerLeave",["pointerout","pointerover"]);so("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));so("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));so("onBeforeInput",["compositionend","keypress","textInput","paste"]);so("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));so("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));so("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gN=new Set("cancel close invalid load scroll toggle".split(" ").concat(al));function py(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,m2(r,e,void 0,t),t.currentTarget=null}function Qw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;py(s,l,d),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;py(s,l,d),i=u}}}if(Yu)throw t=Xf,Yu=!1,Xf=null,t}function ft(t,e){var n=e[om];n===void 0&&(n=e[om]=new Set);var r=t+"__bubble";n.has(r)||(Xw(e,t,2,!1),n.add(r))}function of(t,e,n){var r=0;e&&(r|=4),Xw(n,t,r,e)}var lu="_reactListening"+Math.random().toString(36).slice(2);function Vl(t){if(!t[lu]){t[lu]=!0,rw.forEach(function(n){n!=="selectionchange"&&(gN.has(n)||of(n,!1,t),of(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[lu]||(e[lu]=!0,of("selectionchange",!1,e))}}function Xw(t,e,n,r){switch(Pw(e)){case 1:var s=A2;break;case 4:s=j2;break;default:s=Ep}n=s.bind(null,e,n,t),s=void 0,!Qf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function af(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Ri(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}vw(function(){var d=i,f=vp(n),m=[];e:{var g=Kw.get(t);if(g!==void 0){var x=Np,b=t;switch(t){case"keypress":if(Au(n)===0)break e;case"keydown":case"keyup":x=W2;break;case"focusin":b="focus",x=Zh;break;case"focusout":b="blur",x=Zh;break;case"beforeblur":case"afterblur":x=Zh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=ry;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=D2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Q2;break;case qw:case Hw:case Ww:x=M2;break;case Gw:x=Y2;break;case"scroll":x=R2;break;case"wheel":x=Z2;break;case"copy":case"cut":case"paste":x=U2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=iy}var R=(e&4)!==0,T=!R&&t==="scroll",v=R?g!==null?g+"Capture":null:g;R=[];for(var _=d,y;_!==null;){y=_;var A=y.stateNode;if(y.tag===5&&A!==null&&(y=A,v!==null&&(A=Rl(_,v),A!=null&&R.push(Ul(_,A,y)))),T)break;_=_.return}0<R.length&&(g=new x(g,b,null,n,f),m.push({event:g,listeners:R}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&n!==Gf&&(b=n.relatedTarget||n.fromElement)&&(Ri(b)||b[vs]))break e;if((x||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,x?(b=n.relatedTarget||n.toElement,x=d,b=b?Ri(b):null,b!==null&&(T=io(b),b!==T||b.tag!==5&&b.tag!==6)&&(b=null)):(x=null,b=d),x!==b)){if(R=ry,A="onMouseLeave",v="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(R=iy,A="onPointerLeave",v="onPointerEnter",_="pointer"),T=x==null?g:Mo(x),y=b==null?g:Mo(b),g=new R(A,_+"leave",x,n,f),g.target=T,g.relatedTarget=y,A=null,Ri(f)===d&&(R=new R(v,_+"enter",b,n,f),R.target=y,R.relatedTarget=T,A=R),T=A,x&&b)t:{for(R=x,v=b,_=0,y=R;y;y=To(y))_++;for(y=0,A=v;A;A=To(A))y++;for(;0<_-y;)R=To(R),_--;for(;0<y-_;)v=To(v),y--;for(;_--;){if(R===v||v!==null&&R===v.alternate)break t;R=To(R),v=To(v)}R=null}else R=null;x!==null&&gy(m,g,x,R,!1),b!==null&&T!==null&&gy(m,T,b,R,!0)}}e:{if(g=d?Mo(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var P=oN;else if(ly(g))if(Uw)P=uN;else{P=lN;var O=aN}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(P=cN);if(P&&(P=P(t,d))){Vw(m,P,n,f);break e}O&&O(t,g,d),t==="focusout"&&(O=g._wrapperState)&&O.controlled&&g.type==="number"&&zf(g,"number",g.value)}switch(O=d?Mo(d):window,t){case"focusin":(ly(O)||O.contentEditable==="true")&&(Oo=O,em=d,xl=null);break;case"focusout":xl=em=Oo=null;break;case"mousedown":tm=!0;break;case"contextmenu":case"mouseup":case"dragend":tm=!1,fy(m,n,f);break;case"selectionchange":if(fN)break;case"keydown":case"keyup":fy(m,n,f)}var N;if(Ip)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Do?Lw(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(Ow&&n.locale!=="ko"&&(Do||w!=="onCompositionStart"?w==="onCompositionEnd"&&Do&&(N=Dw()):(Ks=f,Sp="value"in Ks?Ks.value:Ks.textContent,Do=!0)),O=nd(d,w),0<O.length&&(w=new sy(w,t,null,n,f),m.push({event:w,listeners:O}),N?w.data=N:(N=Mw(n),N!==null&&(w.data=N)))),(N=tN?nN(t,n):rN(t,n))&&(d=nd(d,"onBeforeInput"),0<d.length&&(f=new sy("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:d}),f.data=N))}Qw(m,e)})}function Ul(t,e,n){return{instance:t,listener:e,currentTarget:n}}function nd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Rl(t,n),i!=null&&r.unshift(Ul(t,i,s)),i=Rl(t,e),i!=null&&r.push(Ul(t,i,s))),t=t.return}return r}function To(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gy(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Rl(n,i),u!=null&&a.unshift(Ul(n,u,l))):s||(u=Rl(n,i),u!=null&&a.push(Ul(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var yN=/\r\n?/g,xN=/\u0000|\uFFFD/g;function yy(t){return(typeof t=="string"?t:""+t).replace(yN,`
`).replace(xN,"")}function cu(t,e,n){if(e=yy(e),yy(t)!==e&&n)throw Error(J(425))}function rd(){}var nm=null,rm=null;function sm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var im=typeof setTimeout=="function"?setTimeout:void 0,vN=typeof clearTimeout=="function"?clearTimeout:void 0,xy=typeof Promise=="function"?Promise:void 0,wN=typeof queueMicrotask=="function"?queueMicrotask:typeof xy<"u"?function(t){return xy.resolve(null).then(t).catch(_N)}:im;function _N(t){setTimeout(function(){throw t})}function lf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ol(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ol(e)}function ti(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function vy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),Vr="__reactFiber$"+Sa,Fl="__reactProps$"+Sa,vs="__reactContainer$"+Sa,om="__reactEvents$"+Sa,bN="__reactListeners$"+Sa,EN="__reactHandles$"+Sa;function Ri(t){var e=t[Vr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[vs]||n[Vr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=vy(t);t!==null;){if(n=t[Vr])return n;t=vy(t)}return e}t=n,n=t.parentNode}return null}function pc(t){return t=t[Vr]||t[vs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Mo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function Xd(t){return t[Fl]||null}var am=[],Vo=-1;function vi(t){return{current:t}}function pt(t){0>Vo||(t.current=am[Vo],am[Vo]=null,Vo--)}function ut(t,e){Vo++,am[Vo]=t.current,t.current=e}var hi={},wn=vi(hi),Fn=vi(!1),Bi=hi;function ra(t,e){var n=t.type.contextTypes;if(!n)return hi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function $n(t){return t=t.childContextTypes,t!=null}function sd(){pt(Fn),pt(wn)}function wy(t,e,n){if(wn.current!==hi)throw Error(J(168));ut(wn,e),ut(Fn,n)}function Yw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(J(108,a2(t)||"Unknown",s));return Et({},n,r)}function id(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||hi,Bi=wn.current,ut(wn,t),ut(Fn,Fn.current),!0}function _y(t,e,n){var r=t.stateNode;if(!r)throw Error(J(169));n?(t=Yw(t,e,Bi),r.__reactInternalMemoizedMergedChildContext=t,pt(Fn),pt(wn),ut(wn,t)):pt(Fn),ut(Fn,n)}var ss=null,Yd=!1,cf=!1;function Jw(t){ss===null?ss=[t]:ss.push(t)}function SN(t){Yd=!0,Jw(t)}function wi(){if(!cf&&ss!==null){cf=!0;var t=0,e=nt;try{var n=ss;for(nt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ss=null,Yd=!1}catch(s){throw ss!==null&&(ss=ss.slice(t+1)),Ew(wp,wi),s}finally{nt=e,cf=!1}}return null}var Uo=[],Fo=0,od=null,ad=0,ar=[],lr=0,qi=null,ls=1,cs="";function Ci(t,e){Uo[Fo++]=ad,Uo[Fo++]=od,od=t,ad=e}function Zw(t,e,n){ar[lr++]=ls,ar[lr++]=cs,ar[lr++]=qi,qi=t;var r=ls;t=cs;var s=32-Nr(r)-1;r&=~(1<<s),n+=1;var i=32-Nr(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ls=1<<32-Nr(e)+s|n<<s|r,cs=i+t}else ls=1<<i|n<<s|r,cs=t}function Cp(t){t.return!==null&&(Ci(t,1),Zw(t,1,0))}function Ap(t){for(;t===od;)od=Uo[--Fo],Uo[Fo]=null,ad=Uo[--Fo],Uo[Fo]=null;for(;t===qi;)qi=ar[--lr],ar[lr]=null,cs=ar[--lr],ar[lr]=null,ls=ar[--lr],ar[lr]=null}var Jn=null,Qn=null,yt=!1,br=null;function e_(t,e){var n=ur(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function by(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jn=t,Qn=ti(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jn=t,Qn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qi!==null?{id:ls,overflow:cs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ur(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Jn=t,Qn=null,!0):!1;default:return!1}}function lm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cm(t){if(yt){var e=Qn;if(e){var n=e;if(!by(t,e)){if(lm(t))throw Error(J(418));e=ti(n.nextSibling);var r=Jn;e&&by(t,e)?e_(r,n):(t.flags=t.flags&-4097|2,yt=!1,Jn=t)}}else{if(lm(t))throw Error(J(418));t.flags=t.flags&-4097|2,yt=!1,Jn=t}}}function Ey(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jn=t}function uu(t){if(t!==Jn)return!1;if(!yt)return Ey(t),yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sm(t.type,t.memoizedProps)),e&&(e=Qn)){if(lm(t))throw t_(),Error(J(418));for(;e;)e_(t,e),e=ti(e.nextSibling)}if(Ey(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Qn=ti(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Qn=null}}else Qn=Jn?ti(t.stateNode.nextSibling):null;return!0}function t_(){for(var t=Qn;t;)t=ti(t.nextSibling)}function sa(){Qn=Jn=null,yt=!1}function jp(t){br===null?br=[t]:br.push(t)}var NN=Cs.ReactCurrentBatchConfig;function Ja(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,t))}return t}function du(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Sy(t){var e=t._init;return e(t._payload)}function n_(t){function e(v,_){if(t){var y=v.deletions;y===null?(v.deletions=[_],v.flags|=16):y.push(_)}}function n(v,_){if(!t)return null;for(;_!==null;)e(v,_),_=_.sibling;return null}function r(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function s(v,_){return v=ii(v,_),v.index=0,v.sibling=null,v}function i(v,_,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<_?(v.flags|=2,_):y):(v.flags|=2,_)):(v.flags|=1048576,_)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,_,y,A){return _===null||_.tag!==6?(_=gf(y,v.mode,A),_.return=v,_):(_=s(_,y),_.return=v,_)}function u(v,_,y,A){var P=y.type;return P===Po?f(v,_,y.props.children,A,y.key):_!==null&&(_.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Fs&&Sy(P)===_.type)?(A=s(_,y.props),A.ref=Ja(v,_,y),A.return=v,A):(A=Mu(y.type,y.key,y.props,null,v.mode,A),A.ref=Ja(v,_,y),A.return=v,A)}function d(v,_,y,A){return _===null||_.tag!==4||_.stateNode.containerInfo!==y.containerInfo||_.stateNode.implementation!==y.implementation?(_=yf(y,v.mode,A),_.return=v,_):(_=s(_,y.children||[]),_.return=v,_)}function f(v,_,y,A,P){return _===null||_.tag!==7?(_=Fi(y,v.mode,A,P),_.return=v,_):(_=s(_,y),_.return=v,_)}function m(v,_,y){if(typeof _=="string"&&_!==""||typeof _=="number")return _=gf(""+_,v.mode,y),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case eu:return y=Mu(_.type,_.key,_.props,null,v.mode,y),y.ref=Ja(v,null,_),y.return=v,y;case Ro:return _=yf(_,v.mode,y),_.return=v,_;case Fs:var A=_._init;return m(v,A(_._payload),y)}if(il(_)||Ga(_))return _=Fi(_,v.mode,y,null),_.return=v,_;du(v,_)}return null}function g(v,_,y,A){var P=_!==null?_.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return P!==null?null:l(v,_,""+y,A);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case eu:return y.key===P?u(v,_,y,A):null;case Ro:return y.key===P?d(v,_,y,A):null;case Fs:return P=y._init,g(v,_,P(y._payload),A)}if(il(y)||Ga(y))return P!==null?null:f(v,_,y,A,null);du(v,y)}return null}function x(v,_,y,A,P){if(typeof A=="string"&&A!==""||typeof A=="number")return v=v.get(y)||null,l(_,v,""+A,P);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case eu:return v=v.get(A.key===null?y:A.key)||null,u(_,v,A,P);case Ro:return v=v.get(A.key===null?y:A.key)||null,d(_,v,A,P);case Fs:var O=A._init;return x(v,_,y,O(A._payload),P)}if(il(A)||Ga(A))return v=v.get(y)||null,f(_,v,A,P,null);du(_,A)}return null}function b(v,_,y,A){for(var P=null,O=null,N=_,w=_=0,I=null;N!==null&&w<y.length;w++){N.index>w?(I=N,N=null):I=N.sibling;var k=g(v,N,y[w],A);if(k===null){N===null&&(N=I);break}t&&N&&k.alternate===null&&e(v,N),_=i(k,_,w),O===null?P=k:O.sibling=k,O=k,N=I}if(w===y.length)return n(v,N),yt&&Ci(v,w),P;if(N===null){for(;w<y.length;w++)N=m(v,y[w],A),N!==null&&(_=i(N,_,w),O===null?P=N:O.sibling=N,O=N);return yt&&Ci(v,w),P}for(N=r(v,N);w<y.length;w++)I=x(N,v,w,y[w],A),I!==null&&(t&&I.alternate!==null&&N.delete(I.key===null?w:I.key),_=i(I,_,w),O===null?P=I:O.sibling=I,O=I);return t&&N.forEach(function(D){return e(v,D)}),yt&&Ci(v,w),P}function R(v,_,y,A){var P=Ga(y);if(typeof P!="function")throw Error(J(150));if(y=P.call(y),y==null)throw Error(J(151));for(var O=P=null,N=_,w=_=0,I=null,k=y.next();N!==null&&!k.done;w++,k=y.next()){N.index>w?(I=N,N=null):I=N.sibling;var D=g(v,N,k.value,A);if(D===null){N===null&&(N=I);break}t&&N&&D.alternate===null&&e(v,N),_=i(D,_,w),O===null?P=D:O.sibling=D,O=D,N=I}if(k.done)return n(v,N),yt&&Ci(v,w),P;if(N===null){for(;!k.done;w++,k=y.next())k=m(v,k.value,A),k!==null&&(_=i(k,_,w),O===null?P=k:O.sibling=k,O=k);return yt&&Ci(v,w),P}for(N=r(v,N);!k.done;w++,k=y.next())k=x(N,v,w,k.value,A),k!==null&&(t&&k.alternate!==null&&N.delete(k.key===null?w:k.key),_=i(k,_,w),O===null?P=k:O.sibling=k,O=k);return t&&N.forEach(function(L){return e(v,L)}),yt&&Ci(v,w),P}function T(v,_,y,A){if(typeof y=="object"&&y!==null&&y.type===Po&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case eu:e:{for(var P=y.key,O=_;O!==null;){if(O.key===P){if(P=y.type,P===Po){if(O.tag===7){n(v,O.sibling),_=s(O,y.props.children),_.return=v,v=_;break e}}else if(O.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Fs&&Sy(P)===O.type){n(v,O.sibling),_=s(O,y.props),_.ref=Ja(v,O,y),_.return=v,v=_;break e}n(v,O);break}else e(v,O);O=O.sibling}y.type===Po?(_=Fi(y.props.children,v.mode,A,y.key),_.return=v,v=_):(A=Mu(y.type,y.key,y.props,null,v.mode,A),A.ref=Ja(v,_,y),A.return=v,v=A)}return a(v);case Ro:e:{for(O=y.key;_!==null;){if(_.key===O)if(_.tag===4&&_.stateNode.containerInfo===y.containerInfo&&_.stateNode.implementation===y.implementation){n(v,_.sibling),_=s(_,y.children||[]),_.return=v,v=_;break e}else{n(v,_);break}else e(v,_);_=_.sibling}_=yf(y,v.mode,A),_.return=v,v=_}return a(v);case Fs:return O=y._init,T(v,_,O(y._payload),A)}if(il(y))return b(v,_,y,A);if(Ga(y))return R(v,_,y,A);du(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,_!==null&&_.tag===6?(n(v,_.sibling),_=s(_,y),_.return=v,v=_):(n(v,_),_=gf(y,v.mode,A),_.return=v,v=_),a(v)):n(v,_)}return T}var ia=n_(!0),r_=n_(!1),ld=vi(null),cd=null,$o=null,Rp=null;function Pp(){Rp=$o=cd=null}function Dp(t){var e=ld.current;pt(ld),t._currentValue=e}function um(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qo(t,e){cd=t,Rp=$o=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Un=!0),t.firstContext=null)}function fr(t){var e=t._currentValue;if(Rp!==t)if(t={context:t,memoizedValue:e,next:null},$o===null){if(cd===null)throw Error(J(308));$o=t,cd.dependencies={lanes:0,firstContext:t}}else $o=$o.next=t;return e}var Pi=null;function Op(t){Pi===null?Pi=[t]:Pi.push(t)}function s_(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Op(e)):(n.next=s.next,s.next=n),e.interleaved=n,ws(t,r)}function ws(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $s=!1;function Lp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function i_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ms(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ni(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ws(t,n)}return s=r.interleaved,s===null?(e.next=e,Op(r)):(e.next=s.next,s.next=e),r.interleaved=e,ws(t,n)}function ju(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_p(t,n)}}function Ny(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ud(t,e,n,r){var s=t.updateQueue;$s=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==a&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;a=0,f=d=u=null,l=i;do{var g=l.lane,x=l.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,R=l;switch(g=e,x=n,R.tag){case 1:if(b=R.payload,typeof b=="function"){m=b.call(x,m,g);break e}m=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=R.payload,g=typeof b=="function"?b.call(x,m,g):b,g==null)break e;m=Et({},m,g);break e;case 2:$s=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else x={eventTime:x,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=x,u=m):f=f.next=x,a|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(f===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Wi|=a,t.lanes=a,t.memoizedState=m}}function Ty(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var gc={},zr=vi(gc),$l=vi(gc),zl=vi(gc);function Di(t){if(t===gc)throw Error(J(174));return t}function Mp(t,e){switch(ut(zl,e),ut($l,t),ut(zr,gc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qf(e,t)}pt(zr),ut(zr,e)}function oa(){pt(zr),pt($l),pt(zl)}function o_(t){Di(zl.current);var e=Di(zr.current),n=qf(e,t.type);e!==n&&(ut($l,t),ut(zr,n))}function Vp(t){$l.current===t&&(pt(zr),pt($l))}var _t=vi(0);function dd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var uf=[];function Up(){for(var t=0;t<uf.length;t++)uf[t]._workInProgressVersionPrimary=null;uf.length=0}var Ru=Cs.ReactCurrentDispatcher,df=Cs.ReactCurrentBatchConfig,Hi=0,bt=null,Ut=null,Wt=null,hd=!1,vl=!1,Bl=0,TN=0;function hn(){throw Error(J(321))}function Fp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ar(t[n],e[n]))return!1;return!0}function $p(t,e,n,r,s,i){if(Hi=i,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ru.current=t===null||t.memoizedState===null?AN:jN,t=n(r,s),vl){i=0;do{if(vl=!1,Bl=0,25<=i)throw Error(J(301));i+=1,Wt=Ut=null,e.updateQueue=null,Ru.current=RN,t=n(r,s)}while(vl)}if(Ru.current=fd,e=Ut!==null&&Ut.next!==null,Hi=0,Wt=Ut=bt=null,hd=!1,e)throw Error(J(300));return t}function zp(){var t=Bl!==0;return Bl=0,t}function Mr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?bt.memoizedState=Wt=t:Wt=Wt.next=t,Wt}function mr(){if(Ut===null){var t=bt.alternate;t=t!==null?t.memoizedState:null}else t=Ut.next;var e=Wt===null?bt.memoizedState:Wt.next;if(e!==null)Wt=e,Ut=t;else{if(t===null)throw Error(J(310));Ut=t,t={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},Wt===null?bt.memoizedState=Wt=t:Wt=Wt.next=t}return Wt}function ql(t,e){return typeof e=="function"?e(t):e}function hf(t){var e=mr(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=Ut,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,d=i;do{var f=d.lane;if((Hi&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=m,a=r):u=u.next=m,bt.lanes|=f,Wi|=f}d=d.next}while(d!==null&&d!==i);u===null?a=r:u.next=l,Ar(r,e.memoizedState)||(Un=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,bt.lanes|=i,Wi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ff(t){var e=mr(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Ar(i,e.memoizedState)||(Un=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function a_(){}function l_(t,e){var n=bt,r=mr(),s=e(),i=!Ar(r.memoizedState,s);if(i&&(r.memoizedState=s,Un=!0),r=r.queue,Bp(d_.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Wt!==null&&Wt.memoizedState.tag&1){if(n.flags|=2048,Hl(9,u_.bind(null,n,r,s,e),void 0,null),Gt===null)throw Error(J(349));Hi&30||c_(n,e,s)}return s}function c_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function u_(t,e,n,r){e.value=n,e.getSnapshot=r,h_(e)&&f_(t)}function d_(t,e,n){return n(function(){h_(e)&&f_(t)})}function h_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ar(t,n)}catch{return!0}}function f_(t){var e=ws(t,1);e!==null&&Tr(e,t,1,-1)}function Iy(t){var e=Mr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ql,lastRenderedState:t},e.queue=t,t=t.dispatch=CN.bind(null,bt,t),[e.memoizedState,t]}function Hl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function m_(){return mr().memoizedState}function Pu(t,e,n,r){var s=Mr();bt.flags|=t,s.memoizedState=Hl(1|e,n,void 0,r===void 0?null:r)}function Jd(t,e,n,r){var s=mr();r=r===void 0?null:r;var i=void 0;if(Ut!==null){var a=Ut.memoizedState;if(i=a.destroy,r!==null&&Fp(r,a.deps)){s.memoizedState=Hl(e,n,i,r);return}}bt.flags|=t,s.memoizedState=Hl(1|e,n,i,r)}function ky(t,e){return Pu(8390656,8,t,e)}function Bp(t,e){return Jd(2048,8,t,e)}function p_(t,e){return Jd(4,2,t,e)}function g_(t,e){return Jd(4,4,t,e)}function y_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function x_(t,e,n){return n=n!=null?n.concat([t]):null,Jd(4,4,y_.bind(null,e,t),n)}function qp(){}function v_(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function w_(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function __(t,e,n){return Hi&21?(Ar(n,e)||(n=Tw(),bt.lanes|=n,Wi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Un=!0),t.memoizedState=n)}function IN(t,e){var n=nt;nt=n!==0&&4>n?n:4,t(!0);var r=df.transition;df.transition={};try{t(!1),e()}finally{nt=n,df.transition=r}}function b_(){return mr().memoizedState}function kN(t,e,n){var r=si(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},E_(t))S_(e,n);else if(n=s_(t,e,n,r),n!==null){var s=jn();Tr(n,t,r,s),N_(n,e,r)}}function CN(t,e,n){var r=si(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(E_(t))S_(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Ar(l,a)){var u=e.interleaved;u===null?(s.next=s,Op(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=s_(t,e,s,r),n!==null&&(s=jn(),Tr(n,t,r,s),N_(n,e,r))}}function E_(t){var e=t.alternate;return t===bt||e!==null&&e===bt}function S_(t,e){vl=hd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function N_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_p(t,n)}}var fd={readContext:fr,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useInsertionEffect:hn,useLayoutEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useMutableSource:hn,useSyncExternalStore:hn,useId:hn,unstable_isNewReconciler:!1},AN={readContext:fr,useCallback:function(t,e){return Mr().memoizedState=[t,e===void 0?null:e],t},useContext:fr,useEffect:ky,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Pu(4194308,4,y_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Pu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Pu(4,2,t,e)},useMemo:function(t,e){var n=Mr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Mr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=kN.bind(null,bt,t),[r.memoizedState,t]},useRef:function(t){var e=Mr();return t={current:t},e.memoizedState=t},useState:Iy,useDebugValue:qp,useDeferredValue:function(t){return Mr().memoizedState=t},useTransition:function(){var t=Iy(!1),e=t[0];return t=IN.bind(null,t[1]),Mr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=bt,s=Mr();if(yt){if(n===void 0)throw Error(J(407));n=n()}else{if(n=e(),Gt===null)throw Error(J(349));Hi&30||c_(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,ky(d_.bind(null,r,i,t),[t]),r.flags|=2048,Hl(9,u_.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Mr(),e=Gt.identifierPrefix;if(yt){var n=cs,r=ls;n=(r&~(1<<32-Nr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=TN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jN={readContext:fr,useCallback:v_,useContext:fr,useEffect:Bp,useImperativeHandle:x_,useInsertionEffect:p_,useLayoutEffect:g_,useMemo:w_,useReducer:hf,useRef:m_,useState:function(){return hf(ql)},useDebugValue:qp,useDeferredValue:function(t){var e=mr();return __(e,Ut.memoizedState,t)},useTransition:function(){var t=hf(ql)[0],e=mr().memoizedState;return[t,e]},useMutableSource:a_,useSyncExternalStore:l_,useId:b_,unstable_isNewReconciler:!1},RN={readContext:fr,useCallback:v_,useContext:fr,useEffect:Bp,useImperativeHandle:x_,useInsertionEffect:p_,useLayoutEffect:g_,useMemo:w_,useReducer:ff,useRef:m_,useState:function(){return ff(ql)},useDebugValue:qp,useDeferredValue:function(t){var e=mr();return Ut===null?e.memoizedState=t:__(e,Ut.memoizedState,t)},useTransition:function(){var t=ff(ql)[0],e=mr().memoizedState;return[t,e]},useMutableSource:a_,useSyncExternalStore:l_,useId:b_,unstable_isNewReconciler:!1};function wr(t,e){if(t&&t.defaultProps){e=Et({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function dm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Et({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Zd={isMounted:function(t){return(t=t._reactInternals)?io(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=jn(),s=si(t),i=ms(r,s);i.payload=e,n!=null&&(i.callback=n),e=ni(t,i,s),e!==null&&(Tr(e,t,s,r),ju(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=jn(),s=si(t),i=ms(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ni(t,i,s),e!==null&&(Tr(e,t,s,r),ju(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=jn(),r=si(t),s=ms(n,r);s.tag=2,e!=null&&(s.callback=e),e=ni(t,s,r),e!==null&&(Tr(e,t,r,n),ju(e,t,r))}};function Cy(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Ml(n,r)||!Ml(s,i):!0}function T_(t,e,n){var r=!1,s=hi,i=e.contextType;return typeof i=="object"&&i!==null?i=fr(i):(s=$n(e)?Bi:wn.current,r=e.contextTypes,i=(r=r!=null)?ra(t,s):hi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Ay(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Zd.enqueueReplaceState(e,e.state,null)}function hm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Lp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fr(i):(i=$n(e)?Bi:wn.current,s.context=ra(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(dm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Zd.enqueueReplaceState(s,s.state,null),ud(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function aa(t,e){try{var n="",r=e;do n+=o2(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function mf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function fm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var PN=typeof WeakMap=="function"?WeakMap:Map;function I_(t,e,n){n=ms(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){pd||(pd=!0,Em=r),fm(t,e)},n}function k_(t,e,n){n=ms(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){fm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){fm(t,e),typeof r!="function"&&(ri===null?ri=new Set([this]):ri.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function jy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new PN;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=GN.bind(null,t,e,n),e.then(t,t))}function Ry(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Py(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ms(-1,1),e.tag=2,ni(n,e,1))),n.lanes|=1),t)}var DN=Cs.ReactCurrentOwner,Un=!1;function Cn(t,e,n,r){e.child=t===null?r_(e,null,n,r):ia(e,t.child,n,r)}function Dy(t,e,n,r,s){n=n.render;var i=e.ref;return Qo(e,s),r=$p(t,e,n,r,i,s),n=zp(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,_s(t,e,s)):(yt&&n&&Cp(e),e.flags|=1,Cn(t,e,r,s),e.child)}function Oy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Jp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,C_(t,e,i,r,s)):(t=Mu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ml,n(a,r)&&t.ref===e.ref)return _s(t,e,s)}return e.flags|=1,t=ii(i,r),t.ref=e.ref,t.return=e,e.child=t}function C_(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ml(i,r)&&t.ref===e.ref)if(Un=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Un=!0);else return e.lanes=t.lanes,_s(t,e,s)}return mm(t,e,n,r,s)}function A_(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(Bo,Gn),Gn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ut(Bo,Gn),Gn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ut(Bo,Gn),Gn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ut(Bo,Gn),Gn|=r;return Cn(t,e,s,n),e.child}function j_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mm(t,e,n,r,s){var i=$n(n)?Bi:wn.current;return i=ra(e,i),Qo(e,s),n=$p(t,e,n,r,i,s),r=zp(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,_s(t,e,s)):(yt&&r&&Cp(e),e.flags|=1,Cn(t,e,n,s),e.child)}function Ly(t,e,n,r,s){if($n(n)){var i=!0;id(e)}else i=!1;if(Qo(e,s),e.stateNode===null)Du(t,e),T_(e,n,r),hm(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=fr(d):(d=$n(n)?Bi:wn.current,d=ra(e,d));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==d)&&Ay(e,a,r,d),$s=!1;var g=e.memoizedState;a.state=g,ud(e,r,a,s),u=e.memoizedState,l!==r||g!==u||Fn.current||$s?(typeof f=="function"&&(dm(e,n,f,r),u=e.memoizedState),(l=$s||Cy(e,n,l,r,g,u,d))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,i_(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:wr(e.type,l),a.props=d,m=e.pendingProps,g=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=fr(u):(u=$n(n)?Bi:wn.current,u=ra(e,u));var x=n.getDerivedStateFromProps;(f=typeof x=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==m||g!==u)&&Ay(e,a,r,u),$s=!1,g=e.memoizedState,a.state=g,ud(e,r,a,s);var b=e.memoizedState;l!==m||g!==b||Fn.current||$s?(typeof x=="function"&&(dm(e,n,x,r),b=e.memoizedState),(d=$s||Cy(e,n,d,r,g,b,u)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,b,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,b,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),a.props=r,a.state=b,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return pm(t,e,n,r,i,s)}function pm(t,e,n,r,s,i){j_(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&_y(e,n,!1),_s(t,e,i);r=e.stateNode,DN.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ia(e,t.child,null,i),e.child=ia(e,null,l,i)):Cn(t,e,l,i),e.memoizedState=r.state,s&&_y(e,n,!0),e.child}function R_(t){var e=t.stateNode;e.pendingContext?wy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&wy(t,e.context,!1),Mp(t,e.containerInfo)}function My(t,e,n,r,s){return sa(),jp(s),e.flags|=256,Cn(t,e,n,r),e.child}var gm={dehydrated:null,treeContext:null,retryLane:0};function ym(t){return{baseLanes:t,cachePool:null,transitions:null}}function P_(t,e,n){var r=e.pendingProps,s=_t.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ut(_t,s&1),t===null)return cm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=nh(a,r,0,null),t=Fi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ym(n),e.memoizedState=gm,t):Hp(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return ON(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=ii(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=ii(l,i):(i=Fi(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?ym(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=gm,r}return i=t.child,t=i.sibling,r=ii(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hp(t,e){return e=nh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hu(t,e,n,r){return r!==null&&jp(r),ia(e,t.child,null,n),t=Hp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ON(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=mf(Error(J(422))),hu(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=nh({mode:"visible",children:r.children},s,0,null),i=Fi(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ia(e,t.child,null,a),e.child.memoizedState=ym(a),e.memoizedState=gm,i);if(!(e.mode&1))return hu(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(J(419)),r=mf(i,r,void 0),hu(t,e,a,r)}if(l=(a&t.childLanes)!==0,Un||l){if(r=Gt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ws(t,s),Tr(r,t,s,-1))}return Yp(),r=mf(Error(J(421))),hu(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=KN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Qn=ti(s.nextSibling),Jn=e,yt=!0,br=null,t!==null&&(ar[lr++]=ls,ar[lr++]=cs,ar[lr++]=qi,ls=t.id,cs=t.overflow,qi=e),e=Hp(e,r.children),e.flags|=4096,e)}function Vy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),um(t.return,e,n)}function pf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function D_(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Cn(t,e,r.children,n),r=_t.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Vy(t,n,e);else if(t.tag===19)Vy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ut(_t,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&dd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),pf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&dd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}pf(e,!0,n,null,i);break;case"together":pf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Du(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _s(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Wi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,n=ii(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ii(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function LN(t,e,n){switch(e.tag){case 3:R_(e),sa();break;case 5:o_(e);break;case 1:$n(e.type)&&id(e);break;case 4:Mp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ut(ld,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ut(_t,_t.current&1),e.flags|=128,null):n&e.child.childLanes?P_(t,e,n):(ut(_t,_t.current&1),t=_s(t,e,n),t!==null?t.sibling:null);ut(_t,_t.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return D_(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ut(_t,_t.current),r)break;return null;case 22:case 23:return e.lanes=0,A_(t,e,n)}return _s(t,e,n)}var O_,xm,L_,M_;O_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xm=function(){};L_=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Di(zr.current);var i=null;switch(n){case"input":s=Ff(t,s),r=Ff(t,r),i=[];break;case"select":s=Et({},s,{value:void 0}),r=Et({},r,{value:void 0}),i=[];break;case"textarea":s=Bf(t,s),r=Bf(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=rd)}Hf(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Al.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Al.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&ft("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};M_=function(t,e,n,r){n!==r&&(e.flags|=4)};function Za(t,e){if(!yt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function fn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function MN(t,e,n){var r=e.pendingProps;switch(Ap(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(e),null;case 1:return $n(e.type)&&sd(),fn(e),null;case 3:return r=e.stateNode,oa(),pt(Fn),pt(wn),Up(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(uu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,br!==null&&(Tm(br),br=null))),xm(t,e),fn(e),null;case 5:Vp(e);var s=Di(zl.current);if(n=e.type,t!==null&&e.stateNode!=null)L_(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(J(166));return fn(e),null}if(t=Di(zr.current),uu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Vr]=e,r[Fl]=i,t=(e.mode&1)!==0,n){case"dialog":ft("cancel",r),ft("close",r);break;case"iframe":case"object":case"embed":ft("load",r);break;case"video":case"audio":for(s=0;s<al.length;s++)ft(al[s],r);break;case"source":ft("error",r);break;case"img":case"image":case"link":ft("error",r),ft("load",r);break;case"details":ft("toggle",r);break;case"input":G0(r,i),ft("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ft("invalid",r);break;case"textarea":Q0(r,i),ft("invalid",r)}Hf(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&cu(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&cu(r.textContent,l,t),s=["children",""+l]):Al.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&ft("scroll",r)}switch(n){case"input":tu(r),K0(r,i,!0);break;case"textarea":tu(r),X0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=rd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=dw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Vr]=e,t[Fl]=r,O_(t,e,!1,!1),e.stateNode=t;e:{switch(a=Wf(n,r),n){case"dialog":ft("cancel",t),ft("close",t),s=r;break;case"iframe":case"object":case"embed":ft("load",t),s=r;break;case"video":case"audio":for(s=0;s<al.length;s++)ft(al[s],t);s=r;break;case"source":ft("error",t),s=r;break;case"img":case"image":case"link":ft("error",t),ft("load",t),s=r;break;case"details":ft("toggle",t),s=r;break;case"input":G0(t,r),s=Ff(t,r),ft("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Et({},r,{value:void 0}),ft("invalid",t);break;case"textarea":Q0(t,r),s=Bf(t,r),ft("invalid",t);break;default:s=r}Hf(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?mw(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&hw(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&jl(t,u):typeof u=="number"&&jl(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Al.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ft("scroll",t):u!=null&&pp(t,i,u,a))}switch(n){case"input":tu(t),K0(t,r,!1);break;case"textarea":tu(t),X0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+di(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ho(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ho(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=rd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return fn(e),null;case 6:if(t&&e.stateNode!=null)M_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(J(166));if(n=Di(zl.current),Di(zr.current),uu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Vr]=e,(i=r.nodeValue!==n)&&(t=Jn,t!==null))switch(t.tag){case 3:cu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vr]=e,e.stateNode=r}return fn(e),null;case 13:if(pt(_t),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yt&&Qn!==null&&e.mode&1&&!(e.flags&128))t_(),sa(),e.flags|=98560,i=!1;else if(i=uu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(J(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(J(317));i[Vr]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;fn(e),i=!1}else br!==null&&(Tm(br),br=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||_t.current&1?Ft===0&&(Ft=3):Yp())),e.updateQueue!==null&&(e.flags|=4),fn(e),null);case 4:return oa(),xm(t,e),t===null&&Vl(e.stateNode.containerInfo),fn(e),null;case 10:return Dp(e.type._context),fn(e),null;case 17:return $n(e.type)&&sd(),fn(e),null;case 19:if(pt(_t),i=e.memoizedState,i===null)return fn(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Za(i,!1);else{if(Ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=dd(t),a!==null){for(e.flags|=128,Za(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ut(_t,_t.current&1|2),e.child}t=t.sibling}i.tail!==null&&jt()>la&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304)}else{if(!r)if(t=dd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Za(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!yt)return fn(e),null}else 2*jt()-i.renderingStartTime>la&&n!==1073741824&&(e.flags|=128,r=!0,Za(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=jt(),e.sibling=null,n=_t.current,ut(_t,r?n&1|2:n&1),e):(fn(e),null);case 22:case 23:return Xp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gn&1073741824&&(fn(e),e.subtreeFlags&6&&(e.flags|=8192)):fn(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function VN(t,e){switch(Ap(e),e.tag){case 1:return $n(e.type)&&sd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oa(),pt(Fn),pt(wn),Up(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vp(e),null;case 13:if(pt(_t),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pt(_t),null;case 4:return oa(),null;case 10:return Dp(e.type._context),null;case 22:case 23:return Xp(),null;case 24:return null;default:return null}}var fu=!1,gn=!1,UN=typeof WeakSet=="function"?WeakSet:Set,ye=null;function zo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ct(t,e,r)}else n.current=null}function vm(t,e,n){try{n()}catch(r){Ct(t,e,r)}}var Uy=!1;function FN(t,e){if(nm=ed,t=zw(),kp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,d=0,f=0,m=t,g=null;t:for(;;){for(var x;m!==n||s!==0&&m.nodeType!==3||(l=a+s),m!==i||r!==0&&m.nodeType!==3||(u=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(x=m.firstChild)!==null;)g=m,m=x;for(;;){if(m===t)break t;if(g===n&&++d===s&&(l=a),g===i&&++f===r&&(u=a),(x=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=x}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(rm={focusedElem:t,selectionRange:n},ed=!1,ye=e;ye!==null;)if(e=ye,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ye=t;else for(;ye!==null;){e=ye;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var R=b.memoizedProps,T=b.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?R:wr(e.type,R),T);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(A){Ct(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,ye=t;break}ye=e.return}return b=Uy,Uy=!1,b}function wl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&vm(e,n,i)}s=s.next}while(s!==r)}}function eh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function wm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function V_(t){var e=t.alternate;e!==null&&(t.alternate=null,V_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vr],delete e[Fl],delete e[om],delete e[bN],delete e[EN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function U_(t){return t.tag===5||t.tag===3||t.tag===4}function Fy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||U_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _m(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=rd));else if(r!==4&&(t=t.child,t!==null))for(_m(t,e,n),t=t.sibling;t!==null;)_m(t,e,n),t=t.sibling}function bm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(bm(t,e,n),t=t.sibling;t!==null;)bm(t,e,n),t=t.sibling}var Zt=null,_r=!1;function Vs(t,e,n){for(n=n.child;n!==null;)F_(t,e,n),n=n.sibling}function F_(t,e,n){if($r&&typeof $r.onCommitFiberUnmount=="function")try{$r.onCommitFiberUnmount(Wd,n)}catch{}switch(n.tag){case 5:gn||zo(n,e);case 6:var r=Zt,s=_r;Zt=null,Vs(t,e,n),Zt=r,_r=s,Zt!==null&&(_r?(t=Zt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Zt.removeChild(n.stateNode));break;case 18:Zt!==null&&(_r?(t=Zt,n=n.stateNode,t.nodeType===8?lf(t.parentNode,n):t.nodeType===1&&lf(t,n),Ol(t)):lf(Zt,n.stateNode));break;case 4:r=Zt,s=_r,Zt=n.stateNode.containerInfo,_r=!0,Vs(t,e,n),Zt=r,_r=s;break;case 0:case 11:case 14:case 15:if(!gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&vm(n,e,a),s=s.next}while(s!==r)}Vs(t,e,n);break;case 1:if(!gn&&(zo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ct(n,e,l)}Vs(t,e,n);break;case 21:Vs(t,e,n);break;case 22:n.mode&1?(gn=(r=gn)||n.memoizedState!==null,Vs(t,e,n),gn=r):Vs(t,e,n);break;default:Vs(t,e,n)}}function $y(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new UN),e.forEach(function(r){var s=QN.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function vr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Zt=l.stateNode,_r=!1;break e;case 3:Zt=l.stateNode.containerInfo,_r=!0;break e;case 4:Zt=l.stateNode.containerInfo,_r=!0;break e}l=l.return}if(Zt===null)throw Error(J(160));F_(i,a,s),Zt=null,_r=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ct(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$_(e,t),e=e.sibling}function $_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vr(e,t),Lr(t),r&4){try{wl(3,t,t.return),eh(3,t)}catch(R){Ct(t,t.return,R)}try{wl(5,t,t.return)}catch(R){Ct(t,t.return,R)}}break;case 1:vr(e,t),Lr(t),r&512&&n!==null&&zo(n,n.return);break;case 5:if(vr(e,t),Lr(t),r&512&&n!==null&&zo(n,n.return),t.flags&32){var s=t.stateNode;try{jl(s,"")}catch(R){Ct(t,t.return,R)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&cw(s,i),Wf(l,a);var d=Wf(l,i);for(a=0;a<u.length;a+=2){var f=u[a],m=u[a+1];f==="style"?mw(s,m):f==="dangerouslySetInnerHTML"?hw(s,m):f==="children"?jl(s,m):pp(s,f,m,d)}switch(l){case"input":$f(s,i);break;case"textarea":uw(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Ho(s,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?Ho(s,!!i.multiple,i.defaultValue,!0):Ho(s,!!i.multiple,i.multiple?[]:"",!1))}s[Fl]=i}catch(R){Ct(t,t.return,R)}}break;case 6:if(vr(e,t),Lr(t),r&4){if(t.stateNode===null)throw Error(J(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(R){Ct(t,t.return,R)}}break;case 3:if(vr(e,t),Lr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ol(e.containerInfo)}catch(R){Ct(t,t.return,R)}break;case 4:vr(e,t),Lr(t);break;case 13:vr(e,t),Lr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Kp=jt())),r&4&&$y(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(gn=(d=gn)||f,vr(e,t),gn=d):vr(e,t),Lr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(ye=t,f=t.child;f!==null;){for(m=ye=f;ye!==null;){switch(g=ye,x=g.child,g.tag){case 0:case 11:case 14:case 15:wl(4,g,g.return);break;case 1:zo(g,g.return);var b=g.stateNode;if(typeof b.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(R){Ct(r,n,R)}}break;case 5:zo(g,g.return);break;case 22:if(g.memoizedState!==null){By(m);continue}}x!==null?(x.return=g,ye=x):By(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,u=m.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=fw("display",a))}catch(R){Ct(t,t.return,R)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(R){Ct(t,t.return,R)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:vr(e,t),Lr(t),r&4&&$y(t);break;case 21:break;default:vr(e,t),Lr(t)}}function Lr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(U_(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(jl(s,""),r.flags&=-33);var i=Fy(t);bm(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Fy(t);_m(t,l,a);break;default:throw Error(J(161))}}catch(u){Ct(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function $N(t,e,n){ye=t,z_(t)}function z_(t,e,n){for(var r=(t.mode&1)!==0;ye!==null;){var s=ye,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||fu;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||gn;l=fu;var d=gn;if(fu=a,(gn=u)&&!d)for(ye=s;ye!==null;)a=ye,u=a.child,a.tag===22&&a.memoizedState!==null?qy(s):u!==null?(u.return=a,ye=u):qy(s);for(;i!==null;)ye=i,z_(i),i=i.sibling;ye=s,fu=l,gn=d}zy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ye=i):zy(t)}}function zy(t){for(;ye!==null;){var e=ye;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gn||eh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:wr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Ty(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ty(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&Ol(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}gn||e.flags&512&&wm(e)}catch(g){Ct(e,e.return,g)}}if(e===t){ye=null;break}if(n=e.sibling,n!==null){n.return=e.return,ye=n;break}ye=e.return}}function By(t){for(;ye!==null;){var e=ye;if(e===t){ye=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ye=n;break}ye=e.return}}function qy(t){for(;ye!==null;){var e=ye;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{eh(4,e)}catch(u){Ct(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ct(e,s,u)}}var i=e.return;try{wm(e)}catch(u){Ct(e,i,u)}break;case 5:var a=e.return;try{wm(e)}catch(u){Ct(e,a,u)}}}catch(u){Ct(e,e.return,u)}if(e===t){ye=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ye=l;break}ye=e.return}}var zN=Math.ceil,md=Cs.ReactCurrentDispatcher,Wp=Cs.ReactCurrentOwner,hr=Cs.ReactCurrentBatchConfig,Be=0,Gt=null,Dt=null,nn=0,Gn=0,Bo=vi(0),Ft=0,Wl=null,Wi=0,th=0,Gp=0,_l=null,Mn=null,Kp=0,la=1/0,rs=null,pd=!1,Em=null,ri=null,mu=!1,Qs=null,gd=0,bl=0,Sm=null,Ou=-1,Lu=0;function jn(){return Be&6?jt():Ou!==-1?Ou:Ou=jt()}function si(t){return t.mode&1?Be&2&&nn!==0?nn&-nn:NN.transition!==null?(Lu===0&&(Lu=Tw()),Lu):(t=nt,t!==0||(t=window.event,t=t===void 0?16:Pw(t.type)),t):1}function Tr(t,e,n,r){if(50<bl)throw bl=0,Sm=null,Error(J(185));fc(t,n,r),(!(Be&2)||t!==Gt)&&(t===Gt&&(!(Be&2)&&(th|=n),Ft===4&&Bs(t,nn)),zn(t,r),n===1&&Be===0&&!(e.mode&1)&&(la=jt()+500,Yd&&wi()))}function zn(t,e){var n=t.callbackNode;N2(t,e);var r=Zu(t,t===Gt?nn:0);if(r===0)n!==null&&Z0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Z0(n),e===1)t.tag===0?SN(Hy.bind(null,t)):Jw(Hy.bind(null,t)),wN(function(){!(Be&6)&&wi()}),n=null;else{switch(Iw(r)){case 1:n=wp;break;case 4:n=Sw;break;case 16:n=Ju;break;case 536870912:n=Nw;break;default:n=Ju}n=X_(n,B_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function B_(t,e){if(Ou=-1,Lu=0,Be&6)throw Error(J(327));var n=t.callbackNode;if(Xo()&&t.callbackNode!==n)return null;var r=Zu(t,t===Gt?nn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=yd(t,r);else{e=r;var s=Be;Be|=2;var i=H_();(Gt!==t||nn!==e)&&(rs=null,la=jt()+500,Ui(t,e));do try{HN();break}catch(l){q_(t,l)}while(!0);Pp(),md.current=i,Be=s,Dt!==null?e=0:(Gt=null,nn=0,e=Ft)}if(e!==0){if(e===2&&(s=Yf(t),s!==0&&(r=s,e=Nm(t,s))),e===1)throw n=Wl,Ui(t,0),Bs(t,r),zn(t,jt()),n;if(e===6)Bs(t,r);else{if(s=t.current.alternate,!(r&30)&&!BN(s)&&(e=yd(t,r),e===2&&(i=Yf(t),i!==0&&(r=i,e=Nm(t,i))),e===1))throw n=Wl,Ui(t,0),Bs(t,r),zn(t,jt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(J(345));case 2:Ai(t,Mn,rs);break;case 3:if(Bs(t,r),(r&130023424)===r&&(e=Kp+500-jt(),10<e)){if(Zu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){jn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=im(Ai.bind(null,t,Mn,rs),e);break}Ai(t,Mn,rs);break;case 4:if(Bs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Nr(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=jt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zN(r/1960))-r,10<r){t.timeoutHandle=im(Ai.bind(null,t,Mn,rs),r);break}Ai(t,Mn,rs);break;case 5:Ai(t,Mn,rs);break;default:throw Error(J(329))}}}return zn(t,jt()),t.callbackNode===n?B_.bind(null,t):null}function Nm(t,e){var n=_l;return t.current.memoizedState.isDehydrated&&(Ui(t,e).flags|=256),t=yd(t,e),t!==2&&(e=Mn,Mn=n,e!==null&&Tm(e)),t}function Tm(t){Mn===null?Mn=t:Mn.push.apply(Mn,t)}function BN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ar(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Bs(t,e){for(e&=~Gp,e&=~th,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Nr(e),r=1<<n;t[n]=-1,e&=~r}}function Hy(t){if(Be&6)throw Error(J(327));Xo();var e=Zu(t,0);if(!(e&1))return zn(t,jt()),null;var n=yd(t,e);if(t.tag!==0&&n===2){var r=Yf(t);r!==0&&(e=r,n=Nm(t,r))}if(n===1)throw n=Wl,Ui(t,0),Bs(t,e),zn(t,jt()),n;if(n===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ai(t,Mn,rs),zn(t,jt()),null}function Qp(t,e){var n=Be;Be|=1;try{return t(e)}finally{Be=n,Be===0&&(la=jt()+500,Yd&&wi())}}function Gi(t){Qs!==null&&Qs.tag===0&&!(Be&6)&&Xo();var e=Be;Be|=1;var n=hr.transition,r=nt;try{if(hr.transition=null,nt=1,t)return t()}finally{nt=r,hr.transition=n,Be=e,!(Be&6)&&wi()}}function Xp(){Gn=Bo.current,pt(Bo)}function Ui(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,vN(n)),Dt!==null)for(n=Dt.return;n!==null;){var r=n;switch(Ap(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sd();break;case 3:oa(),pt(Fn),pt(wn),Up();break;case 5:Vp(r);break;case 4:oa();break;case 13:pt(_t);break;case 19:pt(_t);break;case 10:Dp(r.type._context);break;case 22:case 23:Xp()}n=n.return}if(Gt=t,Dt=t=ii(t.current,null),nn=Gn=e,Ft=0,Wl=null,Gp=th=Wi=0,Mn=_l=null,Pi!==null){for(e=0;e<Pi.length;e++)if(n=Pi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Pi=null}return t}function q_(t,e){do{var n=Dt;try{if(Pp(),Ru.current=fd,hd){for(var r=bt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}hd=!1}if(Hi=0,Wt=Ut=bt=null,vl=!1,Bl=0,Wp.current=null,n===null||n.return===null){Ft=1,Wl=e,Dt=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=nn,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=l,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var x=Ry(a);if(x!==null){x.flags&=-257,Py(x,a,l,i,e),x.mode&1&&jy(i,d,e),e=x,u=d;var b=e.updateQueue;if(b===null){var R=new Set;R.add(u),e.updateQueue=R}else b.add(u);break e}else{if(!(e&1)){jy(i,d,e),Yp();break e}u=Error(J(426))}}else if(yt&&l.mode&1){var T=Ry(a);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Py(T,a,l,i,e),jp(aa(u,l));break e}}i=u=aa(u,l),Ft!==4&&(Ft=2),_l===null?_l=[i]:_l.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=I_(i,u,e);Ny(i,v);break e;case 1:l=u;var _=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ri===null||!ri.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var A=k_(i,l,e);Ny(i,A);break e}}i=i.return}while(i!==null)}G_(n)}catch(P){e=P,Dt===n&&n!==null&&(Dt=n=n.return);continue}break}while(!0)}function H_(){var t=md.current;return md.current=fd,t===null?fd:t}function Yp(){(Ft===0||Ft===3||Ft===2)&&(Ft=4),Gt===null||!(Wi&268435455)&&!(th&268435455)||Bs(Gt,nn)}function yd(t,e){var n=Be;Be|=2;var r=H_();(Gt!==t||nn!==e)&&(rs=null,Ui(t,e));do try{qN();break}catch(s){q_(t,s)}while(!0);if(Pp(),Be=n,md.current=r,Dt!==null)throw Error(J(261));return Gt=null,nn=0,Ft}function qN(){for(;Dt!==null;)W_(Dt)}function HN(){for(;Dt!==null&&!g2();)W_(Dt)}function W_(t){var e=Q_(t.alternate,t,Gn);t.memoizedProps=t.pendingProps,e===null?G_(t):Dt=e,Wp.current=null}function G_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=VN(n,e),n!==null){n.flags&=32767,Dt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ft=6,Dt=null;return}}else if(n=MN(n,e,Gn),n!==null){Dt=n;return}if(e=e.sibling,e!==null){Dt=e;return}Dt=e=t}while(e!==null);Ft===0&&(Ft=5)}function Ai(t,e,n){var r=nt,s=hr.transition;try{hr.transition=null,nt=1,WN(t,e,n,r)}finally{hr.transition=s,nt=r}return null}function WN(t,e,n,r){do Xo();while(Qs!==null);if(Be&6)throw Error(J(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(T2(t,i),t===Gt&&(Dt=Gt=null,nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mu||(mu=!0,X_(Ju,function(){return Xo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=hr.transition,hr.transition=null;var a=nt;nt=1;var l=Be;Be|=4,Wp.current=null,FN(t,n),$_(n,t),hN(rm),ed=!!nm,rm=nm=null,t.current=n,$N(n),y2(),Be=l,nt=a,hr.transition=i}else t.current=n;if(mu&&(mu=!1,Qs=t,gd=s),i=t.pendingLanes,i===0&&(ri=null),w2(n.stateNode),zn(t,jt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(pd)throw pd=!1,t=Em,Em=null,t;return gd&1&&t.tag!==0&&Xo(),i=t.pendingLanes,i&1?t===Sm?bl++:(bl=0,Sm=t):bl=0,wi(),null}function Xo(){if(Qs!==null){var t=Iw(gd),e=hr.transition,n=nt;try{if(hr.transition=null,nt=16>t?16:t,Qs===null)var r=!1;else{if(t=Qs,Qs=null,gd=0,Be&6)throw Error(J(331));var s=Be;for(Be|=4,ye=t.current;ye!==null;){var i=ye,a=i.child;if(ye.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(ye=d;ye!==null;){var f=ye;switch(f.tag){case 0:case 11:case 15:wl(8,f,i)}var m=f.child;if(m!==null)m.return=f,ye=m;else for(;ye!==null;){f=ye;var g=f.sibling,x=f.return;if(V_(f),f===d){ye=null;break}if(g!==null){g.return=x,ye=g;break}ye=x}}}var b=i.alternate;if(b!==null){var R=b.child;if(R!==null){b.child=null;do{var T=R.sibling;R.sibling=null,R=T}while(R!==null)}}ye=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ye=a;else e:for(;ye!==null;){if(i=ye,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wl(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ye=v;break e}ye=i.return}}var _=t.current;for(ye=_;ye!==null;){a=ye;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,ye=y;else e:for(a=_;ye!==null;){if(l=ye,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:eh(9,l)}}catch(P){Ct(l,l.return,P)}if(l===a){ye=null;break e}var A=l.sibling;if(A!==null){A.return=l.return,ye=A;break e}ye=l.return}}if(Be=s,wi(),$r&&typeof $r.onPostCommitFiberRoot=="function")try{$r.onPostCommitFiberRoot(Wd,t)}catch{}r=!0}return r}finally{nt=n,hr.transition=e}}return!1}function Wy(t,e,n){e=aa(n,e),e=I_(t,e,1),t=ni(t,e,1),e=jn(),t!==null&&(fc(t,1,e),zn(t,e))}function Ct(t,e,n){if(t.tag===3)Wy(t,t,n);else for(;e!==null;){if(e.tag===3){Wy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ri===null||!ri.has(r))){t=aa(n,t),t=k_(e,t,1),e=ni(e,t,1),t=jn(),e!==null&&(fc(e,1,t),zn(e,t));break}}e=e.return}}function GN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=jn(),t.pingedLanes|=t.suspendedLanes&n,Gt===t&&(nn&n)===n&&(Ft===4||Ft===3&&(nn&130023424)===nn&&500>jt()-Kp?Ui(t,0):Gp|=n),zn(t,e)}function K_(t,e){e===0&&(t.mode&1?(e=su,su<<=1,!(su&130023424)&&(su=4194304)):e=1);var n=jn();t=ws(t,e),t!==null&&(fc(t,e,n),zn(t,n))}function KN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),K_(t,n)}function QN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(e),K_(t,n)}var Q_;Q_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fn.current)Un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Un=!1,LN(t,e,n);Un=!!(t.flags&131072)}else Un=!1,yt&&e.flags&1048576&&Zw(e,ad,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Du(t,e),t=e.pendingProps;var s=ra(e,wn.current);Qo(e,n),s=$p(null,e,r,t,s,n);var i=zp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$n(r)?(i=!0,id(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Lp(e),s.updater=Zd,e.stateNode=s,s._reactInternals=e,hm(e,r,t,n),e=pm(null,e,r,!0,i,n)):(e.tag=0,yt&&i&&Cp(e),Cn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Du(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=YN(r),t=wr(r,t),s){case 0:e=mm(null,e,r,t,n);break e;case 1:e=Ly(null,e,r,t,n);break e;case 11:e=Dy(null,e,r,t,n);break e;case 14:e=Oy(null,e,r,wr(r.type,t),n);break e}throw Error(J(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),mm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),Ly(t,e,r,s,n);case 3:e:{if(R_(e),t===null)throw Error(J(387));r=e.pendingProps,i=e.memoizedState,s=i.element,i_(t,e),ud(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=aa(Error(J(423)),e),e=My(t,e,r,n,s);break e}else if(r!==s){s=aa(Error(J(424)),e),e=My(t,e,r,n,s);break e}else for(Qn=ti(e.stateNode.containerInfo.firstChild),Jn=e,yt=!0,br=null,n=r_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),r===s){e=_s(t,e,n);break e}Cn(t,e,r,n)}e=e.child}return e;case 5:return o_(e),t===null&&cm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,sm(r,s)?a=null:i!==null&&sm(r,i)&&(e.flags|=32),j_(t,e),Cn(t,e,a,n),e.child;case 6:return t===null&&cm(e),null;case 13:return P_(t,e,n);case 4:return Mp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):Cn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),Dy(t,e,r,s,n);case 7:return Cn(t,e,e.pendingProps,n),e.child;case 8:return Cn(t,e,e.pendingProps.children,n),e.child;case 12:return Cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,ut(ld,r._currentValue),r._currentValue=a,i!==null)if(Ar(i.value,a)){if(i.children===s.children&&!Fn.current){e=_s(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=ms(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),um(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(J(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),um(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Cn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Qo(e,n),s=fr(s),r=r(s),e.flags|=1,Cn(t,e,r,n),e.child;case 14:return r=e.type,s=wr(r,e.pendingProps),s=wr(r.type,s),Oy(t,e,r,s,n);case 15:return C_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),Du(t,e),e.tag=1,$n(r)?(t=!0,id(e)):t=!1,Qo(e,n),T_(e,r,s),hm(e,r,s,n),pm(null,e,r,!0,t,n);case 19:return D_(t,e,n);case 22:return A_(t,e,n)}throw Error(J(156,e.tag))};function X_(t,e){return Ew(t,e)}function XN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(t,e,n,r){return new XN(t,e,n,r)}function Jp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function YN(t){if(typeof t=="function")return Jp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===yp)return 11;if(t===xp)return 14}return 2}function ii(t,e){var n=t.alternate;return n===null?(n=ur(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Mu(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Jp(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Po:return Fi(n.children,s,i,e);case gp:a=8,s|=8;break;case Lf:return t=ur(12,n,e,s|2),t.elementType=Lf,t.lanes=i,t;case Mf:return t=ur(13,n,e,s),t.elementType=Mf,t.lanes=i,t;case Vf:return t=ur(19,n,e,s),t.elementType=Vf,t.lanes=i,t;case ow:return nh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case sw:a=10;break e;case iw:a=9;break e;case yp:a=11;break e;case xp:a=14;break e;case Fs:a=16,r=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=ur(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Fi(t,e,n,r){return t=ur(7,t,r,e),t.lanes=n,t}function nh(t,e,n,r){return t=ur(22,t,r,e),t.elementType=ow,t.lanes=n,t.stateNode={isHidden:!1},t}function gf(t,e,n){return t=ur(6,t,null,e),t.lanes=n,t}function yf(t,e,n){return e=ur(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function JN(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xh(0),this.expirationTimes=Xh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Zp(t,e,n,r,s,i,a,l,u){return t=new JN(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ur(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lp(i),t}function ZN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ro,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Y_(t){if(!t)return hi;t=t._reactInternals;e:{if(io(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var n=t.type;if($n(n))return Yw(t,n,e)}return e}function J_(t,e,n,r,s,i,a,l,u){return t=Zp(n,r,!0,t,s,i,a,l,u),t.context=Y_(null),n=t.current,r=jn(),s=si(n),i=ms(r,s),i.callback=e??null,ni(n,i,s),t.current.lanes=s,fc(t,s,r),zn(t,r),t}function rh(t,e,n,r){var s=e.current,i=jn(),a=si(s);return n=Y_(n),e.context===null?e.context=n:e.pendingContext=n,e=ms(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ni(s,e,a),t!==null&&(Tr(t,s,a,i),ju(t,s,a)),a}function xd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Gy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function eg(t,e){Gy(t,e),(t=t.alternate)&&Gy(t,e)}function eT(){return null}var Z_=typeof reportError=="function"?reportError:function(t){console.error(t)};function tg(t){this._internalRoot=t}sh.prototype.render=tg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));rh(t,e,null,null)};sh.prototype.unmount=tg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Gi(function(){rh(null,t,null,null)}),e[vs]=null}};function sh(t){this._internalRoot=t}sh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Aw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<zs.length&&e!==0&&e<zs[n].priority;n++);zs.splice(n,0,t),n===0&&Rw(t)}};function ng(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ih(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ky(){}function tT(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=xd(a);i.call(d)}}var a=J_(e,r,t,0,null,!1,!1,"",Ky);return t._reactRootContainer=a,t[vs]=a.current,Vl(t.nodeType===8?t.parentNode:t),Gi(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=xd(u);l.call(d)}}var u=Zp(t,0,!1,null,null,!1,!1,"",Ky);return t._reactRootContainer=u,t[vs]=u.current,Vl(t.nodeType===8?t.parentNode:t),Gi(function(){rh(e,u,n,r)}),u}function oh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=xd(a);l.call(u)}}rh(e,a,t,s)}else a=tT(n,e,t,s,r);return xd(a)}kw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ol(e.pendingLanes);n!==0&&(_p(e,n|1),zn(e,jt()),!(Be&6)&&(la=jt()+500,wi()))}break;case 13:Gi(function(){var r=ws(t,1);if(r!==null){var s=jn();Tr(r,t,1,s)}}),eg(t,1)}};bp=function(t){if(t.tag===13){var e=ws(t,134217728);if(e!==null){var n=jn();Tr(e,t,134217728,n)}eg(t,134217728)}};Cw=function(t){if(t.tag===13){var e=si(t),n=ws(t,e);if(n!==null){var r=jn();Tr(n,t,e,r)}eg(t,e)}};Aw=function(){return nt};jw=function(t,e){var n=nt;try{return nt=t,e()}finally{nt=n}};Kf=function(t,e,n){switch(e){case"input":if($f(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Xd(r);if(!s)throw Error(J(90));lw(r),$f(r,s)}}}break;case"textarea":uw(t,n);break;case"select":e=n.value,e!=null&&Ho(t,!!n.multiple,e,!1)}};yw=Qp;xw=Gi;var nT={usingClientEntryPoint:!1,Events:[pc,Mo,Xd,pw,gw,Qp]},el={findFiberByHostInstance:Ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rT={bundleType:el.bundleType,version:el.version,rendererPackageName:el.rendererPackageName,rendererConfig:el.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_w(t),t===null?null:t.stateNode},findFiberByHostInstance:el.findFiberByHostInstance||eT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pu.isDisabled&&pu.supportsFiber)try{Wd=pu.inject(rT),$r=pu}catch{}}er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nT;er.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ng(e))throw Error(J(200));return ZN(t,e,null,n)};er.createRoot=function(t,e){if(!ng(t))throw Error(J(299));var n=!1,r="",s=Z_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Zp(t,1,!1,null,null,n,!1,r,s),t[vs]=e.current,Vl(t.nodeType===8?t.parentNode:t),new tg(e)};er.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=_w(e),t=t===null?null:t.stateNode,t};er.flushSync=function(t){return Gi(t)};er.hydrate=function(t,e,n){if(!ih(e))throw Error(J(200));return oh(null,t,e,!0,n)};er.hydrateRoot=function(t,e,n){if(!ng(t))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Z_;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=J_(e,null,t,1,n??null,s,!1,i,a),t[vs]=e.current,Vl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new sh(e)};er.render=function(t,e,n){if(!ih(e))throw Error(J(200));return oh(null,t,e,!1,n)};er.unmountComponentAtNode=function(t){if(!ih(t))throw Error(J(40));return t._reactRootContainer?(Gi(function(){oh(null,null,t,!1,function(){t._reactRootContainer=null,t[vs]=null})}),!0):!1};er.unstable_batchedUpdates=Qp;er.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ih(n))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return oh(t,e,n,!1,r)};er.version="18.3.1-next-f1338f8080-20240426";function eb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eb)}catch(t){console.error(t)}}eb(),ew.exports=er;var sT=ew.exports,tb,Qy=sT;tb=Ku.createRoot=Qy.createRoot,Ku.hydrateRoot=Qy.hydrateRoot;const iT=Object.freeze(Object.defineProperty({__proto__:null,get createRoot(){return tb},default:Ku},Symbol.toStringTag,{value:"Module"}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gl(){return Gl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gl.apply(this,arguments)}var Xs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Xs||(Xs={}));const Xy="popstate";function oT(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:a,hash:l}=r.location;return Im("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:vd(s)}return lT(e,n,null,t)}function Lt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function nb(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aT(){return Math.random().toString(36).substr(2,8)}function Yy(t,e){return{usr:t.state,key:t.key,idx:e}}function Im(t,e,n,r){return n===void 0&&(n=null),Gl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Na(e):e,{state:n,key:e&&e.key||r||aT()})}function vd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Na(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function lT(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l=Xs.Pop,u=null,d=f();d==null&&(d=0,a.replaceState(Gl({},a.state,{idx:d}),""));function f(){return(a.state||{idx:null}).idx}function m(){l=Xs.Pop;let T=f(),v=T==null?null:T-d;d=T,u&&u({action:l,location:R.location,delta:v})}function g(T,v){l=Xs.Push;let _=Im(R.location,T,v);d=f()+1;let y=Yy(_,d),A=R.createHref(_);try{a.pushState(y,"",A)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(A)}i&&u&&u({action:l,location:R.location,delta:1})}function x(T,v){l=Xs.Replace;let _=Im(R.location,T,v);d=f();let y=Yy(_,d),A=R.createHref(_);a.replaceState(y,"",A),i&&u&&u({action:l,location:R.location,delta:0})}function b(T){let v=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof T=="string"?T:vd(T);return _=_.replace(/ $/,"%20"),Lt(v,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,v)}let R={get action(){return l},get location(){return t(s,a)},listen(T){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Xy,m),u=T,()=>{s.removeEventListener(Xy,m),u=null}},createHref(T){return e(s,T)},createURL:b,encodeLocation(T){let v=b(T);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:g,replace:x,go(T){return a.go(T)}};return R}var Jy;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Jy||(Jy={}));function cT(t,e,n){return n===void 0&&(n="/"),uT(t,e,n)}function uT(t,e,n,r){let s=typeof e=="string"?Na(e):e,i=rg(s.pathname||"/",n);if(i==null)return null;let a=rb(t);dT(a);let l=null;for(let u=0;l==null&&u<a.length;++u){let d=ET(i);l=wT(a[u],d)}return l}function rb(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,a,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(Lt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=oi([r,u.relativePath]),f=n.concat(u);i.children&&i.children.length>0&&(Lt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),rb(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:xT(d,i.index),routesMeta:f})};return t.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let u of sb(i.path))s(i,a,u)}),e}function sb(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=sb(r.join("/")),l=[];return l.push(...a.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...a),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function dT(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:vT(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const hT=/^:[\w-]+$/,fT=3,mT=2,pT=1,gT=10,yT=-2,Zy=t=>t==="*";function xT(t,e){let n=t.split("/"),r=n.length;return n.some(Zy)&&(r+=yT),e&&(r+=mT),n.filter(s=>!Zy(s)).reduce((s,i)=>s+(hT.test(i)?fT:i===""?pT:gT),r)}function vT(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function wT(t,e,n){let{routesMeta:r}=t,s={},i="/",a=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=_T({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),g=u.route;if(!m)return null;Object.assign(s,m.params),a.push({params:s,pathname:oi([i,m.pathname]),pathnameBase:IT(oi([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=oi([i,m.pathnameBase]))}return a}function _T(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=bT(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,f,m)=>{let{paramName:g,isOptional:x}=f;if(g==="*"){let R=l[m]||"";a=i.slice(0,i.length-R.length).replace(/(.)\/+$/,"$1")}const b=l[m];return x&&!b?d[g]=void 0:d[g]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:t}}function bT(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),nb(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function ET(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return nb(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function rg(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function ST(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Na(t):t;return{pathname:n?n.startsWith("/")?n:NT(n,e):e,search:kT(r),hash:CT(s)}}function NT(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function xf(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function TT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ib(t,e){let n=TT(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function ob(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Na(t):(s=Gl({},t),Lt(!s.pathname||!s.pathname.includes("?"),xf("?","pathname","search",s)),Lt(!s.pathname||!s.pathname.includes("#"),xf("#","pathname","hash",s)),Lt(!s.search||!s.search.includes("#"),xf("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=n;else{let m=e.length-1;if(!r&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}l=m>=0?e[m]:"/"}let u=ST(s,l),d=a&&a!=="/"&&a.endsWith("/"),f=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}const oi=t=>t.join("/").replace(/\/\/+/g,"/"),IT=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),kT=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,CT=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function AT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const ab=["post","put","patch","delete"];new Set(ab);const jT=["get",...ab];new Set(jT);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kl(){return Kl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kl.apply(this,arguments)}const sg=S.createContext(null),RT=S.createContext(null),oo=S.createContext(null),ah=S.createContext(null),_i=S.createContext({outlet:null,matches:[],isDataRoute:!1}),lb=S.createContext(null);function PT(t,e){let{relative:n}=e===void 0?{}:e;yc()||Lt(!1);let{basename:r,navigator:s}=S.useContext(oo),{hash:i,pathname:a,search:l}=db(t,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:oi([r,a])),s.createHref({pathname:u,search:l,hash:i})}function yc(){return S.useContext(ah)!=null}function Ta(){return yc()||Lt(!1),S.useContext(ah).location}function cb(t){S.useContext(oo).static||S.useLayoutEffect(t)}function ub(){let{isDataRoute:t}=S.useContext(_i);return t?GT():DT()}function DT(){yc()||Lt(!1);let t=S.useContext(sg),{basename:e,future:n,navigator:r}=S.useContext(oo),{matches:s}=S.useContext(_i),{pathname:i}=Ta(),a=JSON.stringify(ib(s,n.v7_relativeSplatPath)),l=S.useRef(!1);return cb(()=>{l.current=!0}),S.useCallback(function(d,f){if(f===void 0&&(f={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let m=ob(d,JSON.parse(a),i,f.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:oi([e,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[e,r,a,i,t])}function OT(){let{matches:t}=S.useContext(_i),e=t[t.length-1];return e?e.params:{}}function db(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=S.useContext(oo),{matches:s}=S.useContext(_i),{pathname:i}=Ta(),a=JSON.stringify(ib(s,r.v7_relativeSplatPath));return S.useMemo(()=>ob(t,JSON.parse(a),i,n==="path"),[t,a,i,n])}function LT(t,e){return MT(t,e)}function MT(t,e,n,r){yc()||Lt(!1);let{navigator:s}=S.useContext(oo),{matches:i}=S.useContext(_i),a=i[i.length-1],l=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=Ta(),f;if(e){var m;let T=typeof e=="string"?Na(e):e;u==="/"||(m=T.pathname)!=null&&m.startsWith(u)||Lt(!1),f=T}else f=d;let g=f.pathname||"/",x=g;if(u!=="/"){let T=u.replace(/^\//,"").split("/");x="/"+g.replace(/^\//,"").split("/").slice(T.length).join("/")}let b=cT(t,{pathname:x}),R=zT(b&&b.map(T=>Object.assign({},T,{params:Object.assign({},l,T.params),pathname:oi([u,s.encodeLocation?s.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?u:oi([u,s.encodeLocation?s.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),i,n,r);return e&&R?S.createElement(ah.Provider,{value:{location:Kl({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Xs.Pop}},R):R}function VT(){let t=WT(),e=AT(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),n?S.createElement("pre",{style:s},n):null,null)}const UT=S.createElement(VT,null);class FT extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?S.createElement(_i.Provider,{value:this.props.routeContext},S.createElement(lb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function $T(t){let{routeContext:e,match:n,children:r}=t,s=S.useContext(sg);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(_i.Provider,{value:e},r)}function zT(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let f=a.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);f>=0||Lt(!1),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<a.length;f++){let m=a[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=f),m.route.id){let{loaderData:g,errors:x}=n,b=m.route.loader&&g[m.route.id]===void 0&&(!x||x[m.route.id]===void 0);if(m.route.lazy||b){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,m,g)=>{let x,b=!1,R=null,T=null;n&&(x=l&&m.route.id?l[m.route.id]:void 0,R=m.route.errorElement||UT,u&&(d<0&&g===0?(KT("route-fallback"),b=!0,T=null):d===g&&(b=!0,T=m.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,g+1)),_=()=>{let y;return x?y=R:b?y=T:m.route.Component?y=S.createElement(m.route.Component,null):m.route.element?y=m.route.element:y=f,S.createElement($T,{match:m,routeContext:{outlet:f,matches:v,isDataRoute:n!=null},children:y})};return n&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?S.createElement(FT,{location:n.location,revalidation:n.revalidation,component:R,error:x,children:_(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):_()},null)}var hb=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(hb||{}),fb=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(fb||{});function BT(t){let e=S.useContext(sg);return e||Lt(!1),e}function qT(t){let e=S.useContext(RT);return e||Lt(!1),e}function HT(t){let e=S.useContext(_i);return e||Lt(!1),e}function mb(t){let e=HT(),n=e.matches[e.matches.length-1];return n.route.id||Lt(!1),n.route.id}function WT(){var t;let e=S.useContext(lb),n=qT(),r=mb();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function GT(){let{router:t}=BT(hb.UseNavigateStable),e=mb(fb.UseNavigateStable),n=S.useRef(!1);return cb(()=>{n.current=!0}),S.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Kl({fromRouteId:e},i)))},[t,e])}const ex={};function KT(t,e,n){ex[t]||(ex[t]=!0)}function QT(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function or(t){Lt(!1)}function XT(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Xs.Pop,navigator:i,static:a=!1,future:l}=t;yc()&&Lt(!1);let u=e.replace(/^\/*/,"/"),d=S.useMemo(()=>({basename:u,navigator:i,static:a,future:Kl({v7_relativeSplatPath:!1},l)}),[u,l,i,a]);typeof r=="string"&&(r=Na(r));let{pathname:f="/",search:m="",hash:g="",state:x=null,key:b="default"}=r,R=S.useMemo(()=>{let T=rg(f,u);return T==null?null:{location:{pathname:T,search:m,hash:g,state:x,key:b},navigationType:s}},[u,f,m,g,x,b,s]);return R==null?null:S.createElement(oo.Provider,{value:d},S.createElement(ah.Provider,{children:n,value:R}))}function YT(t){let{children:e,location:n}=t;return LT(km(e),n)}new Promise(()=>{});function km(t,e){e===void 0&&(e=[]);let n=[];return S.Children.forEach(t,(r,s)=>{if(!S.isValidElement(r))return;let i=[...e,s];if(r.type===S.Fragment){n.push.apply(n,km(r.props.children,i));return}r.type!==or&&Lt(!1),!r.props.index||!r.props.children||Lt(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=km(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cm(){return Cm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Cm.apply(this,arguments)}function JT(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function ZT(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function eI(t,e){return t.button===0&&(!e||e==="_self")&&!ZT(t)}const tI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],nI="6";try{window.__reactRouterVersion=nI}catch{}const rI="startTransition",tx=GS[rI];function sI(t){let{basename:e,children:n,future:r,window:s}=t,i=S.useRef();i.current==null&&(i.current=oT({window:s,v5Compat:!0}));let a=i.current,[l,u]=S.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},f=S.useCallback(m=>{d&&tx?tx(()=>u(m)):u(m)},[u,d]);return S.useLayoutEffect(()=>a.listen(f),[a,f]),S.useEffect(()=>QT(r),[r]),S.createElement(XT,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a,future:r})}const iI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",oI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ur=S.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:a,state:l,target:u,to:d,preventScrollReset:f,viewTransition:m}=e,g=JT(e,tI),{basename:x}=S.useContext(oo),b,R=!1;if(typeof d=="string"&&oI.test(d)&&(b=d,iI))try{let y=new URL(window.location.href),A=d.startsWith("//")?new URL(y.protocol+d):new URL(d),P=rg(A.pathname,x);A.origin===y.origin&&P!=null?d=P+A.search+A.hash:R=!0}catch{}let T=PT(d,{relative:s}),v=aI(d,{replace:a,state:l,target:u,preventScrollReset:f,relative:s,viewTransition:m});function _(y){r&&r(y),y.defaultPrevented||v(y)}return S.createElement("a",Cm({},g,{href:b||T,onClick:R||i?r:_,ref:n,target:u}))});var nx;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(nx||(nx={}));var rx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(rx||(rx={}));function aI(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:a,viewTransition:l}=e===void 0?{}:e,u=ub(),d=Ta(),f=db(t,{relative:a});return S.useCallback(m=>{if(eI(m,n)){m.preventDefault();let g=r!==void 0?r:vd(d)===vd(f);u(t,{replace:g,state:s,preventScrollReset:i,relative:a,viewTransition:l})}},[d,u,f,r,s,n,t,i,a,l])}const pb=S.createContext(),gb=()=>{const t=S.useContext(pb);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},lI=({children:t})=>{const[e,n]=S.useState("salsa");S.useEffect(()=>{const i=localStorage.getItem("theme")||"salsa";n(i),document.documentElement.setAttribute("data-theme",i)},[]);const s={theme:e,changeTheme:i=>{n(i),localStorage.setItem("theme",i),document.documentElement.setAttribute("data-theme",i)},isDark:e==="dark",isLight:e==="light",isSalsa:e==="salsa"};return o.jsx(pb.Provider,{value:s,children:t})};var sx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},cI=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},xb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,m=(i&3)<<4|l>>4;let g=(l&15)<<2|d>>6,x=d&63;u||(x=64,a||(g=64)),r.push(n[f],n[m],n[g],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(yb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):cI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||m==null)throw new uI;const g=i<<2|l>>4;if(r.push(g),d!==64){const x=l<<4&240|d>>2;if(r.push(x),m!==64){const b=d<<6&192|m;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dI=function(t){const e=yb(t);return xb.encodeByteArray(e,!0)},wd=function(t){return dI(t).replace(/\./g,"")},vb=function(t){try{return xb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=()=>hI().__FIREBASE_DEFAULTS__,mI=()=>{if(typeof process>"u"||typeof sx>"u")return;const t=sx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},pI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&vb(t[1]);return e&&JSON.parse(e)},lh=()=>{try{return fI()||mI()||pI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wb=t=>{var e,n;return(n=(e=lh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},_b=t=>{const e=wb(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},bb=()=>{var t;return(t=lh())===null||t===void 0?void 0:t.config},Eb=t=>{var e;return(e=lh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[wd(JSON.stringify(n)),wd(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())}function xI(){var t;const e=(t=lh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function _I(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bI(){const t=_n();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function EI(){return!xI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SI(){try{return typeof indexedDB=="object"}catch{return!1}}function NI(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="FirebaseError";class Jr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=TI,Object.setPrototypeOf(this,Jr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xc.prototype.create)}}class xc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?II(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Jr(s,l,r)}}function II(t,e){return t.replace(kI,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const kI=/\{\$([^}]+)}/g;function CI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function _d(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(ix(i)&&ix(a)){if(!_d(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function ix(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ll(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function cl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function AI(t,e){const n=new jI(t,e);return n.subscribe.bind(n)}class jI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");RI(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=vf),s.error===void 0&&(s.error=vf),s.complete===void 0&&(s.complete=vf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function RI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function vf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function st(t){return t&&t._delegate?t._delegate:t}class fi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new gI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(OI(e))try{this.getOrInitializeService({instanceIdentifier:ji})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ji){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ji){return this.instances.has(e)}getOptions(e=ji){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:DI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ji){return this.component?this.component.multipleInstances?e:ji:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DI(t){return t===ji?void 0:t}function OI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new PI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Fe||(Fe={}));const MI={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},VI=Fe.INFO,UI={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},FI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=UI[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ig{constructor(e){this.name=e,this._logLevel=VI,this._logHandler=FI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const $I=(t,e)=>e.some(n=>t instanceof n);let ox,ax;function zI(){return ox||(ox=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BI(){return ax||(ax=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Nb=new WeakMap,Am=new WeakMap,Tb=new WeakMap,wf=new WeakMap,og=new WeakMap;function qI(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(ai(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&Nb.set(n,t)}).catch(()=>{}),og.set(e,t),e}function HI(t){if(Am.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Am.set(t,e)}let jm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Am.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Tb.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ai(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function WI(t){jm=t(jm)}function GI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_f(this),e,...n);return Tb.set(r,e.sort?e.sort():[e]),ai(r)}:BI().includes(t)?function(...e){return t.apply(_f(this),e),ai(Nb.get(this))}:function(...e){return ai(t.apply(_f(this),e))}}function KI(t){return typeof t=="function"?GI(t):(t instanceof IDBTransaction&&HI(t),$I(t,zI())?new Proxy(t,jm):t)}function ai(t){if(t instanceof IDBRequest)return qI(t);if(wf.has(t))return wf.get(t);const e=KI(t);return e!==t&&(wf.set(t,e),og.set(e,t)),e}const _f=t=>og.get(t);function QI(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=ai(a);return r&&a.addEventListener("upgradeneeded",u=>{r(ai(a.result),u.oldVersion,u.newVersion,ai(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const XI=["get","getKey","getAll","getAllKeys","count"],YI=["put","add","delete","clear"],bf=new Map;function lx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(bf.get(e))return bf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=YI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||XI.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return bf.set(e,i),i}WI(t=>({...t,get:(e,n,r)=>lx(e,n)||t.get(e,n,r),has:(e,n)=>!!lx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(ZI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function ZI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Rm="@firebase/app",cx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs=new ig("@firebase/app"),ek="@firebase/app-compat",tk="@firebase/analytics-compat",nk="@firebase/analytics",rk="@firebase/app-check-compat",sk="@firebase/app-check",ik="@firebase/auth",ok="@firebase/auth-compat",ak="@firebase/database",lk="@firebase/data-connect",ck="@firebase/database-compat",uk="@firebase/functions",dk="@firebase/functions-compat",hk="@firebase/installations",fk="@firebase/installations-compat",mk="@firebase/messaging",pk="@firebase/messaging-compat",gk="@firebase/performance",yk="@firebase/performance-compat",xk="@firebase/remote-config",vk="@firebase/remote-config-compat",wk="@firebase/storage",_k="@firebase/storage-compat",bk="@firebase/firestore",Ek="@firebase/vertexai-preview",Sk="@firebase/firestore-compat",Nk="firebase",Tk="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm="[DEFAULT]",Ik={[Rm]:"fire-core",[ek]:"fire-core-compat",[nk]:"fire-analytics",[tk]:"fire-analytics-compat",[sk]:"fire-app-check",[rk]:"fire-app-check-compat",[ik]:"fire-auth",[ok]:"fire-auth-compat",[ak]:"fire-rtdb",[lk]:"fire-data-connect",[ck]:"fire-rtdb-compat",[uk]:"fire-fn",[dk]:"fire-fn-compat",[hk]:"fire-iid",[fk]:"fire-iid-compat",[mk]:"fire-fcm",[pk]:"fire-fcm-compat",[gk]:"fire-perf",[yk]:"fire-perf-compat",[xk]:"fire-rc",[vk]:"fire-rc-compat",[wk]:"fire-gcs",[_k]:"fire-gcs-compat",[bk]:"fire-fst",[Sk]:"fire-fst-compat",[Ek]:"fire-vertex","fire-js":"fire-js",[Nk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd=new Map,kk=new Map,Dm=new Map;function ux(t,e){try{t.container.addComponent(e)}catch(n){bs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ki(t){const e=t.name;if(Dm.has(e))return bs.debug(`There were multiple attempts to register component ${e}.`),!1;Dm.set(e,t);for(const n of bd.values())ux(n,t);for(const n of kk.values())ux(n,t);return!0}function ch(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Er(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},li=new xc("app","Firebase",Ck);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw li.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao=Tk;function Ib(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Pm,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw li.create("bad-app-name",{appName:String(s)});if(n||(n=bb()),!n)throw li.create("no-options");const i=bd.get(s);if(i){if(_d(n,i.options)&&_d(r,i.config))return i;throw li.create("duplicate-app",{appName:s})}const a=new LI(s);for(const u of Dm.values())a.addComponent(u);const l=new Ak(n,r,a);return bd.set(s,l),l}function ag(t=Pm){const e=bd.get(t);if(!e&&t===Pm&&bb())return Ib();if(!e)throw li.create("no-app",{appName:t});return e}function Br(t,e,n){var r;let s=(r=Ik[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bs.warn(l.join(" "));return}Ki(new fi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk="firebase-heartbeat-database",Rk=1,Ql="firebase-heartbeat-store";let Ef=null;function kb(){return Ef||(Ef=QI(jk,Rk,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ql)}catch(n){console.warn(n)}}}}).catch(t=>{throw li.create("idb-open",{originalErrorMessage:t.message})})),Ef}async function Pk(t){try{const n=(await kb()).transaction(Ql),r=await n.objectStore(Ql).get(Cb(t));return await n.done,r}catch(e){if(e instanceof Jr)bs.warn(e.message);else{const n=li.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});bs.warn(n.message)}}}async function dx(t,e){try{const r=(await kb()).transaction(Ql,"readwrite");await r.objectStore(Ql).put(e,Cb(t)),await r.done}catch(n){if(n instanceof Jr)bs.warn(n.message);else{const r=li.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});bs.warn(r.message)}}}function Cb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=1024,Ok=30*24*60*60*1e3;class Lk{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Vk(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=hx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Ok}),this._storage.overwrite(this._heartbeatsCache))}catch(r){bs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=hx(),{heartbeatsToSend:r,unsentEntries:s}=Mk(this._heartbeatsCache.heartbeats),i=wd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return bs.warn(n),""}}}function hx(){return new Date().toISOString().substring(0,10)}function Mk(t,e=Dk){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),fx(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),fx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Vk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SI()?NI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Pk(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return dx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return dx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function fx(t){return wd(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(t){Ki(new fi("platform-logger",e=>new JI(e),"PRIVATE")),Ki(new fi("heartbeat",e=>new Lk(e),"PRIVATE")),Br(Rm,cx,t),Br(Rm,cx,"esm2017"),Br("fire-js","")}Uk("");var Fk="firebase",$k="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Br(Fk,$k,"app");function lg(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Ab(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zk=Ab,jb=new xc("auth","Firebase",Ab());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed=new ig("@firebase/auth");function Bk(t,...e){Ed.logLevel<=Fe.WARN&&Ed.warn(`Auth (${ao}): ${t}`,...e)}function Vu(t,...e){Ed.logLevel<=Fe.ERROR&&Ed.error(`Auth (${ao}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t,...e){throw ug(t,...e)}function Ir(t,...e){return ug(t,...e)}function cg(t,e,n){const r=Object.assign(Object.assign({},zk()),{[e]:n});return new xc("auth","Firebase",r).create(e,{appName:t.name})}function ps(t){return cg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qk(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&pr(t,"argument-error"),cg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ug(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return jb.create(t,...e)}function Ie(t,e,...n){if(!t)throw ug(e,...n)}function us(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Vu(e),new Error(e)}function Es(t,e){t||us(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Hk(){return mx()==="http:"||mx()==="https:"}function mx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Hk()||wI()||"connection"in navigator)?navigator.onLine:!0}function Gk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Es(n>e,"Short delay should be less than long delay!"),this.isMobile=yI()||_I()}get(){return Wk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dg(t,e){Es(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;us("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;us("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;us("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk=new wc(3e4,6e4);function As(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Zr(t,e,n,r,s={}){return Pb(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=vc(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return vI()||(d.referrerPolicy="no-referrer"),Rb.fetch()(Db(t,t.config.apiHost,n,l),d)})}async function Pb(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Kk),e);try{const s=new Yk(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw gu(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw gu(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw gu(t,"user-disabled",a);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw cg(t,f,d);pr(t,f)}}catch(s){if(s instanceof Jr)throw s;pr(t,"network-request-failed",{message:String(s)})}}async function _c(t,e,n,r,s={}){const i=await Zr(t,e,n,r,s);return"mfaPendingCredential"in i&&pr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Db(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?dg(t.config,s):`${t.config.apiScheme}://${s}`}function Xk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Yk{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ir(this.auth,"network-request-failed")),Qk.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function gu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Ir(t,e,r);return s.customData._tokenResponse=n,s}function px(t){return t!==void 0&&t.enterprise!==void 0}class Jk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Xk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Zk(t,e){return Zr(t,"GET","/v2/recaptchaConfig",As(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eC(t,e){return Zr(t,"POST","/v1/accounts:delete",e)}async function Ob(t,e){return Zr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function tC(t,e=!1){const n=st(t),r=await n.getIdToken(e),s=hg(r);Ie(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:El(Sf(s.auth_time)),issuedAtTime:El(Sf(s.iat)),expirationTime:El(Sf(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Sf(t){return Number(t)*1e3}function hg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Vu("JWT malformed, contained fewer than 3 sections"),null;try{const s=vb(n);return s?JSON.parse(s):(Vu("Failed to decode base64 JWT payload"),null)}catch(s){return Vu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function gx(t){const e=hg(t);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ca(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Jr&&nC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function nC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=El(this.lastLoginAt),this.creationTime=El(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sd(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ca(t,Ob(n,{idToken:r}));Ie(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Lb(i.providerUserInfo):[],l=iC(t.providerData,a),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),f=u?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Lm(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,m)}async function sC(t){const e=st(t);await Sd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iC(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Lb(t){return t.map(e=>{var{providerId:n}=e,r=lg(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oC(t,e){const n=await Pb(t,{},async()=>{const r=vc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=Db(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Rb.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function aC(t,e){return Zr(t,"POST","/v2/accounts:revokeToken",As(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ie(e.length!==0,"internal-error");const n=gx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await oC(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new Yo;return r&&(Ie(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(Ie(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Ie(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yo,this.toJSON())}_performRefresh(){return us("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(t,e){Ie(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ds{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=lg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new rC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Lm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ca(this,this.stsTokenManager.getToken(this.auth,e));return Ie(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return tC(this,e)}reload(){return sC(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ds(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Sd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Er(this.auth.app))return Promise.reject(ps(this.auth));const e=await this.getIdToken();return await ca(this,eC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,l,u,d,f;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(s=n.email)!==null&&s!==void 0?s:void 0,x=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,b=(a=n.photoURL)!==null&&a!==void 0?a:void 0,R=(l=n.tenantId)!==null&&l!==void 0?l:void 0,T=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,v=(d=n.createdAt)!==null&&d!==void 0?d:void 0,_=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:y,emailVerified:A,isAnonymous:P,providerData:O,stsTokenManager:N}=n;Ie(y&&N,e,"internal-error");const w=Yo.fromJSON(this.name,N);Ie(typeof y=="string",e,"internal-error"),Us(m,e.name),Us(g,e.name),Ie(typeof A=="boolean",e,"internal-error"),Ie(typeof P=="boolean",e,"internal-error"),Us(x,e.name),Us(b,e.name),Us(R,e.name),Us(T,e.name),Us(v,e.name),Us(_,e.name);const I=new ds({uid:y,auth:e,email:g,emailVerified:A,displayName:m,isAnonymous:P,photoURL:b,phoneNumber:x,tenantId:R,stsTokenManager:w,createdAt:v,lastLoginAt:_});return O&&Array.isArray(O)&&(I.providerData=O.map(k=>Object.assign({},k))),T&&(I._redirectEventId=T),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new Yo;s.updateFromServerResponse(n);const i=new ds({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Sd(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Ie(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Lb(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Yo;l.updateFromIdToken(r);const u=new ds({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Lm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=new Map;function hs(t){Es(t instanceof Function,"Expected a class definition");let e=yx.get(t);return e?(Es(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,yx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Mb.type="NONE";const xx=Mb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(t,e,n){return`firebase:${t}:${e}:${n}`}class Jo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Uu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Uu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ds._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Jo(hs(xx),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||hs(xx);const a=Uu(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const f=await d._get(a);if(f){const m=ds._fromJSON(e,f);d!==i&&(l=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Jo(i,e,r):(i=u[0],l&&await i._set(a,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new Jo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($b(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Vb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Bb(e))return"Blackberry";if(qb(e))return"Webos";if(Ub(e))return"Safari";if((e.includes("chrome/")||Fb(e))&&!e.includes("edge/"))return"Chrome";if(zb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Vb(t=_n()){return/firefox\//i.test(t)}function Ub(t=_n()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fb(t=_n()){return/crios\//i.test(t)}function $b(t=_n()){return/iemobile/i.test(t)}function zb(t=_n()){return/android/i.test(t)}function Bb(t=_n()){return/blackberry/i.test(t)}function qb(t=_n()){return/webos/i.test(t)}function fg(t=_n()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function lC(t=_n()){var e;return fg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function cC(){return bI()&&document.documentMode===10}function Hb(t=_n()){return fg(t)||zb(t)||qb(t)||Bb(t)||/windows phone/i.test(t)||$b(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(t,e=[]){let n;switch(t){case"Browser":n=vx(_n());break;case"Worker":n=`${vx(_n())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ao}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,l)=>{try{const u=e(i);a(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(t,e={}){return Zr(t,"GET","/v2/passwordPolicy",As(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC=6;class fC{constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:hC,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new wx(this),this.idTokenSubscription=new wx(this),this.beforeStateQueue=new uC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=hs(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Jo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ob(this,{idToken:e}),r=await ds._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Er(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Sd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Gk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Er(this.app))return Promise.reject(ps(this));const n=e?st(e):null;return n&&Ie(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Er(this.app)?Promise.reject(ps(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Er(this.app)?Promise.reject(ps(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(hs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await dC(this),n=new fC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await aC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&hs(e)||this._popupRedirectResolver;Ie(n,this,"argument-error"),this.redirectPersistenceManager=await Jo.create(this,[hs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(l,this,"internal-error"),l.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Bk(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function js(t){return st(t)}class wx{constructor(e){this.auth=e,this.observer=null,this.addObserver=AI(n=>this.observer=n)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pC(t){uh=t}function Gb(t){return uh.loadJS(t)}function gC(){return uh.recaptchaEnterpriseScript}function yC(){return uh.gapiScript}function xC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const vC="recaptcha-enterprise",wC="NO_RECAPTCHA";class _C{constructor(e){this.type=vC,this.auth=js(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,l)=>{Zk(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new Jk(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,a(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,a,l){const u=window.grecaptcha;px(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{a(d)}).catch(()=>{a(wC)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{r(this.auth).then(l=>{if(!n&&px(window.grecaptcha))s(l,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=gC();u.length!==0&&(u+=l),Gb(u).then(()=>{s(l,i,a)}).catch(d=>{a(d)})}}).catch(l=>{a(l)})})}}async function _x(t,e,n,r=!1){const s=new _C(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Nd(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await _x(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await _x(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t,e){const n=ch(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(_d(i,e??{}))return s;pr(s,"already-initialized")}return n.initialize({options:e})}function EC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(hs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function SC(t,e,n){const r=js(t);Ie(r._canInitEmulator,r,"emulator-config-failed"),Ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Kb(e),{host:a,port:l}=NC(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${a}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),TC()}function Kb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function NC(t){const e=Kb(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:bx(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:bx(a)}}}function bx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function TC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return us("not implemented")}_getIdTokenResponse(e){return us("not implemented")}_linkToIdToken(e,n){return us("not implemented")}_getReauthenticationResolver(e){return us("not implemented")}}async function IC(t,e){return Zr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kC(t,e){return _c(t,"POST","/v1/accounts:signInWithPassword",As(t,e))}async function CC(t,e){return Zr(t,"POST","/v1/accounts:sendOobCode",As(t,e))}async function AC(t,e){return CC(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jC(t,e){return _c(t,"POST","/v1/accounts:signInWithEmailLink",As(t,e))}async function RC(t,e){return _c(t,"POST","/v1/accounts:signInWithEmailLink",As(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl extends mg{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Xl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Xl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nd(e,n,"signInWithPassword",kC);case"emailLink":return jC(e,{email:this._email,oobCode:this._password});default:pr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nd(e,r,"signUpPassword",IC);case"emailLink":return RC(e,{idToken:n,email:this._email,oobCode:this._password});default:pr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zo(t,e){return _c(t,"POST","/v1/accounts:signInWithIdp",As(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC="http://localhost";class Qi extends mg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Qi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):pr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=lg(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new Qi(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Zo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Zo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Zo(e,n)}buildRequest(){const e={requestUri:PC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=vc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function OC(t){const e=ll(cl(t)).link,n=e?ll(cl(e)).deep_link_id:null,r=ll(cl(t)).deep_link_id;return(r?ll(cl(r)).link:null)||r||n||e||t}class pg{constructor(e){var n,r,s,i,a,l;const u=ll(cl(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,m=DC((s=u.mode)!==null&&s!==void 0?s:null);Ie(d&&f&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=f,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=u.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=OC(e);try{return new pg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(){this.providerId=Ia.PROVIDER_ID}static credential(e,n){return Xl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=pg.parseLink(n);return Ie(r,"argument-error"),Xl._fromEmailAndCode(e,r.code,r.tenantId)}}Ia.PROVIDER_ID="password";Ia.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ia.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc extends gg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs extends bc{constructor(){super("facebook.com")}static credential(e){return Qi._fromParams({providerId:qs.PROVIDER_ID,signInMethod:qs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qs.credentialFromTaggedObject(e)}static credentialFromError(e){return qs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qs.credential(e.oauthAccessToken)}catch{return null}}}qs.FACEBOOK_SIGN_IN_METHOD="facebook.com";qs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os extends bc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Qi._fromParams({providerId:os.PROVIDER_ID,signInMethod:os.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return os.credentialFromTaggedObject(e)}static credentialFromError(e){return os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return os.credential(n,r)}catch{return null}}}os.GOOGLE_SIGN_IN_METHOD="google.com";os.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends bc{constructor(){super("github.com")}static credential(e){return Qi._fromParams({providerId:Hs.PROVIDER_ID,signInMethod:Hs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hs.credentialFromTaggedObject(e)}static credentialFromError(e){return Hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hs.credential(e.oauthAccessToken)}catch{return null}}}Hs.GITHUB_SIGN_IN_METHOD="github.com";Hs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends bc{constructor(){super("twitter.com")}static credential(e,n){return Qi._fromParams({providerId:Ws.PROVIDER_ID,signInMethod:Ws.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ws.credentialFromTaggedObject(e)}static credentialFromError(e){return Ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ws.credential(n,r)}catch{return null}}}Ws.TWITTER_SIGN_IN_METHOD="twitter.com";Ws.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LC(t,e){return _c(t,"POST","/v1/accounts:signUp",As(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await ds._fromIdTokenResponse(e,r,s),a=Ex(r);return new Xi({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Ex(r);return new Xi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Ex(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td extends Jr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Td.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Td(e,n,r,s)}}function Qb(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Td._fromErrorAndOperation(t,i,e,r):i})}async function MC(t,e,n=!1){const r=await ca(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Xi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VC(t,e,n=!1){const{auth:r}=t;if(Er(r.app))return Promise.reject(ps(r));const s="reauthenticate";try{const i=await ca(t,Qb(r,s,e,t),n);Ie(i.idToken,r,"internal-error");const a=hg(i.idToken);Ie(a,r,"internal-error");const{sub:l}=a;return Ie(t.uid===l,r,"user-mismatch"),Xi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&pr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xb(t,e,n=!1){if(Er(t.app))return Promise.reject(ps(t));const r="signIn",s=await Qb(t,r,e),i=await Xi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function UC(t,e){return Xb(js(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yb(t){const e=js(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function FC(t,e,n){const r=js(t);await Nd(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",AC)}async function $C(t,e,n){if(Er(t.app))return Promise.reject(ps(t));const r=js(t),a=await Nd(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",LC).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Yb(t),u}),l=await Xi._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function zC(t,e,n){return Er(t.app)?Promise.reject(ps(t)):UC(st(t),Ia.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Yb(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BC(t,e){return Zr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qC(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=st(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},a=await ca(r,BC(r.auth,i));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const l=r.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function HC(t,e,n,r){return st(t).onIdTokenChanged(e,n,r)}function WC(t,e,n){return st(t).beforeAuthStateChanged(e,n)}function GC(t,e,n,r){return st(t).onAuthStateChanged(e,n,r)}function KC(t){return st(t).signOut()}const Id="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Id,"1"),this.storage.removeItem(Id),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=1e3,XC=10;class Zb extends Jb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Hb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);cC()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,XC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},QC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Zb.type="LOCAL";const YC=Zb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE extends Jb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}eE.type="SESSION";const tE=eE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new dh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async d=>d(n.origin,i)),u=await JC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,u)=>{const d=yg("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(){return window}function eA(t){qr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){return typeof qr().WorkerGlobalScope<"u"&&typeof qr().importScripts=="function"}async function tA(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nA(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function rA(){return nE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="firebaseLocalStorageDb",sA=1,kd="firebaseLocalStorage",sE="fbase_key";class Ec{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function hh(t,e){return t.transaction([kd],e?"readwrite":"readonly").objectStore(kd)}function iA(){const t=indexedDB.deleteDatabase(rE);return new Ec(t).toPromise()}function Mm(){const t=indexedDB.open(rE,sA);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(kd,{keyPath:sE})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(kd)?e(r):(r.close(),await iA(),e(await Mm()))})})}async function Sx(t,e,n){const r=hh(t,!0).put({[sE]:e,value:n});return new Ec(r).toPromise()}async function oA(t,e){const n=hh(t,!1).get(e),r=await new Ec(n).toPromise();return r===void 0?null:r.value}function Nx(t,e){const n=hh(t,!0).delete(e);return new Ec(n).toPromise()}const aA=800,lA=3;class iE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>lA)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dh._getInstance(rA()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await tA(),!this.activeServiceWorker)return;this.sender=new ZC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mm();return await Sx(e,Id,"1"),await Nx(e,Id),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Sx(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>oA(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Nx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=hh(s,!1).getAll();return new Ec(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iE.type="LOCAL";const cA=iE;new wc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t,e){return e?hs(e):(Ie(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg extends mg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Zo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Zo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Zo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function uA(t){return Xb(t.auth,new xg(t),t.bypassAuthState)}function dA(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),VC(n,new xg(t),t.bypassAuthState)}async function hA(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),MC(n,new xg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uA;case"linkViaPopup":case"linkViaRedirect":return hA;case"reauthViaPopup":case"reauthViaRedirect":return dA;default:pr(this.auth,"internal-error")}}resolve(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=new wc(2e3,1e4);async function mA(t,e,n){if(Er(t.app))return Promise.reject(Ir(t,"operation-not-supported-in-this-environment"));const r=js(t);qk(t,e,gg);const s=oE(r,n);return new Oi(r,"signInViaPopup",e,s).executeNotNull()}class Oi extends aE{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Oi.currentPopupAction&&Oi.currentPopupAction.cancel(),Oi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){Es(this.filter.length===1,"Popup operations only handle one event");const e=yg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ir(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ir(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Oi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ir(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fA.get())};e()}}Oi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="pendingRedirect",Fu=new Map;class gA extends aE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Fu.get(this.auth._key());if(!e){try{const r=await yA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Fu.set(this.auth._key(),e)}return this.bypassAuthState||Fu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yA(t,e){const n=wA(e),r=vA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function xA(t,e){Fu.set(t._key(),e)}function vA(t){return hs(t._redirectPersistence)}function wA(t){return Uu(pA,t.config.apiKey,t.name)}async function _A(t,e,n=!1){if(Er(t.app))return Promise.reject(ps(t));const r=js(t),s=oE(r,e),a=await new gA(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA=10*60*1e3;class EA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!SA(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!lE(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ir(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=bA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Tx(e))}saveEventToCache(e){this.cachedEventUids.add(Tx(e)),this.lastProcessedEventTime=Date.now()}}function Tx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function SA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NA(t,e={}){return Zr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IA=/^https?/;async function kA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await NA(t);for(const n of e)try{if(CA(n))return}catch{}pr(t,"unauthorized-domain")}function CA(t){const e=Om(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!IA.test(n))return!1;if(TA.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=new wc(3e4,6e4);function Ix(){const t=qr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function jA(t){return new Promise((e,n)=>{var r,s,i;function a(){Ix(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ix(),n(Ir(t,"network-request-failed"))},timeout:AA.get()})}if(!((s=(r=qr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=qr().gapi)===null||i===void 0)&&i.load)a();else{const l=xC("iframefcb");return qr()[l]=()=>{gapi.load?a():n(Ir(t,"network-request-failed"))},Gb(`${yC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw $u=null,e})}let $u=null;function RA(t){return $u=$u||jA(t),$u}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=new wc(5e3,15e3),DA="__/auth/iframe",OA="emulator/auth/iframe",LA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},MA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function VA(t){const e=t.config;Ie(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?dg(e,OA):`https://${t.config.authDomain}/${DA}`,r={apiKey:e.apiKey,appName:t.name,v:ao},s=MA.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${vc(r).slice(1)}`}async function UA(t){const e=await RA(t),n=qr().gapi;return Ie(n,t,"internal-error"),e.open({where:document.body,url:VA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:LA,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=Ir(t,"network-request-failed"),l=qr().setTimeout(()=>{i(a)},PA.get());function u(){qr().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$A=500,zA=600,BA="_blank",qA="http://localhost";class kx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function HA(t,e,n,r=$A,s=zA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},FA),{width:r.toString(),height:s.toString(),top:i,left:a}),d=_n().toLowerCase();n&&(l=Fb(d)?BA:n),Vb(d)&&(e=e||qA,u.scrollbars="yes");const f=Object.entries(u).reduce((g,[x,b])=>`${g}${x}=${b},`,"");if(lC(d)&&l!=="_self")return WA(e||"",l),new kx(null);const m=window.open(e||"",l,f);Ie(m,t,"popup-blocked");try{m.focus()}catch{}return new kx(m)}function WA(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="__/auth/handler",KA="emulator/auth/handler",QA=encodeURIComponent("fac");async function Cx(t,e,n,r,s,i){Ie(t.config.authDomain,t,"auth-domain-config-required"),Ie(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ao,eventId:s};if(e instanceof gg){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",CI(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))a[f]=m}if(e instanceof bc){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await t._getAppCheckToken(),d=u?`#${QA}=${encodeURIComponent(u)}`:"";return`${XA(t)}?${vc(l).slice(1)}${d}`}function XA({config:t}){return t.emulator?dg(t,KA):`https://${t.authDomain}/${GA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="webStorageSupport";class YA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tE,this._completeRedirectFn=_A,this._overrideRedirectResult=xA}async _openPopup(e,n,r,s){var i;Es((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await Cx(e,n,r,Om(),s);return HA(e,a,yg())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Cx(e,n,r,Om(),s);return eA(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Es(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await UA(e),r=new EA(e);return n.register("authEvent",s=>(Ie(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Nf,{type:Nf},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Nf];a!==void 0&&n(!!a),pr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=kA(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Hb()||Ub()||fg()}}const JA=YA;var Ax="@firebase/auth",jx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ej(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tj(t){Ki(new fi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;Ie(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wb(t)},d=new mC(r,s,i,u);return EC(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ki(new fi("auth-internal",e=>{const n=js(e.getProvider("auth").getImmediate());return(r=>new ZA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Br(Ax,jx,ej(t)),Br(Ax,jx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj=5*60,rj=Eb("authIdTokenMaxAge")||nj;let Rx=null;const sj=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>rj)return;const s=n==null?void 0:n.token;Rx!==s&&(Rx=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function ij(t=ag()){const e=ch(t,"auth");if(e.isInitialized())return e.getImmediate();const n=bC(t,{popupRedirectResolver:JA,persistence:[cA,YC,tE]}),r=Eb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=sj(i.toString());WC(n,a,()=>a(n.currentUser)),HC(n,l=>a(l))}}const s=wb("auth");return s&&SC(n,`http://${s}`),n}function oj(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}pC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Ir("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",oj().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tj("Browser");var Px=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $i,cE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,w){function I(){}I.prototype=w.prototype,N.D=w.prototype,N.prototype=new I,N.prototype.constructor=N,N.C=function(k,D,L){for(var j=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)j[ce-2]=arguments[ce];return w.prototype[D].apply(k,j)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,w,I){I||(I=0);var k=Array(16);if(typeof w=="string")for(var D=0;16>D;++D)k[D]=w.charCodeAt(I++)|w.charCodeAt(I++)<<8|w.charCodeAt(I++)<<16|w.charCodeAt(I++)<<24;else for(D=0;16>D;++D)k[D]=w[I++]|w[I++]<<8|w[I++]<<16|w[I++]<<24;w=N.g[0],I=N.g[1],D=N.g[2];var L=N.g[3],j=w+(L^I&(D^L))+k[0]+3614090360&4294967295;w=I+(j<<7&4294967295|j>>>25),j=L+(D^w&(I^D))+k[1]+3905402710&4294967295,L=w+(j<<12&4294967295|j>>>20),j=D+(I^L&(w^I))+k[2]+606105819&4294967295,D=L+(j<<17&4294967295|j>>>15),j=I+(w^D&(L^w))+k[3]+3250441966&4294967295,I=D+(j<<22&4294967295|j>>>10),j=w+(L^I&(D^L))+k[4]+4118548399&4294967295,w=I+(j<<7&4294967295|j>>>25),j=L+(D^w&(I^D))+k[5]+1200080426&4294967295,L=w+(j<<12&4294967295|j>>>20),j=D+(I^L&(w^I))+k[6]+2821735955&4294967295,D=L+(j<<17&4294967295|j>>>15),j=I+(w^D&(L^w))+k[7]+4249261313&4294967295,I=D+(j<<22&4294967295|j>>>10),j=w+(L^I&(D^L))+k[8]+1770035416&4294967295,w=I+(j<<7&4294967295|j>>>25),j=L+(D^w&(I^D))+k[9]+2336552879&4294967295,L=w+(j<<12&4294967295|j>>>20),j=D+(I^L&(w^I))+k[10]+4294925233&4294967295,D=L+(j<<17&4294967295|j>>>15),j=I+(w^D&(L^w))+k[11]+2304563134&4294967295,I=D+(j<<22&4294967295|j>>>10),j=w+(L^I&(D^L))+k[12]+1804603682&4294967295,w=I+(j<<7&4294967295|j>>>25),j=L+(D^w&(I^D))+k[13]+4254626195&4294967295,L=w+(j<<12&4294967295|j>>>20),j=D+(I^L&(w^I))+k[14]+2792965006&4294967295,D=L+(j<<17&4294967295|j>>>15),j=I+(w^D&(L^w))+k[15]+1236535329&4294967295,I=D+(j<<22&4294967295|j>>>10),j=w+(D^L&(I^D))+k[1]+4129170786&4294967295,w=I+(j<<5&4294967295|j>>>27),j=L+(I^D&(w^I))+k[6]+3225465664&4294967295,L=w+(j<<9&4294967295|j>>>23),j=D+(w^I&(L^w))+k[11]+643717713&4294967295,D=L+(j<<14&4294967295|j>>>18),j=I+(L^w&(D^L))+k[0]+3921069994&4294967295,I=D+(j<<20&4294967295|j>>>12),j=w+(D^L&(I^D))+k[5]+3593408605&4294967295,w=I+(j<<5&4294967295|j>>>27),j=L+(I^D&(w^I))+k[10]+38016083&4294967295,L=w+(j<<9&4294967295|j>>>23),j=D+(w^I&(L^w))+k[15]+3634488961&4294967295,D=L+(j<<14&4294967295|j>>>18),j=I+(L^w&(D^L))+k[4]+3889429448&4294967295,I=D+(j<<20&4294967295|j>>>12),j=w+(D^L&(I^D))+k[9]+568446438&4294967295,w=I+(j<<5&4294967295|j>>>27),j=L+(I^D&(w^I))+k[14]+3275163606&4294967295,L=w+(j<<9&4294967295|j>>>23),j=D+(w^I&(L^w))+k[3]+4107603335&4294967295,D=L+(j<<14&4294967295|j>>>18),j=I+(L^w&(D^L))+k[8]+1163531501&4294967295,I=D+(j<<20&4294967295|j>>>12),j=w+(D^L&(I^D))+k[13]+2850285829&4294967295,w=I+(j<<5&4294967295|j>>>27),j=L+(I^D&(w^I))+k[2]+4243563512&4294967295,L=w+(j<<9&4294967295|j>>>23),j=D+(w^I&(L^w))+k[7]+1735328473&4294967295,D=L+(j<<14&4294967295|j>>>18),j=I+(L^w&(D^L))+k[12]+2368359562&4294967295,I=D+(j<<20&4294967295|j>>>12),j=w+(I^D^L)+k[5]+4294588738&4294967295,w=I+(j<<4&4294967295|j>>>28),j=L+(w^I^D)+k[8]+2272392833&4294967295,L=w+(j<<11&4294967295|j>>>21),j=D+(L^w^I)+k[11]+1839030562&4294967295,D=L+(j<<16&4294967295|j>>>16),j=I+(D^L^w)+k[14]+4259657740&4294967295,I=D+(j<<23&4294967295|j>>>9),j=w+(I^D^L)+k[1]+2763975236&4294967295,w=I+(j<<4&4294967295|j>>>28),j=L+(w^I^D)+k[4]+1272893353&4294967295,L=w+(j<<11&4294967295|j>>>21),j=D+(L^w^I)+k[7]+4139469664&4294967295,D=L+(j<<16&4294967295|j>>>16),j=I+(D^L^w)+k[10]+3200236656&4294967295,I=D+(j<<23&4294967295|j>>>9),j=w+(I^D^L)+k[13]+681279174&4294967295,w=I+(j<<4&4294967295|j>>>28),j=L+(w^I^D)+k[0]+3936430074&4294967295,L=w+(j<<11&4294967295|j>>>21),j=D+(L^w^I)+k[3]+3572445317&4294967295,D=L+(j<<16&4294967295|j>>>16),j=I+(D^L^w)+k[6]+76029189&4294967295,I=D+(j<<23&4294967295|j>>>9),j=w+(I^D^L)+k[9]+3654602809&4294967295,w=I+(j<<4&4294967295|j>>>28),j=L+(w^I^D)+k[12]+3873151461&4294967295,L=w+(j<<11&4294967295|j>>>21),j=D+(L^w^I)+k[15]+530742520&4294967295,D=L+(j<<16&4294967295|j>>>16),j=I+(D^L^w)+k[2]+3299628645&4294967295,I=D+(j<<23&4294967295|j>>>9),j=w+(D^(I|~L))+k[0]+4096336452&4294967295,w=I+(j<<6&4294967295|j>>>26),j=L+(I^(w|~D))+k[7]+1126891415&4294967295,L=w+(j<<10&4294967295|j>>>22),j=D+(w^(L|~I))+k[14]+2878612391&4294967295,D=L+(j<<15&4294967295|j>>>17),j=I+(L^(D|~w))+k[5]+4237533241&4294967295,I=D+(j<<21&4294967295|j>>>11),j=w+(D^(I|~L))+k[12]+1700485571&4294967295,w=I+(j<<6&4294967295|j>>>26),j=L+(I^(w|~D))+k[3]+2399980690&4294967295,L=w+(j<<10&4294967295|j>>>22),j=D+(w^(L|~I))+k[10]+4293915773&4294967295,D=L+(j<<15&4294967295|j>>>17),j=I+(L^(D|~w))+k[1]+2240044497&4294967295,I=D+(j<<21&4294967295|j>>>11),j=w+(D^(I|~L))+k[8]+1873313359&4294967295,w=I+(j<<6&4294967295|j>>>26),j=L+(I^(w|~D))+k[15]+4264355552&4294967295,L=w+(j<<10&4294967295|j>>>22),j=D+(w^(L|~I))+k[6]+2734768916&4294967295,D=L+(j<<15&4294967295|j>>>17),j=I+(L^(D|~w))+k[13]+1309151649&4294967295,I=D+(j<<21&4294967295|j>>>11),j=w+(D^(I|~L))+k[4]+4149444226&4294967295,w=I+(j<<6&4294967295|j>>>26),j=L+(I^(w|~D))+k[11]+3174756917&4294967295,L=w+(j<<10&4294967295|j>>>22),j=D+(w^(L|~I))+k[2]+718787259&4294967295,D=L+(j<<15&4294967295|j>>>17),j=I+(L^(D|~w))+k[9]+3951481745&4294967295,N.g[0]=N.g[0]+w&4294967295,N.g[1]=N.g[1]+(D+(j<<21&4294967295|j>>>11))&4294967295,N.g[2]=N.g[2]+D&4294967295,N.g[3]=N.g[3]+L&4294967295}r.prototype.u=function(N,w){w===void 0&&(w=N.length);for(var I=w-this.blockSize,k=this.B,D=this.h,L=0;L<w;){if(D==0)for(;L<=I;)s(this,N,L),L+=this.blockSize;if(typeof N=="string"){for(;L<w;)if(k[D++]=N.charCodeAt(L++),D==this.blockSize){s(this,k),D=0;break}}else for(;L<w;)if(k[D++]=N[L++],D==this.blockSize){s(this,k),D=0;break}}this.h=D,this.o+=w},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var w=1;w<N.length-8;++w)N[w]=0;var I=8*this.o;for(w=N.length-8;w<N.length;++w)N[w]=I&255,I/=256;for(this.u(N),N=Array(16),w=I=0;4>w;++w)for(var k=0;32>k;k+=8)N[I++]=this.g[w]>>>k&255;return N};function i(N,w){var I=l;return Object.prototype.hasOwnProperty.call(I,N)?I[N]:I[N]=w(N)}function a(N,w){this.h=w;for(var I=[],k=!0,D=N.length-1;0<=D;D--){var L=N[D]|0;k&&L==w||(I[D]=L,k=!1)}this.g=I}var l={};function u(N){return-128<=N&&128>N?i(N,function(w){return new a([w|0],0>w?-1:0)}):new a([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return m;if(0>N)return T(d(-N));for(var w=[],I=1,k=0;N>=I;k++)w[k]=N/I|0,I*=4294967296;return new a(w,0)}function f(N,w){if(N.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(N.charAt(0)=="-")return T(f(N.substring(1),w));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(w,8)),k=m,D=0;D<N.length;D+=8){var L=Math.min(8,N.length-D),j=parseInt(N.substring(D,D+L),w);8>L?(L=d(Math.pow(w,L)),k=k.j(L).add(d(j))):(k=k.j(I),k=k.add(d(j)))}return k}var m=u(0),g=u(1),x=u(16777216);t=a.prototype,t.m=function(){if(R(this))return-T(this).m();for(var N=0,w=1,I=0;I<this.g.length;I++){var k=this.i(I);N+=(0<=k?k:4294967296+k)*w,w*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(b(this))return"0";if(R(this))return"-"+T(this).toString(N);for(var w=d(Math.pow(N,6)),I=this,k="";;){var D=A(I,w).g;I=v(I,D.j(w));var L=((0<I.g.length?I.g[0]:I.h)>>>0).toString(N);if(I=D,b(I))return L+k;for(;6>L.length;)L="0"+L;k=L+k}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function b(N){if(N.h!=0)return!1;for(var w=0;w<N.g.length;w++)if(N.g[w]!=0)return!1;return!0}function R(N){return N.h==-1}t.l=function(N){return N=v(this,N),R(N)?-1:b(N)?0:1};function T(N){for(var w=N.g.length,I=[],k=0;k<w;k++)I[k]=~N.g[k];return new a(I,~N.h).add(g)}t.abs=function(){return R(this)?T(this):this},t.add=function(N){for(var w=Math.max(this.g.length,N.g.length),I=[],k=0,D=0;D<=w;D++){var L=k+(this.i(D)&65535)+(N.i(D)&65535),j=(L>>>16)+(this.i(D)>>>16)+(N.i(D)>>>16);k=j>>>16,L&=65535,j&=65535,I[D]=j<<16|L}return new a(I,I[I.length-1]&-2147483648?-1:0)};function v(N,w){return N.add(T(w))}t.j=function(N){if(b(this)||b(N))return m;if(R(this))return R(N)?T(this).j(T(N)):T(T(this).j(N));if(R(N))return T(this.j(T(N)));if(0>this.l(x)&&0>N.l(x))return d(this.m()*N.m());for(var w=this.g.length+N.g.length,I=[],k=0;k<2*w;k++)I[k]=0;for(k=0;k<this.g.length;k++)for(var D=0;D<N.g.length;D++){var L=this.i(k)>>>16,j=this.i(k)&65535,ce=N.i(D)>>>16,H=N.i(D)&65535;I[2*k+2*D]+=j*H,_(I,2*k+2*D),I[2*k+2*D+1]+=L*H,_(I,2*k+2*D+1),I[2*k+2*D+1]+=j*ce,_(I,2*k+2*D+1),I[2*k+2*D+2]+=L*ce,_(I,2*k+2*D+2)}for(k=0;k<w;k++)I[k]=I[2*k+1]<<16|I[2*k];for(k=w;k<2*w;k++)I[k]=0;return new a(I,0)};function _(N,w){for(;(N[w]&65535)!=N[w];)N[w+1]+=N[w]>>>16,N[w]&=65535,w++}function y(N,w){this.g=N,this.h=w}function A(N,w){if(b(w))throw Error("division by zero");if(b(N))return new y(m,m);if(R(N))return w=A(T(N),w),new y(T(w.g),T(w.h));if(R(w))return w=A(N,T(w)),new y(T(w.g),w.h);if(30<N.g.length){if(R(N)||R(w))throw Error("slowDivide_ only works with positive integers.");for(var I=g,k=w;0>=k.l(N);)I=P(I),k=P(k);var D=O(I,1),L=O(k,1);for(k=O(k,2),I=O(I,2);!b(k);){var j=L.add(k);0>=j.l(N)&&(D=D.add(I),L=j),k=O(k,1),I=O(I,1)}return w=v(N,D.j(w)),new y(D,w)}for(D=m;0<=N.l(w);){for(I=Math.max(1,Math.floor(N.m()/w.m())),k=Math.ceil(Math.log(I)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),L=d(I),j=L.j(w);R(j)||0<j.l(N);)I-=k,L=d(I),j=L.j(w);b(L)&&(L=g),D=D.add(L),N=v(N,j)}return new y(D,N)}t.A=function(N){return A(this,N).h},t.and=function(N){for(var w=Math.max(this.g.length,N.g.length),I=[],k=0;k<w;k++)I[k]=this.i(k)&N.i(k);return new a(I,this.h&N.h)},t.or=function(N){for(var w=Math.max(this.g.length,N.g.length),I=[],k=0;k<w;k++)I[k]=this.i(k)|N.i(k);return new a(I,this.h|N.h)},t.xor=function(N){for(var w=Math.max(this.g.length,N.g.length),I=[],k=0;k<w;k++)I[k]=this.i(k)^N.i(k);return new a(I,this.h^N.h)};function P(N){for(var w=N.g.length+1,I=[],k=0;k<w;k++)I[k]=N.i(k)<<1|N.i(k-1)>>>31;return new a(I,N.h)}function O(N,w){var I=w>>5;w%=32;for(var k=N.g.length-I,D=[],L=0;L<k;L++)D[L]=0<w?N.i(L+I)>>>w|N.i(L+I+1)<<32-w:N.i(L+I);return new a(D,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,cE=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,$i=a}).apply(typeof Px<"u"?Px:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uE,ul,dE,zu,Vm,hE,fE,mE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,h,p){return c==Array.prototype||c==Object.prototype||(c[h]=p.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var h=0;h<c.length;++h){var p=c[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(c,h){if(h)e:{var p=r;c=c.split(".");for(var E=0;E<c.length-1;E++){var M=c[E];if(!(M in p))break e;p=p[M]}c=c[c.length-1],E=p[c],h=h(E),h!=E&&h!=null&&e(p,c,{configurable:!0,writable:!0,value:h})}}function i(c,h){c instanceof String&&(c+="");var p=0,E=!1,M={next:function(){if(!E&&p<c.length){var F=p++;return{value:h(F,c[F]),done:!1}}return E=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(c){return c||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(c){var h=typeof c;return h=h!="object"?h:c?Array.isArray(c)?"array":h:"null",h=="array"||h=="object"&&typeof c.length=="number"}function d(c){var h=typeof c;return h=="object"&&c!=null||h=="function"}function f(c,h,p){return c.call.apply(c.bind,arguments)}function m(c,h,p){if(!c)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,E),c.apply(h,M)}}return function(){return c.apply(h,arguments)}}function g(c,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function x(c,h){var p=Array.prototype.slice.call(arguments,1);return function(){var E=p.slice();return E.push.apply(E,arguments),c.apply(this,E)}}function b(c,h){function p(){}p.prototype=h.prototype,c.aa=h.prototype,c.prototype=new p,c.prototype.constructor=c,c.Qb=function(E,M,F){for(var se=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)se[lt-2]=arguments[lt];return h.prototype[M].apply(E,se)}}function R(c){const h=c.length;if(0<h){const p=Array(h);for(let E=0;E<h;E++)p[E]=c[E];return p}return[]}function T(c,h){for(let p=1;p<arguments.length;p++){const E=arguments[p];if(u(E)){const M=c.length||0,F=E.length||0;c.length=M+F;for(let se=0;se<F;se++)c[M+se]=E[se]}else c.push(E)}}class v{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function _(c){return/^[\s\xa0]*$/.test(c)}function y(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function A(c){return A[" "](c),c}A[" "]=function(){};var P=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function O(c,h,p){for(const E in c)h.call(p,c[E],E,c)}function N(c,h){for(const p in c)h.call(void 0,c[p],p,c)}function w(c){const h={};for(const p in c)h[p]=c[p];return h}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(c,h){let p,E;for(let M=1;M<arguments.length;M++){E=arguments[M];for(p in E)c[p]=E[p];for(let F=0;F<I.length;F++)p=I[F],Object.prototype.hasOwnProperty.call(E,p)&&(c[p]=E[p])}}function D(c){var h=1;c=c.split(":");const p=[];for(;0<h&&c.length;)p.push(c.shift()),h--;return c.length&&p.push(c.join(":")),p}function L(c){l.setTimeout(()=>{throw c},0)}function j(){var c=B;let h=null;return c.g&&(h=c.g,c.g=c.g.next,c.g||(c.h=null),h.next=null),h}class ce{constructor(){this.h=this.g=null}add(h,p){const E=H.get();E.set(h,p),this.h?this.h.next=E:this.g=E,this.h=E}}var H=new v(()=>new me,c=>c.reset());class me{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,G=!1,B=new ce,ae=()=>{const c=l.Promise.resolve(void 0);ue=()=>{c.then(we)}};var we=()=>{for(var c;c=j();){try{c.h.call(c.g)}catch(p){L(p)}var h=H;h.j(c),100>h.h&&(h.h++,c.next=h.g,h.g=c)}G=!1};function q(){this.s=this.s,this.C=this.C}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(c,h){this.type=c,this.g=this.target=h,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var ie=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,h=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const p=()=>{};l.addEventListener("test",p,h),l.removeEventListener("test",p,h)}catch{}return c}();function _e(c,h){if(Y.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var p=this.type=c.type,E=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=h,h=c.relatedTarget){if(P){e:{try{A(h.nodeName);var M=!0;break e}catch{}M=!1}M||(h=null)}}else p=="mouseover"?h=c.fromElement:p=="mouseout"&&(h=c.toElement);this.relatedTarget=h,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:ve[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&_e.aa.h.call(this)}}b(_e,Y);var ve={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Se="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function V(c,h,p,E,M){this.listener=c,this.proxy=null,this.src=h,this.type=p,this.capture=!!E,this.ha=M,this.key=++Qe,this.da=this.fa=!1}function le(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function oe(c){this.src=c,this.g={},this.h=0}oe.prototype.add=function(c,h,p,E,M){var F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);var se=pe(c,h,E,M);return-1<se?(h=c[se],p||(h.fa=!1)):(h=new V(h,this.src,F,!!E,M),h.fa=p,c.push(h)),h};function be(c,h){var p=h.type;if(p in c.g){var E=c.g[p],M=Array.prototype.indexOf.call(E,h,void 0),F;(F=0<=M)&&Array.prototype.splice.call(E,M,1),F&&(le(h),c.g[p].length==0&&(delete c.g[p],c.h--))}}function pe(c,h,p,E){for(var M=0;M<c.length;++M){var F=c[M];if(!F.da&&F.listener==h&&F.capture==!!p&&F.ha==E)return M}return-1}var Ae="closure_lm_"+(1e6*Math.random()|0),Le={};function Xe(c,h,p,E,M){if(Array.isArray(h)){for(var F=0;F<h.length;F++)Xe(c,h[F],p,E,M);return null}return p=vt(p),c&&c[Se]?c.K(h,p,d(E)?!!E.capture:!1,M):he(c,h,p,!1,E,M)}function he(c,h,p,E,M,F){if(!h)throw Error("Invalid event type");var se=d(M)?!!M.capture:!!M,lt=Tt(c);if(lt||(c[Ae]=lt=new oe(c)),p=lt.add(h,p,E,se,F),p.proxy)return p;if(E=Oe(),p.proxy=E,E.src=c,E.listener=p,c.addEventListener)ie||(M=se),M===void 0&&(M=!1),c.addEventListener(h.toString(),E,M);else if(c.attachEvent)c.attachEvent(Mt(h.toString()),E);else if(c.addListener&&c.removeListener)c.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Oe(){function c(p){return h.call(c.src,c.listener,p)}const h=Nt;return c}function Ke(c,h,p,E,M){if(Array.isArray(h))for(var F=0;F<h.length;F++)Ke(c,h[F],p,E,M);else E=d(E)?!!E.capture:!!E,p=vt(p),c&&c[Se]?(c=c.i,h=String(h).toString(),h in c.g&&(F=c.g[h],p=pe(F,p,E,M),-1<p&&(le(F[p]),Array.prototype.splice.call(F,p,1),F.length==0&&(delete c.g[h],c.h--)))):c&&(c=Tt(c))&&(h=c.g[h.toString()],c=-1,h&&(c=pe(h,p,E,M)),(p=-1<c?h[c]:null)&&qe(p))}function qe(c){if(typeof c!="number"&&c&&!c.da){var h=c.src;if(h&&h[Se])be(h.i,c);else{var p=c.type,E=c.proxy;h.removeEventListener?h.removeEventListener(p,E,c.capture):h.detachEvent?h.detachEvent(Mt(p),E):h.addListener&&h.removeListener&&h.removeListener(E),(p=Tt(h))?(be(p,c),p.h==0&&(p.src=null,h[Ae]=null)):le(c)}}}function Mt(c){return c in Le?Le[c]:Le[c]="on"+c}function Nt(c,h){if(c.da)c=!0;else{h=new _e(h,this);var p=c.listener,E=c.ha||c.src;c.fa&&qe(c),c=p.call(E,h)}return c}function Tt(c){return c=c[Ae],c instanceof oe?c:null}var it="__closure_events_fn_"+(1e9*Math.random()>>>0);function vt(c){return typeof c=="function"?c:(c[it]||(c[it]=function(h){return c.handleEvent(h)}),c[it])}function Me(){q.call(this),this.i=new oe(this),this.M=this,this.F=null}b(Me,q),Me.prototype[Se]=!0,Me.prototype.removeEventListener=function(c,h,p,E){Ke(this,c,h,p,E)};function je(c,h){var p,E=c.F;if(E)for(p=[];E;E=E.F)p.push(E);if(c=c.M,E=h.type||h,typeof h=="string")h=new Y(h,c);else if(h instanceof Y)h.target=h.target||c;else{var M=h;h=new Y(E,c),k(h,M)}if(M=!0,p)for(var F=p.length-1;0<=F;F--){var se=h.g=p[F];M=gt(se,E,!0,h)&&M}if(se=h.g=c,M=gt(se,E,!0,h)&&M,M=gt(se,E,!1,h)&&M,p)for(F=0;F<p.length;F++)se=h.g=p[F],M=gt(se,E,!1,h)&&M}Me.prototype.N=function(){if(Me.aa.N.call(this),this.i){var c=this.i,h;for(h in c.g){for(var p=c.g[h],E=0;E<p.length;E++)le(p[E]);delete c.g[h],c.h--}}this.F=null},Me.prototype.K=function(c,h,p,E){return this.i.add(String(c),h,!1,p,E)},Me.prototype.L=function(c,h,p,E){return this.i.add(String(c),h,!0,p,E)};function gt(c,h,p,E){if(h=c.i.g[String(h)],!h)return!0;h=h.concat();for(var M=!0,F=0;F<h.length;++F){var se=h[F];if(se&&!se.da&&se.capture==p){var lt=se.listener,Jt=se.ha||se.src;se.fa&&be(c.i,se),M=lt.call(Jt,E)!==!1&&M}}return M&&!E.defaultPrevented}function Bn(c,h,p){if(typeof c=="function")p&&(c=g(c,p));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(c,h||0)}function Qt(c){c.g=Bn(()=>{c.g=null,c.i&&(c.i=!1,Qt(c))},c.l);const h=c.h;c.h=null,c.m.apply(null,h)}class Z extends q{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Qt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bt(c){q.call(this),this.h=c,this.g={}}b(Bt,q);var bn=[];function He(c){O(c.g,function(h,p){this.g.hasOwnProperty(p)&&qe(h)},c),c.g={}}Bt.prototype.N=function(){Bt.aa.N.call(this),He(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var an=l.JSON.stringify,nr=l.JSON.parse,Rr=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function re(){}re.prototype.h=null;function Te(c){return c.h||(c.h=c.i())}function En(){}var wt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $(){Y.call(this,"d")}b($,Y);function ne(){Y.call(this,"c")}b(ne,Y);var te={},X=null;function Ye(){return X=X||new Me}te.La="serverreachability";function ln(c){Y.call(this,te.La,c)}b(ln,Y);function qt(c){const h=Ye();je(h,new ln(h))}te.STAT_EVENT="statevent";function Pr(c,h){Y.call(this,te.STAT_EVENT,c),this.stat=h}b(Pr,Y);function It(c){const h=Ye();je(h,new Pr(h,c))}te.Ma="timingevent";function Rs(c,h){Y.call(this,te.Ma,c),this.size=h}b(Rs,Y);function Dr(c,h){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},h)}function es(){this.g=!0}es.prototype.xa=function(){this.g=!1};function fo(c,h,p,E,M,F){c.info(function(){if(c.g)if(F)for(var se="",lt=F.split("&"),Jt=0;Jt<lt.length;Jt++){var We=lt[Jt].split("=");if(1<We.length){var un=We[0];We=We[1];var dn=un.split("_");se=2<=dn.length&&dn[1]=="type"?se+(un+"="+We+"&"):se+(un+"=redacted&")}}else se=null;else se=F;return"XMLHTTP REQ ("+E+") [attempt "+M+"]: "+h+`
`+p+`
`+se})}function mo(c,h,p,E,M,F,se){c.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+M+"]: "+h+`
`+p+`
`+F+" "+se})}function K(c,h,p,E){c.info(function(){return"XMLHTTP TEXT ("+h+"): "+ct(c,p)+(E?" "+E:"")})}function Ne(c,h){c.info(function(){return"TIMEOUT: "+h})}es.prototype.info=function(){};function ct(c,h){if(!c.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(c=0;c<p.length;c++)if(Array.isArray(p[c])){var E=p[c];if(!(2>E.length)){var M=E[1];if(Array.isArray(M)&&!(1>M.length)){var F=M[0];if(F!="noop"&&F!="stop"&&F!="close")for(var se=1;se<M.length;se++)M[se]=""}}}}return an(p)}catch{return h}}var ht={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Sn;function ts(){}b(ts,re),ts.prototype.g=function(){return new XMLHttpRequest},ts.prototype.i=function(){return{}},Sn=new ts;function Or(c,h,p,E){this.j=c,this.i=h,this.l=p,this.R=E||1,this.U=new Bt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $c}function $c(){this.i=null,this.g="",this.h=!1}var zc={},La={};function Ma(c,h,p){c.L=1,c.v=Ds(Xt(h)),c.m=p,c.P=!0,Bc(c,null)}function Bc(c,h){c.F=Date.now(),po(c),c.A=Xt(c.v);var p=c.A,E=c.R;Array.isArray(E)||(E=[String(E)]),yr(p.i,"t",E),c.C=0,p=c.j.J,c.h=new $c,c.g=O0(c.j,p?h:null,!c.m),0<c.O&&(c.M=new Z(g(c.Y,c,c.g),c.O)),h=c.U,p=c.g,E=c.ca;var M="readystatechange";Array.isArray(M)||(M&&(bn[0]=M.toString()),M=bn);for(var F=0;F<M.length;F++){var se=Xe(p,M[F],E||h.handleEvent,!1,h.h||h);if(!se)break;h.g[se.key]=se}h=c.H?w(c.H):{},c.m?(c.u||(c.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,h)):(c.u="GET",c.g.ea(c.A,c.u,null,h)),qt(),fo(c.i,c.u,c.A,c.l,c.R,c.m)}Or.prototype.ca=function(c){c=c.target;const h=this.M;h&&ns(c)==3?h.j():this.Y(c)},Or.prototype.Y=function(c){try{if(c==this.g)e:{const dn=ns(this.g);var h=this.g.Ba();const No=this.g.Z();if(!(3>dn)&&(dn!=3||this.g&&(this.h.h||this.g.oa()||S0(this.g)))){this.J||dn!=4||h==7||(h==8||0>=No?qt(3):qt(2)),go(this);var p=this.g.Z();this.X=p;t:if(Va(this)){var E=S0(this.g);c="";var M=E.length,F=ns(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){rr(this),Ps(this);var se="";break t}this.h.i=new l.TextDecoder}for(h=0;h<M;h++)this.h.h=!0,c+=this.h.i.decode(E[h],{stream:!(F&&h==M-1)});E.length=0,this.h.g+=c,this.C=0,se=this.h.g}else se=this.g.oa();if(this.o=p==200,mo(this.i,this.u,this.A,this.l,this.R,dn,p),this.o){if(this.T&&!this.K){t:{if(this.g){var lt,Jt=this.g;if((lt=Jt.g?Jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(lt)){var We=lt;break t}}We=null}if(p=We)K(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fa(this,p);else{this.o=!1,this.s=3,It(12),rr(this),Ps(this);break e}}if(this.P){p=!0;let xr;for(;!this.J&&this.C<se.length;)if(xr=Mh(this,se),xr==La){dn==4&&(this.s=4,It(14),p=!1),K(this.i,this.l,null,"[Incomplete Response]");break}else if(xr==zc){this.s=4,It(15),K(this.i,this.l,se,"[Invalid Chunk]"),p=!1;break}else K(this.i,this.l,xr,null),Fa(this,xr);if(Va(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dn!=4||se.length!=0||this.h.h||(this.s=1,It(16),p=!1),this.o=this.o&&p,!p)K(this.i,this.l,se,"[Invalid Chunked Response]"),rr(this),Ps(this);else if(0<se.length&&!this.W){this.W=!0;var un=this.j;un.g==this&&un.ba&&!un.M&&(un.j.info("Great, no buffering proxy detected. Bytes received: "+se.length),Bh(un),un.M=!0,It(11))}}else K(this.i,this.l,se,null),Fa(this,se);dn==4&&rr(this),this.o&&!this.J&&(dn==4?j0(this.j,this):(this.o=!1,po(this)))}else TS(this.g),p==400&&0<se.indexOf("Unknown SID")?(this.s=3,It(12)):(this.s=0,It(13)),rr(this),Ps(this)}}}catch{}finally{}};function Va(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Mh(c,h){var p=c.C,E=h.indexOf(`
`,p);return E==-1?La:(p=Number(h.substring(p,E)),isNaN(p)?zc:(E+=1,E+p>h.length?La:(h=h.slice(E,E+p),c.C=E+p,h)))}Or.prototype.cancel=function(){this.J=!0,rr(this)};function po(c){c.S=Date.now()+c.I,Ua(c,c.I)}function Ua(c,h){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Dr(g(c.ba,c),h)}function go(c){c.B&&(l.clearTimeout(c.B),c.B=null)}Or.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Ne(this.i,this.A),this.L!=2&&(qt(),It(17)),rr(this),this.s=2,Ps(this)):Ua(this,this.S-c)};function Ps(c){c.j.G==0||c.J||j0(c.j,c)}function rr(c){go(c);var h=c.M;h&&typeof h.ma=="function"&&h.ma(),c.M=null,He(c.U),c.g&&(h=c.g,c.g=null,h.abort(),h.ma())}function Fa(c,h){try{var p=c.j;if(p.G!=0&&(p.g==c||xo(p.h,c))){if(!c.K&&xo(p.h,c)&&p.G==3){try{var E=p.Da.g.parse(h)}catch{E=null}if(Array.isArray(E)&&E.length==3){var M=E;if(M[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<c.F)Xc(p),Kc(p);else break e;zh(p),It(18)}}else p.za=M[1],0<p.za-p.T&&37500>M[2]&&p.F&&p.v==0&&!p.C&&(p.C=Dr(g(p.Za,p),6e3));if(1>=yo(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Ii(p,11)}else if((c.K||p.g==c)&&Xc(p),!_(h))for(M=p.Da.g.parse(h),h=0;h<M.length;h++){let We=M[h];if(p.T=We[0],We=We[1],p.G==2)if(We[0]=="c"){p.K=We[1],p.ia=We[2];const un=We[3];un!=null&&(p.la=un,p.j.info("VER="+p.la));const dn=We[4];dn!=null&&(p.Aa=dn,p.j.info("SVER="+p.Aa));const No=We[5];No!=null&&typeof No=="number"&&0<No&&(E=1.5*No,p.L=E,p.j.info("backChannelRequestTimeoutMs_="+E)),E=p;const xr=c.g;if(xr){const Jc=xr.g?xr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jc){var F=E.h;F.g||Jc.indexOf("spdy")==-1&&Jc.indexOf("quic")==-1&&Jc.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(vo(F,F.h),F.h=null))}if(E.D){const qh=xr.g?xr.g.getResponseHeader("X-HTTP-Session-Id"):null;qh&&(E.ya=qh,et(E.I,E.D,qh))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-c.F,p.j.info("Handshake RTT: "+p.R+"ms")),E=p;var se=c;if(E.qa=D0(E,E.J?E.ia:null,E.W),se.K){C(E.h,se);var lt=se,Jt=E.L;Jt&&(lt.I=Jt),lt.B&&(go(lt),po(lt)),E.g=se}else C0(E);0<p.i.length&&Qc(p)}else We[0]!="stop"&&We[0]!="close"||Ii(p,7);else p.G==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?Ii(p,7):$h(p):We[0]!="noop"&&p.l&&p.l.ta(We),p.v=0)}}qt(4)}catch{}}var Vh=class{constructor(c,h){this.g=c,this.map=h}};function qc(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ni(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function yo(c){return c.h?1:c.g?c.g.size:0}function xo(c,h){return c.h?c.h==h:c.g?c.g.has(h):!1}function vo(c,h){c.g?c.g.add(h):c.h=h}function C(c,h){c.h&&c.h==h?c.h=null:c.g&&c.g.has(h)&&c.g.delete(h)}qc.prototype.cancel=function(){if(this.i=U(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function U(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let h=c.i;for(const p of c.g.values())h=h.concat(p.D);return h}return R(c.i)}function ee(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var h=[],p=c.length,E=0;E<p;E++)h.push(c[E]);return h}h=[],p=0;for(E in c)h[p++]=c[E];return h}function fe(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var h=[];c=c.length;for(var p=0;p<c;p++)h.push(p);return h}h=[],p=0;for(const E in c)h[p++]=E;return h}}}function ke(c,h){if(c.forEach&&typeof c.forEach=="function")c.forEach(h,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,h,void 0);else for(var p=fe(c),E=ee(c),M=E.length,F=0;F<M;F++)h.call(void 0,E[F],p&&p[F],c)}var ot=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Je(c,h){if(c){c=c.split("&");for(var p=0;p<c.length;p++){var E=c[p].indexOf("="),M=null;if(0<=E){var F=c[p].substring(0,E);M=c[p].substring(E+1)}else F=c[p];h(F,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Ze(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Ze){this.h=c.h,sr(this,c.j),this.o=c.o,this.g=c.g,Nn(this,c.s),this.l=c.l;var h=c.i,p=new Rt;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),wo(this,p),this.m=c.m}else c&&(h=String(c).match(ot))?(this.h=!1,sr(this,h[1]||"",!0),this.o=Ti(h[2]||""),this.g=Ti(h[3]||"",!0),Nn(this,h[4]),this.l=Ti(h[5]||"",!0),wo(this,h[6]||"",!0),this.m=Ti(h[7]||"")):(this.h=!1,this.i=new Rt(null,this.h))}Ze.prototype.toString=function(){var c=[],h=this.j;h&&c.push(Os(h,_o,!0),":");var p=this.g;return(p||h=="file")&&(c.push("//"),(h=this.o)&&c.push(Os(h,_o,!0),"@"),c.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&c.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(Os(p,p.charAt(0)=="/"?Uh:bo,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",Os(p,$e)),c.join("")};function Xt(c){return new Ze(c)}function sr(c,h,p){c.j=p?Ti(h,!0):h,c.j&&(c.j=c.j.replace(/:$/,""))}function Nn(c,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);c.s=h}else c.s=null}function wo(c,h,p){h instanceof Rt?(c.i=h,vS(c.i,c.h)):(p||(h=Os(h,Eo)),c.i=new Rt(h,c.h))}function et(c,h,p){c.i.set(h,p)}function Ds(c){return et(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ti(c,h){return c?h?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Os(c,h,p){return typeof c=="string"?(c=encodeURI(c).replace(h,$a),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function $a(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var _o=/[#\/\?@]/g,bo=/[#\?:]/g,Uh=/[#\?]/g,Eo=/[#\?@]/g,$e=/#/g;function Rt(c,h){this.h=this.g=null,this.i=c||null,this.j=!!h}function Vt(c){c.g||(c.g=new Map,c.h=0,c.i&&Je(c.i,function(h,p){c.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=Rt.prototype,t.add=function(c,h){Vt(this),this.i=null,c=ir(this,c);var p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(h),this.h+=1,this};function Yt(c,h){Vt(c),h=ir(c,h),c.g.has(h)&&(c.i=null,c.h-=c.g.get(h).length,c.g.delete(h))}function cn(c,h){return Vt(c),h=ir(c,h),c.g.has(h)}t.forEach=function(c,h){Vt(this),this.g.forEach(function(p,E){p.forEach(function(M){c.call(h,M,E,this)},this)},this)},t.na=function(){Vt(this);const c=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let E=0;E<h.length;E++){const M=c[E];for(let F=0;F<M.length;F++)p.push(h[E])}return p},t.V=function(c){Vt(this);let h=[];if(typeof c=="string")cn(this,c)&&(h=h.concat(this.g.get(ir(this,c))));else{c=Array.from(this.g.values());for(let p=0;p<c.length;p++)h=h.concat(c[p])}return h},t.set=function(c,h){return Vt(this),this.i=null,c=ir(this,c),cn(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[h]),this.h+=1,this},t.get=function(c,h){return c?(c=this.V(c),0<c.length?String(c[0]):h):h};function yr(c,h,p){Yt(c,h),0<p.length&&(c.i=null,c.g.set(ir(c,h),R(p)),c.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var E=h[p];const F=encodeURIComponent(String(E)),se=this.V(E);for(E=0;E<se.length;E++){var M=F;se[E]!==""&&(M+="="+encodeURIComponent(String(se[E]))),c.push(M)}}return this.i=c.join("&")};function ir(c,h){return h=String(h),c.j&&(h=h.toLowerCase()),h}function vS(c,h){h&&!c.j&&(Vt(c),c.i=null,c.g.forEach(function(p,E){var M=E.toLowerCase();E!=M&&(Yt(this,E),yr(this,M,p))},c)),c.j=h}function wS(c,h){const p=new es;if(l.Image){const E=new Image;E.onload=x(Ls,p,"TestLoadImage: loaded",!0,h,E),E.onerror=x(Ls,p,"TestLoadImage: error",!1,h,E),E.onabort=x(Ls,p,"TestLoadImage: abort",!1,h,E),E.ontimeout=x(Ls,p,"TestLoadImage: timeout",!1,h,E),l.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=c}else h(!1)}function _S(c,h){const p=new es,E=new AbortController,M=setTimeout(()=>{E.abort(),Ls(p,"TestPingServer: timeout",!1,h)},1e4);fetch(c,{signal:E.signal}).then(F=>{clearTimeout(M),F.ok?Ls(p,"TestPingServer: ok",!0,h):Ls(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(M),Ls(p,"TestPingServer: error",!1,h)})}function Ls(c,h,p,E,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),E(p)}catch{}}function bS(){this.g=new Rr}function ES(c,h,p){const E=p||"";try{ke(c,function(M,F){let se=M;d(M)&&(se=an(M)),h.push(E+F+"="+encodeURIComponent(se))})}catch(M){throw h.push(E+"type="+encodeURIComponent("_badmap")),M}}function Hc(c){this.l=c.Ub||null,this.j=c.eb||!1}b(Hc,re),Hc.prototype.g=function(){return new Wc(this.l,this.j)},Hc.prototype.i=function(c){return function(){return c}}({});function Wc(c,h){Me.call(this),this.D=c,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(Wc,Me),t=Wc.prototype,t.open=function(c,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=h,this.readyState=1,Ba(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(h.body=c),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,za(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Ba(this)),this.g&&(this.readyState=3,Ba(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;x0(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function x0(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var h=c.value?c.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!c.done}))&&(this.response=this.responseText+=h)}c.done?za(this):Ba(this),this.readyState==3&&x0(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,za(this))},t.Qa=function(c){this.g&&(this.response=c,za(this))},t.ga=function(){this.g&&za(this)};function za(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Ba(c)}t.setRequestHeader=function(c,h){this.u.append(c,h)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=h.next();return c.join(`\r
`)};function Ba(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Wc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function v0(c){let h="";return O(c,function(p,E){h+=E,h+=":",h+=p,h+=`\r
`}),h}function Fh(c,h,p){e:{for(E in p){var E=!1;break e}E=!0}E||(p=v0(p),typeof c=="string"?p!=null&&encodeURIComponent(String(p)):et(c,h,p))}function kt(c){Me.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(kt,Me);var SS=/^https?$/i,NS=["POST","PUT"];t=kt.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,h,p,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);h=h?h.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Sn.g(),this.v=this.o?Te(this.o):Te(Sn),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(c),!0),this.B=!1}catch(F){w0(this,F);return}if(c=p||"",p=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var M in E)p.set(M,E[M]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const F of E.keys())p.set(F,E.get(F));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(p.keys()).find(F=>F.toLowerCase()=="content-type"),M=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(NS,h,void 0))||E||M||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,se]of p)this.g.setRequestHeader(F,se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{E0(this),this.u=!0,this.g.send(c),this.u=!1}catch(F){w0(this,F)}};function w0(c,h){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=h,c.m=5,_0(c),Gc(c)}function _0(c){c.A||(c.A=!0,je(c,"complete"),je(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,je(this,"complete"),je(this,"abort"),Gc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gc(this,!0)),kt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?b0(this):this.bb())},t.bb=function(){b0(this)};function b0(c){if(c.h&&typeof a<"u"&&(!c.v[1]||ns(c)!=4||c.Z()!=2)){if(c.u&&ns(c)==4)Bn(c.Ea,0,c);else if(je(c,"readystatechange"),ns(c)==4){c.h=!1;try{const se=c.Z();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var E;if(E=se===0){var M=String(c.D).match(ot)[1]||null;!M&&l.self&&l.self.location&&(M=l.self.location.protocol.slice(0,-1)),E=!SS.test(M?M.toLowerCase():"")}p=E}if(p)je(c,"complete"),je(c,"success");else{c.m=6;try{var F=2<ns(c)?c.g.statusText:""}catch{F=""}c.l=F+" ["+c.Z()+"]",_0(c)}}finally{Gc(c)}}}}function Gc(c,h){if(c.g){E0(c);const p=c.g,E=c.v[0]?()=>{}:null;c.g=null,c.v=null,h||je(c,"ready");try{p.onreadystatechange=E}catch{}}}function E0(c){c.I&&(l.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function ns(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<ns(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var h=this.g.responseText;return c&&h.indexOf(c)==0&&(h=h.substring(c.length)),nr(h)}};function S0(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function TS(c){const h={};c=(c.g&&2<=ns(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<c.length;E++){if(_(c[E]))continue;var p=D(c[E]);const M=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const F=h[M]||[];h[M]=F,F.push(p)}N(h,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function qa(c,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||h}function N0(c){this.Aa=0,this.i=[],this.j=new es,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=qa("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=qa("baseRetryDelayMs",5e3,c),this.cb=qa("retryDelaySeedMs",1e4,c),this.Wa=qa("forwardChannelMaxRetries",2,c),this.wa=qa("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new qc(c&&c.concurrentRequestLimit),this.Da=new bS,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=N0.prototype,t.la=8,t.G=1,t.connect=function(c,h,p,E){It(0),this.W=c,this.H=h||{},p&&E!==void 0&&(this.H.OSID=p,this.H.OAID=E),this.F=this.X,this.I=D0(this,null,this.W),Qc(this)};function $h(c){if(T0(c),c.G==3){var h=c.U++,p=Xt(c.I);if(et(p,"SID",c.K),et(p,"RID",h),et(p,"TYPE","terminate"),Ha(c,p),h=new Or(c,c.j,h),h.L=2,h.v=Ds(Xt(p)),p=!1,l.navigator&&l.navigator.sendBeacon)try{p=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&l.Image&&(new Image().src=h.v,p=!0),p||(h.g=O0(h.j,null),h.g.ea(h.v)),h.F=Date.now(),po(h)}P0(c)}function Kc(c){c.g&&(Bh(c),c.g.cancel(),c.g=null)}function T0(c){Kc(c),c.u&&(l.clearTimeout(c.u),c.u=null),Xc(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function Qc(c){if(!Ni(c.h)&&!c.s){c.s=!0;var h=c.Ga;ue||ae(),G||(ue(),G=!0),B.add(h,c),c.B=0}}function IS(c,h){return yo(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=h.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Dr(g(c.Ga,c,h),R0(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const M=new Or(this,this.j,c);let F=this.o;if(this.S&&(F?(F=w(F),k(F,this.S)):F=this.S),this.m!==null||this.O||(M.H=F,F=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var E=this.i[p];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(h+=E,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=k0(this,M,h),p=Xt(this.I),et(p,"RID",c),et(p,"CVER",22),this.D&&et(p,"X-HTTP-Session-Id",this.D),Ha(this,p),F&&(this.O?h="headers="+encodeURIComponent(String(v0(F)))+"&"+h:this.m&&Fh(p,this.m,F)),vo(this.h,M),this.Ua&&et(p,"TYPE","init"),this.P?(et(p,"$req",h),et(p,"SID","null"),M.T=!0,Ma(M,p,null)):Ma(M,p,h),this.G=2}}else this.G==3&&(c?I0(this,c):this.i.length==0||Ni(this.h)||I0(this))};function I0(c,h){var p;h?p=h.l:p=c.U++;const E=Xt(c.I);et(E,"SID",c.K),et(E,"RID",p),et(E,"AID",c.T),Ha(c,E),c.m&&c.o&&Fh(E,c.m,c.o),p=new Or(c,c.j,p,c.B+1),c.m===null&&(p.H=c.o),h&&(c.i=h.D.concat(c.i)),h=k0(c,p,1e3),p.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),vo(c.h,p),Ma(p,E,h)}function Ha(c,h){c.H&&O(c.H,function(p,E){et(h,E,p)}),c.l&&ke({},function(p,E){et(h,E,p)})}function k0(c,h,p){p=Math.min(c.i.length,p);var E=c.l?g(c.l.Na,c.l,c):null;e:{var M=c.i;let F=-1;for(;;){const se=["count="+p];F==-1?0<p?(F=M[0].g,se.push("ofs="+F)):F=0:se.push("ofs="+F);let lt=!0;for(let Jt=0;Jt<p;Jt++){let We=M[Jt].g;const un=M[Jt].map;if(We-=F,0>We)F=Math.max(0,M[Jt].g-100),lt=!1;else try{ES(un,se,"req"+We+"_")}catch{E&&E(un)}}if(lt){E=se.join("&");break e}}}return c=c.i.splice(0,p),h.D=c,E}function C0(c){if(!c.g&&!c.u){c.Y=1;var h=c.Fa;ue||ae(),G||(ue(),G=!0),B.add(h,c),c.v=0}}function zh(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Dr(g(c.Fa,c),R0(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,A0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Dr(g(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,It(10),Kc(this),A0(this))};function Bh(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function A0(c){c.g=new Or(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var h=Xt(c.qa);et(h,"RID","rpc"),et(h,"SID",c.K),et(h,"AID",c.T),et(h,"CI",c.F?"0":"1"),!c.F&&c.ja&&et(h,"TO",c.ja),et(h,"TYPE","xmlhttp"),Ha(c,h),c.m&&c.o&&Fh(h,c.m,c.o),c.L&&(c.g.I=c.L);var p=c.g;c=c.ia,p.L=1,p.v=Ds(Xt(h)),p.m=null,p.P=!0,Bc(p,c)}t.Za=function(){this.C!=null&&(this.C=null,Kc(this),zh(this),It(19))};function Xc(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function j0(c,h){var p=null;if(c.g==h){Xc(c),Bh(c),c.g=null;var E=2}else if(xo(c.h,h))p=h.D,C(c.h,h),E=1;else return;if(c.G!=0){if(h.o)if(E==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var M=c.B;E=Ye(),je(E,new Rs(E,p)),Qc(c)}else C0(c);else if(M=h.s,M==3||M==0&&0<h.X||!(E==1&&IS(c,h)||E==2&&zh(c)))switch(p&&0<p.length&&(h=c.h,h.i=h.i.concat(p)),M){case 1:Ii(c,5);break;case 4:Ii(c,10);break;case 3:Ii(c,6);break;default:Ii(c,2)}}}function R0(c,h){let p=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(p*=2),p*h}function Ii(c,h){if(c.j.info("Error code "+h),h==2){var p=g(c.fb,c),E=c.Xa;const M=!E;E=new Ze(E||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||sr(E,"https"),Ds(E),M?wS(E.toString(),p):_S(E.toString(),p)}else It(2);c.G=0,c.l&&c.l.sa(h),P0(c),T0(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function P0(c){if(c.G=0,c.ka=[],c.l){const h=U(c.h);(h.length!=0||c.i.length!=0)&&(T(c.ka,h),T(c.ka,c.i),c.h.i.length=0,R(c.i),c.i.length=0),c.l.ra()}}function D0(c,h,p){var E=p instanceof Ze?Xt(p):new Ze(p);if(E.g!="")h&&(E.g=h+"."+E.g),Nn(E,E.s);else{var M=l.location;E=M.protocol,h=h?h+"."+M.hostname:M.hostname,M=+M.port;var F=new Ze(null);E&&sr(F,E),h&&(F.g=h),M&&Nn(F,M),p&&(F.l=p),E=F}return p=c.D,h=c.ya,p&&h&&et(E,p,h),et(E,"VER",c.la),Ha(c,E),E}function O0(c,h,p){if(h&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=c.Ca&&!c.pa?new kt(new Hc({eb:p})):new kt(c.pa),h.Ha(c.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function L0(){}t=L0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yc(){}Yc.prototype.g=function(c,h){return new Hn(c,h)};function Hn(c,h){Me.call(this),this.g=new N0(h),this.l=c,this.h=h&&h.messageUrlParams||null,c=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(c?c["X-WebChannel-Content-Type"]=h.messageContentType:c={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(c?c["X-WebChannel-Client-Profile"]=h.va:c={"X-WebChannel-Client-Profile":h.va}),this.g.S=c,(c=h&&h.Sb)&&!_(c)&&(this.g.m=c),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!_(h)&&(this.g.D=h,c=this.h,c!==null&&h in c&&(c=this.h,h in c&&delete c[h])),this.j=new So(this)}b(Hn,Me),Hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){$h(this.g)},Hn.prototype.o=function(c){var h=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.u&&(p={},p.__data__=an(c),c=p);h.i.push(new Vh(h.Ya++,c)),h.G==3&&Qc(h)},Hn.prototype.N=function(){this.g.l=null,delete this.j,$h(this.g),delete this.g,Hn.aa.N.call(this)};function M0(c){$.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var h=c.__sm__;if(h){e:{for(const p in h){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,h=h!==null&&c in h?h[c]:void 0),this.data=h}else this.data=c}b(M0,$);function V0(){ne.call(this),this.status=1}b(V0,ne);function So(c){this.g=c}b(So,L0),So.prototype.ua=function(){je(this.g,"a")},So.prototype.ta=function(c){je(this.g,new M0(c))},So.prototype.sa=function(c){je(this.g,new V0)},So.prototype.ra=function(){je(this.g,"b")},Yc.prototype.createWebChannel=Yc.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,mE=function(){return new Yc},fE=function(){return Ye()},hE=te,Vm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ht.NO_ERROR=0,ht.TIMEOUT=8,ht.HTTP_ERROR=6,zu=ht,qn.COMPLETE="complete",dE=qn,En.EventType=wt,wt.OPEN="a",wt.CLOSE="b",wt.ERROR="c",wt.MESSAGE="d",Me.prototype.listen=Me.prototype.K,ul=En,kt.prototype.listenOnce=kt.prototype.L,kt.prototype.getLastError=kt.prototype.Ka,kt.prototype.getLastErrorCode=kt.prototype.Ba,kt.prototype.getStatus=kt.prototype.Z,kt.prototype.getResponseJson=kt.prototype.Oa,kt.prototype.getResponseText=kt.prototype.oa,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Ha,uE=kt}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});const Dx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};pn.UNAUTHENTICATED=new pn(null),pn.GOOGLE_CREDENTIALS=new pn("google-credentials-uid"),pn.FIRST_PARTY=new pn("first-party-uid"),pn.MOCK_USER=new pn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ka="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=new ig("@firebase/firestore");function tl(){return Yi.logLevel}function xe(t,...e){if(Yi.logLevel<=Fe.DEBUG){const n=e.map(vg);Yi.debug(`Firestore (${ka}): ${t}`,...n)}}function Ss(t,...e){if(Yi.logLevel<=Fe.ERROR){const n=e.map(vg);Yi.error(`Firestore (${ka}): ${t}`,...n)}}function ua(t,...e){if(Yi.logLevel<=Fe.WARN){const n=e.map(vg);Yi.warn(`Firestore (${ka}): ${t}`,...n)}}function vg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(t="Unexpected state"){const e=`FIRESTORE (${ka}) INTERNAL ASSERTION FAILED: `+t;throw Ss(e),new Error(e)}function rt(t,e){t||Ce()}function Pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends Jr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(pn.UNAUTHENTICATED))}shutdown(){}}class lj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class cj{constructor(e){this.t=e,this.currentUser=pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){rt(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new gs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new gs,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new gs)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(rt(typeof r.accessToken=="string"),new pE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return rt(e===null||typeof e=="string"),new pn(e)}}class uj{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=pn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class dj{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new uj(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(pn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){rt(this.o===void 0);const r=i=>{i.error!=null&&xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,xe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(rt(typeof n.token=="string"),this.R=n.token,new hj(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=mj(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Ge(t,e){return t<e?-1:t>e?1:0}function da(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ge(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ge(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ge(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $t.fromMillis(Date.now())}static fromDate(e){return $t.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new $t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Re(e)}static min(){return new Re(new $t(0,0))}static max(){return new Re(new $t(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ce(),r===void 0?r=e.length-n:r>e.length-n&&Ce(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Yl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Yl?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class mt extends Yl{construct(e,n,r){return new mt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ge(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new mt(n)}static emptyPath(){return new mt([])}}const pj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends Yl{construct(e,n,r){return new tn(e,n,r)}static isValidIdentifier(e){return pj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new tn(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ge(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new ge(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new ge(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new ge(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(n)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(mt.fromString(e))}static fromName(e){return new Ee(mt.fromString(e).popFirst(5))}static empty(){return new Ee(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return mt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new mt(e.slice()))}}function gj(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Re.fromTimestamp(r===1e9?new $t(n+1,0):new $t(n,r));return new mi(s,Ee.empty(),e)}function yj(t){return new mi(t.readTime,t.key,-1)}class mi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new mi(Re.min(),Ee.empty(),-1)}static max(){return new mi(Re.max(),Ee.empty(),-1)}}function xj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ee.comparator(t.documentKey,e.documentKey),n!==0?n:Ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sc(t){if(t.code!==W.FAILED_PRECONDITION||t.message!==vj)throw t;xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Q((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Q?n:Q.resolve(n)}catch(n){return Q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Q.reject(n)}static resolve(e){return new Q((n,r)=>{n(e)})}static reject(e){return new Q((n,r)=>{r(e)})}static waitFor(e){return new Q((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=Q.resolve(!1);for(const r of e)n=n.next(s=>s?Q.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new Q((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{a[d]=f,++l,l===i&&r(a)},f=>s(f))}})}static doWhile(e,n){return new Q((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function _j(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Nc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}wg.oe=-1;function fh(t){return t==null}function Cd(t){return t===0&&1/t==-1/0}function bj(t){return typeof t=="number"&&Number.isInteger(t)&&!Cd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function yE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n){this.comparator=e,this.root=n||en.EMPTY}insert(e,n){return new St(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,en.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,en.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xu(this.root,e,this.comparator,!1)}getReverseIterator(){return new xu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xu(this.root,e,this.comparator,!0)}}class xu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class en{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??en.RED,this.left=s??en.EMPTY,this.right=i??en.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new en(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return en.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return en.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,en.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,en.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ce();const e=this.left.check();if(e!==this.right.check())throw Ce();return e+(this.isRed()?0:1)}}en.EMPTY=null,en.RED=!0,en.BLACK=!1;en.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce()}get value(){throw Ce()}get color(){throw Ce()}get left(){throw Ce()}get right(){throw Ce()}copy(e,n,r,s,i){return this}insert(e,n,r){return new en(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Lx(this.data.getIterator())}getIteratorFrom(e){return new Lx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof rn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new rn(this.comparator);return n.data=e,n}}class Lx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new Xn([])}unionWith(e){let n=new rn(tn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Xn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return da(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new xE("Invalid base64 string: "+i):i}}(e);return new on(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new on(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}on.EMPTY_BYTE_STRING=new on("");const Ej=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pi(t){if(rt(!!t),typeof t=="string"){let e=0;const n=Ej.exec(t);if(rt(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:At(t.seconds),nanos:At(t.nanos)}}function At(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ji(t){return typeof t=="string"?on.fromBase64String(t):on.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function bg(t){const e=t.mapValue.fields.__previous_value__;return _g(e)?bg(e):e}function Jl(t){const e=pi(t.mapValue.fields.__local_write_time__.timestampValue);return new $t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,n,r,s,i,a,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class Zl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Zl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Zl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu={mapValue:{}};function Zi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_g(t)?4:Tj(t)?9007199254740991:Nj(t)?10:11:Ce()}function Kr(t,e){if(t===e)return!0;const n=Zi(t);if(n!==Zi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jl(t).isEqual(Jl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=pi(s.timestampValue),l=pi(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ji(s.bytesValue).isEqual(Ji(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return At(s.geoPointValue.latitude)===At(i.geoPointValue.latitude)&&At(s.geoPointValue.longitude)===At(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return At(s.integerValue)===At(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=At(s.doubleValue),l=At(i.doubleValue);return a===l?Cd(a)===Cd(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return da(t.arrayValue.values||[],e.arrayValue.values||[],Kr);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Ox(a)!==Ox(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Kr(a[u],l[u])))return!1;return!0}(t,e);default:return Ce()}}function ec(t,e){return(t.values||[]).find(n=>Kr(n,e))!==void 0}function ha(t,e){if(t===e)return 0;const n=Zi(t),r=Zi(e);if(n!==r)return Ge(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ge(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=At(i.integerValue||i.doubleValue),u=At(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Mx(t.timestampValue,e.timestampValue);case 4:return Mx(Jl(t),Jl(e));case 5:return Ge(t.stringValue,e.stringValue);case 6:return function(i,a){const l=Ji(i),u=Ji(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let d=0;d<l.length&&d<u.length;d++){const f=Ge(l[d],u[d]);if(f!==0)return f}return Ge(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Ge(At(i.latitude),At(a.latitude));return l!==0?l:Ge(At(i.longitude),At(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Vx(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,u,d,f;const m=i.fields||{},g=a.fields||{},x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,b=(u=g.value)===null||u===void 0?void 0:u.arrayValue,R=Ge(((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0,((f=b==null?void 0:b.values)===null||f===void 0?void 0:f.length)||0);return R!==0?R:Vx(x,b)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===vu.mapValue&&a===vu.mapValue)return 0;if(i===vu.mapValue)return 1;if(a===vu.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const g=Ge(u[m],f[m]);if(g!==0)return g;const x=ha(l[u[m]],d[f[m]]);if(x!==0)return x}return Ge(u.length,f.length)}(t.mapValue,e.mapValue);default:throw Ce()}}function Mx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ge(t,e);const n=pi(t),r=pi(e),s=Ge(n.seconds,r.seconds);return s!==0?s:Ge(n.nanos,r.nanos)}function Vx(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ha(n[s],r[s]);if(i)return i}return Ge(n.length,r.length)}function fa(t){return Um(t)}function Um(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=pi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ji(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Um(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Um(n.fields[a])}`;return s+"}"}(t.mapValue):Ce()}function Ux(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Fm(t){return!!t&&"integerValue"in t}function Eg(t){return!!t&&"arrayValue"in t}function Fx(t){return!!t&&"nullValue"in t}function $x(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bu(t){return!!t&&"mapValue"in t}function Nj(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Sl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return lo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Sl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Sl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Tj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.value=e}static empty(){return new Vn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Bu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Sl(n)}setAll(e){let n=tn.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=Sl(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Bu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Bu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){lo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Vn(Sl(this.value))}}function vE(t){const e=[];return lo(t.fields,(n,r)=>{const s=new tn([n]);if(Bu(r)){const i=vE(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Xn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new yn(e,0,Re.min(),Re.min(),Re.min(),Vn.empty(),0)}static newFoundDocument(e,n,r,s){return new yn(e,1,n,Re.min(),r,s,0)}static newNoDocument(e,n){return new yn(e,2,n,Re.min(),Re.min(),Vn.empty(),0)}static newUnknownDocument(e,n){return new yn(e,3,n,Re.min(),Re.min(),Vn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,n){this.position=e,this.inclusive=n}}function zx(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=Ee.comparator(Ee.fromName(a.referenceValue),n.key):r=ha(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Bx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Kr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,n="asc"){this.field=e,this.dir=n}}function Ij(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wE=class{};class Ot extends wE{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Cj(e,n,r):n==="array-contains"?new Rj(e,r):n==="in"?new Pj(e,r):n==="not-in"?new Dj(e,r):n==="array-contains-any"?new Oj(e,r):new Ot(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Aj(e,r):new jj(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ha(n,this.value)):n!==null&&Zi(this.value)===Zi(n)&&this.matchesComparison(ha(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class jr extends wE{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new jr(e,n)}matches(e){return _E(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function _E(t){return t.op==="and"}function bE(t){return kj(t)&&_E(t)}function kj(t){for(const e of t.filters)if(e instanceof jr)return!1;return!0}function $m(t){if(t instanceof Ot)return t.field.canonicalString()+t.op.toString()+fa(t.value);if(bE(t))return t.filters.map(e=>$m(e)).join(",");{const e=t.filters.map(n=>$m(n)).join(",");return`${t.op}(${e})`}}function EE(t,e){return t instanceof Ot?function(r,s){return s instanceof Ot&&r.op===s.op&&r.field.isEqual(s.field)&&Kr(r.value,s.value)}(t,e):t instanceof jr?function(r,s){return s instanceof jr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&EE(a,s.filters[l]),!0):!1}(t,e):void Ce()}function SE(t){return t instanceof Ot?function(n){return`${n.field.canonicalString()} ${n.op} ${fa(n.value)}`}(t):t instanceof jr?function(n){return n.op.toString()+" {"+n.getFilters().map(SE).join(" ,")+"}"}(t):"Filter"}class Cj extends Ot{constructor(e,n,r){super(e,n,r),this.key=Ee.fromName(r.referenceValue)}matches(e){const n=Ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class Aj extends Ot{constructor(e,n){super(e,"in",n),this.keys=NE("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class jj extends Ot{constructor(e,n){super(e,"not-in",n),this.keys=NE("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function NE(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ee.fromName(r.referenceValue))}class Rj extends Ot{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Eg(n)&&ec(n.arrayValue,this.value)}}class Pj extends Ot{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ec(this.value.arrayValue,n)}}class Dj extends Ot{constructor(e,n){super(e,"not-in",n)}matches(e){if(ec(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ec(this.value.arrayValue,n)}}class Oj extends Ot{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Eg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ec(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function qx(t,e=null,n=[],r=[],s=null,i=null,a=null){return new Lj(t,e,n,r,s,i,a)}function Sg(t){const e=Pe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>$m(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),fh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>fa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>fa(r)).join(",")),e.ue=n}return e.ue}function Ng(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ij(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!EE(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bx(t.startAt,e.startAt)&&Bx(t.endAt,e.endAt)}function zm(t){return Ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Mj(t,e,n,r,s,i,a,l){return new Ca(t,e,n,r,s,i,a,l)}function mh(t){return new Ca(t)}function Hx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function TE(t){return t.collectionGroup!==null}function Nl(t){const e=Pe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new rn(tn.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new tc(i,r))}),n.has(tn.keyField().canonicalString())||e.ce.push(new tc(tn.keyField(),r))}return e.ce}function Hr(t){const e=Pe(t);return e.le||(e.le=Vj(e,Nl(t))),e.le}function Vj(t,e){if(t.limitType==="F")return qx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new tc(s.field,i)});const n=t.endAt?new Ad(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ad(t.startAt.position,t.startAt.inclusive):null;return qx(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Bm(t,e){const n=t.filters.concat([e]);return new Ca(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qm(t,e,n){return new Ca(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ph(t,e){return Ng(Hr(t),Hr(e))&&t.limitType===e.limitType}function IE(t){return`${Sg(Hr(t))}|lt:${t.limitType}`}function Co(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>SE(s)).join(", ")}]`),fh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>fa(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>fa(s)).join(",")),`Target(${r})`}(Hr(t))}; limitType=${t.limitType})`}function gh(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Nl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,u){const d=zx(a,l,u);return a.inclusive?d<=0:d<0}(r.startAt,Nl(r),s)||r.endAt&&!function(a,l,u){const d=zx(a,l,u);return a.inclusive?d>=0:d>0}(r.endAt,Nl(r),s))}(t,e)}function Uj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function kE(t){return(e,n)=>{let r=!1;for(const s of Nl(t)){const i=Fj(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Fj(t,e,n){const r=t.field.isKeyField()?Ee.comparator(e.key,n.key):function(i,a,l){const u=a.data.field(i),d=l.data.field(i);return u!==null&&d!==null?ha(u,d):Ce()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ce()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return yE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=new St(Ee.comparator);function Ns(){return $j}const CE=new St(Ee.comparator);function dl(...t){let e=CE;for(const n of t)e=e.insert(n.key,n);return e}function AE(t){let e=CE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Li(){return Tl()}function jE(){return Tl()}function Tl(){return new Aa(t=>t.toString(),(t,e)=>t.isEqual(e))}const zj=new St(Ee.comparator),Bj=new rn(Ee.comparator);function Ue(...t){let e=Bj;for(const n of t)e=e.add(n);return e}const qj=new rn(Ge);function Hj(){return qj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cd(e)?"-0":e}}function RE(t){return{integerValue:""+t}}function Wj(t,e){return bj(e)?RE(e):Tg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(){this._=void 0}}function Gj(t,e,n){return t instanceof nc?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&_g(i)&&(i=bg(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof rc?DE(t,e):t instanceof sc?OE(t,e):function(s,i){const a=PE(s,i),l=Wx(a)+Wx(s.Pe);return Fm(a)&&Fm(s.Pe)?RE(l):Tg(s.serializer,l)}(t,e)}function Kj(t,e,n){return t instanceof rc?DE(t,e):t instanceof sc?OE(t,e):n}function PE(t,e){return t instanceof jd?function(r){return Fm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class nc extends yh{}class rc extends yh{constructor(e){super(),this.elements=e}}function DE(t,e){const n=LE(e);for(const r of t.elements)n.some(s=>Kr(s,r))||n.push(r);return{arrayValue:{values:n}}}class sc extends yh{constructor(e){super(),this.elements=e}}function OE(t,e){let n=LE(e);for(const r of t.elements)n=n.filter(s=>!Kr(s,r));return{arrayValue:{values:n}}}class jd extends yh{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Wx(t){return At(t.integerValue||t.doubleValue)}function LE(t){return Eg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e,n){this.field=e,this.transform=n}}function Xj(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof rc&&s instanceof rc||r instanceof sc&&s instanceof sc?da(r.elements,s.elements,Kr):r instanceof jd&&s instanceof jd?Kr(r.Pe,s.Pe):r instanceof nc&&s instanceof nc}(t.transform,e.transform)}class Yj{constructor(e,n){this.version=e,this.transformResults=n}}class Rn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Rn}static exists(e){return new Rn(void 0,e)}static updateTime(e){return new Rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class xh{}function ME(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vh(t.key,Rn.none()):new Tc(t.key,t.data,Rn.none());{const n=t.data,r=Vn.empty();let s=new rn(tn.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new bi(t.key,r,new Xn(s.toArray()),Rn.none())}}function Jj(t,e,n){t instanceof Tc?function(s,i,a){const l=s.value.clone(),u=Kx(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof bi?function(s,i,a){if(!qu(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=Kx(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(VE(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Il(t,e,n,r){return t instanceof Tc?function(i,a,l,u){if(!qu(i.precondition,a))return l;const d=i.value.clone(),f=Qx(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof bi?function(i,a,l,u){if(!qu(i.precondition,a))return l;const d=Qx(i.fieldTransforms,u,a),f=a.data;return f.setAll(VE(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,a,l){return qu(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function Zj(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=PE(r.transform,s||null);i!=null&&(n===null&&(n=Vn.empty()),n.set(r.field,i))}return n||null}function Gx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&da(r,s,(i,a)=>Xj(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Tc extends xh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class bi extends xh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function VE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Kx(t,e,n){const r=new Map;rt(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,Kj(a,l,n[s]))}return r}function Qx(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,Gj(i,a,e))}return r}class vh extends xh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eR extends xh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Jj(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Il(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Il(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=jE();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=ME(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(Re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ue())}isEqual(e){return this.batchId===e.batchId&&da(this.mutations,e.mutations,(n,r)=>Gx(n,r))&&da(this.baseMutations,e.baseMutations,(n,r)=>Gx(n,r))}}class Ig{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){rt(e.mutations.length===r.length);let s=function(){return zj}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Ig(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt,ze;function sR(t){switch(t){default:return Ce();case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0}}function UE(t){if(t===void 0)return Ss("GRPC error has no .code"),W.UNKNOWN;switch(t){case Pt.OK:return W.OK;case Pt.CANCELLED:return W.CANCELLED;case Pt.UNKNOWN:return W.UNKNOWN;case Pt.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case Pt.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case Pt.INTERNAL:return W.INTERNAL;case Pt.UNAVAILABLE:return W.UNAVAILABLE;case Pt.UNAUTHENTICATED:return W.UNAUTHENTICATED;case Pt.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case Pt.NOT_FOUND:return W.NOT_FOUND;case Pt.ALREADY_EXISTS:return W.ALREADY_EXISTS;case Pt.PERMISSION_DENIED:return W.PERMISSION_DENIED;case Pt.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case Pt.ABORTED:return W.ABORTED;case Pt.OUT_OF_RANGE:return W.OUT_OF_RANGE;case Pt.UNIMPLEMENTED:return W.UNIMPLEMENTED;case Pt.DATA_LOSS:return W.DATA_LOSS;default:return Ce()}}(ze=Pt||(Pt={}))[ze.OK=0]="OK",ze[ze.CANCELLED=1]="CANCELLED",ze[ze.UNKNOWN=2]="UNKNOWN",ze[ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ze[ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ze[ze.NOT_FOUND=5]="NOT_FOUND",ze[ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",ze[ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",ze[ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",ze[ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ze[ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ze[ze.ABORTED=10]="ABORTED",ze[ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",ze[ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",ze[ze.INTERNAL=13]="INTERNAL",ze[ze.UNAVAILABLE=14]="UNAVAILABLE",ze[ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR=new $i([4294967295,4294967295],0);function Xx(t){const e=iR().encode(t),n=new cE;return n.update(e),new Uint8Array(n.digest())}function Yx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new $i([n,r],0),new $i([s,i],0)]}class kg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new hl(`Invalid padding: ${n}`);if(r<0)throw new hl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new hl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new hl(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=$i.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply($i.fromNumber(r)));return s.compare(oR)===1&&(s=new $i([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Xx(e),[r,s]=Yx(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new kg(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=Xx(e),[r,s]=Yx(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class hl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ic.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new wh(Re.min(),s,new St(Ge),Ns(),Ue())}}class Ic{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ic(r,n,Ue(),Ue(),Ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class FE{constructor(e,n){this.targetId=e,this.me=n}}class $E{constructor(e,n,r=on.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Jx{constructor(){this.fe=0,this.ge=ev(),this.pe=on.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ue(),n=Ue(),r=Ue();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Ce()}}),new Ic(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=ev()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,rt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class aR{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ns(),this.qe=Zx(),this.Qe=new St(Ge)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Ce()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(zm(i))if(r===0){const a=new Ee(i.path);this.Ue(n,a,yn.newNoDocument(a,Re.min()))}else rt(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=Ji(r).toUint8Array()}catch(u){if(u instanceof xE)return ua("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new kg(a,s,i)}catch(u){return ua(u instanceof hl?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&zm(l.target)){const u=new Ee(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,yn.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=Ue();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new wh(e,n,this.Qe,this.ke,r);return this.ke=Ns(),this.qe=Zx(),this.Qe=new St(Ge),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Jx,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new rn(Ge),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||xe("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Jx),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Zx(){return new St(Ee.comparator)}function ev(){return new St(Ee.comparator)}const lR={asc:"ASCENDING",desc:"DESCENDING"},cR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uR={and:"AND",or:"OR"};class dR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Hm(t,e){return t.useProto3Json||fh(e)?e:{value:e}}function Rd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function hR(t,e){return Rd(t,e.toTimestamp())}function Wr(t){return rt(!!t),Re.fromTimestamp(function(n){const r=pi(n);return new $t(r.seconds,r.nanos)}(t))}function Cg(t,e){return Wm(t,e).canonicalString()}function Wm(t,e){const n=function(s){return new mt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function BE(t){const e=mt.fromString(t);return rt(KE(e)),e}function Gm(t,e){return Cg(t.databaseId,e.path)}function Tf(t,e){const n=BE(e);if(n.get(1)!==t.databaseId.projectId)throw new ge(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ge(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ee(HE(n))}function qE(t,e){return Cg(t.databaseId,e)}function fR(t){const e=BE(t);return e.length===4?mt.emptyPath():HE(e)}function Km(t){return new mt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function HE(t){return rt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function tv(t,e,n){return{name:Gm(t,e),fields:n.value.mapValue.fields}}function mR(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(rt(f===void 0||typeof f=="string"),on.fromBase64String(f||"")):(rt(f===void 0||f instanceof Buffer||f instanceof Uint8Array),on.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(d){const f=d.code===void 0?W.UNKNOWN:UE(d.code);return new ge(f,d.message||"")}(a);n=new $E(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Tf(t,r.document.name),i=Wr(r.document.updateTime),a=r.document.createTime?Wr(r.document.createTime):Re.min(),l=new Vn({mapValue:{fields:r.document.fields}}),u=yn.newFoundDocument(s,i,a,l),d=r.targetIds||[],f=r.removedTargetIds||[];n=new Hu(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Tf(t,r.document),i=r.readTime?Wr(r.readTime):Re.min(),a=yn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Hu([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Tf(t,r.document),i=r.removedTargetIds||[];n=new Hu([],i,s,null)}else{if(!("filter"in e))return Ce();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new rR(s,i),l=r.targetId;n=new FE(l,a)}}return n}function pR(t,e){let n;if(e instanceof Tc)n={update:tv(t,e.key,e.value)};else if(e instanceof vh)n={delete:Gm(t,e.key)};else if(e instanceof bi)n={update:tv(t,e.key,e.data),updateMask:SR(e.fieldMask)};else{if(!(e instanceof eR))return Ce();n={verify:Gm(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof nc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof rc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof sc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof jd)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw Ce()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:hR(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ce()}(t,e.precondition)),n}function gR(t,e){return t&&t.length>0?(rt(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Wr(s.updateTime):Wr(i);return a.isEqual(Re.min())&&(a=Wr(i)),new Yj(a,s.transformResults||[])}(n,e))):[]}function yR(t,e){return{documents:[qE(t,e.path)]}}function xR(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=qE(t,s);const i=function(d){if(d.length!==0)return GE(jr.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:Ao(g.field),direction:_R(g.dir)}}(f))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=Hm(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function vR(t){let e=fR(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){rt(r===1);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(m){const g=WE(m);return g instanceof jr&&bE(g)?g.getFilters():[g]}(n.where));let a=[];n.orderBy&&(a=function(m){return m.map(g=>function(b){return new tc(jo(b.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,fh(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(m){const g=!!m.before,x=m.values||[];return new Ad(x,g)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const g=!m.before,x=m.values||[];return new Ad(x,g)}(n.endAt)),Mj(e,s,a,i,l,"F",u,d)}function wR(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function WE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=jo(n.unaryFilter.field);return Ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=jo(n.unaryFilter.field);return Ot.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=jo(n.unaryFilter.field);return Ot.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=jo(n.unaryFilter.field);return Ot.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ce()}}(t):t.fieldFilter!==void 0?function(n){return Ot.create(jo(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ce()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return jr.create(n.compositeFilter.filters.map(r=>WE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ce()}}(n.compositeFilter.op))}(t):Ce()}function _R(t){return lR[t]}function bR(t){return cR[t]}function ER(t){return uR[t]}function Ao(t){return{fieldPath:t.canonicalString()}}function jo(t){return tn.fromServerFormat(t.fieldPath)}function GE(t){return t instanceof Ot?function(n){if(n.op==="=="){if($x(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NAN"}};if(Fx(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($x(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NOT_NAN"}};if(Fx(n.value))return{unaryFilter:{field:Ao(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ao(n.field),op:bR(n.op),value:n.value}}}(t):t instanceof jr?function(n){const r=n.getFilters().map(s=>GE(s));return r.length===1?r[0]:{compositeFilter:{op:ER(n.op),filters:r}}}(t):Ce()}function SR(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function KE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,n,r,s,i=Re.min(),a=Re.min(),l=on.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Ys(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e){this.ct=e}}function TR(t){const e=vR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?qm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(){this.un=new kR}addToCollectionParentIndex(e,n){return this.un.add(n),Q.resolve()}getCollectionParents(e,n){return Q.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Q.resolve()}deleteFieldIndex(e,n){return Q.resolve()}deleteAllFieldIndexes(e){return Q.resolve()}createTargetIndexes(e,n){return Q.resolve()}getDocumentsMatchingTarget(e,n){return Q.resolve(null)}getIndexType(e,n){return Q.resolve(0)}getFieldIndexes(e,n){return Q.resolve([])}getNextCollectionGroupToUpdate(e){return Q.resolve(null)}getMinOffset(e,n){return Q.resolve(mi.min())}getMinOffsetFromCollectionGroup(e,n){return Q.resolve(mi.min())}updateCollectionGroup(e,n,r){return Q.resolve()}updateIndexEntries(e,n){return Q.resolve()}}class kR{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new rn(mt.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new rn(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ma(0)}static kn(){return new ma(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(){this.changes=new Aa(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,yn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Il(r.mutation,s,Xn.empty(),$t.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ue()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ue()){const s=Li();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=dl();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Li();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ue()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=Ns();const a=Tl(),l=function(){return Tl()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof bi)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),Il(f.mutation,d,f.mutation.getFieldMask(),$t.now())):a.set(d.key,Xn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>a.set(d,f)),n.forEach((d,f)=>{var m;return l.set(d,new AR(f,(m=a.get(d))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Tl();let s=new St((a,l)=>a-l),i=Ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||Xn.empty();f=l.applyToLocalView(d,f),r.set(u,f);const m=(s.get(l.batchId)||Ue()).add(u);s=s.insert(l.batchId,m)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,f=u.value,m=jE();f.forEach(g=>{if(!i.has(g)){const x=ME(n.get(g),r.get(g));x!==null&&m.set(g,x),i=i.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return Q.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return Ee.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):TE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):Q.resolve(Li());let l=-1,u=i;return a.next(d=>Q.forEach(d,(f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(f)?Q.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,Ue())).next(f=>({batchId:l,changes:AE(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ee(n)).next(r=>{let s=dl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=dl();return this.indexManager.getCollectionParents(e,i).next(l=>Q.forEach(l,u=>{const d=function(m,g){return new Ca(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((m,g)=>{a=a.insert(m,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,yn.newInvalidDocument(f)))});let l=dl();return a.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Il(f.mutation,d,Xn.empty(),$t.now()),gh(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Q.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Wr(s.createTime)}}(n)),Q.resolve()}getNamedQuery(e,n){return Q.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:TR(s.bundledQuery),readTime:Wr(s.readTime)}}(n)),Q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(){this.overlays=new St(Ee.comparator),this.Ir=new Map}getOverlay(e,n){return Q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Li();return Q.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),Q.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),Q.resolve()}getOverlaysForCollection(e,n,r){const s=Li(),i=n.length+1,a=new Ee(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Q.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new St((d,f)=>d-f);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Li(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const l=Li(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>l.set(d,f)),!(l.size()>=s)););return Q.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new nR(n,r));let i=this.Ir.get(n);i===void 0&&(i=Ue(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(){this.sessionToken=on.EMPTY_BYTE_STRING}getSessionToken(e){return Q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(){this.Tr=new rn(Ht.Er),this.dr=new rn(Ht.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ht(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ht(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Ee(new mt([])),r=new Ht(n,e),s=new Ht(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Ee(new mt([])),r=new Ht(n,e),s=new Ht(n,e+1);let i=Ue();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Ht(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ht{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Ee.comparator(e.key,n.key)||Ge(e.wr,n.wr)}static Ar(e,n){return Ge(e.wr,n.wr)||Ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new rn(Ht.Er)}checkEmpty(e){return Q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new tR(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new Ht(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Q.resolve(a)}lookupMutationBatch(e,n){return Q.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return Q.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Q.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ht(n,0),s=new Ht(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),Q.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rn(Ge);return n.forEach(s=>{const i=new Ht(s,0),a=new Ht(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),Q.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Ee.isDocumentKey(i)||(i=i.child(""));const a=new Ht(new Ee(i),0);let l=new rn(Ge);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.wr)),!0)},a),Q.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){rt(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Q.forEach(n.mutations,s=>{const i=new Ht(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ht(n,0),s=this.br.firstAfterOrEqual(r);return Q.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Q.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e){this.Mr=e,this.docs=function(){return new St(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Q.resolve(r?r.document.mutableCopy():yn.newInvalidDocument(n))}getEntries(e,n){let r=Ns();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():yn.newInvalidDocument(s))}),Q.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ns();const a=n.path,l=new Ee(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||xj(yj(f),r)<=0||(s.has(f.key)||gh(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return Q.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Ce()}Or(e,n){return Q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new MR(this)}getSize(e){return Q.resolve(this.size)}}class MR extends CR{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),Q.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e){this.persistence=e,this.Nr=new Aa(n=>Sg(n),Ng),this.lastRemoteSnapshotVersion=Re.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ag,this.targetCount=0,this.kr=ma.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),Q.resolve()}getLastRemoteSnapshotVersion(e){return Q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Q.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ma(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Q.resolve()}updateTargetData(e,n){return this.Kn(n),Q.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Q.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),Q.waitFor(i).next(()=>s)}getTargetCount(e){return Q.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Q.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Q.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),Q.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Q.resolve(r)}containsKey(e,n){return Q.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e,n){this.qr={},this.overlays={},this.Qr=new wg(0),this.Kr=!1,this.Kr=!0,this.$r=new DR,this.referenceDelegate=e(this),this.Ur=new VR(this),this.indexManager=new IR,this.remoteDocumentCache=function(s){return new LR(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new NR(n),this.Gr=new RR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new PR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new OR(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){xe("MemoryPersistence","Starting transaction:",e);const s=new FR(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return Q.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class FR extends wj{constructor(e){super(),this.currentSequenceNumber=e}}class jg{constructor(e){this.persistence=e,this.Jr=new Ag,this.Yr=null}static Zr(e){return new jg(e)}get Xr(){if(this.Yr)return this.Yr;throw Ce()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Q.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Q.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Q.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Q.forEach(this.Xr,r=>{const s=Ee.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,Re.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Q.or([()=>Q.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Ue(),s=Ue();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Rg(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return EI()?8:_j(_n())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new $R;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(tl()<=Fe.DEBUG&&xe("QueryEngine","SDK will not create cache indexes for query:",Co(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Q.resolve()):(tl()<=Fe.DEBUG&&xe("QueryEngine","Query:",Co(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(tl()<=Fe.DEBUG&&xe("QueryEngine","The SDK decides to create cache indexes for query:",Co(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hr(n))):Q.resolve())}Yi(e,n){if(Hx(n))return Q.resolve(null);let r=Hr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=qm(n,null,"F"),r=Hr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=Ue(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,l);return this.ns(n,d,a,u.readTime)?this.Yi(e,qm(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return Hx(n)||s.isEqual(Re.min())?Q.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?Q.resolve(null):(tl()<=Fe.DEBUG&&xe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Co(n)),this.rs(e,a,n,gj(s,-1)).next(l=>l))})}ts(e,n){let r=new rn(kE(e));return n.forEach((s,i)=>{gh(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return tl()<=Fe.DEBUG&&xe("QueryEngine","Using full collection scan to execute query:",Co(n)),this.Ji.getDocumentsMatchingQuery(e,n,mi.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new St(Ge),this._s=new Aa(i=>Sg(i),Ng),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jR(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function qR(t,e,n,r){return new BR(t,e,n,r)}async function QE(t,e){const n=Pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=Ue();for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){l.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:l}))})})}function HR(t,e){const n=Pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,f){const m=d.batch,g=m.keys();let x=Q.resolve();return g.forEach(b=>{x=x.next(()=>f.getEntry(u,b)).next(R=>{const T=d.docVersions.get(b);rt(T!==null),R.version.compareTo(T)<0&&(m.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),f.addEntry(R)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=Ue();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function XE(t){const e=Pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function WR(t,e){const n=Pe(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((f,m)=>{const g=s.get(m);if(!g)return;l.push(n.Ur.removeMatchingKeys(i,f.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,f.addedDocuments,m)));let x=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(on.EMPTY_BYTE_STRING,Re.min()).withLastLimboFreeSnapshotVersion(Re.min()):f.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(f.resumeToken,r)),s=s.insert(m,x),function(R,T,v){return R.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(g,x,f)&&l.push(n.Ur.updateTargetData(i,x))});let u=Ns(),d=Ue();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(GR(i,a,e.documentUpdates).next(f=>{u=f.Ps,d=f.Is})),!r.isEqual(Re.min())){const f=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return Q.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function GR(t,e,n){let r=Ue(),s=Ue();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=Ns();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(Re.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):xe("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function KR(t,e){const n=Pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function QR(t,e){const n=Pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,Q.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Ys(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Qm(t,e,n){const r=Pe(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Nc(a))throw a;xe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function nv(t,e,n){const r=Pe(t);let s=Re.min(),i=Ue();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,f){const m=Pe(u),g=m._s.get(f);return g!==void 0?Q.resolve(m.os.get(g)):m.Ur.getTargetData(d,f)}(r,a,Hr(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:Re.min(),n?i:Ue())).next(l=>(XR(r,Uj(e),l),{documents:l,Ts:i})))}function XR(t,e,n){let r=t.us.get(e)||Re.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class rv{constructor(){this.activeTargetIds=Hj()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YR{constructor(){this.so=new rv,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new rv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){xe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){xe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wu=null;function If(){return wu===null?wu=function(){return 268435456+Math.round(2147483648*Math.random())}():wu++,"0x"+wu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn="WebChannelConnection";class tP extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=If(),u=this.xo(n,r.toUriEncodedString());xe("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,a),this.No(n,u,d,s).then(f=>(xe("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw ua("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ka}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=ZR[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=If();return new Promise((a,l)=>{const u=new uE;u.setWithCredentials(!0),u.listenOnce(dE.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case zu.NO_ERROR:const f=u.getResponseJson();xe(mn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),a(f);break;case zu.TIMEOUT:xe(mn,`RPC '${e}' ${i} timed out`),l(new ge(W.DEADLINE_EXCEEDED,"Request time out"));break;case zu.HTTP_ERROR:const m=u.getStatus();if(xe(mn,`RPC '${e}' ${i} failed with status:`,m,"response text:",u.getResponseText()),m>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const x=g==null?void 0:g.error;if(x&&x.status&&x.message){const b=function(T){const v=T.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(v)>=0?v:W.UNKNOWN}(x.status);l(new ge(b,x.message))}else l(new ge(W.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new ge(W.UNAVAILABLE,"Connection failed."));break;default:Ce()}}finally{xe(mn,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);xe(mn,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=If(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=mE(),l=fE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");xe(mn,`Creating RPC '${e}' stream ${s}: ${f}`,u);const m=a.createWebChannel(f,u);let g=!1,x=!1;const b=new eP({Io:T=>{x?xe(mn,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(g||(xe(mn,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),xe(mn,`RPC '${e}' stream ${s} sending:`,T),m.send(T))},To:()=>m.close()}),R=(T,v,_)=>{T.listen(v,y=>{try{_(y)}catch(A){setTimeout(()=>{throw A},0)}})};return R(m,ul.EventType.OPEN,()=>{x||(xe(mn,`RPC '${e}' stream ${s} transport opened.`),b.yo())}),R(m,ul.EventType.CLOSE,()=>{x||(x=!0,xe(mn,`RPC '${e}' stream ${s} transport closed`),b.So())}),R(m,ul.EventType.ERROR,T=>{x||(x=!0,ua(mn,`RPC '${e}' stream ${s} transport errored:`,T),b.So(new ge(W.UNAVAILABLE,"The operation could not be completed")))}),R(m,ul.EventType.MESSAGE,T=>{var v;if(!x){const _=T.data[0];rt(!!_);const y=_,A=y.error||((v=y[0])===null||v===void 0?void 0:v.error);if(A){xe(mn,`RPC '${e}' stream ${s} received error:`,A);const P=A.status;let O=function(I){const k=Pt[I];if(k!==void 0)return UE(k)}(P),N=A.message;O===void 0&&(O=W.INTERNAL,N="Unknown error status: "+P+" with message "+A.message),x=!0,b.So(new ge(O,N)),m.close()}else xe(mn,`RPC '${e}' stream ${s} received:`,_),b.bo(_)}}),R(l,hE.STAT_EVENT,T=>{T.stat===Vm.PROXY?xe(mn,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===Vm.NOPROXY&&xe(mn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}}function kf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _h(t){return new dR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&xe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n,r,s,i,a,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new YE(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===W.RESOURCE_EXHAUSTED?(Ss(n.toString()),Ss("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new ge(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return xe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(xe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nP extends JE{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=mR(this.serializer,e),r=function(i){if(!("targetChange"in i))return Re.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Re.min():a.readTime?Wr(a.readTime):Re.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Km(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=zm(u)?{documents:yR(i,u)}:{query:xR(i,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=zE(i,a.resumeToken);const d=Hm(i,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(Re.min())>0){l.readTime=Rd(i,a.snapshotVersion.toTimestamp());const d=Hm(i,a.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=wR(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Km(this.serializer),n.removeTarget=e,this.a_(n)}}class rP extends JE{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return rt(!!e.streamToken),this.lastStreamToken=e.streamToken,rt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){rt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=gR(e.writeResults,e.commitTime),r=Wr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Km(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>pR(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new ge(W.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Wm(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ge(W.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,Wm(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ge(W.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class iP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ss(n),this.D_=!1):xe("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{co(this)&&(xe("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=Pe(u);d.L_.add(4),await kc(d),d.q_.set("Unknown"),d.L_.delete(4),await bh(d)}(this))})}),this.q_=new iP(r,s)}}async function bh(t){if(co(t))for(const e of t.B_)await e(!0)}async function kc(t){for(const e of t.B_)await e(!1)}function ZE(t,e){const n=Pe(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Lg(n)?Og(n):ja(n).r_()&&Dg(n,e))}function Pg(t,e){const n=Pe(t),r=ja(n);n.N_.delete(e),r.r_()&&e1(n,e),n.N_.size===0&&(r.r_()?r.o_():co(n)&&n.q_.set("Unknown"))}function Dg(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ja(t).A_(e)}function e1(t,e){t.Q_.xe(e),ja(t).R_(e)}function Og(t){t.Q_=new aR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ja(t).start(),t.q_.v_()}function Lg(t){return co(t)&&!ja(t).n_()&&t.N_.size>0}function co(t){return Pe(t).L_.size===0}function t1(t){t.Q_=void 0}async function aP(t){t.q_.set("Online")}async function lP(t){t.N_.forEach((e,n)=>{Dg(t,e)})}async function cP(t,e){t1(t),Lg(t)?(t.q_.M_(e),Og(t)):t.q_.set("Unknown")}async function uP(t,e,n){if(t.q_.set("Online"),e instanceof $E&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){xe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Pd(t,r)}else if(e instanceof Hu?t.Q_.Ke(e):e instanceof FE?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Re.min()))try{const r=await XE(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(d);f&&i.N_.set(d,f.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,d)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(on.EMPTY_BYTE_STRING,f.snapshotVersion)),e1(i,u);const m=new Ys(f.target,u,d,f.sequenceNumber);Dg(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){xe("RemoteStore","Failed to raise snapshot:",r),await Pd(t,r)}}async function Pd(t,e,n){if(!Nc(e))throw e;t.L_.add(1),await kc(t),t.q_.set("Offline"),n||(n=()=>XE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{xe("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await bh(t)})}function n1(t,e){return e().catch(n=>Pd(t,n,e))}async function Eh(t){const e=Pe(t),n=gi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;dP(e);)try{const s=await KR(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,hP(e,s)}catch(s){await Pd(e,s)}r1(e)&&s1(e)}function dP(t){return co(t)&&t.O_.length<10}function hP(t,e){t.O_.push(e);const n=gi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function r1(t){return co(t)&&!gi(t).n_()&&t.O_.length>0}function s1(t){gi(t).start()}async function fP(t){gi(t).p_()}async function mP(t){const e=gi(t);for(const n of t.O_)e.m_(n.mutations)}async function pP(t,e,n){const r=t.O_.shift(),s=Ig.from(r,e,n);await n1(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Eh(t)}async function gP(t,e){e&&gi(t).V_&&await async function(r,s){if(function(a){return sR(a)&&a!==W.ABORTED}(s.code)){const i=r.O_.shift();gi(r).s_(),await n1(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Eh(r)}}(t,e),r1(t)&&s1(t)}async function iv(t,e){const n=Pe(t);n.asyncQueue.verifyOperationInProgress(),xe("RemoteStore","RemoteStore received new credentials");const r=co(n);n.L_.add(3),await kc(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await bh(n)}async function yP(t,e){const n=Pe(t);e?(n.L_.delete(2),await bh(n)):e||(n.L_.add(2),await kc(n),n.q_.set("Unknown"))}function ja(t){return t.K_||(t.K_=function(n,r,s){const i=Pe(n);return i.w_(),new nP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:aP.bind(null,t),Ro:lP.bind(null,t),mo:cP.bind(null,t),d_:uP.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Lg(t)?Og(t):t.q_.set("Unknown")):(await t.K_.stop(),t1(t))})),t.K_}function gi(t){return t.U_||(t.U_=function(n,r,s){const i=Pe(n);return i.w_(),new rP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:fP.bind(null,t),mo:gP.bind(null,t),f_:mP.bind(null,t),g_:pP.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Eh(t)):(await t.U_.stop(),t.O_.length>0&&(xe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Mg(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vg(t,e){if(Ss("AsyncQueue",`${e}: ${t}`),Nc(t))return new ge(W.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ee.comparator(n.key,r.key):(n,r)=>Ee.comparator(n.key,r.key),this.keyedMap=dl(),this.sortedSet=new St(this.comparator)}static emptySet(e){return new ea(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ea)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ea;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(){this.W_=new St(Ee.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Ce():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class pa{constructor(e,n,r,s,i,a,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new pa(e,n,ea.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ph(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class vP{constructor(){this.queries=av(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=Pe(n),i=s.queries;s.queries=av(),i.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new ge(W.ABORTED,"Firestore shutting down"))}}function av(){return new Aa(t=>IE(t),ph)}async function Ug(t,e){const n=Pe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new xP,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=Vg(a,`Initialization of query '${Co(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&$g(n)}async function Fg(t,e){const n=Pe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wP(t,e){const n=Pe(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&$g(n)}function _P(t,e,n){const r=Pe(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function $g(t){t.Y_.forEach(e=>{e.next()})}var Xm,lv;(lv=Xm||(Xm={})).ea="default",lv.Cache="cache";class zg{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new pa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=pa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Xm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e){this.key=e}}class o1{constructor(e){this.key=e}}class bP{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ue(),this.mutatedKeys=Ue(),this.Aa=kE(e),this.Ra=new ea(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new ov,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const g=s.get(f),x=gh(this.query,m)?m:null,b=!!g&&this.mutatedKeys.has(g.key),R=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let T=!1;g&&x?g.data.isEqual(x.data)?b!==R&&(r.track({type:3,doc:x}),T=!0):this.ga(g,x)||(r.track({type:2,doc:x}),T=!0,(u&&this.Aa(x,u)>0||d&&this.Aa(x,d)<0)&&(l=!0)):!g&&x?(r.track({type:0,doc:x}),T=!0):g&&!x&&(r.track({type:1,doc:g}),T=!0,(u||d)&&(l=!0)),T&&(x?(a=a.add(x),i=R?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,m)=>function(x,b){const R=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce()}};return R(x)-R(b)}(f.type,m.type)||this.Aa(f.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,a.length!==0||d?{snapshot:new pa(this.query,e.Ra,i,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ov,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ue(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new o1(r))}),this.da.forEach(r=>{e.has(r)||n.push(new i1(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ue();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return pa.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class EP{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class SP{constructor(e){this.key=e,this.va=!1}}class NP{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Aa(l=>IE(l),ph),this.Ma=new Map,this.xa=new Set,this.Oa=new St(Ee.comparator),this.Na=new Map,this.La=new Ag,this.Ba={},this.ka=new Map,this.qa=ma.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function TP(t,e,n=!0){const r=h1(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await a1(r,e,n,!0),s}async function IP(t,e){const n=h1(t);await a1(n,e,!0,!1)}async function a1(t,e,n,r){const s=await QR(t.localStore,Hr(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await kP(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&ZE(t.remoteStore,s),l}async function kP(t,e,n,r,s){t.Ka=(m,g,x)=>async function(R,T,v,_){let y=T.view.ma(v);y.ns&&(y=await nv(R.localStore,T.query,!1).then(({documents:N})=>T.view.ma(N,y)));const A=_&&_.targetChanges.get(T.targetId),P=_&&_.targetMismatches.get(T.targetId)!=null,O=T.view.applyChanges(y,R.isPrimaryClient,A,P);return uv(R,T.targetId,O.wa),O.snapshot}(t,m,g,x);const i=await nv(t.localStore,e,!0),a=new bP(e,i.Ts),l=a.ma(i.documents),u=Ic.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=a.applyChanges(l,t.isPrimaryClient,u);uv(t,n,d.wa);const f=new EP(e,n,a);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function CP(t,e,n){const r=Pe(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!ph(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Qm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Pg(r.remoteStore,s.targetId),Ym(r,s.targetId)}).catch(Sc)):(Ym(r,s.targetId),await Qm(r.localStore,s.targetId,!0))}async function AP(t,e){const n=Pe(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Pg(n.remoteStore,r.targetId))}async function jP(t,e,n){const r=VP(t);try{const s=await function(a,l){const u=Pe(a),d=$t.now(),f=l.reduce((x,b)=>x.add(b.key),Ue());let m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let b=Ns(),R=Ue();return u.cs.getEntries(x,f).next(T=>{b=T,b.forEach((v,_)=>{_.isValidDocument()||(R=R.add(v))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,b)).next(T=>{m=T;const v=[];for(const _ of l){const y=Zj(_,m.get(_.key).overlayedDocument);y!=null&&v.push(new bi(_.key,y,vE(y.value.mapValue),Rn.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,v,l)}).next(T=>{g=T;const v=T.applyToLocalDocumentSet(m,R);return u.documentOverlayCache.saveOverlays(x,T.batchId,v)})}).then(()=>({batchId:g.batchId,changes:AE(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let d=a.Ba[a.currentUser.toKey()];d||(d=new St(Ge)),d=d.insert(l,u),a.Ba[a.currentUser.toKey()]=d}(r,s.batchId,n),await Cc(r,s.changes),await Eh(r.remoteStore)}catch(s){const i=Vg(s,"Failed to persist write");n.reject(i)}}async function l1(t,e){const n=Pe(t);try{const r=await WR(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(rt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?rt(a.va):s.removedDocuments.size>0&&(rt(a.va),a.va=!1))}),await Cc(n,r,e)}catch(r){await Sc(r)}}function cv(t,e,n){const r=Pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=Pe(a);u.onlineState=l;let d=!1;u.queries.forEach((f,m)=>{for(const g of m.j_)g.Z_(l)&&(d=!0)}),d&&$g(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RP(t,e,n){const r=Pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new St(Ee.comparator);a=a.insert(i,yn.newNoDocument(i,Re.min()));const l=Ue().add(i),u=new wh(Re.min(),new Map,new St(Ge),a,l);await l1(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Bg(r)}else await Qm(r.localStore,e,!1).then(()=>Ym(r,e,n)).catch(Sc)}async function PP(t,e){const n=Pe(t),r=e.batch.batchId;try{const s=await HR(n.localStore,e);u1(n,r,null),c1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Cc(n,s)}catch(s){await Sc(s)}}async function DP(t,e,n){const r=Pe(t);try{const s=await function(a,l){const u=Pe(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,l).next(m=>(rt(m!==null),f=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);u1(r,e,n),c1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Cc(r,s)}catch(s){await Sc(s)}}function c1(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function u1(t,e,n){const r=Pe(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ym(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||d1(t,r)})}function d1(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Pg(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Bg(t))}function uv(t,e,n){for(const r of n)r instanceof i1?(t.La.addReference(r.key,e),OP(t,r)):r instanceof o1?(xe("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||d1(t,r.key)):Ce()}function OP(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(xe("SyncEngine","New document in limbo: "+n),t.xa.add(r),Bg(t))}function Bg(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Ee(mt.fromString(e)),r=t.qa.next();t.Na.set(r,new SP(n)),t.Oa=t.Oa.insert(n,r),ZE(t.remoteStore,new Ys(Hr(mh(n.path)),r,"TargetPurposeLimboResolution",wg.oe))}}async function Cc(t,e,n){const r=Pe(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Rg.Wi(u.targetId,d);i.push(m)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,d){const f=Pe(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Q.forEach(d,g=>Q.forEach(g.$i,x=>f.persistence.referenceDelegate.addReference(m,g.targetId,x)).next(()=>Q.forEach(g.Ui,x=>f.persistence.referenceDelegate.removeReference(m,g.targetId,x)))))}catch(m){if(!Nc(m))throw m;xe("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const g=m.targetId;if(!m.fromCache){const x=f.os.get(g),b=x.snapshotVersion,R=x.withLastLimboFreeSnapshotVersion(b);f.os=f.os.insert(g,R)}}}(r.localStore,i))}async function LP(t,e){const n=Pe(t);if(!n.currentUser.isEqual(e)){xe("SyncEngine","User change. New user:",e.toKey());const r=await QE(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new ge(W.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Cc(n,r.hs)}}function MP(t,e){const n=Pe(t),r=n.Na.get(e);if(r&&r.va)return Ue().add(r.key);{let s=Ue();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function h1(t){const e=Pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=l1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RP.bind(null,e),e.Ca.d_=wP.bind(null,e.eventManager),e.Ca.$a=_P.bind(null,e.eventManager),e}function VP(t){const e=Pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=PP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DP.bind(null,e),e}class Dd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_h(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return qR(this.persistence,new zR,e.initialUser,this.serializer)}Ga(e){return new UR(jg.Zr,this.serializer)}Wa(e){return new YR}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dd.provider={build:()=>new Dd};class Jm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>cv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LP.bind(null,this.syncEngine),await yP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vP}()}createDatastore(e){const n=_h(e.databaseInfo.databaseId),r=function(i){return new tP(i)}(e.databaseInfo);return function(i,a,l,u){return new sP(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new oP(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>cv(this.syncEngine,n,0),function(){return sv.D()?new sv:new JR}())}createSyncEngine(e,n){return function(s,i,a,l,u,d,f){const m=new NP(s,i,a,l,u,d);return f&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Pe(s);xe("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await kc(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Jm.provider={build:()=>new Jm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ss("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=pn.UNAUTHENTICATED,this.clientId=gE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{xe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(xe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Vg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Cf(t,e){t.asyncQueue.verifyOperationInProgress(),xe("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await QE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function dv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await FP(t);xe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>iv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>iv(e.remoteStore,s)),t._onlineComponents=e}async function FP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){xe("FirestoreClient","Using user provided OfflineComponentProvider");try{await Cf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;ua("Error using user provided cache. Falling back to memory cache: "+n),await Cf(t,new Dd)}}else xe("FirestoreClient","Using default OfflineComponentProvider"),await Cf(t,new Dd);return t._offlineComponents}async function f1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(xe("FirestoreClient","Using user provided OnlineComponentProvider"),await dv(t,t._uninitializedComponentsProvider._online)):(xe("FirestoreClient","Using default OnlineComponentProvider"),await dv(t,new Jm))),t._onlineComponents}function $P(t){return f1(t).then(e=>e.syncEngine)}async function Od(t){const e=await f1(t),n=e.eventManager;return n.onListen=TP.bind(null,e.syncEngine),n.onUnlisten=CP.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=IP.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=AP.bind(null,e.syncEngine),n}function zP(t,e,n={}){const r=new gs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,d){const f=new qg({next:g=>{f.Za(),a.enqueueAndForget(()=>Fg(i,m));const x=g.docs.has(l);!x&&g.fromCache?d.reject(new ge(W.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&g.fromCache&&u&&u.source==="server"?d.reject(new ge(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new zg(mh(l.path),f,{includeMetadataChanges:!0,_a:!0});return Ug(i,m)}(await Od(t),t.asyncQueue,e,n,r)),r.promise}function BP(t,e,n={}){const r=new gs;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,d){const f=new qg({next:g=>{f.Za(),a.enqueueAndForget(()=>Fg(i,m)),g.fromCache&&u.source==="server"?d.reject(new ge(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new zg(l,f,{includeMetadataChanges:!0,_a:!0});return Ug(i,m)}(await Od(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p1(t,e,n){if(!n)throw new ge(W.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function qP(t,e,n,r){if(e===!0&&r===!0)throw new ge(W.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function fv(t){if(!Ee.isDocumentKey(t))throw new ge(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function mv(t){if(Ee.isDocumentKey(t))throw new ge(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Sh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ce()}function Pn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ge(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sh(t);throw new ge(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=m1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ge(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ge(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ge(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pv(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new aj;switch(r.type){case"firstParty":return new dj(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ge(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=hv.get(n);r&&(xe("ComponentProvider","Removing Datastore"),hv.delete(n),r.terminate())}(this),Promise.resolve()}}function HP(t,e,n,r={}){var s;const i=(t=Pn(t,Nh))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&ua("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=pn.MOCK_USER;else{l=Sb(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ge(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new pn(d)}t._authCredentials=new lj(new pE(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ei(this.firestore,e,this._query)}}class vn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}}class ci extends Ei{constructor(e,n,r){super(e,n,mh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new Ee(e))}withConverter(e){return new ci(this.firestore,e,this._path)}}function eo(t,e,...n){if(t=st(t),p1("collection","path",e),t instanceof Nh){const r=mt.fromString(e,...n);return mv(r),new ci(t,null,r)}{if(!(t instanceof vn||t instanceof ci))throw new ge(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(mt.fromString(e,...n));return mv(r),new ci(t.firestore,null,r)}}function zt(t,e,...n){if(t=st(t),arguments.length===1&&(e=gE.newId()),p1("doc","path",e),t instanceof Nh){const r=mt.fromString(e,...n);return fv(r),new vn(t,null,new Ee(r))}{if(!(t instanceof vn||t instanceof ci))throw new ge(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(mt.fromString(e,...n));return fv(r),new vn(t.firestore,t instanceof ci?t.converter:null,new Ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new YE(this,"async_queue_retry"),this.Vu=()=>{const r=kf();r&&xe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=kf();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=kf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new gs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Nc(e))throw e;xe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Ss("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Mg.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Ce()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function yv(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Qr extends Nh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new gv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gv(e),this._firestoreClient=void 0,await e}}}function WP(t,e){const n=typeof t=="object"?t:ag(),r=typeof t=="string"?t:"(default)",s=ch(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=_b("firestore");i&&HP(s,...i)}return s}function Ac(t){if(t._terminated)throw new ge(W.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GP(t),t._firestoreClient}function GP(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,d,f){return new Sj(l,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,m1(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new UP(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ga(on.fromBase64String(e))}catch(n){throw new ge(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ga(on.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ge(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ge(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ge(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=/^__.*__$/;class QP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new bi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Tc(e,this.data,n,this.fieldTransforms)}}class g1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new bi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function y1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce()}}class Gg{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Gg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ld(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(y1(this.Cu)&&KP.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class XP{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||_h(e)}Qu(e,n,r,s=!1){return new Gg({Cu:e,methodName:n,qu:r,path:tn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rc(t){const e=t._freezeSettings(),n=_h(t._databaseId);return new XP(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Kg(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Xg("Data must be an object, but it was:",a,r);const l=w1(r,a);let u,d;if(i.merge)u=new Xn(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const g=Zm(e,m,n);if(!a.contains(g))throw new ge(W.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);b1(f,g)||f.push(g)}u=new Xn(f),d=a.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=a.fieldTransforms;return new QP(new Vn(l),u,d)}class Ih extends Th{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ih}}class Qg extends Th{_toFieldTransform(e){return new Qj(e.path,new nc)}isEqual(e){return e instanceof Qg}}function x1(t,e,n,r){const s=t.Qu(1,e,n);Xg("Data must be an object, but it was:",s,r);const i=[],a=Vn.empty();lo(r,(u,d)=>{const f=Yg(e,u,n);d=st(d);const m=s.Nu(f);if(d instanceof Ih)i.push(f);else{const g=Pc(d,m);g!=null&&(i.push(f),a.set(f,g))}});const l=new Xn(i);return new g1(a,l,s.fieldTransforms)}function v1(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Zm(e,r,n)],u=[s];if(i.length%2!=0)throw new ge(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(Zm(e,i[g])),u.push(i[g+1]);const d=[],f=Vn.empty();for(let g=l.length-1;g>=0;--g)if(!b1(d,l[g])){const x=l[g];let b=u[g];b=st(b);const R=a.Nu(x);if(b instanceof Ih)d.push(x);else{const T=Pc(b,R);T!=null&&(d.push(x),f.set(x,T))}}const m=new Xn(d);return new g1(f,m,a.fieldTransforms)}function YP(t,e,n,r=!1){return Pc(n,t.Qu(r?4:3,e))}function Pc(t,e){if(_1(t=st(t)))return Xg("Unsupported field value:",e,t),w1(t,e);if(t instanceof Th)return function(r,s){if(!y1(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=Pc(l,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=st(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Wj(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=$t.fromDate(r);return{timestampValue:Rd(s.serializer,i)}}if(r instanceof $t){const i=new $t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Rd(s.serializer,i)}}if(r instanceof Hg)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ga)return{bytesValue:zE(s.serializer,r._byteString)};if(r instanceof vn){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Cg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Wg)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Tg(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Sh(r)}`)}(t,e)}function w1(t,e){const n={};return yE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,(r,s)=>{const i=Pc(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function _1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $t||t instanceof Hg||t instanceof ga||t instanceof vn||t instanceof Th||t instanceof Wg)}function Xg(t,e,n){if(!_1(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Sh(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Zm(t,e,n){if((e=st(e))instanceof jc)return e._internalPath;if(typeof e=="string")return Yg(t,e);throw Ld("Field path arguments must be of type string or ",t,!1,void 0,n)}const JP=new RegExp("[~\\*/\\[\\]]");function Yg(t,e,n){if(e.search(JP)>=0)throw Ld(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jc(...e.split("."))._internalPath}catch{throw Ld(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ld(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new ge(W.INVALID_ARGUMENT,l+t+u)}function b1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(kh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ZP extends E1{data(){return super.data()}}function kh(t,e){return typeof e=="string"?Yg(t,e):e instanceof jc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ge(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jg{}class N1 extends Jg{}function ic(t,e,...n){let r=[];e instanceof Jg&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof e0).length,l=i.filter(u=>u instanceof Ch).length;if(a>1||a>0&&l>0)throw new ge(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Ch extends N1{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ch(e,n,r)}_apply(e){const n=this._parse(e);return T1(e._query,n),new Ei(e.firestore,e.converter,Bm(e._query,n))}_parse(e){const n=Rc(e.firestore);return function(i,a,l,u,d,f,m){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new ge(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){vv(m,f);const x=[];for(const b of m)x.push(xv(u,i,b));g={arrayValue:{values:x}}}else g=xv(u,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||vv(m,f),g=YP(l,a,m,f==="in"||f==="not-in");return Ot.create(d,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Zg(t,e,n){const r=e,s=kh("where",t);return Ch._create(s,r,n)}class e0 extends Jg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new e0(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:jr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)T1(a,u),a=Bm(a,u)}(e._query,n),new Ei(e.firestore,e.converter,Bm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class t0 extends N1{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t0(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new ge(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ge(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tc(i,a)}(e._query,this._field,this._direction);return new Ei(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new Ca(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Md(t,e="asc"){const n=e,r=kh("orderBy",t);return t0._create(r,n)}function xv(t,e,n){if(typeof(n=st(n))=="string"){if(n==="")throw new ge(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!TE(e)&&n.indexOf("/")!==-1)throw new ge(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(mt.fromString(n));if(!Ee.isDocumentKey(r))throw new ge(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ux(t,new Ee(r))}if(n instanceof vn)return Ux(t,n._key);throw new ge(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sh(n)}.`)}function vv(t,e){if(!Array.isArray(t)||t.length===0)throw new ge(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function T1(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ge(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class e4{convertValue(e,n="none"){switch(Zi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return At(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return lo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>At(a.doubleValue));return new Wg(i)}convertGeoPoint(e){return new Hg(At(e.latitude),At(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=bg(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Jl(e));default:return null}}convertTimestamp(e){const n=pi(e);return new $t(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=mt.fromString(e);rt(KE(r));const s=new Zl(r.get(1),r.get(3)),i=new Ee(r.popFirst(5));return s.isEqual(n)||Ss(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class I1 extends E1{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Wu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(kh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Wu extends I1{data(e={}){return super.data(e)}}class k1{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new fl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Wu(this._firestore,this._userDataWriter,r.key,r,new fl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ge(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new Wu(s._firestore,s._userDataWriter,l.doc.key,l.doc,new fl(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Wu(s._firestore,s._userDataWriter,l.doc.key,l.doc,new fl(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),f=a.indexOf(l.doc.key)),{type:t4(l.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function t4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(t){t=Pn(t,vn);const e=Pn(t.firestore,Qr);return zP(Ac(e),t._key).then(n=>j1(e,t,n))}class r0 extends e4{constructor(e){super(),this.firestore=e}convertBytes(e){return new ga(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,n)}}function C1(t){t=Pn(t,Ei);const e=Pn(t.firestore,Qr),n=Ac(e),r=new r0(e);return S1(t._query),BP(n,t._query).then(s=>new k1(e,r,t,s))}function s0(t,e,n){t=Pn(t,vn);const r=Pn(t.firestore,Qr),s=n0(t.converter,e,n);return Dc(r,[Kg(Rc(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Rn.none())])}function Pa(t,e,n,...r){t=Pn(t,vn);const s=Pn(t.firestore,Qr),i=Rc(s);let a;return a=typeof(e=st(e))=="string"||e instanceof jc?v1(i,"updateDoc",t._key,e,n,r):x1(i,"updateDoc",t._key,e),Dc(s,[a.toMutation(t._key,Rn.exists(!0))])}function A1(t){return Dc(Pn(t.firestore,Qr),[new vh(t._key,Rn.none())])}function n4(t,e){const n=Pn(t.firestore,Qr),r=zt(t),s=n0(t.converter,e);return Dc(n,[Kg(Rc(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Rn.exists(!1))]).then(()=>r)}function ep(t,...e){var n,r,s;t=st(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||yv(e[a])||(i=e[a],a++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(yv(e[a])){const m=e[a];e[a]=(n=m.next)===null||n===void 0?void 0:n.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let u,d,f;if(t instanceof vn)d=Pn(t.firestore,Qr),f=mh(t._key.path),u={next:m=>{e[a]&&e[a](j1(d,t,m))},error:e[a+1],complete:e[a+2]};else{const m=Pn(t,Ei);d=Pn(m.firestore,Qr),f=m._query;const g=new r0(d);u={next:x=>{e[a]&&e[a](new k1(d,g,m,x))},error:e[a+1],complete:e[a+2]},S1(t._query)}return function(g,x,b,R){const T=new qg(R),v=new zg(x,T,b);return g.asyncQueue.enqueueAndForget(async()=>Ug(await Od(g),v)),()=>{T.Za(),g.asyncQueue.enqueueAndForget(async()=>Fg(await Od(g),v))}}(Ac(d),f,l,u)}function Dc(t,e){return function(r,s){const i=new gs;return r.asyncQueue.enqueueAndForget(async()=>jP(await $P(r),s,i)),i.promise}(Ac(t),e)}function j1(t,e,n){const r=n.docs.get(e._key),s=new r0(t);return new I1(t,s,e._key,r,new fl(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Rc(e)}set(e,n,r){this._verifyNotCommitted();const s=Af(e,this._firestore),i=n0(s.converter,n,r),a=Kg(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,Rn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Af(e,this._firestore);let a;return a=typeof(n=st(n))=="string"||n instanceof jc?v1(this._dataReader,"WriteBatch.update",i._key,n,r,s):x1(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,Rn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Af(e,this._firestore);return this._mutations=this._mutations.concat(new vh(n._key,Rn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ge(W.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Af(t,e){if((t=st(t)).firestore!==e)throw new ge(W.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Dn(){return new Qg("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i0(t){return Ac(t=Pn(t,Qr)),new r4(t,e=>Dc(t,e))}(function(e,n=!0){(function(s){ka=s})(ao),Ki(new fi("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Qr(new cj(r.getProvider("auth-internal")),new fj(r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ge(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zl(d.options.projectId,f)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Br(Dx,"4.7.3",e),Br(Dx,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1="firebasestorage.googleapis.com",P1="storageBucket",s4=2*60*1e3,i4=10*60*1e3,o4=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt extends Jr{constructor(e,n,r=0){super(jf(e),`Firebase Storage: ${n} (${jf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return jf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var dt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(dt||(dt={}));function jf(t){return"storage/"+t}function o0(){const t="An unknown error occurred, please check the error payload for server response.";return new xt(dt.UNKNOWN,t)}function a4(t){return new xt(dt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function l4(t){return new xt(dt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function c4(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new xt(dt.UNAUTHENTICATED,t)}function u4(){return new xt(dt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function d4(t){return new xt(dt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function D1(){return new xt(dt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function O1(){return new xt(dt.CANCELED,"User canceled the upload/download.")}function h4(t){return new xt(dt.INVALID_URL,"Invalid URL '"+t+"'.")}function f4(t){return new xt(dt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function m4(){return new xt(dt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+P1+"' property when initializing the app?")}function L1(){return new xt(dt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function p4(){return new xt(dt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function g4(){return new xt(dt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function y4(t){return new xt(dt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Vd(t){return new xt(dt.INVALID_ARGUMENT,t)}function M1(){return new xt(dt.APP_DELETED,"The Firebase app was deleted.")}function V1(t){return new xt(dt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function kl(t,e){return new xt(dt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function nl(t){throw new xt(dt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=xn.makeFromUrl(e,n)}catch{return new xn(e,"")}if(r.path==="")return r;throw f4(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+s+a,"i"),u={bucket:1,path:3};function d(A){A.path_=decodeURIComponent(A.path)}const f="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${f}/b/${s}/o${g}`,"i"),b={bucket:1,path:3},R=n===R1?"(?:storage.googleapis.com|storage.cloud.google.com)":n,T="([^?#]*)",v=new RegExp(`^https?://${R}/${s}/${T}`,"i"),y=[{regex:l,indices:u,postModify:i},{regex:x,indices:b,postModify:d},{regex:v,indices:{bucket:1,path:2},postModify:d}];for(let A=0;A<y.length;A++){const P=y[A],O=P.regex.exec(e);if(O){const N=O[P.indices.bucket];let w=O[P.indices.path];w||(w=""),r=new xn(N,w),P.postModify(r);break}}if(r==null)throw h4(e);return r}}class x4{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(t,e,n){let r=1,s=null,i=null,a=!1,l=0;function u(){return l===2}let d=!1;function f(...T){d||(d=!0,e.apply(null,T))}function m(T){s=setTimeout(()=>{s=null,t(x,u())},T)}function g(){i&&clearTimeout(i)}function x(T,...v){if(d){g();return}if(T){g(),f.call(null,T,...v);return}if(u()||a){g(),f.call(null,T,...v);return}r<64&&(r*=2);let y;l===1?(l=2,y=0):y=(r+Math.random())*1e3,m(y)}let b=!1;function R(T){b||(b=!0,g(),!d&&(s!==null?(T||(l=2),clearTimeout(s),m(0)):T||(l=1)))}return m(0),i=setTimeout(()=>{a=!0,R(!0)},n),R}function w4(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(t){return t!==void 0}function b4(t){return typeof t=="function"}function E4(t){return typeof t=="object"&&!Array.isArray(t)}function Ah(t){return typeof t=="string"||t instanceof String}function wv(t){return a0()&&t instanceof Blob}function a0(){return typeof Blob<"u"}function tp(t,e,n,r){if(r<e)throw Vd(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Vd(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function U1(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var zi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(zi||(zi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,n,r,s,i,a,l,u,d,f,m,g=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=f,this.connectionFactory_=m,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,b)=>{this.resolve_=x,this.reject_=b,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new _u(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=l=>{const u=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const l=i.getErrorCode()===zi.NO_ERROR,u=i.getStatus();if(!l||F1(u,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===zi.ABORT;r(!1,new _u(!1,null,f));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new _u(d,i))})},n=(r,s)=>{const i=this.resolve_,a=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());_4(u)?i(u):i()}catch(u){a(u)}else if(l!==null){const u=o0();u.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,u)):a(u)}else if(s.canceled){const u=this.appDelete_?M1():O1();a(u)}else{const u=D1();a(u)}};this.canceled_?n(!1,new _u(!1,null,!0)):this.backoffId_=v4(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&w4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class _u{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function N4(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function T4(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function I4(t,e){e&&(t["X-Firebase-GMPID"]=e)}function k4(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function C4(t,e,n,r,s,i,a=!0){const l=U1(t.urlParams),u=t.url+l,d=Object.assign({},t.headers);return I4(d,e),N4(d,n),T4(d,i),k4(d,r),new S4(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A4(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function j4(...t){const e=A4();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(a0())return new Blob(t);throw new xt(dt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function R4(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P4(t){if(typeof atob>"u")throw y4("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Rf{constructor(e,n){this.data=e,this.contentType=n||null}}function $1(t,e){switch(t){case Sr.RAW:return new Rf(z1(e));case Sr.BASE64:case Sr.BASE64URL:return new Rf(B1(t,e));case Sr.DATA_URL:return new Rf(O4(e),L4(e))}throw o0()}function z1(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=t.charCodeAt(++n);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function D4(t){let e;try{e=decodeURIComponent(t)}catch{throw kl(Sr.DATA_URL,"Malformed data URL.")}return z1(e)}function B1(t,e){switch(t){case Sr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw kl(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Sr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw kl(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=P4(e)}catch(s){throw s.message.includes("polyfill")?s:kl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class q1{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw kl(Sr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=M4(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function O4(t){const e=new q1(t);return e.base64?B1(Sr.BASE64,e.rest):D4(e.rest)}function L4(t){return new q1(t).contentType}function M4(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n){let r=0,s="";wv(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(wv(this.data_)){const r=this.data_,s=R4(r,e,n);return s===null?null:new Fr(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Fr(r,!0)}}static getBlob(...e){if(a0()){const n=e.map(r=>r instanceof Fr?r.data_:r);return new Fr(j4.apply(null,n))}else{const n=e.map(a=>Ah(a)?$1(Sr.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(a=>{for(let l=0;l<a.length;l++)s[i++]=a[l]}),new Fr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(t){let e;try{e=JSON.parse(t)}catch{return null}return E4(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function U4(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function H1(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F4(t,e){return e}class In{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||F4}}let bu=null;function $4(t){return!Ah(t)||t.length<2?t:H1(t)}function c0(){if(bu)return bu;const t=[];t.push(new In("bucket")),t.push(new In("generation")),t.push(new In("metageneration")),t.push(new In("name","fullPath",!0));function e(i,a){return $4(a)}const n=new In("name");n.xform=e,t.push(n);function r(i,a){return a!==void 0?Number(a):a}const s=new In("size");return s.xform=r,t.push(s),t.push(new In("timeCreated")),t.push(new In("updated")),t.push(new In("md5Hash",null,!0)),t.push(new In("cacheControl",null,!0)),t.push(new In("contentDisposition",null,!0)),t.push(new In("contentEncoding",null,!0)),t.push(new In("contentLanguage",null,!0)),t.push(new In("contentType",null,!0)),t.push(new In("metadata","customMetadata",!0)),bu=t,bu}function z4(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new xn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function B4(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const a=n[i];r[a.local]=a.xform(r,e[a.server])}return z4(r,t),r}function W1(t,e,n){const r=l0(e);return r===null?null:B4(t,r,n)}function q4(t,e,n,r){const s=l0(e);if(s===null||!Ah(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(d=>{const f=t.bucket,m=t.fullPath,g="/b/"+a(f)+"/o/"+a(m),x=uo(g,n,r),b=U1({alt:"media",token:d});return x+b})[0]}function G1(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v="prefixes",bv="items";function H4(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[_v])for(const s of n[_v]){const i=s.replace(/\/$/,""),a=t._makeStorageReference(new xn(e,i));r.prefixes.push(a)}if(n[bv])for(const s of n[bv]){const i=t._makeStorageReference(new xn(e,s.name));r.items.push(i)}return r}function W4(t,e,n){const r=l0(n);return r===null?null:H4(t,e,r)}class Si{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(t){if(!t)throw o0()}function u0(t,e){function n(r,s){const i=W1(t,s,e);return Gr(i!==null),i}return n}function G4(t,e){function n(r,s){const i=W4(t,e,s);return Gr(i!==null),i}return n}function K4(t,e){function n(r,s){const i=W1(t,s,e);return Gr(i!==null),q4(i,s,t.host,t._protocol)}return n}function Da(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=u4():s=c4():n.getStatus()===402?s=l4(t.bucket):n.getStatus()===403?s=d4(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function d0(t){const e=Da(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=a4(t.path)),i.serverResponse=s.serverResponse,i}return n}function Q4(t,e,n){const r=e.fullServerUrl(),s=uo(r,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,l=new Si(s,i,u0(t,n),a);return l.errorHandler=d0(e),l}function X4(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const a=e.bucketOnlyServerUrl(),l=uo(a,t.host,t._protocol),u="GET",d=t.maxOperationRetryTime,f=new Si(l,u,G4(t,e.bucket),d);return f.urlParams=i,f.errorHandler=Da(e),f}function Y4(t,e,n){const r=e.fullServerUrl(),s=uo(r,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,l=new Si(s,i,K4(t,n),a);return l.errorHandler=d0(e),l}function J4(t,e){const n=e.fullServerUrl(),r=uo(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(u,d){}const l=new Si(r,s,a,i);return l.successCodes=[200,204],l.errorHandler=d0(e),l}function Z4(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function K1(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=Z4(null,e)),r}function Q1(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function l(){let y="";for(let A=0;A<2;A++)y=y+Math.random().toString().slice(2);return y}const u=l();a["Content-Type"]="multipart/related; boundary="+u;const d=K1(e,r,s),f=G1(d,n),m="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,g=`\r
--`+u+"--",x=Fr.getBlob(m,r,g);if(x===null)throw L1();const b={name:d.fullPath},R=uo(i,t.host,t._protocol),T="POST",v=t.maxUploadRetryTime,_=new Si(R,T,u0(t,n),v);return _.urlParams=b,_.headers=a,_.body=x.uploadData(),_.errorHandler=Da(e),_}class Ud{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function h0(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Gr(!1)}return Gr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function e5(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),a=K1(e,r,s),l={name:a.fullPath},u=uo(i,t.host,t._protocol),d="POST",f={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},m=G1(a,n),g=t.maxUploadRetryTime;function x(R){h0(R);let T;try{T=R.getResponseHeader("X-Goog-Upload-URL")}catch{Gr(!1)}return Gr(Ah(T)),T}const b=new Si(u,d,x,g);return b.urlParams=l,b.headers=f,b.body=m,b.errorHandler=Da(e),b}function t5(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(d){const f=h0(d,["active","final"]);let m=null;try{m=d.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Gr(!1)}m||Gr(!1);const g=Number(m);return Gr(!isNaN(g)),new Ud(g,r.size(),f==="final")}const a="POST",l=t.maxUploadRetryTime,u=new Si(n,a,i,l);return u.headers=s,u.errorHandler=Da(e),u}const Ev=256*1024;function n5(t,e,n,r,s,i,a,l){const u=new Ud(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw p4();const d=u.total-u.current;let f=d;s>0&&(f=Math.min(f,s));const m=u.current,g=m+f;let x="";f===0?x="finalize":d===f?x="upload, finalize":x="upload";const b={"X-Goog-Upload-Command":x,"X-Goog-Upload-Offset":`${u.current}`},R=r.slice(m,g);if(R===null)throw L1();function T(A,P){const O=h0(A,["active","final"]),N=u.current+f,w=r.size();let I;return O==="final"?I=u0(e,i)(A,P):I=null,new Ud(N,w,O==="final",I)}const v="POST",_=e.maxUploadRetryTime,y=new Si(n,v,T,_);return y.headers=b,y.body=R.uploadData(),y.progressCallback=l||null,y.errorHandler=Da(t),y}const An={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Pf(t){switch(t){case"running":case"pausing":case"canceling":return An.RUNNING;case"paused":return An.PAUSED;case"success":return An.SUCCESS;case"canceled":return An.CANCELED;case"error":return An.ERROR;default:return An.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e,n,r){if(b4(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class s5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw nl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw nl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw nl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw nl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw nl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class i5 extends s5{initXhr(){this.xhr_.responseType="text"}}function as(){return new i5}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=c0(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(dt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(F1(s.status,[]))if(i)s=D1();else{this.sleepTime=Math.max(this.sleepTime*2,o4),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(dt.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=e5(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,as,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=t5(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,as,n,r);this._request=i,i.getPromise().then(a=>{a=a,this._request=void 0,this._updateProgress(a.current),this._needToFetchStatus=!1,a.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Ev*this._chunkMultiplier,n=new Ud(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let a;try{a=n5(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){this._error=u,this._transition("error");return}const l=this._ref.storage._makeRequest(a,as,s,i,!1);this._request=l,l.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){Ev*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=Q4(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,as,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=Q1(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,as,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=O1(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Pf(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new r5(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Pf(this._state)){case An.SUCCESS:Io(this._resolve.bind(null,this.snapshot))();break;case An.CANCELED:case An.ERROR:const n=this._reject;Io(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Pf(this._state)){case An.RUNNING:case An.PAUSED:e.next&&Io(e.next.bind(e,this.snapshot))();break;case An.SUCCESS:e.complete&&Io(e.complete.bind(e))();break;case An.CANCELED:case An.ERROR:e.error&&Io(e.error.bind(e,this._error))();break;default:e.error&&Io(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,n){this._service=e,n instanceof xn?this._location=n:this._location=xn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new to(e,n)}get root(){const e=new xn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return H1(this._location.path)}get storage(){return this._service}get parent(){const e=V4(this._location.path);if(e===null)return null;const n=new xn(this._location.bucket,e);return new to(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw V1(e)}}function o5(t,e,n){t._throwIfRoot("uploadBytes");const r=Q1(t.storage,t._location,c0(),new Fr(e,!0),n);return t.storage.makeRequestWithTokens(r,as).then(s=>({metadata:s,ref:t}))}function a5(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new X1(t,new Fr(e),n)}function l5(t){const e={prefixes:[],items:[]};return Y1(t,e).then(()=>e)}async function Y1(t,e,n){const s=await c5(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await Y1(t,e,s.nextPageToken)}function c5(t,e){e!=null&&typeof e.maxResults=="number"&&tp("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=X4(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,as)}function u5(t){t._throwIfRoot("getDownloadURL");const e=Y4(t.storage,t._location,c0());return t.storage.makeRequestWithTokens(e,as).then(n=>{if(n===null)throw g4();return n})}function d5(t){t._throwIfRoot("deleteObject");const e=J4(t.storage,t._location);return t.storage.makeRequestWithTokens(e,as)}function h5(t,e){const n=U4(t._location.path,e),r=new xn(t._location.bucket,n);return new to(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(t){return/^[A-Za-z]+:\/\//.test(t)}function m5(t,e){return new to(t,e)}function J1(t,e){if(t instanceof f0){const n=t;if(n._bucket==null)throw m4();const r=new to(n,n._bucket);return e!=null?J1(r,e):r}else return e!==void 0?h5(t,e):t}function p5(t,e){if(e&&f5(e)){if(t instanceof f0)return m5(t,e);throw Vd("To use ref(service, url), the first argument must be a Storage instance.")}else return J1(t,e)}function Sv(t,e){const n=e==null?void 0:e[P1];return n==null?null:xn.makeFromBucketSpec(n,t)}function g5(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:Sb(s,t.app.options.projectId))}class f0{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=R1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=s4,this._maxUploadRetryTime=i4,this._requests=new Set,s!=null?this._bucket=xn.makeFromBucketSpec(s,this._host):this._bucket=Sv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=xn.makeFromBucketSpec(this._url,e):this._bucket=Sv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){tp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){tp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new to(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new x4(M1());{const a=C4(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Nv="@firebase/storage",Tv="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="storage";function m0(t,e,n){return t=st(t),o5(t,e,n)}function eS(t,e,n){return t=st(t),a5(t,e,n)}function Fd(t){return t=st(t),l5(t)}function oc(t){return t=st(t),u5(t)}function no(t){return t=st(t),d5(t)}function Xr(t,e){return t=st(t),p5(t,e)}function tS(t=ag(),e){t=st(t);const r=ch(t,Z1).getImmediate({identifier:e}),s=_b("storage");return s&&nS(r,...s),r}function nS(t,e,n,r={}){g5(t,e,n,r)}function y5(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new f0(n,r,s,e,ao)}function x5(){Ki(new fi(Z1,y5,"PUBLIC").setMultipleInstances(!0)),Br(Nv,Tv,""),Br(Nv,Tv,"esm2017")}x5();const ac=Object.freeze(Object.defineProperty({__proto__:null,StorageError:xt,get StorageErrorCode(){return dt},StringFormat:Sr,_FbsBlob:Fr,_Location:xn,_TaskState:An,_UploadTask:X1,_dataFromString:$1,_invalidArgument:Vd,_invalidRootOperation:V1,connectStorageEmulator:nS,deleteObject:no,getDownloadURL:oc,getStorage:tS,listAll:Fd,ref:Xr,uploadBytes:m0,uploadBytesResumable:eS},Symbol.toStringTag,{value:"Module"})),v5={apiKey:"AIzaSyBxqEJAHyV4jyeE1-GW-dOeECyLXRAsjiM",authDomain:"salsahacks-a9cac.firebaseapp.com",projectId:"salsahacks-a9cac",storageBucket:"salsahacks-a9cac.firebasestorage.app",messagingSenderId:"934621871243",appId:"1:934621871243:web:9107fa3b61d9b9928fa88e"},p0=Ib(v5),ho=ij(p0),at=WP(p0),Yr=tS(p0),rS=Object.freeze(Object.defineProperty({__proto__:null,auth:ho,db:at,storage:Yr},Symbol.toStringTag,{value:"Module"})),w5=async(t,e,n)=>{try{const r=await $C(ho,t,e);return n&&await qC(r.user,{displayName:n}),{user:r.user,error:null}}catch(r){return{user:null,error:r.message}}},_5=async(t,e)=>{try{return{user:(await zC(ho,t,e)).user,error:null}}catch(n){return{user:null,error:n.message}}},b5=async()=>{try{const t=new os;return{user:(await mA(ho,t)).user,error:null}}catch(t){return{user:null,error:t.message}}},E5=async()=>{try{return await KC(ho),{error:null}}catch(t){return{error:t.message}}},S5=async t=>{try{return await FC(ho,t),{error:null}}catch(e){return{error:e.message}}},N5=t=>GC(ho,t),Kt={USERS:"users",NOTES:"notes",CATEGORIES:"categories",EVENTS:"events",FIGURES:"figures",SCHOOL:"school",INVITATIONS:"invitations",VIDEOS:"videos"},Iv=async(t,e)=>{try{return console.log("📝 Creando perfil de usuario en Firestore:",t),await s0(zt(at,Kt.USERS,t),{uid:t,...e,createdAt:Dn(),updatedAt:Dn()}),console.log("✅ Perfil de usuario creado exitosamente en Firestore"),{success:!0,error:null}}catch(n){return console.error("❌ Error al crear perfil de usuario:",n),{success:!1,error:n.message}}},Eu=async t=>{try{console.log("🔍 Buscando perfil de usuario:",t);const e=zt(at,Kt.USERS,t),n=await Ra(e);if(n.exists()){const r={id:n.id,...n.data()};return console.log("✅ Perfil de usuario encontrado:",r),{user:r,error:null}}return console.log("❌ Usuario no encontrado en Firestore"),{user:null,error:"Usuario no encontrado"}}catch(e){return console.error("❌ Error al obtener perfil de usuario:",e),{user:null,error:e.message}}},Df=async(t,e)=>{try{console.log("📝 Actualizando perfil de usuario:",t,e);const n=zt(at,Kt.USERS,t);return await Pa(n,{...e,updatedAt:Dn()}),console.log("✅ Perfil de usuario actualizado exitosamente"),{success:!0,error:null}}catch(n){return console.error("❌ Error al actualizar perfil de usuario:",n),{success:!1,error:n.message}}},T5=async t=>{try{const e=C5(),n=new Date;n.setDate(n.getDate()+t.expiresInDays);const r={code:e,email:t.email,displayName:t.displayName,username:t.username,role:t.role,createdBy:t.createdBy,createdAt:Dn(),expiresAt:n,status:"pending",usedAt:null,usedBy:null};return await s0(zt(at,"invitations",e),r),{success:!0,invitationCode:e,invitation:r}}catch(e){return console.error("Error creating invitation:",e),{success:!1,error:e.message}}},I5=async t=>{try{const e=zt(at,"invitations",t),n=await Ra(e);if(!n.exists())return{success:!1,error:"Invitación no encontrada"};const r=n.data();return r.status==="used"?{success:!1,error:"Esta invitación ya ha sido utilizada"}:r.expiresAt&&r.expiresAt.toDate()<new Date?{success:!1,error:"Esta invitación ha expirado"}:{success:!0,invitation:r}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},k5=async(t,e)=>{try{const n=zt(at,"invitations",t);return await Pa(n,{status:"used",usedAt:Dn(),usedBy:e}),{success:!0}}catch(n){return console.error("Error marking invitation as used:",n),{success:!1,error:n.message}}},C5=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let n=0;n<8;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},A5=async t=>{try{console.log("📹 Creando documento de video en Firestore:",t.title);const e=zt(eo(at,Kt.VIDEOS));return await s0(e,{...t,id:e.id,bpm:t.bpm||null,bpmDetected:t.bpmDetected||!1,createdAt:Dn(),updatedAt:Dn()}),console.log("✅ Documento de video creado exitosamente:",e.id),{success:!0,id:e.id,error:null}}catch(e){return console.error("❌ Error al crear documento de video:",e),{success:!1,error:e.message}}},Gu=async(t,e)=>{try{console.log("📝 Actualizando video:",t,e);const n=zt(at,Kt.VIDEOS,t);return await Pa(n,{...e,updatedAt:Dn()}),console.log("✅ Video actualizado exitosamente"),{success:!0,error:null}}catch(n){return console.error("❌ Error al actualizar video:",n),{success:!1,error:n.message}}},np=async(t,e)=>{try{console.log("❤️ Toggle like para video:",t,"usuario:",e);const n=zt(at,Kt.VIDEOS,t),r=await Ra(n);if(!r.exists())throw new Error("Video no encontrado");const s=r.data(),i=s.likedBy||[],a=s.likes||0,l=i.indexOf(e);let u,d;l===-1?(u=[...i,e],d=a+1,console.log("✅ Like agregado por usuario:",e)):(u=i.filter(m=>m!==e),d=a-1,console.log("✅ Like removido por usuario:",e)),await Pa(n,{likes:d,likedBy:u,updatedAt:Dn()});let f=null;try{l===-1?(f=await kv(t,e),console.log("⭐ Video agregado automáticamente a favoritos")):(f=await kv(t,e),console.log("⭐ Video removido automáticamente de favoritos"))}catch(m){console.error("⚠️ Error al manejar favoritos automáticamente:",m)}return console.log(`✅ Video actualizado: ${d} likes, ${u.length} usuarios`),{success:!0,likes:d,likedBy:u,userLiked:l===-1,isFavorite:(f==null?void 0:f.isFavorite)||!1,error:null}}catch(n){return console.error("❌ Error al toggle like:",n),{success:!1,error:n.message}}},j5=async(t,e)=>{try{const n=zt(at,Kt.VIDEOS,t),r=await Ra(n);return r.exists()?{userLiked:(r.data().likedBy||[]).includes(e),error:null}:{userLiked:!1,error:"Video no encontrado"}}catch(n){return console.error("❌ Error al verificar like del usuario:",n),{userLiked:!1,error:n.message}}},kv=async(t,e)=>{try{console.log("⭐ Toggle favorito para video:",t,"usuario:",e);const n=zt(at,Kt.USERS,e),r=await Ra(n);if(!r.exists())throw new Error("Usuario no encontrado");const i=r.data().favorites||[],a=i.indexOf(t);let l;return a===-1?(l=[...i,t],console.log("✅ Video agregado a favoritos del usuario:",e)):(l=i.filter(u=>u!==t),console.log("✅ Video removido de favoritos del usuario:",e)),await Pa(n,{favorites:l,updatedAt:Dn()}),console.log(`✅ Perfil de usuario actualizado: ${l.length} favoritos`),{success:!0,favorites:l,isFavorite:a===-1,error:null}}catch(n){return console.error("❌ Error al toggle favorito:",n),{success:!1,error:n.message}}},R5=async(t,e)=>{try{const n=zt(at,Kt.USERS,e),r=await Ra(n);return r.exists()?{isFavorite:(r.data().favorites||[]).includes(t),error:null}:{isFavorite:!1,error:"Usuario no encontrado"}}catch(n){return console.error("❌ Error al verificar favorito del usuario:",n),{isFavorite:!1,error:n.message}}},P5=async t=>{try{console.log("🗑️ Eliminando video de Firestore:",t),console.log("📁 Colección:",Kt.VIDEOS);const e=zt(at,Kt.VIDEOS,t);return console.log("📄 Referencia del documento:",e.path),await A1(e),console.log("✅ Video eliminado exitosamente de Firestore"),{success:!0,error:null}}catch(e){return console.error("❌ Error al eliminar video de Firestore:",e),console.error("❌ Código de error:",e.code),console.error("❌ Mensaje de error:",e.message),{success:!1,error:e.message}}},D5=async t=>{try{console.log("🔍 Verificando duplicado:",t);const e=ic(eo(at,Kt.VIDEOS),Zg("originalTitle","==",t)),r=!(await C1(e)).empty;return console.log(`✅ Verificación de duplicado: ${r?"SÍ":"NO"}`),{isDuplicate:r,error:null}}catch(e){return console.error("❌ Error al verificar duplicado:",e),{isDuplicate:!1,error:e.message}}},ya=async()=>{try{console.log("🔍 Obteniendo todos los videos...");const t=ic(eo(at,Kt.VIDEOS),Md("uploadedAt","desc")),e=await C1(t),n=[];return e.forEach(r=>{n.push({id:r.id,...r.data()})}),console.log(`✅ ${n.length} videos obtenidos`),n}catch(t){return console.error("❌ Error al obtener videos:",t),[]}},O5=(t,e)=>{try{console.log(`🔄 Iniciando suscripción en tiempo real a videos de estilo: ${t}`);const n=ic(eo(at,Kt.VIDEOS),Zg("style","==",t),Md("uploadedAt","desc"));return ep(n,s=>{const i=[];s.forEach(a=>{i.push({id:a.id,...a.data()})}),console.log(`🔄 Actualización en tiempo real para ${t}: ${i.length} videos`),e(i)},s=>{if(console.error(`❌ Error en suscripción de videos de ${t}:`,s),s.code==="failed-precondition"||s.message.includes("index")){console.log(`⚠️ Usando fallback para ${t} (sin índice)`);const i=ic(eo(at,Kt.VIDEOS),Md("uploadedAt","desc"));return ep(i,l=>{const u=[];l.forEach(f=>{u.push({id:f.id,...f.data()})});const d=u.filter(f=>f.style===t);console.log(`🔄 Fallback: ${d.length} videos de ${t} de ${u.length} total`),e(d)},l=>{console.error(`❌ Error en fallback para ${t}:`,l)})}})}catch(n){return console.error(`❌ Error al iniciar suscripción de videos de ${t}:`,n),()=>{}}},L5=async()=>{try{console.log("🗑️ Iniciando eliminación de todos los videos...");const t=await ya();if(console.log(`📊 Videos a eliminar: ${t.length}`),t.length===0)return console.log("✅ No hay videos para eliminar"),{success:!0,deletedCount:0,error:null};const e=i0(at);let n=0;return t.forEach(r=>{const s=zt(at,Kt.VIDEOS,r.id);e.delete(s),n++}),await e.commit(),console.log(`✅ ${n} videos eliminados de Firestore`),{success:!0,deletedCount:n,error:null}}catch(t){return console.error("❌ Error al eliminar todos los videos:",t),{success:!1,deletedCount:0,error:t.message}}},M5=async()=>{try{console.log("🔧 Iniciando actualización de rutas de thumbnails...");const t=await ya();if(console.log(`📊 Videos a actualizar: ${t.length}`),t.length===0)return console.log("✅ No hay videos para actualizar"),{success:!0,updatedCount:0,error:null};const e=i0(at);let n=0;return t.forEach(r=>{if(!r.thumbnailPath||r.thumbnailPath==="placeholder"){const s=zt(at,Kt.VIDEOS,r.id);e.update(s,{thumbnailPath:null,updatedAt:Dn()}),n++}}),n>0?(await e.commit(),console.log(`✅ ${n} videos actualizados`)):console.log("✅ No se requirieron actualizaciones"),{success:!0,updatedCount:n,error:null}}catch(t){return console.error("❌ Error al actualizar rutas de thumbnails:",t),{success:!1,updatedCount:0,error:t.message}}},V5=async()=>{try{console.log("🔍 Iniciando diagnóstico de videos...");const t=await ya();console.log(`📊 Total de videos en Firestore: ${t.length}`);const e={};t.forEach(i=>{const a=i.style||"sin-estilo";e[a]||(e[a]=[]),e[a].push(i)}),console.log("📊 Videos por estilo:",e);const n=t.filter(i=>i.style==="salsa"||i.tags&&i.tags.estilo&&i.tags.estilo.includes("salsa"));console.log(`📊 Videos de salsa encontrados: ${n.length}`),n.forEach(i=>{console.log(`  - ${i.title} (ID: ${i.id}, Style: ${i.style})`)});const r=t.find(i=>i.originalTitle&&i.originalTitle.includes("Fig003"));r?console.log("🎯 Video Fig003 encontrado:",r):console.log("❌ Video Fig003 NO encontrado en Firestore");const s=t.filter(i=>!i.resolution||i.resolution==="Unknown");return console.log(`📊 Videos sin resolución: ${s.length}`),s.forEach(i=>{console.log(`  - ${i.title} (ID: ${i.id})`)}),{success:!0,totalVideos:t.length,videosByStyle:e,salsaVideos:n.length,fig003Found:!!r,fig003Video:r,videosWithoutResolution:s.length,error:null}}catch(t){return console.error("❌ Error en diagnóstico de videos:",t),{success:!1,totalVideos:0,videosByStyle:{},salsaVideos:0,fig003Found:!1,fig003Video:null,videosWithoutResolution:0,error:t.message}}},U5=async()=>{try{console.log("🧹 Iniciando limpieza de tags duplicados...");const t=await ya();if(console.log(`📊 Videos a revisar: ${t.length}`),t.length===0)return console.log("✅ No hay videos para revisar"),{success:!0,updatedCount:0,error:null};const e=i0(at);let n=0;return t.forEach(r=>{let s=!1;const i={},a={},l={};if(r.tags&&Object.keys(r.tags).forEach(u=>{if(Array.isArray(r.tags[u])){const d=[...new Set(r.tags[u])];d.length!==r.tags[u].length&&(i[u]=d,s=!0,console.log(`🔄 ${r.title}: Eliminados ${r.tags[u].length-d.length} tags duplicados en ${u}`))}}),r.tagsIniciales&&Object.keys(r.tagsIniciales).forEach(u=>{if(Array.isArray(r.tagsIniciales[u])){const d=[...new Set(r.tagsIniciales[u])];d.length!==r.tagsIniciales[u].length&&(a[u]=d,s=!0,console.log(`🔄 ${r.title}: Eliminados ${r.tagsIniciales[u].length-d.length} tags iniciales duplicados en ${u}`))}}),r.tagsFinales&&Object.keys(r.tagsFinales).forEach(u=>{if(Array.isArray(r.tagsFinales[u])){const d=[...new Set(r.tagsFinales[u])];d.length!==r.tagsFinales[u].length&&(l[u]=d,s=!0,console.log(`🔄 ${r.title}: Eliminados ${r.tagsFinales[u].length-d.length} tags finales duplicados en ${u}`))}}),s){const u=zt(at,Kt.VIDEOS,r.id),d={updatedAt:Dn()};Object.keys(i).length>0&&(d.tags={...r.tags,...i}),Object.keys(a).length>0&&(d.tagsIniciales={...r.tagsIniciales,...a}),Object.keys(l).length>0&&(d.tagsFinales={...r.tagsFinales,...l}),e.update(u,d),n++}}),n>0?(await e.commit(),console.log(`✅ ${n} videos actualizados con tags limpios`)):console.log("✅ No se encontraron tags duplicados"),{success:!0,updatedCount:n,error:null}}catch(t){return console.error("❌ Error al limpiar tags duplicados:",t),{success:!1,updatedCount:0,error:t.message}}},F5=async t=>{try{const e=URL.createObjectURL(t),n=document.createElement("video");n.crossOrigin="anonymous",n.muted=!0,n.playsInline=!0;const r=document.createElement("canvas"),s=r.getContext("2d");return new Promise((i,a)=>{n.onloadedmetadata=()=>{const d=n.videoWidth/n.videoHeight;let f,m;d>1?(f=1280,m=1280/d):(m=720,f=720*d),r.width=f,r.height=m;const g=n.duration;n.currentTime=Math.min(g*.5,1),n.onseeked=()=>{try{s.drawImage(n,0,0,r.width,r.height),r.toBlob(x=>{if(x){const b=URL.createObjectURL(x);URL.revokeObjectURL(e),n.remove(),r.remove(),i({success:!0,thumbnailURL:b,blob:x,error:null})}else a(new Error("No se pudo generar el thumbnail"))},"image/jpeg",.95)}catch(x){a(new Error(`Error al capturar frame: ${x.message}`))}},n.onerror=()=>{a(new Error("Error al cargar el video para thumbnail"))}},n.onerror=()=>{URL.revokeObjectURL(e),n.remove(),r.remove(),a(new Error("Error al cargar el video"))},n.src=e})}catch(e){return{success:!1,thumbnailURL:"https://via.placeholder.com/300x200/1a1a1a/ffffff?text=VIDEO",blob:null,error:e.message}}},ta=async(t,e,n)=>{try{const r=Xr(Yr,e),s={contentType:t.type,customMetadata:{uploadedAt:new Date().toISOString(),originalName:t.name,fileSize:t.size.toString()}},i=await m0(r,t,s);return{success:!0,url:await oc(i.ref),path:i.ref.fullPath,error:null}}catch(r){return console.error("Error uploading file:",r),{success:!1,url:null,path:null,error:r.message}}},Cv=async t=>{try{const e=Xr(Yr,t);return await no(e),{success:!0,error:null}}catch(e){return{success:!1,error:e.message}}},$5=async(t,e,n)=>{try{if(!t.type.startsWith("video/"))throw new Error("El archivo debe ser un video");const r=100*1024*1024;if(t.size>r)throw new Error("El video es demasiado grande. Máximo 100MB");console.log("Subiendo video a Firebase Storage...");const s={contentType:t.type,customMetadata:{uploadedAt:new Date().toISOString(),originalName:t.name,fileSize:t.size.toString(),fileType:"video"}},i=Xr(Yr,e);try{const a=await m0(i,t,s),l=await oc(a.ref);return console.log("Video subido exitosamente a Firebase Storage:",l),{success:!0,url:l,path:a.ref.fullPath,error:null,simulated:!1}}catch(a){console.error("Error con uploadBytes, intentando con uploadBytesResumable:",a);const l=eS(i,t,s);return new Promise((u,d)=>{l.on("state_changed",f=>{const m=f.bytesTransferred/f.totalBytes*100;n&&n(m)},f=>{console.error("Error uploading video:",f);let m="Error al subir el video";f.code==="storage/unauthorized"?m="No tienes permisos para subir videos":f.code==="storage/quota-exceeded"?m="Se ha excedido la cuota de almacenamiento":f.code==="storage/retry-limit-exceeded"?m="Error de conexión. Intenta de nuevo":f.code==="storage/canceled"?m="Upload cancelado":f.message&&(m=f.message),u({success:!1,url:null,path:null,error:m,simulated:!1})},async()=>{try{const f=await oc(l.snapshot.ref);console.log("Video subido exitosamente a Firebase Storage:",f),u({success:!0,url:f,path:l.snapshot.ref.fullPath,error:null,simulated:!1})}catch{u({success:!1,url:null,path:null,error:"Error al obtener la URL del video",simulated:!1})}})})}}catch(r){console.error("Error uploading video:",r);let s="Error al subir el video";return r.code==="storage/unauthorized"?s="No tienes permisos para subir videos":r.code==="storage/quota-exceeded"?s="Se ha excedido la cuota de almacenamiento":r.code==="storage/retry-limit-exceeded"?s="Error de conexión. Intenta de nuevo":r.message&&(s=r.message),{success:!1,url:null,path:null,error:s,simulated:!1}}},Av=async(t,e)=>{try{console.log("🗑️ Iniciando eliminación de archivos:"),console.log("📁 Video path:",t),console.log("🖼️ Thumbnail path:",e);const n=[];if(t){console.log("🎬 Eliminando video:",t);const r=Xr(Yr,t);n.push(no(r))}else console.log("⚠️ No hay ruta de video para eliminar");if(e&&e!==null&&e!==""){console.log("🖼️ Eliminando thumbnail:",e);const r=Xr(Yr,e);n.push(no(r))}else console.log("⚠️ No hay ruta de thumbnail para eliminar (thumbnailPath:",e,")");return console.log(`📊 Archivos a eliminar: ${n.length}`),n.length===0?(console.log("⚠️ No hay archivos para eliminar"),{success:!0,error:null,deletedCount:0}):(await Promise.all(n),console.log("✅ Archivos eliminados exitosamente"),{success:!0,error:null,deletedCount:n.length})}catch(n){return console.error("❌ Error deleting video:",n),{success:!1,error:n.message,deletedCount:0}}},z5=async()=>{try{console.log("🗑️ Iniciando eliminación de todos los archivos de videos...");const t=await jv("videos");console.log(`✅ Archivos de videos eliminados: ${t.deletedCount}`);const e=await jv("thumbnails");return console.log(`✅ Archivos de thumbnails eliminados: ${e.deletedCount}`),{success:!0,videosDeleted:t.deletedCount,thumbnailsDeleted:e.deletedCount,error:null}}catch(t){return console.error("❌ Error al eliminar archivos de videos:",t),{success:!1,videosDeleted:0,thumbnailsDeleted:0,error:t.message}}},jv=async t=>{try{console.log(`🗑️ Eliminando archivos en carpeta: ${t}`);const e=Xr(Yr,t),n=await Fd(e);if(n.items.length===0)return console.log(`✅ No hay archivos en ${t}`),{success:!0,deletedCount:0,error:null};console.log(`📊 Archivos a eliminar en ${t}: ${n.items.length}`);const r=n.items.map(async l=>{try{return await no(l),{success:!0,path:l.fullPath}}catch(u){return console.error(`❌ Error eliminando ${l.fullPath}:`,u),{success:!1,path:l.fullPath,error:u.message}}}),s=await Promise.all(r),i=s.filter(l=>l.success).length,a=s.filter(l=>!l.success).length;return console.log(`✅ ${i} archivos eliminados exitosamente en ${t}`),a>0&&console.log(`⚠️ ${a} archivos fallaron al eliminar en ${t}`),{success:!0,deletedCount:i,failedCount:a,error:null}}catch(e){return console.error(`❌ Error al eliminar archivos en ${t}:`,e),{success:!1,deletedCount:0,failedCount:0,error:e.message}}},B5=async t=>{try{console.log("🧹 Iniciando limpieza de archivos huérfanos...");const e=await Fd(Xr(Yr,"videos")),n=await Fd(Xr(Yr,"thumbnails")),r=new Set(t.map(u=>u.videoPath).filter(Boolean)),s=new Set(t.map(u=>u.thumbnailPath).filter(Boolean)),i=e.items.filter(u=>!r.has(u.fullPath)),a=n.items.filter(u=>!s.has(u.fullPath));console.log(`📊 Archivos huérfanos encontrados: ${i.length} videos, ${a.length} thumbnails`);const l=[...i.map(u=>no(u)),...a.map(u=>no(u))];return l.length>0?(await Promise.all(l),console.log(`✅ ${l.length} archivos huérfanos eliminados`)):console.log("✅ No se encontraron archivos huérfanos"),{success:!0,orphanedVideosDeleted:i.length,orphanedThumbnailsDeleted:a.length,error:null}}catch(e){return console.error("❌ Error en limpieza de archivos huérfanos:",e),{success:!1,orphanedVideosDeleted:0,orphanedThumbnailsDeleted:0,error:e.message}}},Rv=async t=>{try{const e=Xr(Yr,t),n=await oc(e),r=await fetch(n);if(!r.ok)throw new Error(`Error al descargar archivo: ${r.status}`);return await r.blob()}catch(e){throw console.error(`Error descargando archivo ${t}:`,e),e}},Pv=(t,e)=>new File([t],e,{type:t.type}),q5=async t=>{try{console.log("🔄 Iniciando migración de videos a estructura organizada...");const e=[];for(const i of t)try{if(i.videoPath&&i.videoPath.includes("/figuras/")||i.videoPath&&i.videoPath.includes("/escuela/")||i.videoPath&&i.videoPath.includes("/eventos/")){console.log(`⏭️ Video ${i.title} ya está en estructura organizada`),e.push({videoId:i.id,title:i.title,status:"already_organized",error:null});continue}const a=i.style||"salsa",l="figuras",u=i.videoPath,d=i.thumbnailPath,f=`videos/${l}/${a}/${u.split("/").pop()}`,m=d?`thumbnails/${l}/${a}/${d.split("/").pop()}`:null;console.log(`🔄 Migrando video: ${i.title}`),console.log(`   De: ${u}`),console.log(`   A: ${f}`);let g=!1,x=!1;try{console.log(`📥 Descargando video: ${u}`);const b=await Rv(u),R=Pv(b,u.split("/").pop());console.log(`📤 Subiendo video a nueva ubicación: ${f}`),await ta(R,f),g=!0,console.log("✅ Video migrado exitosamente"),console.log(`🗑️ Eliminando archivo original: ${u}`),await Cv(u)}catch(b){throw console.error(`❌ Error migrando video ${i.title}:`,b),new Error(`Error migrando video: ${b.message}`)}if(d&&m)try{console.log(`📥 Descargando thumbnail: ${d}`);const b=await Rv(d),R=Pv(b,d.split("/").pop());console.log(`📤 Subiendo thumbnail a nueva ubicación: ${m}`),await ta(R,m),x=!0,console.log("✅ Thumbnail migrado exitosamente"),console.log(`🗑️ Eliminando thumbnail original: ${d}`),await Cv(d)}catch(b){console.error(`❌ Error migrando thumbnail ${i.title}:`,b)}e.push({videoId:i.id,title:i.title,oldVideoPath:u,newVideoPath:f,oldThumbnailPath:d,newThumbnailPath:m,status:"migrated",videoMigrated:g,thumbnailMigrated:x,error:null})}catch(a){console.error(`❌ Error migrando video ${i.title}:`,a),e.push({videoId:i.id,title:i.title,status:"error",error:a.message})}const n=e.filter(i=>i.status==="migrated").length,r=e.filter(i=>i.status==="already_organized").length,s=e.filter(i=>i.status==="error").length;return console.log(`✅ Migración completada: ${n} migrados, ${r} ya organizados, ${s} fallidos`),{success:!0,totalVideos:t.length,successfulMigrations:n,alreadyOrganized:r,failedMigrations:s,results:e,error:null}}catch(e){return console.error("❌ Error en migración de videos:",e),{success:!1,totalVideos:0,successfulMigrations:0,alreadyOrganized:0,failedMigrations:0,results:[],error:e.message}}},z={SUPER_ADMIN:"super_admin",MAESE:"maese",USER:"user",POLLITO:"pollito"},cr={[z.SUPER_ADMIN]:"Super Administrador",[z.MAESE]:"Maese",[z.USER]:"Soldado",[z.POLLITO]:"Pollito"},ui={[z.SUPER_ADMIN]:"bg-purple-600 text-white",[z.MAESE]:"bg-red-500 text-white",[z.USER]:"bg-green-500 text-white",[z.POLLITO]:"bg-yellow-400 text-gray-800"},$d={MANAGE_USERS:[z.SUPER_ADMIN,z.MAESE],VIEW_USERS:[z.SUPER_ADMIN,z.MAESE],CREATE_CONTENT:[z.SUPER_ADMIN,z.MAESE],EDIT_CONTENT:[z.SUPER_ADMIN,z.MAESE],DELETE_CONTENT:[z.SUPER_ADMIN],PUBLISH_CONTENT:[z.SUPER_ADMIN,z.MAESE],CREATE_EVENTS:[z.SUPER_ADMIN,z.MAESE],EDIT_EVENTS:[z.SUPER_ADMIN,z.MAESE],DELETE_EVENTS:[z.SUPER_ADMIN],MANAGE_EVENTS:[z.SUPER_ADMIN,z.MAESE],CREATE_FIGURES:[z.SUPER_ADMIN,z.MAESE],EDIT_FIGURES:[z.SUPER_ADMIN,z.MAESE],DELETE_FIGURES:[z.SUPER_ADMIN],CREATE_LESSONS:[z.SUPER_ADMIN,z.MAESE],EDIT_LESSONS:[z.SUPER_ADMIN,z.MAESE],DELETE_LESSONS:[z.SUPER_ADMIN],ACCESS_PREMIUM_CONTENT:[z.SUPER_ADMIN,z.MAESE,z.USER],ACCESS_BASIC_CONTENT:[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO],ACCESS_PUBLIC_CONTENT:[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO],MANAGE_SYSTEM:[z.SUPER_ADMIN],VIEW_ANALYTICS:[z.SUPER_ADMIN,z.MAESE],MANAGE_CATEGORIES:[z.SUPER_ADMIN,z.MAESE],UPLOAD_VIDEOS:[z.SUPER_ADMIN,z.MAESE],UPLOAD_IMAGES:[z.SUPER_ADMIN,z.MAESE,z.USER],COMMENT_CONTENT:[z.SUPER_ADMIN,z.MAESE,z.USER],RATE_CONTENT:[z.SUPER_ADMIN,z.MAESE,z.USER],SEND_NOTIFICATIONS:[z.SUPER_ADMIN,z.MAESE],RECEIVE_NOTIFICATIONS:[z.SUPER_ADMIN,z.MAESE,z.USER]},H5=(t,e)=>!t||!$d[e]?!1:$d[e].includes(t),ko=t=>t?Object.keys($d).filter(e=>$d[e].includes(t)):[],Dv={"/":[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO],"/figuras":[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO],"/escuela":[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO],"/eventos":[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO],"/categorias":[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO],"/notas":[z.SUPER_ADMIN,z.MAESE,z.USER],"/admin":[z.SUPER_ADMIN,z.MAESE],"/auth":[z.SUPER_ADMIN,z.MAESE,z.USER,z.POLLITO]},W5=(t,e)=>!t||!Dv[e]?!1:Dv[e].includes(t),sS=S.createContext(),gr=()=>{const t=S.useContext(sS);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},G5=({children:t})=>{const[e,n]=S.useState(null),[r,s]=S.useState(null),[i,a]=S.useState(!0),l=async P=>{if(P.email==="david_exile_92@hotmail.com"){console.log("🆕 Creando perfil de David en Firestore...");try{const O={displayName:"David",email:P.email,role:z.SUPER_ADMIN,username:"david",createdAt:new Date,permissions:ko(z.SUPER_ADMIN),photoURL:P.photoURL||null,isSuperAdmin:!0},N=await Iv(P.uid,O);if(N.success)return console.log("✅ Perfil de David creado exitosamente"),O;console.error("❌ Error al crear perfil de David:",N.error)}catch(O){console.error("❌ Error al crear perfil de David:",O)}}return null},u=async P=>{if(console.log("🔍 Verificando rol de David:",P==null?void 0:P.email,P==null?void 0:P.role),(P==null?void 0:P.email)==="david_exile_92@hotmail.com"&&(P==null?void 0:P.role)!==z.SUPER_ADMIN){console.log("🔄 Actualizando rol de David a Super Admin...");try{return await Df(P.uid,{role:z.SUPER_ADMIN,permissions:ko(z.SUPER_ADMIN),updatedAt:new Date}),console.log("✅ Rol de David actualizado a Super Admin exitosamente"),{...P,role:z.SUPER_ADMIN,permissions:ko(z.SUPER_ADMIN)}}catch(O){console.error("❌ Error al actualizar rol de David:",O)}}else(P==null?void 0:P.email)==="david_exile_92@hotmail.com"&&console.log("✅ David ya tiene rol de Super Admin");return P};S.useEffect(()=>{const P=N5(async O=>{if(console.log("🔄 Cambio en estado de autenticación:",O==null?void 0:O.email),O){n(O),console.log("👤 Usuario autenticado:",O.email,O.uid);try{const{user:N}=await Eu(O.uid);if(N){console.log("📋 Perfil encontrado:",N.email,N.role);const w=await u(N);s(w),console.log("✅ Perfil actualizado y establecido:",w.role)}else if(console.log("❌ No se encontró perfil para:",O.email),O.email==="david_exile_92@hotmail.com"){console.log("🆕 David no tiene perfil, creándolo automáticamente...");const w=await l(O);w&&(s(w),console.log("✅ Perfil de David creado y establecido automáticamente"))}}catch(N){if(console.log("❌ Error al obtener perfil:",N),O.email==="david_exile_92@hotmail.com"){console.log("🆕 Error al obtener perfil de David, creándolo...");const w=await l(O);w&&(s(w),console.log("✅ Perfil de David creado después de error"))}}}else console.log("🚪 Usuario no autenticado"),n(null),s(null);a(!1)});return()=>P()},[]);const d=async(P,O)=>{try{const{user:N,error:w}=await _5(P,O);if(w)throw new Error(w);return{success:!0,error:null}}catch(N){return{success:!1,error:N.message}}},f=async()=>{try{const{user:P,error:O}=await b5();if(O)throw new Error(O);return{success:!0,error:null}}catch(P){return{success:!1,error:P.message}}},m=async(P,O,N,w,I=7)=>{try{if(!r||r.role!==z.SUPER_ADMIN)throw new Error("Solo el Super Administrador puede crear invitaciones");const k=await T5({email:P,displayName:O,role:N,username:w,expiresInDays:I,createdBy:r.uid,createdAt:new Date});if(k.success){const D=`${window.location.origin}/invite/${k.invitationCode}`;return{success:!0,invitationCode:k.invitationCode,invitationUrl:D,error:null}}else return{success:!1,error:k.error}}catch(k){return{success:!1,error:k.message}}},g=async P=>{try{return await I5(P)}catch(O){return{success:!1,error:O.message}}},x=async(P,O)=>{try{console.log("🔍 Iniciando creación de usuario por invitación:",P);const N=await g(P);if(!N.success)throw console.error("❌ Invitación inválida:",N.error),new Error(N.error);const w=N.invitation;console.log("✅ Invitación válida:",w);const{user:I,error:k}=await w5(w.email,O,w.displayName);if(k)throw console.error("❌ Error al crear usuario:",k),new Error(k);if(console.log("✅ Usuario creado en Firebase Auth:",I.uid),I){const D={displayName:w.displayName,email:w.email,role:w.role,username:w.username,createdAt:new Date,permissions:ko(w.role),photoURL:I.photoURL||null,invitedBy:w.createdBy,invitationCode:P,invitationDate:new Date};console.log("📝 Creando perfil de usuario:",D);const L=await Iv(I.uid,D);if(!L.success)throw console.error("❌ Error al crear perfil:",L.error),new Error(L.error);console.log("✅ Perfil de usuario creado exitosamente");const j=await k5(P,I.uid);j.success?console.log("✅ Invitación marcada como usada"):console.error("❌ Error al marcar invitación como usada:",j.error);const{user:ce}=await Eu(I.uid);ce&&(console.log("✅ Perfil cargado inmediatamente:",ce),s(ce))}return{success:!0,error:null}}catch(N){return console.error("❌ Error en createUserByInvitation:",N),{success:!1,error:N.message}}},b=async()=>{try{return await E5(),{success:!0,error:null}}catch(P){return{success:!1,error:P.message}}},R=async P=>{try{const{error:O}=await S5(P);if(O)throw new Error(O);return{success:!0,error:null}}catch(O){return{success:!1,error:O.message}}},T=async P=>{var O;try{if(!(e!=null&&e.uid))throw new Error("Usuario no autenticado");const N={...P,username:P.username||((O=P.displayName)==null?void 0:O.toLowerCase().replace(/\s+/g,"")),updatedAt:new Date};return await Df(e.uid,N),s(w=>({...w,...N})),{success:!0,error:null}}catch(N){return console.error("Error al actualizar perfil:",N),{success:!1,error:N.message}}},v=()=>{var P;return(r==null?void 0:r.username)||((P=r==null?void 0:r.displayName)==null?void 0:P.toLowerCase().replace(/\s+/g,""))||"usuario"},_=()=>(r==null?void 0:r.photoURL)||(e==null?void 0:e.photoURL)||null,y=async()=>{if(!(e!=null&&e.uid))return console.error("❌ No hay usuario autenticado"),{success:!1,error:"No hay usuario autenticado"};if(e.email!=="david_exile_92@hotmail.com")return console.error("❌ Solo David puede usar esta función"),{success:!1,error:"Solo David puede usar esta función"};console.log("🔧 Forzando actualización del rol de David...");try{const{user:P}=await Eu(e.uid);P?(await Df(e.uid,{role:z.SUPER_ADMIN,permissions:ko(z.SUPER_ADMIN),updatedAt:new Date,isSuperAdmin:!0}),console.log("✅ Perfil de David actualizado forzadamente")):await l(e)&&console.log("✅ Perfil de David creado forzadamente");const{user:O}=await Eu(e.uid);return O&&(s(O),console.log("✅ Perfil recargado:",O.role)),{success:!0,error:null}}catch(P){return console.error("❌ Error al forzar actualización:",P),{success:!1,error:P.message}}},A={user:e,userProfile:r,loading:i,login:d,loginWithGoogle:f,createInvitation:m,validateInvitation:g,createUserByInvitation:x,logout:b,resetPassword:R,updateUserProfile:T,getUserUsername:v,getUserPhoto:_,isAuthenticated:!!e,isSuperAdmin:(r==null?void 0:r.role)===z.SUPER_ADMIN,isMaese:(r==null?void 0:r.role)===z.MAESE,isUser:(r==null?void 0:r.role)===z.USER,isPollito:(r==null?void 0:r.role)===z.POLLITO,hasPermission:P=>H5(r==null?void 0:r.role,P),hasPageAccess:P=>W5(r==null?void 0:r.role,P),getRolePermissions:()=>ko(r==null?void 0:r.role),forceUpdateDavidRole:y};return o.jsx(sS.Provider,{value:A,children:t})},iS=S.createContext(),oS=()=>{const t=S.useContext(iS);if(!t)throw new Error("useSequenceBuilderContext debe usarse dentro de un SequenceBuilderProvider");return t},K5=({children:t})=>{const[e,n]=S.useState([]),[r,s]=S.useState(""),[i,a]=S.useState(""),[l,u]=S.useState(!1),[d,f]=S.useState(!1),[m,g]=S.useState(null),x=S.useCallback(ce=>{if(!ce)return[];const H=[];return Array.isArray(ce)?ce:(Object.values(ce).forEach(me=>{Array.isArray(me)&&H.push(...me)}),H)},[]),b=S.useCallback((ce,H)=>{if(!ce||!H)return!1;const me=x(ce.tagsFinales),ue=x(H.tagsIniciales);console.log("🔍 Verificando compatibilidad:"),console.log("Video 1:",ce.title,"Tags Finales:",me),console.log("Video 2:",H.title,"Tags Iniciales:",ue);const G=me.some(B=>ue.some(ae=>{const we=B===ae;return we&&console.log("✅ Match encontrado:",B,"=",ae),we}));return console.log("Resultado compatibilidad:",G),G},[x]),R=S.useCallback(ce=>{n(H=>[...H,ce])},[]),T=S.useCallback(ce=>{n(H=>H.filter((me,ue)=>ue!==ce))},[]),v=S.useCallback((ce,H)=>{n(me=>{const ue=[...me],[G]=ue.splice(ce,1);return ue.splice(H,0,G),ue})},[]),_=S.useCallback((ce,H=5)=>{if(ce.length===0)return;const me=[...e];let ue=[...ce];if(ue=ue.filter(B=>!me.some(ae=>ae.id===B.id)),console.log("🎲 Generando secuencia aleatoria para completar",H,"videos totales"),console.log("📋 Videos actuales en secuencia:",me.length),console.log("📋 Videos disponibles:",ue.length),me.length===0){const B=Math.floor(Math.random()*ue.length),ae=ue[B];me.push(ae),ue.splice(B,1),console.log("🎯 Primer video seleccionado:",ae.title)}const G=H-me.length;console.log(`🎯 Videos necesarios para completar: ${G}`);for(let B=0;B<G&&ue.length>0;B++){const ae=me[me.length-1],we=ue.filter(q=>b(ae,q));if(console.log(`📋 Paso ${B+1}: ${we.length} videos compatibles disponibles`),we.length===0){console.log("⚠️ No hay videos compatibles, terminando secuencia");break}else{const q=Math.floor(Math.random()*we.length),Y=we[q];me.push(Y),ue=ue.filter(ie=>ie.id!==Y.id),console.log(`✅ Añadido: ${Y.title}`)}}console.log(`🎉 Secuencia final: ${me.length} videos`),n(me)},[e,b]),y=S.useCallback(()=>{n([]),s(""),a(""),g(null)},[]),A=S.useCallback(()=>{u(ce=>!ce)},[]),P=S.useCallback(()=>{u(!0)},[]),O=S.useCallback(()=>{u(!1),y()},[y]),N=S.useCallback(ce=>{n(ce.videos||[]),s(ce.name||""),a(ce.description||""),g(ce.id||null),u(!0)},[]),w=S.useCallback(()=>{f(ce=>!ce)},[]),I=S.useCallback(ce=>{if(e.length===0)return!0;const H=e[e.length-1];return b(H,ce)},[e,b]),k=S.useCallback(ce=>{if(e.length===0)return console.log("📋 Secuencia vacía, mostrando todos los videos"),ce;const H=e[e.length-1];console.log("🎯 Buscando videos compatibles con:",H.title);const me=ce.filter(ue=>{const G=b(H,ue);return console.log(`${ue.title}: ${G?"✅ Compatible":"❌ Incompatible"}`),G});return console.log(`📊 Videos compatibles encontrados: ${me.length}/${ce.length}`),me},[e,b]),D=S.useCallback(ce=>d?ce:k(ce),[d,k]),L=S.useCallback(ce=>!1,[e]),j={sequence:e,sequenceName:r,sequenceDescription:i,isBuilderOpen:l,showAllVideos:d,editingSequenceId:m,setSequenceName:s,setSequenceDescription:a,addVideoToSequence:R,removeVideoFromSequence:T,reorderSequence:v,generateRandomSequence:_,clearSequence:y,openBuilder:P,closeBuilder:O,toggleBuilder:A,loadSequence:N,toggleShowAllVideos:w,checkCompatibility:b,isVideoCompatible:I,isVideoInSequence:L,getCompatibleVideos:k,getFilteredVideos:D};return o.jsx(iS.Provider,{value:j,children:t})},aS=S.createContext(),g0=()=>{const t=S.useContext(aS);if(!t)throw new Error("useCardSize debe ser usado dentro de un CardSizeProvider");return t},Q5=({children:t})=>{const[e,n]=S.useState("large"),[r,s]=S.useState("large"),i={small:{grid:"md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6",aspect:"aspect-square",titleSize:"text-xs",descriptionLines:1,showStats:!1,showTags:!0,compact:!0},medium:{grid:"md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",aspect:"aspect-video",titleSize:"text-sm",descriptionLines:1,showStats:!1,showTags:!0,compact:!0},large:{grid:"md:grid-cols-2 lg:grid-cols-3",aspect:"aspect-video",titleSize:"text-xl",descriptionLines:3,showStats:!0,showTags:!0,compact:!1},"extra-large":{grid:"md:grid-cols-1 lg:grid-cols-2",aspect:"aspect-video",titleSize:"text-2xl",descriptionLines:4,showStats:!0,showTags:!0,compact:!1}},a={small:{grid:"md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6",aspect:"aspect-square",titleSize:"text-xs",descriptionLines:0,showStats:!0,showTags:!1,showIcons:!0,compact:!0},medium:{grid:"md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",aspect:"aspect-video",titleSize:"text-sm",descriptionLines:0,showStats:!0,showTags:!1,showIcons:!0,compact:!0},large:{grid:"md:grid-cols-2 lg:grid-cols-3",aspect:"aspect-video",titleSize:"text-lg",descriptionLines:2,showStats:!0,showTags:!0,showIcons:!1,compact:!1},"extra-large":{grid:"md:grid-cols-1 lg:grid-cols-2",aspect:"aspect-video",titleSize:"text-xl",descriptionLines:3,showStats:!0,showTags:!0,showIcons:!1,compact:!1}},l={videoCardSize:e,sequenceCardSize:r,setVideoCardSize:n,setSequenceCardSize:s,videoSizeConfig:i,sequenceSizeConfig:a,getVideoConfig:()=>i[e],getSequenceConfig:()=>a[r],availableSizes:["small","medium","large","extra-large"],sizeLabels:{small:"Pequeño",medium:"Mediano",large:"Grande","extra-large":"Extra Grande"}};return o.jsx(aS.Provider,{value:l,children:t})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var X5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y5=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),de=(t,e)=>{const n=S.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:u,...d},f)=>S.createElement("svg",{ref:f,...X5,width:s,height:s,stroke:r,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Y5(t)}`,l].join(" "),...d},[...e.map(([m,g])=>S.createElement(m,g)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=de("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=de("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J5=de("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z5=de("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=de("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=de("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=de("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=de("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=de("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=de("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=de("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=de("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=de("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=de("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sD=de("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=de("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=de("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=de("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=de("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jh=de("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=de("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=de("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=de("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=de("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=de("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=de("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=de("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=de("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=de("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=de("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uD=de("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dD=de("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=de("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hD=de("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=de("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=de("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=de("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mD=de("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=de("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=de("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gD=de("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=de("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=de("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=de("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xD=de("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=de("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vD=de("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cc=de("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=de("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=de("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=de("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=de("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=de("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=de("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=de("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=de("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=de("Shuffle",[["path",{d:"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22",key:"1wmou1"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 6h1.9c1.5 0 2.9.9 3.6 2.2",key:"10bdb2"}],["path",{d:"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8",key:"vgxac0"}],["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=de("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=de("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=de("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=de("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=de("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=de("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=de("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _D=de("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uc=de("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=de("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=de("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=de("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=de("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=de("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bD=de("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=de("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=de("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),ED=()=>{const t=Ta(),{theme:e,changeTheme:n}=gb(),{user:r,userProfile:s,isAuthenticated:i,logout:a,hasPermission:l,getUserUsername:u,getUserPhoto:d}=gr(),f=[{path:"/",label:"Inicio"},{path:"/figuras",label:"Figuras"},{path:"/escuela",label:"Escuela"},{path:"/eventos",label:"Eventos"},{path:"/categorias",label:"Categorías"},{path:"/notas",label:"Notas"}];l("MANAGE_USERS")&&f.push({path:"/admin",label:"Admin"});const m=()=>{const g=["light","dark","salsa"],b=(g.indexOf(e)+1)%g.length;n(g[b])};return o.jsx("nav",{className:"bg-white shadow-lg border-b-2 border-salsa-primary",children:o.jsx("div",{className:"container mx-auto px-4",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs(Ur,{to:"/",className:"flex items-center space-x-2",children:[o.jsx(dr,{className:"h-8 w-8 text-salsa-primary"}),o.jsx("span",{className:"text-2xl font-bold text-salsa-primary",children:"SalsaHacks"})]}),o.jsx("div",{className:"hidden md:flex space-x-8",children:f.map(g=>o.jsx(Ur,{to:g.path,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${t.pathname===g.path?"text-salsa-primary bg-salsa-light":"text-gray-700 hover:text-salsa-primary hover:bg-salsa-light"}`,children:g.label},g.path))}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{className:"p-2 text-gray-600 hover:text-salsa-primary transition-colors",children:o.jsx(va,{className:"h-5 w-5"})}),o.jsx("button",{onClick:m,className:"p-2 text-gray-600 hover:text-salsa-primary transition-colors",children:e==="dark"?o.jsx(Ph,{className:"h-5 w-5"}):o.jsx(yD,{className:"h-5 w-5"})}),o.jsxs("button",{className:"p-2 text-gray-600 hover:text-salsa-primary transition-colors relative",children:[o.jsx(lS,{className:"h-5 w-5"}),o.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center",children:"3"})]}),o.jsx("button",{className:"p-2 text-gray-600 hover:text-salsa-primary transition-colors",children:o.jsx(ys,{className:"h-5 w-5"})}),i?o.jsxs("div",{className:"relative group",children:[o.jsxs("button",{className:"flex items-center space-x-3 p-2 text-gray-600 hover:text-salsa-primary transition-colors rounded-lg hover:bg-gray-100",children:[o.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center",children:d()?o.jsx("img",{src:d(),alt:"Foto de perfil",className:"w-8 h-8 rounded-full object-cover"}):o.jsx(Yn,{className:"h-4 w-4 text-white"})}),o.jsxs("div",{className:"flex flex-col items-start",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:u()}),(s==null?void 0:s.role)&&o.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ui[s.role]||"bg-gray-500 text-white"}`,children:[o.jsx(Kn,{className:"h-3 w-3 mr-1"}),cr[s.role]||s.role]})]})]}),o.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:o.jsxs("div",{className:"py-2",children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center",children:d()?o.jsx("img",{src:d(),alt:"Foto de perfil",className:"w-10 h-10 rounded-full object-cover"}):o.jsx(Yn,{className:"h-5 w-5 text-white"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(s==null?void 0:s.displayName)||(r==null?void 0:r.displayName)||"Usuario"}),o.jsx("p",{className:"text-xs text-gray-500 truncate",children:u()}),(s==null?void 0:s.role)&&o.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mt-1 ${ui[s.role]||"bg-gray-500 text-white"}`,children:[o.jsx(Kn,{className:"h-3 w-3 mr-1"}),cr[s.role]||s.role]})]})]})}),o.jsx(Ur,{to:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:"Mi Perfil"}),o.jsx(Ur,{to:"/settings",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:"Configuración"}),o.jsx("button",{onClick:async()=>{try{await a()}catch(g){console.error("Error al cerrar sesión:",g)}},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Cerrar Sesión"})]})})]}):o.jsx(Ur,{to:"/auth",className:"px-4 py-2 bg-gradient-to-r from-pink-500 to-orange-500 text-white rounded-lg hover:from-pink-600 hover:to-orange-600 transition-all duration-200 font-medium",children:"Iniciar Sesión"})]})]})})})},SD=()=>{const{user:t,userProfile:e,logout:n,hasPermission:r,getRolePermissions:s}=gr(),i=async()=>{try{await n()}catch(a){console.error("Error al cerrar sesión:",a)}};return t?o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Yn,{className:"h-10 w-10 text-white"})}),o.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:(e==null?void 0:e.displayName)||t.displayName||"Usuario"}),o.jsx("p",{className:"text-gray-600",children:t.email}),(e==null?void 0:e.role)&&o.jsx("div",{className:"mt-2",children:o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${ui[e.role]||"bg-gray-500 text-white"}`,children:[o.jsx(Kn,{className:"h-3 w-3 mr-1"}),cr[e.role]||e.role]})})]}),o.jsxs("div",{className:"space-y-4 mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx(Rh,{className:"h-5 w-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Email"}),o.jsx("p",{className:"text-sm text-gray-600",children:t.email})]})]}),(e==null?void 0:e.createdAt)&&o.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx(Oa,{className:"h-5 w-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Miembro desde"}),o.jsx("p",{className:"text-sm text-gray-600",children:new Date(e.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})})]})]}),(e==null?void 0:e.role)&&o.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx(Kn,{className:"h-5 w-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Rol"}),o.jsx("p",{className:"text-sm text-gray-600 capitalize",children:cr[e.role]||e.role})]})]}),(e==null?void 0:e.permissions)&&e.permissions.length>0&&o.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[o.jsx(Oc,{className:"h-5 w-5 text-gray-500 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Permisos principales"}),o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.permissions.slice(0,3).map((a,l)=>o.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded font-medium",children:a.replace(/_/g," ")},l)),e.permissions.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded font-medium",children:["+",e.permissions.length-3," más"]})]})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs(Ur,{to:"/profile",className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[o.jsx(Yn,{className:"h-4 w-4"}),o.jsx("span",{children:"Mi Perfil"})]}),o.jsxs(Ur,{to:"/settings",className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[o.jsx(Mc,{className:"h-4 w-4"}),o.jsx("span",{children:"Configuración"})]}),o.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[o.jsx(fD,{className:"h-4 w-4"}),o.jsx("span",{children:"Cerrar Sesión"})]})]})]}):o.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-20 h-20 bg-gray-300 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Yn,{className:"h-10 w-10 text-gray-500"})}),o.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No autenticado"}),o.jsx("p",{className:"text-gray-600",children:"Inicia sesión para ver tu perfil"})]})})},ND=()=>{const{isAuthenticated:t}=gr(),e=[{icon:o.jsx(Dh,{className:"h-8 w-8"}),title:"Figuras",description:"Galería de videos de figuras de salsa con filtros avanzados",path:"/figuras",color:"text-blue-600"},{icon:o.jsx(cS,{className:"h-8 w-8"}),title:"Escuela",description:"Cursos y tutoriales estructurados para aprender salsa",path:"/escuela",color:"text-green-600"},{icon:o.jsx(Oa,{className:"h-8 w-8"}),title:"Eventos",description:"Calendario de eventos, talleres y fiestas de salsa",path:"/eventos",color:"text-purple-600"},{icon:o.jsx(op,{className:"h-8 w-8"}),title:"Categorías",description:"Centro de control de categorías y etiquetas",path:"/categorias",color:"text-orange-600"},{icon:o.jsx(uS,{className:"h-8 w-8"}),title:"Notas",description:"Seguimiento de commits y control de hitos",path:"/notas",color:"text-red-600"}];return o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("div",{className:"flex justify-center mb-6",children:o.jsx(dr,{className:"h-20 w-20 text-salsa-primary"})}),o.jsx("h1",{className:"text-5xl font-bold text-salsa-primary mb-4",children:"¡Bienvenido a SalsaHacks!"}),o.jsx("p",{className:"text-xl text-gray-600 mb-8 max-w-3xl mx-auto",children:"La plataforma definitiva para aprender, practicar y compartir el arte del baile de salsa. Descubre figuras, mejora tu técnica y conecta con la comunidad."}),o.jsxs("div",{className:"flex justify-center space-x-4",children:[o.jsx(Ur,{to:"/figuras",className:"btn-primary",children:"Explorar Figuras"}),o.jsx(Ur,{to:"/escuela",className:"btn-secondary",children:"Empezar a Aprender"})]})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16",children:e.map(n=>o.jsxs(Ur,{to:n.path,className:"card p-6 hover:scale-105 transition-transform duration-300",children:[o.jsx("div",{className:`${n.color} mb-4`,children:n.icon}),o.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:n.title}),o.jsx("p",{className:"text-gray-600",children:n.description})]},n.path))}),o.jsxs("div",{className:"bg-salsa-light rounded-2xl p-8 mb-16",children:[o.jsx("h2",{className:"text-3xl font-bold text-salsa-primary mb-8 text-center",children:"Estadísticas de la Plataforma"}),o.jsxs("div",{className:"grid md:grid-cols-4 gap-8 text-center",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-bold text-salsa-primary mb-2",children:"150+"}),o.jsx("div",{className:"text-gray-600",children:"Videos de Figuras"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-bold text-salsa-primary mb-2",children:"25+"}),o.jsx("div",{className:"text-gray-600",children:"Cursos Disponibles"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-bold text-salsa-primary mb-2",children:"50+"}),o.jsx("div",{className:"text-gray-600",children:"Eventos Próximos"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-3xl font-bold text-salsa-primary mb-2",children:"1000+"}),o.jsx("div",{className:"text-gray-600",children:"Usuarios Activos"})]})]})]}),t&&o.jsxs("div",{className:"mb-16",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-8 text-center",children:"Mi Perfil"}),o.jsx("div",{className:"max-w-md mx-auto",children:o.jsx(SD,{})})]})]})},TD=()=>{const[t,e]=S.useState("commits"),[n,r]=S.useState("TODAS"),[s,i]=S.useState(new Set),a=[{name:"TODAS",icon:uS,count:59},{name:"PÁGINAS",icon:cD,count:12},{name:"SISTEMAS",icon:Mc,count:28},{name:"CONTENIDO",icon:Dh,count:19}],l=[{id:43,hash:"m2n3o4p",date:"2025-01-27",time:"19:15:30",title:"Commit #043 - Actualizar documentación completa del proyecto",description:"Actualización de NOTAS_COMMITS.md, TODO.md y PLAN_COMPLETO.md con estado actual",files:["NOTAS_COMMITS.md","TODO.md","PLAN_COMPLETO.md"],notes:"Actualización completa de documentación: NOTAS_COMMITS.md actualizado a 43 commits con detalles de constructor de secuencias, VideoPlayer avanzado, sistema de descarga y modal personalizado. TODO.md reestructurado con funcionalidades completadas recientemente. PLAN_COMPLETO.md actualizado con constructor de secuencias completo integrado. Estado actual del proyecto reflejado en toda la documentación.",status:"Completado",category:"SISTEMAS"},{id:42,hash:"l1k2j3i",date:"2025-01-27",time:"19:10:15",title:"Commit #042 - Convertir advertencia de edición de secuencia en modal personalizado",description:"Reemplazar window.confirm con ConfirmModal para mejor UX",files:["src/pages/FigurasPage.jsx"],notes:'Conversión de window.confirm a modal personalizado: nuevo estado editSequenceModal, funciones handleConfirmEditSequence y handleCancelEditSequence, ConfirmModal con título "🎬 Cargar Secuencia", mensaje explicativo sobre reemplazo de secuencia actual, botones "Cargar Secuencia" y "Cancelar", diseño consistente con otros modales de la aplicación.',status:"Completado",category:"SISTEMAS"},{id:41,hash:"h9g8f7e",date:"2025-01-27",time:"19:05:45",title:"Commit #041 - Arreglar verificación de secuencia en construcción al editar",description:"Usar variables del contexto en lugar del parámetro de función",files:["src/pages/FigurasPage.jsx"],notes:"Corrección del diálogo de confirmación: renombrado parámetro de sequence a sequenceToEdit para evitar shadowing de variables del contexto, verificación correcta de secuencia actual en construcción usando sequence y sequenceName del contexto, diálogo de confirmación ahora aparece correctamente cuando hay una secuencia activa.",status:"Completado",category:"SISTEMAS"},{id:40,hash:"k9l8m7n",date:"2025-01-27",time:"18:45:30",title:"Commit #040 - Mejorar VideoPlayer: doble clic para navegación, botones estilo Disney+/YouTube, sistema de resoluciones inteligente",description:"Mejoras finales del VideoPlayer con navegación intuitiva y sistema de resoluciones inteligente",files:["src/components/video/VideoPlayer.jsx","src/index.css","NOTAS_COMMITS.md","PLAN_COMPLETO.md"],notes:'Doble-clic para navegación: izquierda (-10s), derecha (+10s). Botones centrales estilo Disney+/YouTube: "10" + círculo con flecha, ocultos en móvil. Sistema de resoluciones inteligente: detección automática de resolución máxima del video, indicación de resolución actual en "Auto", deshabilitación de resoluciones no disponibles. Eliminación del indicador de orientación vertical/horizontal. Controles reorganizados: fullscreen arriba-derecha, play/pause y skip en centro, loop/A-B/resolución/volumen agrupados abajo-derecha. Volumen vertical sobre la barra de progreso. Actualización completa de documentación con todos los commits y estado del proyecto.',status:"Completado",category:"CONTENIDO"},{id:39,hash:"j6i5h4g",date:"2025-01-27",time:"18:30:15",title:"Commit #039 - Sistema de Resoluciones Inteligente",description:"Implementación de sistema de resoluciones inteligente hasta 4K",files:["src/components/video/VideoPlayer.jsx","src/index.css"],notes:'Sistema de resoluciones: 360p, 480p, 720p, 1080p, 4K. Detección automática de resolución máxima del video. Indicación de resolución actual en modo "Auto". Deshabilitación visual de resoluciones no disponibles. Botón de resolución en controles principales. Dropdown con todas las opciones disponibles.',status:"Completado",category:"CONTENIDO"},{id:38,hash:"f3e2d1c",date:"2025-01-27",time:"18:15:45",title:"Commit #038 - Mejoras y Correcciones del VideoPlayer",description:"Correcciones y mejoras del sistema de controles del VideoPlayer",files:["src/components/video/VideoPlayer.jsx","src/index.css"],notes:"Volumen vertical sobre la barra de progreso. Slider vertical con gradiente azul y porcentaje. Controles reorganizados: fullscreen arriba-derecha, play/pause y skip en centro, loop/A-B/resolución/volumen agrupados abajo-derecha. Eliminación del indicador de orientación vertical/horizontal. Botones centrales ocultos en móvil (hidden md:block).",status:"Completado",category:"CONTENIDO"},{id:37,hash:"b9a8z7y",date:"2025-01-27",time:"18:00:20",title:"Commit #037 - VideoPlayer Avanzado con Controles Profesionales",description:"Implementación de VideoPlayer completo con controles A-B y volumen",files:["src/components/video/VideoPlayer.jsx","src/index.css"],notes:"VideoPlayer completo: play/pause, progress bar, volume control, fullscreen, skip, full loop, A-B segment loop. Controles auto-ocultos con delay. A-B functionality: click A/B para marcar puntos, botón principal para activar/desactivar. Volumen con slider vertical y porcentaje. Controles reorganizados y responsive.",status:"Completado",category:"CONTENIDO"},{id:36,hash:"x6w5v4u",date:"2025-01-27",time:"17:45:10",title:"Commit #036 - Sistema de Edición de Videos Completo",description:"Implementación completa del sistema de edición de videos",files:["src/components/video/VideoEditModal.jsx","src/pages/FigurasPage.jsx","src/services/firebase/firestore.js"],notes:"VideoEditModal completo: edición de título, descripción, thumbnail, tags normales, tags iniciales y finales. Secciones colapsables. Integración con VideoPlayer para visualización. Botón de edición en cada video card. Tags iniciales (azul-morado) y finales (verde-turquesa) visibles en cards. Filtrado exclusivo por categorías (AND logic).",status:"Completado",category:"CONTENIDO"},{id:35,hash:"t3s2r1q",date:"2025-01-27",time:"17:30:00",title:"Commit #035 - Sistema de Video Upload con Thumbnails y Categorías",description:"Implementación del sistema completo de subida de videos",files:["src/components/video/VideoUploadModal.jsx","src/pages/FigurasPage.jsx","src/services/firebase/storage.js","src/services/firebase/firestore.js"],notes:"VideoUploadModal completo: subida de videos con thumbnails automáticos y personalizados. Categorización con tags múltiples. Integración con VideoPlayer para preview. Videos colapsados por defecto con thumbnails grandes al expandir. Sistema de notificaciones con Toast. Almacenamiento en Firebase Storage y metadatos en Firestore.",status:"Completado",category:"CONTENIDO"},{id:34,hash:"p9o8n7m",date:"2025-01-27",time:"17:15:30",title:"Commit #034 - Integración de VideoPlayer en Modales",description:"Integración del VideoPlayer en modales de subida y edición",files:["src/components/video/VideoUploadModal.jsx","src/components/video/VideoEditModal.jsx","src/pages/FigurasPage.jsx"],notes:"VideoPlayer integrado en VideoUploadModal y VideoEditModal. Centrado en modales. Integración en reproducción dinámica de cards. Controles funcionales en todos los contextos. Modal de reproducción con VideoPlayer completo.",status:"Completado",category:"CONTENIDO"},{id:33,hash:"l6k5j4i",date:"2025-01-27",time:"17:00:15",title:"Commit #033 - VideoPlayer Componente Base",description:"Creación del componente VideoPlayer base con controles básicos",files:["src/components/video/VideoPlayer.jsx"],notes:"VideoPlayer base: play/pause, progress bar, volume, fullscreen, skip, loop. Controles auto-ocultos. Responsive design. Integración con HTML5 video element. Preparado para funcionalidades avanzadas.",status:"Completado",category:"CONTENIDO"},{id:32,hash:"h3g2f1e",date:"2025-01-27",time:"16:45:00",title:"Commit #032 - Preparación para Sistema de Videos",description:"Preparación de la infraestructura para el sistema de videos",files:["src/services/firebase/storage.js","src/services/firebase/firestore.js"],notes:"Configuración de Firebase Storage para videos. Funciones de upload y download. Estructura de Firestore para metadatos de videos. Preparación para sistema completo de gestión de videos.",status:"Completado",category:"SISTEMAS"},{id:31,hash:"d9c8b7a",date:"2025-01-27",time:"16:30:45",title:"Commit #031 - Sistema de Tags Iniciales y Finales",description:"Implementación del sistema de tags para secuencias lógicas",files:["src/components/video/VideoUploadModal.jsx","src/pages/FigurasPage.jsx"],notes:"Tags iniciales y finales para construcción de secuencias lógicas. Selección desde categorías existentes. Filtrado exclusivo por categorías (AND logic). Preparación para sistema de secuencias.",status:"Completado",category:"SISTEMAS"},{id:30,hash:"a6z5y4x",date:"2025-01-27",time:"16:15:20",title:"Commit #030 - Galerías Independientes por Estilo",description:"Implementación de galerías independientes para cada estilo de baile",files:["src/pages/FigurasPage.jsx"],notes:"Galerías independientes por estilo: SALSA, BACHATA, KIZOMBA, ZOUK, MERENGUE. Filtros dinámicos que se actualizan según el estilo seleccionado. Navegación fluida entre estilos. Preparación para contenido específico por estilo.",status:"Completado",category:"PÁGINAS"},{id:29,hash:"a1b2c3d",date:"2025-01-27",time:"16:20:45",title:"Commit #029 - Corrección de Navegación y Estado Inicial",description:"Corrección del estado inicial y navegación en FigurasPage",files:["src/pages/FigurasPage.jsx","NOTAS_COMMITS.md"],notes:"Estado inicial corregido: SALSA seleccionado por defecto al entrar a FIGURAS. Navegación por keys: uso de style.key en lugar de style.name. Filtros dinámicos que se actualizan correctamente. Títulos dinámicos que se actualizan según el estilo. VideoUploadModal dinámico que usa el estilo seleccionado actualmente. Comparación correcta: selectedStyle === style.key. Filtros colapsados: estado inicial showFilters: false. Eliminación de useEffect que forzaba filtros abiertos. Interfaz profesional con navegación clara e intuitiva.",status:"Completado",category:"PÁGINAS"},{id:28,hash:"d4e5f6g",date:"2025-01-27",time:"16:18:30",title:"Commit #028 - Sistema de Galerías y Tabs en FigurasPage",description:"Implementación completa del sistema de galerías con tabs y corrección de colores del botón SALSA",files:["src/pages/FigurasPage.jsx","NOTAS_COMMITS.md"],notes:"Sistema de tabs funcional: Galería de Videos y Galería de Secuencias como en EscuelaPage. Colores del botón SALSA: degradado naranja-rosa (from-orange-500 to-pink-500) consistente. Jerarquía de botones: nivel principal (SUBIR VIDEO, CREAR SECUENCIA) y secundario (Galerías). Navegación por tabs con contador dinámico y transiciones suaves. Estado de tabs persistente. Filtros colapsados por defecto para interfaz más limpia. Corrección de navegación: SALSA pre-seleccionado al entrar a FIGURAS. Iconos corregidos con mapeo correcto para todos los estilos. Gradientes unificados: todos los botones activos usan el degradado de SALSA. Interfaz limpia y optimizada. Funcionalidad futura: preparado para implementación de secuencias.",status:"Completado",category:"PÁGINAS"},{id:27,hash:"24f8600",date:"2025-01-27",time:"16:15:30",title:"Commit #027 - Sistema de Usuarios de Prueba Creados",description:"Creación exitosa de usuarios de prueba de todos los niveles",files:["NOTAS_COMMITS.md","Firebase Console"],notes:"Usuario Pollito, Soldado, Maese, Admin y Super Admin David creados. Sistema de invitaciones completamente funcional. Todos los usuarios persistentes en Firebase Console.",status:"Completado",category:"SISTEMAS"},{id:26,hash:"603085c",date:"2025-01-27",time:"16:10:15",title:"Commit #026 - Fix: Creación Automática del Perfil de David como Super Admin",description:"Implementación de creación automática del perfil de David como Super Admin",files:["src/contexts/AuthContext.jsx","src/services/firebase/firestore.js"],notes:"Función forceUpdateDavidRole para el botón del perfil. Creación automática de perfil si no existe en Firestore. Logs detallados para debugging. Sistema de roles persistente para David.",status:"Completado",category:"SISTEMAS"},{id:25,hash:"b024ca6",date:"2025-01-27",time:"16:05:45",title:"Commit #025 - Debug: Verificación de Rol de Super Admin de David",description:"Agregados logs para verificar el rol de Super Admin de David",files:["src/contexts/AuthContext.jsx"],notes:"Logs detallados en autenticación y carga de perfil. Verificación automática de rol david_exile_92@hotmail.com. Debugging mejorado para roles de usuario.",status:"Completado",category:"SISTEMAS"},{id:24,hash:"e8bba30",date:"2025-01-27",time:"16:00:20",title:"Commit #024 - Mejorado Sistema de Persistencia de Usuarios",description:"Mejora del sistema de persistencia de usuarios con UID como ID de documento",files:["src/services/firebase/firestore.js","src/contexts/AuthContext.jsx"],notes:"Uso de UID como ID de documento en Firestore. Logs de debugging agregados. Carga inmediata de perfil después de registro. Prevención de duplicados de usuarios.",status:"Completado",category:"SISTEMAS"},{id:23,hash:"2f9aaa8",date:"2025-01-27",time:"15:55:10",title:"Commit #023 - Actualización Completa de NOTAS_COMMITS.md",description:"Actualización completa de la documentación del proyecto",files:["NOTAS_COMMITS.md"],notes:"Estado actual del proyecto con 29 commits. Sistema de invitaciones completamente funcional. Página cargando correctamente. Roles y permisos operativos.",status:"Completado",category:"SISTEMAS"},{id:22,hash:"cf253bf",date:"2025-01-27",time:"15:50:25",title:"Commit #022 - Sistema Completo Funcionando",description:"Sistema completo funcionando con página cargando correctamente",files:["src/services/firebase/index.js"],notes:"Página cargando correctamente sin errores. Rol Super Administrador visible en navegación. Sistema de invitaciones operativo. Warnings de React Router resueltos.",status:"Completado",category:"SISTEMAS"},{id:21,hash:"fa3c24c",date:"2025-01-27",time:"15:45:15",title:"Commit #021 - Fix: Error de Importación de Storage",description:"Corrección del error de importación que causaba página en blanco",files:["src/services/firebase/index.js"],notes:"Corregida exportación de getFileURL en lugar de getDownloadURL. Solucionado error de importación. Página cargando correctamente sin errores.",status:"Completado",category:"SISTEMAS"},{id:20,hash:"e83932a",date:"2025-01-27",time:"15:40:30",title:"Commit #020 - Fix: Marcado de Invitaciones como Usadas",description:"Corrección del sistema de marcado de invitaciones como usadas",files:["src/contexts/AuthContext.jsx","src/services/firebase/firestore.js"],notes:"Agregada función markInvitationAsUsed al contexto de autenticación. Marcado automático de invitaciones como usadas al crear usuarios. Integración completa con Firebase Firestore.",status:"Completado",category:"SISTEMAS"},{id:19,hash:"78f59b2",date:"2025-01-27",time:"15:35:45",title:"Commit #019 - Sistema de Invitaciones por Enlace",description:"Implementación completa del sistema de invitaciones por enlace",files:["src/pages/AdminPage.jsx","src/pages/InvitePage.jsx","src/services/firebase/firestore.js"],notes:"Creación de invitaciones únicas con códigos alfanuméricos. Panel de administración para gestionar invitaciones. Página de registro por invitación. Enlaces copiables para compartir por WhatsApp.",status:"Completado",category:"SISTEMAS"},{id:18,hash:"56f8efc",date:"2025-01-27",time:"15:30:20",title:"Commit #018 - Sistema de Seguridad por Invitación",description:"Implementación del sistema de seguridad que elimina el registro público",files:["src/pages/AuthPage.jsx","src/contexts/AuthContext.jsx"],notes:"Eliminación completa del registro público. Sistema de registro solo por invitación del Super Admin. Panel de administración para crear usuarios por invitación. Control total de roles y permisos.",status:"Completado",category:"SISTEMAS"},{id:17,hash:"879754e",date:"2025-01-27",time:"15:30:45",title:"Commit #017 - Páginas de Perfil y Configuración Implementadas",description:"Páginas de perfil y configuración completas con funcionalidad",files:["src/pages/ProfilePage.jsx","src/pages/SettingsPage.jsx","src/components/UserProfile.jsx","src/components/layout/Navigation.jsx","src/App.jsx","src/pages/HomePage.jsx"],notes:"Páginas de perfil y configuración implementadas, botones funcionales, navegación mejorada, botones de acción rápida removidos",status:"Completado",category:"SISTEMAS"},{id:16,hash:"e933a1a",date:"2025-01-27",time:"13:14:29",title:"Commit #016 - Sistema de Roles Simplificado",description:"Super Admin, Maese, Usuario y Pollito implementados",files:["src/constants/roles.js","src/contexts/AuthContext.jsx","USUARIOS_PRUEBA.md"],notes:"Sistema de roles simplificado con 4 roles principales, permisos actualizados, AuthContext mejorado",status:"Completado",category:"SISTEMAS"},{id:15,hash:"56f8efc",date:"2025-01-27",time:"10:45:32",title:"Commit #015 - Configuración Completa de Firebase",description:"Auth, Firestore y Storage habilitados con credenciales reales",files:["src/services/firebase/*","NOTAS_COMMITS.md"],notes:"Firebase completamente configurado, componente de prueba integrado, credenciales reales actualizadas",status:"Completado",category:"SISTEMAS"},{id:14,hash:"e83932a",date:"2025-01-27",time:"10:30:15",title:"Commit #014 - Fix: Aplicación funcionando",description:"Firebase temporalmente deshabilitado para evitar errores",files:["src/contexts/AuthContext.jsx","src/pages/HomePage.jsx"],notes:"Aplicación funcionando correctamente, Firebase comentado temporalmente",status:"Completado",category:"SISTEMAS"},{id:13,hash:"78f59b2",date:"2025-01-27",time:"09:15:42",title:"Commit #013 - Actualización de Documentación",description:"Agregado Commit #012 a NOTAS_COMMITS.md",files:["NOTAS_COMMITS.md"],notes:"Documentación actualizada con simplificación del gestor de categorías",status:"Completado",category:"SISTEMAS"},{id:12,hash:"26b3ab2",date:"2025-01-27",time:"08:45:18",title:"Commit #012 - Simplificación del Gestor de Categorías",description:"Eliminación de botones innecesarios, corrección de errores",files:["src/pages/CategoriesPage.jsx"],notes:"Interfaz más limpia, solo botón Ver, protección de categorías hardcodeadas",status:"Completado",category:"SISTEMAS"},{id:11,hash:"360fa0a",date:"2025-01-27",time:"08:20:33",title:"Commit #011 - Gestor de Categorías Jerárquico",description:"Implementación de estructura jerárquica de 3 niveles",files:["src/pages/CategoriesPage.jsx","NOTAS_COMMITS.md"],notes:"Pestañas → Estilos → Categorías con tags, navegación específica",status:"Completado",category:"SISTEMAS"},{id:10,hash:"a3933cb",date:"2025-01-27",time:"07:55:27",title:"Commit #010 - Eliminación de Header Duplicado en FigurasPage",description:"Limpieza de navegación duplicada",files:["src/pages/FigurasPage.jsx"],notes:"Eliminación de Gallery Tabs, imports no utilizados",status:"Completado",category:"PÁGINAS"},{id:9,hash:"6938a03",date:"2025-01-27",time:"07:30:45",title:"Commit #009 - Sistema de Categorías Hardcodeadas",description:"Implementación completa del sistema centralizado",files:["src/constants/categories.js","src/hooks/useCategories.js","src/components/common/CategoryBadge.jsx"],notes:"Hook useCategories, componente CategoryBadge, integración en FigurasPage",status:"Completado",category:"SISTEMAS"},{id:8,hash:"0e51076",date:"2025-01-27",time:"07:15:12",title:"Commit #008 - Hoja de Ruta Completa",description:"Implementación de toda la hoja de ruta del proyecto",files:["NOTAS_COMMITS.md"],notes:"25 tareas organizadas, categorías claras, eliminación de términos técnicos",status:"Completado",category:"SISTEMAS"},{id:7,hash:"83eeffb",date:"2025-01-27",title:"Commit #007 - Corrección de Navegación Duplicada",description:"Eliminación de headers duplicados",files:["EscuelaPage.jsx","EventosPage.jsx","SISTEMA_CATEGORIAS.md"],notes:"Interfaz más limpia, navegación global unificada",status:"Completado",category:"PÁGINAS"},{id:6,hash:"b3b80a8",date:"2025-01-27",title:"Commit #006 - Unificación de Estructura",description:"Conversión a estructura de FigurasPage",files:["EscuelaPage.jsx","EventosPage.jsx"],notes:"Estructura unificada, contenido específico por página",status:"Completado",category:"PÁGINAS"},{id:5,hash:"a1b2c3d",date:"2025-01-27",title:"Commit #005 - Perfeccionamiento de FigurasPage",description:"Ajustes finos y efectos visuales",files:["FigurasPage.jsx","NOTAS_COMMITS.md"],notes:"Transiciones suaves, animaciones, efectos pulidos",status:"Completado",category:"PÁGINAS"},{id:4,hash:"d4e5f6g",date:"2025-01-27",title:"Commit #004 - Sistema de Categorías",description:"Documentación completa del sistema de categorías hardcodeadas",files:["SISTEMA_CATEGORIAS.md"],notes:"Definición de categorías principales, estilos de baile, niveles de dificultad, etiquetas específicas",status:"Completado",category:"SISTEMAS"},{id:3,hash:"h7i8j9k",date:"2025-01-27",title:"Commit #003 - Documentación y Planificación",description:"Creación de sistema de documentación y notas",files:["NOTAS_COMMITS.md"],notes:"Documentación de funcionalidades planificadas, estado actual del proyecto, historial de commits",status:"Completado",category:"SISTEMAS"},{id:2,hash:"l1m2n3o",date:"2025-01-27",title:"Commit #002 - Diseño de FigurasPage",description:"Implementación completa del diseño de FigurasPage basado en imagen de referencia",files:["src/pages/FigurasPage.jsx"],notes:"Header completo, filtros de estilo, barra de búsqueda, botones de acción, grid de videos, sistema de etiquetas",status:"Completado",category:"PÁGINAS"},{id:1,hash:"p4q5r6s",date:"2025-01-27",title:"Commit #001 - Configuración Inicial",description:"Configuración inicial del proyecto SalsaHacks V2.0",files:["package.json","vite.config.js","src/App.jsx","src/main.jsx"],notes:"Creación del proyecto React con Vite, instalación de dependencias, configuración de estructura de carpetas",status:"Completado",category:"SISTEMAS"}],u=[{id:1,title:"Configuración inicial del proyecto",description:"React + Vite + Tailwind CSS configurado",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:2,title:"Página de Figuras diseñada",description:"Diseño completo basado en imagen de referencia",category:"PÁGINAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:3,title:"Sistema de navegación unificado",description:"Header global consistente en todas las páginas",category:"PÁGINAS",date:"2025-01-27",priority:"Media",status:"Completado"},{id:4,title:"Documentación del proyecto",description:"NOTAS_COMMITS.md y SISTEMA_CATEGORIAS.md creados",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:5,title:"Páginas Escuela y Eventos",description:"Estructura unificada con contenido específico",category:"PÁGINAS",date:"2025-01-27",priority:"Media",status:"Completado"},{id:6,title:"Sistema de categorías hardcodeadas",description:"Implementación completa con gestión centralizada",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:7,title:"Configuración completa de Firebase",description:"Auth, Firestore y Storage habilitados con credenciales reales",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:8,title:"Sistema de autenticación completo",description:"Login/registro con Firebase Auth, roles y permisos",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:9,title:"Sistema de invitaciones por enlace",description:"Registro controlado solo por Super Admin",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:10,title:"Panel de administración",description:"Gestión de usuarios y invitaciones",category:"PÁGINAS",date:"2025-01-27",priority:"Media",status:"Completado"},{id:11,title:"Páginas de perfil y configuración",description:"Perfil de usuario y configuración completa",category:"PÁGINAS",date:"2025-01-27",priority:"Media",status:"Completado"},{id:12,title:"Sistema de roles y permisos",description:"Super Admin, Maese, Soldado, Pollito implementados",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:13,title:"Sistema de gestión de videos completo",description:"Upload, reproducción, edición y eliminación de videos",category:"CONTENIDO",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:14,title:"VideoPlayer profesional",description:"Controles avanzados, resoluciones múltiples, navegación intuitiva",category:"CONTENIDO",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:15,title:"Constructor de secuencias integrado",description:"Sistema completo de creación y edición de secuencias de baile",category:"CONTENIDO",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:16,title:"Sistema de descarga de videos",description:"Descarga directa desde tarjetas y reproductor",category:"CONTENIDO",date:"2025-01-27",priority:"Media",status:"Completado"},{id:17,title:"Sistema de tags iniciales y finales",description:"Lógica de compatibilidad para secuencias",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:18,title:"Galerías independientes por estilo",description:"Filtrado dinámico por estilo de baile",category:"PÁGINAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:19,title:"Sistema de búsqueda avanzada",description:"Búsqueda inteligente y filtrado por categorías",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"},{id:20,title:"Sincronización en tiempo real",description:"Firebase Firestore con actualizaciones automáticas",category:"SISTEMAS",date:"2025-01-27",priority:"Alta",status:"Completado"}],d=[{id:1,title:"Página de Escuela",description:"Preparando réplica de Figuras con sistema de tabs y constructor de secuencias",category:"PÁGINAS",priority:"Alta",progress:15,status:"En Progreso"},{id:2,title:"Página de Eventos",description:"Preparando réplica de Figuras con sistema de tabs y constructor de secuencias",category:"PÁGINAS",priority:"Alta",progress:10,status:"En Progreso"},{id:3,title:"Adaptación de orientación móvil",description:"Última funcionalidad del VideoPlayer para dispositivos móviles",category:"CONTENIDO",priority:"Media",progress:30,status:"En Progreso"}],f=[{id:1,title:"Sistema de recomendaciones",description:"Algoritmo para recomendar videos y contenido basado en historial",category:"SISTEMAS",priority:"Baja",estimatedTime:"5 días",status:"Futuro"},{id:2,title:"Analytics avanzados",description:"Métricas de uso de secuencias y comportamiento de usuarios",category:"SISTEMAS",priority:"Baja",estimatedTime:"3 días",status:"Futuro"},{id:3,title:"Testing automatizado",description:"Tests unitarios y E2E para todas las funcionalidades",category:"SISTEMAS",priority:"Media",estimatedTime:"4 días",status:"Futuro"},{id:4,title:"Deploy a producción",description:"Firebase Hosting con configuración de producción",category:"SISTEMAS",priority:"Media",estimatedTime:"2 días",status:"Futuro"},{id:5,title:"HomePage - Dashboard principal",description:"Página de inicio con estadísticas y videos destacados",category:"PÁGINAS",priority:"Media",estimatedTime:"3 días",status:"Futuro"},{id:6,title:"CategoriesPage - Gestión de categorías",description:"Página para gestionar categorías y etiquetas",category:"PÁGINAS",priority:"Media",estimatedTime:"2 días",status:"Futuro"},{id:7,title:"Página de búsqueda avanzada",description:"Búsqueda con filtros por categorías y estilos",category:"PÁGINAS",priority:"Media",estimatedTime:"2 días",status:"Futuro"},{id:8,title:"Exportación de secuencias",description:"Videos combinados descargables desde secuencias",category:"CONTENIDO",priority:"Media",estimatedTime:"3 días",status:"Futuro"},{id:9,title:"Sistema de comentarios",description:"Comentarios en videos y sistema de ratings",category:"CONTENIDO",priority:"Baja",estimatedTime:"3 días",status:"Futuro"},{id:10,title:"Sistema de favoritos",description:"Guardar videos favoritos y crear playlists",category:"CONTENIDO",priority:"Baja",estimatedTime:"2 días",status:"Futuro"},{id:11,title:"Notificaciones",description:"Sistema de notificaciones para nuevos videos y eventos",category:"CONTENIDO",priority:"Baja",estimatedTime:"2 días",status:"Futuro"},{id:12,title:"Inteligencia artificial",description:"Sugerencias automáticas de secuencias",category:"SISTEMAS",priority:"Baja",estimatedTime:"7 días",status:"Futuro"},{id:13,title:"Sistema de colaboración",description:"Secuencias compartidas entre usuarios",category:"SISTEMAS",priority:"Baja",estimatedTime:"5 días",status:"Futuro"},{id:14,title:"Aplicación móvil",description:"Versión nativa para iOS/Android",category:"SISTEMAS",priority:"Baja",estimatedTime:"15 días",status:"Futuro"},{id:15,title:"Integración con redes sociales",description:"Compartir secuencias en redes sociales",category:"CONTENIDO",priority:"Baja",estimatedTime:"3 días",status:"Futuro"},{id:16,title:"Funcionalidades premium",description:"Contenido exclusivo para usuarios avanzados",category:"CONTENIDO",priority:"Baja",estimatedTime:"4 días",status:"Futuro"},{id:17,title:"Sistema de certificaciones",description:"Certificados de cursos completados",category:"CONTENIDO",priority:"Baja",estimatedTime:"3 días",status:"Futuro"},{id:18,title:"Calendario de eventos",description:"Calendario interactivo para eventos de salsa",category:"PÁGINAS",priority:"Media",estimatedTime:"3 días",status:"Futuro"},{id:19,title:"Sistema de mensajería",description:"Chat entre usuarios e instructores",category:"SISTEMAS",priority:"Baja",estimatedTime:"5 días",status:"Futuro"}],m=y=>{switch(y){case"Completado":return"bg-green-500";case"En Progreso":return"bg-blue-500";case"Futuro":return"bg-gray-500";case"Pendiente":return"bg-yellow-500";default:return"bg-gray-500"}},g=y=>{switch(y){case"Completado":return o.jsx(yi,{className:"h-5 w-5 text-green-500"});case"En Progreso":return o.jsx(Mv,{className:"h-5 w-5 text-blue-500"});case"Futuro":return o.jsx(qo,{className:"h-5 w-5 text-gray-500"});case"Pendiente":return o.jsx(Ts,{className:"h-5 w-5 text-yellow-500"});default:return o.jsx(qo,{className:"h-5 w-5 text-gray-500"})}},x=y=>{switch(y){case"Alta":return"bg-red-500";case"Media":return"bg-yellow-500";case"Baja":return"bg-green-500";default:return"bg-gray-500"}},b=y=>{switch(y){case"PÁGINAS":return"bg-blue-500";case"SISTEMAS":return"bg-purple-500";case"CONTENIDO":return"bg-pink-500";default:return"bg-gray-500"}},R=y=>{switch(y){case"Completado":return"border-l-green-500";case"En Progreso":return"border-l-blue-500";case"Futuro":return"border-l-gray-500";case"Pendiente":return"border-l-yellow-500";default:return"border-l-gray-500"}},T=y=>{const A=new Set(s);A.has(y)?A.delete(y):A.add(y),i(A)},v=y=>s.has(y),_=()=>{let y=[];return t==="commits"?y=l:t==="hechas"?y=u:t==="proceso"?y=d:t==="futuras"&&(y=f),n!=="TODAS"&&(y=y.filter(A=>A.category===n)),y};return o.jsx("div",{className:"min-h-screen bg-white",children:o.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold mb-2",children:o.jsx("span",{className:"text-pink-500",children:"NOTAS DE DESARROLLO"})}),o.jsx("p",{className:"text-gray-600 text-lg",children:"Seguimiento de commits y control de hitos del proyecto"})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:a.map(y=>o.jsxs("button",{onClick:()=>r(y.name),className:`relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${n===y.name?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[o.jsx(y.icon,{className:"h-4 w-4"}),o.jsx("span",{children:y.name}),o.jsx("span",{className:"bg-white bg-opacity-20 px-2 py-1 rounded text-xs",children:y.count})]},y.name))}),o.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:o.jsxs("div",{className:"relative",children:[o.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),o.jsx("input",{type:"text",placeholder:"Buscar en notas...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]})}),o.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[o.jsxs("button",{onClick:()=>e("commits"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${t==="commits"?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(Ov,{className:"h-4 w-4"}),o.jsxs("span",{children:["COMMITS (",l.length,")"]})]}),o.jsxs("button",{onClick:()=>e("hechas"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${t==="hechas"?"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(yi,{className:"h-4 w-4"}),o.jsxs("span",{children:["HECHO (",u.length,")"]})]}),o.jsxs("button",{onClick:()=>e("proceso"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${t==="proceso"?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(Mv,{className:"h-4 w-4"}),o.jsxs("span",{children:["EN PROCESO (",d.length,")"]})]}),o.jsxs("button",{onClick:()=>e("futuras"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${t==="futuras"?"bg-gradient-to-r from-gray-500 to-gray-600 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(qo,{className:"h-4 w-4"}),o.jsxs("span",{children:["FUTURO (",f.length,")"]})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:[t==="commits"&&"Historial de Commits",t==="hechas"&&"Tareas Completadas",t==="proceso"&&"Tareas en Progreso",t==="futuras"&&"Tareas Futuras"]}),o.jsx("div",{className:"grid gap-4",children:_().map(y=>o.jsx("div",{className:`bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.01] border-l-4 ${R(y.status)}`,children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:`flex items-center justify-between mb-3 ${t==="commits"?"cursor-pointer":""}`,onClick:()=>t==="commits"&&T(y.id),children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[t==="commits"&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ov,{className:"h-4 w-4 text-pink-500"}),o.jsx("span",{className:"font-mono text-xs text-gray-600",children:y.hash})]}),t!=="commits"&&g(y.status),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-800 text-base",children:y.title}),t==="commits"&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("p",{className:"text-xs text-gray-500",children:y.date}),y.time&&o.jsxs("p",{className:"text-xs text-gray-400",children:["• ",y.time]})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[t==="commits"&&o.jsx("button",{onClick:A=>{A.stopPropagation(),T(y.id)},className:"p-1 hover:bg-gray-100 rounded transition-colors",children:v(y.id)?o.jsx(lc,{className:"h-4 w-4 text-gray-500"}):o.jsx(nD,{className:"h-4 w-4 text-gray-500"})}),o.jsx("span",{className:`px-2 py-1 text-white text-xs rounded-full font-medium ${b(y.category)}`,children:y.category}),o.jsx("span",{className:`px-2 py-1 text-white text-xs rounded-full font-medium ${m(y.status)}`,children:y.status}),y.priority&&o.jsx("span",{className:`px-2 py-1 text-white text-xs rounded-full font-medium ${x(y.priority)}`,children:y.priority})]})]}),o.jsx("p",{className:"text-gray-600 text-sm mb-3",children:y.description}),t==="commits"&&v(y.id)&&o.jsxs("div",{className:"border-t border-gray-100 pt-3 mt-3",children:[y.files&&o.jsxs("div",{className:"mb-3",children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Archivos modificados:"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:y.files.map((A,P)=>o.jsx("span",{className:"px-2 py-1 bg-pink-100 text-pink-700 text-xs rounded font-medium",children:A},P))})]}),y.notes&&o.jsxs("div",{className:"mb-3",children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Notas:"}),o.jsx("p",{className:"text-xs text-gray-600 bg-gray-50 p-2 rounded",children:y.notes})]})]}),t!=="commits"&&o.jsxs(o.Fragment,{children:[t==="proceso"&&y.progress&&o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[o.jsx("span",{children:"Progreso"}),o.jsxs("span",{children:[y.progress,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:o.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all duration-300",style:{width:`${y.progress}%`}})})]}),t==="commits"&&y.files&&!v(y.id)&&o.jsx("div",{className:"mb-3",children:o.jsxs("div",{className:"flex flex-wrap gap-1",children:[y.files.slice(0,3).map((A,P)=>o.jsx("span",{className:"px-2 py-1 bg-pink-100 text-pink-700 text-xs rounded font-medium",children:A},P)),y.files.length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded font-medium",children:["+",y.files.length-3," más"]})]})}),y.notes&&!v(y.id)&&o.jsx("div",{className:"mb-3",children:o.jsx("p",{className:"text-xs text-gray-600",children:y.notes})}),t==="futuras"&&y.estimatedTime&&o.jsx("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(qo,{className:"h-3 w-3"}),o.jsx("span",{children:y.estimatedTime})]})}),t==="hechas"&&y.date&&o.jsx("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(Oa,{className:"h-3 w-3"}),o.jsx("span",{children:y.date})]})})]})]})},y.id))})]})]})})},ID=()=>{const[t,e]=S.useState("figuras"),[n,r]=S.useState("salsa"),[s,i]=S.useState(!0),a={figuras:{name:"FIGURAS",icon:dr,styles:{salsa:{name:"SALSA",icon:dr,color:"salsa",categories:{estilo:{name:"ESTILO",color:"pink",tags:["Salsa","Salsa en línea On1","Salsa cubana","Estilo LA","Estilo NY","Estilo show"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Pasitos libres","Parejas","Footwork On1","Footwork On2","Shines","Fusionado con afro","Body movement"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Cross Body Lead","Copa","Sombrero","Dile que no","Setenta","Vacilala","Enchufla"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos paralelas","Cruzadas","Entrelazadas","Cambio de manos","Manos abiertas","Sin contacto"]}}},bachata:{name:"BACHATA",icon:ys,color:"bachata",categories:{estilo:{name:"ESTILO",color:"red",tags:["Bachata dominicana","Bachata moderna","Bachata sensual","Bachata urbana"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Body rolls","Hip movement","Footwork básico","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Dile que no","Setenta","Vacilala","Sombrero","Copa"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Entrelazadas"]}}},kizomba:{name:"KIZOMBA",icon:Vc,color:"kizomba",categories:{estilo:{name:"ESTILO",color:"yellow",tags:["Kizomba tradicional","Kizomba urbana","Tarraxinha","Semba"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Body movement","Hip rolls","Footwork","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Saída","Volta","Tarraxinha","Semba step"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Sin contacto"]}}},zouk:{name:"ZOUK",icon:wa,color:"zouk",categories:{estilo:{name:"ESTILO",color:"purple",tags:["Zouk brasileño","Zouk flow","Zouk neofusion","Zouk tradicional"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Body rolls","Head movement","Footwork","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Lateral","Tranca","Pião","Balanço"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Entrelazadas"]}}},merengue:{name:"MERENGUE",icon:Ph,color:"merengue",categories:{estilo:{name:"ESTILO",color:"orange",tags:["Merengue dominicano","Merengue tradicional","Merengue moderno"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Hip movement","Footwork básico","Turns simples"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Giros simples","Cambios de dirección","Pasos básicos"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Sin contacto"]}}}}},escuela:{name:"ESCUELA",icon:aD,styles:{salsa:{name:"SALSA",icon:dr,color:"salsa",categories:{nivel:{name:"NIVEL",color:"green",tags:["Principiante","Intermedio","Avanzado","Experto"]},tipo:{name:"TIPO DE CURSO",color:"blue",tags:["Básico","Técnica","Coreografía","Ritmo","Musicalidad"]},duracion:{name:"DURACIÓN",color:"orange",tags:["5-15 min","10-25 min","15-45 min","20-60 min"]},instructor:{name:"INSTRUCTOR",color:"purple",tags:["Carlos Rodríguez","María González","Juan Pérez","Ana López"]}}}}},eventos:{name:"EVENTOS",icon:Oa,styles:{salsa:{name:"SALSA",icon:dr,color:"salsa",categories:{tipo:{name:"TIPO DE EVENTO",color:"green",tags:["Competición","Encuentro","Congreso","Workshop","Fiesta"]},ubicacion:{name:"UBICACIÓN",color:"blue",tags:["Madrid","Barcelona","Valencia","Sevilla","Bilbao"]},nivel:{name:"NIVEL",color:"orange",tags:["Todos los niveles","Intermedio-Avanzado","Solo avanzado"]},fecha:{name:"FECHA",color:"purple",tags:["Este mes","Próximo mes","Este trimestre","Este año"]}}}}}},l=m=>({salsa:"bg-orange-500 text-white",bachata:"bg-emerald-500 text-white",merengue:"bg-cyan-500 text-white",zouk:"bg-violet-500 text-white",kizomba:"bg-amber-500 text-white",pink:"bg-pink-500 text-white",red:"bg-red-500 text-white",yellow:"bg-yellow-500 text-white",purple:"bg-purple-500 text-white",orange:"bg-orange-500 text-white",green:"bg-green-500 text-white",blue:"bg-blue-500 text-white"})[m]||"bg-gray-500 text-white",u=m=>({salsa:"bg-gradient-to-r from-orange-400 to-pink-500",bachata:"bg-gradient-to-r from-emerald-400 to-teal-600",merengue:"bg-gradient-to-r from-cyan-400 to-blue-600",zouk:"bg-gradient-to-r from-violet-400 to-indigo-600",kizomba:"bg-gradient-to-r from-amber-400 to-orange-600",pink:"bg-gradient-to-r from-orange-500 to-pink-500",red:"bg-gradient-to-r from-red-500 to-pink-500",yellow:"bg-gradient-to-r from-yellow-500 to-orange-500",purple:"bg-gradient-to-r from-purple-500 to-pink-500",orange:"bg-gradient-to-r from-orange-500 to-yellow-500"})[m]||"bg-gradient-to-r from-gray-500 to-gray-600",d=a[t],f=d==null?void 0:d.styles[n];return o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold text-pink-500 mb-2",children:"Gestión de Categorías y Tags"}),o.jsx("p",{className:"text-gray-600",children:"Gestiona categorías, etiquetas y estilos de baile"})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:Object.entries(a).map(([m,g])=>o.jsxs("button",{onClick:()=>{e(m);const x=Object.keys(g.styles)[0];r(x)},className:`relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${t===m?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[o.jsx(g.icon,{className:"h-4 w-4"}),o.jsx("span",{children:g.name})]},m))}),d&&o.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:Object.entries(d.styles).map(([m,g])=>o.jsxs("button",{onClick:()=>r(m),className:`relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${n===m?`${u(g.color)} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[o.jsx(g.icon,{className:"h-4 w-4"}),o.jsx("span",{children:g.name})]},m))}),f&&o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Categorías de ",f.name," en ",d.name]})}),o.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:Object.entries(f.categories).map(([m,g])=>o.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:`w-4 h-4 rounded-full ${l(g.color)}`}),o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:g.name}),o.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full font-medium",children:[g.tags.length," tags"]})]}),o.jsx("div",{className:"flex space-x-2",children:o.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-500 transition-colors",children:o.jsx(Lc,{className:"h-4 w-4"})})})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:g.tags.map((x,b)=>o.jsxs("div",{className:`relative flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium ${l(g.color)}`,children:[b<3&&o.jsx(xa,{className:"h-3 w-3"}),o.jsx("span",{children:x}),s&&b>=3&&o.jsx("button",{className:"ml-1 hover:bg-white hover:bg-opacity-20 rounded-full p-0.5 transition-colors",children:o.jsx("span",{className:"text-xs",children:"×"})})]},b))}),s&&o.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:o.jsxs("button",{className:"flex items-center space-x-2 text-sm text-gray-500 hover:text-green-500 transition-colors",children:[o.jsx(ro,{className:"h-3 w-3"}),o.jsx("span",{children:"Agregar tag"})]})})]})},m))})]}),!d&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Mc,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No hay estilos configurados"}),o.jsx("p",{className:"text-gray-500",children:"Selecciona una pestaña para ver los estilos disponibles"})]})]})},kD="modulepreload",CD=function(t){return"/"+t},Vv={},fs=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=CD(u),u in Vv)return;Vv[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":kD,d||(m.as="script"),m.crossOrigin="",m.href=u,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((g,x)=>{m.addEventListener("load",g),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},Nu={figuras:{name:"FIGURAS",icon:"Music",styles:{salsa:{name:"SALSA",icon:"Music",color:"salsa",categories:{estilo:{name:"ESTILO",color:"pink",tags:["Salsa","Salsa en línea On1","Salsa cubana","Estilo LA","Estilo NY","Estilo show"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Pasitos libres","Parejas","Footwork On1","Footwork On2","Shines","Fusionado con afro","Body movement"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Cross Body Lead","Copa","Sombrero","Dile que no","Setenta","Vacilala","Enchufla"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos paralelas","Cruzadas","Entrelazadas","Cambio de manos","Manos abiertas","Sin contacto"]}}},bachata:{name:"BACHATA",icon:"Heart",color:"bachata",categories:{estilo:{name:"ESTILO",color:"red",tags:["Bachata dominicana","Bachata moderna","Bachata sensual","Bachata urbana"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Body rolls","Hip movement","Footwork básico","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Dile que no","Setenta","Vacilala","Sombrero","Copa"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Entrelazadas"]}}},kizomba:{name:"KIZOMBA",icon:"Zap",color:"kizomba",categories:{estilo:{name:"ESTILO",color:"yellow",tags:["Kizomba tradicional","Kizomba urbana","Tarraxinha","Semba"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Body movement","Hip rolls","Footwork","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Saída","Volta","Tarraxinha","Semba step"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Sin contacto"]}}},zouk:{name:"ZOUK",icon:"Star",color:"zouk",categories:{estilo:{name:"ESTILO",color:"purple",tags:["Zouk brasileño","Zouk flow","Zouk neofusion","Zouk tradicional"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Body rolls","Head movement","Footwork","Turns"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Lateral","Tranca","Pião","Balanço"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Cruzadas","Entrelazadas"]}}},merengue:{name:"MERENGUE",icon:"Sun",color:"merengue",categories:{estilo:{name:"ESTILO",color:"orange",tags:["Merengue dominicano","Merengue tradicional","Merengue moderno"]},subestilo:{name:"SUBESTILO/TÉCNICA",color:"orange",tags:["Hip movement","Footwork básico","Turns simples"]},tipo:{name:"TIPO DE FIGURA",color:"green",tags:["Giros simples","Cambios de dirección","Pasos básicos"]},manos:{name:"MANOS/TÉCNICA DE AGARRE",color:"blue",tags:["Una mano","Dos manos","Sin contacto"]}}}}},escuela:{name:"ESCUELA",icon:"GraduationCap",styles:{salsa:{name:"SALSA",icon:"Music",color:"pink",categories:{nivel:{name:"NIVEL",color:"green",tags:["Principiante","Intermedio","Avanzado","Experto"]},tipo:{name:"TIPO DE CURSO",color:"blue",tags:["Básico","Técnica","Coreografía","Ritmo","Musicalidad"]},duracion:{name:"DURACIÓN",color:"orange",tags:["5-15 min","10-25 min","15-45 min","20-60 min"]},instructor:{name:"INSTRUCTOR",color:"purple",tags:["Carlos Rodríguez","María González","Juan Pérez","Ana López"]}}}}},eventos:{name:"EVENTOS",icon:"Calendar",styles:{salsa:{name:"SALSA",icon:"Music",color:"pink",categories:{tipo:{name:"TIPO DE EVENTO",color:"green",tags:["Competición","Encuentro","Congreso","Workshop","Fiesta"]},ubicacion:{name:"UBICACIÓN",color:"blue",tags:["Madrid","Barcelona","Valencia","Sevilla","Bilbao"]},nivel:{name:"NIVEL",color:"orange",tags:["Todos los niveles","Intermedio-Avanzado","Solo avanzado"]},fecha:{name:"FECHA",color:"purple",tags:["Este mes","Próximo mes","Este trimestre","Este año"]}}}}}},Uc=(t="figuras",e="salsa")=>{const[n,r]=S.useState(t),[s,i]=S.useState(e);S.useEffect(()=>{i(e)},[e]),S.useEffect(()=>{r(t)},[t]);const a=S.useMemo(()=>{const x=Nu[n];if(!x)return null;const b=x.styles[s];return b?b.categories:null},[n,s]),l=S.useMemo(()=>{if(!a)return[];const x=[];return Object.entries(a).forEach(([b,R])=>{R.tags.forEach(T=>{x.push({tag:T,category:b,categoryName:R.name,color:R.color})})}),x},[a]),u=S.useMemo(()=>a?Object.entries(a).map(([x,b])=>({key:x,name:b.name,color:b.color,tags:b.tags})):[],[a]),d=S.useMemo(()=>{const x=Nu[n];return x?Object.entries(x.styles).map(([b,R])=>({key:b,name:R.name,color:R.color,icon:R.icon})):[]},[n]),f=S.useMemo(()=>Object.entries(Nu).map(([x,b])=>({key:x,name:b.name,icon:b.icon})),[]);return{selectedPage:n,selectedStyle:s,setSelectedPage:r,setSelectedStyle:i,currentCategories:a,availableTags:l,categoriesList:u,availableStyles:d,availablePages:f,categoryStructure:Nu,getColorClasses:x=>({salsa:"bg-orange-100 text-orange-800 border-orange-200",bachata:"bg-emerald-100 text-emerald-800 border-emerald-200",merengue:"bg-cyan-100 text-cyan-800 border-cyan-200",zouk:"bg-violet-100 text-violet-800 border-violet-200",kizomba:"bg-amber-100 text-amber-800 border-amber-200",pink:"bg-pink-100 text-pink-800 border-pink-200",red:"bg-red-100 text-red-800 border-red-200",orange:"bg-orange-100 text-orange-800 border-orange-200",yellow:"bg-yellow-100 text-yellow-800 border-yellow-200",green:"bg-green-100 text-green-800 border-green-200",blue:"bg-blue-100 text-blue-800 border-blue-200",purple:"bg-purple-100 text-purple-800 border-purple-200"})[x]||"bg-gray-100 text-gray-800 border-gray-200",getGradientClasses:x=>({salsa:"from-orange-400 to-pink-500",bachata:"from-emerald-400 to-teal-600",merengue:"from-cyan-400 to-blue-600",zouk:"from-violet-400 to-indigo-600",kizomba:"from-amber-400 to-orange-600",pink:"from-pink-500 to-rose-500",red:"from-red-500 to-pink-500",orange:"from-orange-500 to-red-500",yellow:"from-yellow-500 to-orange-500",green:"from-green-500 to-emerald-500",blue:"from-blue-500 to-cyan-500",purple:"from-purple-500 to-pink-500"})[x]||"from-gray-500 to-gray-600"}},Fc=({message:t,type:e="success",duration:n=5e3,onClose:r})=>{const[s,i]=S.useState(!0);S.useEffect(()=>{const u=setTimeout(()=>{i(!1),setTimeout(()=>{r==null||r()},300)},n);return()=>clearTimeout(u)},[n,r]);const a=()=>{switch(e){case"success":return o.jsx(yi,{className:"w-5 h-5"});case"error":return o.jsx(bD,{className:"w-5 h-5"});case"warning":return o.jsx(Ts,{className:"w-5 h-5"});default:return o.jsx(yi,{className:"w-5 h-5"})}},l=()=>{switch(e){case"success":return"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-green-400";case"error":return"bg-gradient-to-r from-red-500 to-pink-500 text-white border-red-400";case"warning":return"bg-gradient-to-r from-orange-500 to-red-500 text-white border-orange-400";default:return"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-green-400"}};return o.jsx("div",{className:`
        fixed top-4 right-4 z-50 max-w-sm w-full
        transform transition-all duration-300 ease-in-out
        ${s?"translate-x-0 opacity-100":"translate-x-full opacity-0"}
      `,children:o.jsxs("div",{className:`
        flex items-center justify-between p-4 rounded-lg shadow-lg border
        ${l()}
      `,children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[a(),o.jsx("span",{className:"font-medium",children:t})]}),o.jsx("button",{onClick:()=>{i(!1),setTimeout(()=>r==null?void 0:r(),300)},className:"ml-4 text-white hover:text-gray-200 transition-colors",children:o.jsx(Cr,{className:"w-4 h-4"})})]})})},dc=({src:t,size:e="medium",loop:n=!1,loopSegment:r=null,showControls:s=!0,autoplay:i=!1,muted:a=!1,onTimeUpdate:l=null,onEnded:u=null,className:d="",resolutions:f=null,currentResolution:m=null,onResolutionChange:g=null,videoTitle:x="video"})=>{const b=S.useRef(null),R=S.useRef(null),[T,v]=S.useState(!1),[_,y]=S.useState(0),[A,P]=S.useState(0),[O,N]=S.useState(1),[w,I]=S.useState(a),[k,D]=S.useState(!1),[L,j]=S.useState(null),[ce,H]=S.useState(!1),[me,ue]=S.useState(!1),[G,B]=S.useState((r==null?void 0:r.start)||0),[ae,we]=S.useState((r==null?void 0:r.end)||0),[q,Y]=S.useState(!!r),[ie,_e]=S.useState(!1),[ve,Se]=S.useState(!1),[Qe,V]=S.useState(0),[le,oe]=S.useState(0),[be,pe]=S.useState(s),[Ae,Le]=S.useState(null),[Xe,he]=S.useState(!1),[Oe,Ke]=S.useState(m||"auto"),[qe,Mt]=S.useState(null),[Nt,Tt]=S.useState(null),[it,vt]=S.useState(!1),[Me,je]=S.useState(1),[gt,Bn]=S.useState("horizontal"),Qt=[.25,.5,.75,1,1.25,1.5,2];S.useEffect(()=>{if(b.current&&q&&T&&ie&&ve){const K=b.current,Ne=()=>{K.currentTime>=ae&&(K.currentTime=G)};return K.addEventListener("timeupdate",Ne),()=>K.removeEventListener("timeupdate",Ne)}},[q,G,ae,T,ie,ve]),S.useEffect(()=>{const K=Ne=>{if(!b.current)return;const ct=document.activeElement;if(!(ct&&(ct.tagName==="INPUT"||ct.tagName==="TEXTAREA"||ct.contentEditable==="true"||ct.classList.contains("ql-editor"))))switch(Ne.code){case"Space":Ne.preventDefault(),re();break;case"ArrowLeft":Ne.preventDefault(),Te(-10);break;case"ArrowRight":Ne.preventDefault(),Te(10);break;case"KeyA":Ne.preventDefault(),B(_);break;case"KeyB":Ne.preventDefault(),we(_);break;case"KeyL":Ne.preventDefault(),ue(!me);break;case"KeyS":Ne.preventDefault();const qn=(Qt.indexOf(Me)+1)%Qt.length;It(Qt[qn]);break}};return document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)},[_,me,Me]),S.useEffect(()=>{if(be&&T){const K=setTimeout(()=>{pe(!1)},4e3);return Le(K),()=>clearTimeout(K)}},[be,T]),S.useEffect(()=>()=>{Ae&&clearTimeout(Ae),L&&clearTimeout(L)},[]),S.useEffect(()=>{b.current&&(b.current.volume=O,b.current.muted=w,b.current.playbackRate=Me)},[O,w,Me]),S.useEffect(()=>{Oe==="auto"&&qe&&Tt(qe)},[Oe,qe]),S.useEffect(()=>{const K=Ne=>{Xe&&he(!1),it&&vt(!1)};return document.addEventListener("click",K),()=>document.removeEventListener("click",K)},[Xe,it]);const Z=()=>{pe(!0),Ae&&clearTimeout(Ae)},Bt=()=>{Z()},[bn,He]=S.useState(0),[an,nr]=S.useState(0),Rr=K=>{const Ne=Date.now();if(Ne-bn<300){const ht=K.currentTarget.getBoundingClientRect(),qn=K.clientX-ht.left,Sn=ht.width;qn<Sn/2?Te(-10):Te(10),nr(0),He(0)}else nr(1),He(Ne)},re=()=>{console.log("Toggle play clicked!"),b.current&&(T?b.current.pause():b.current.play(),v(!T))},Te=K=>{if(b.current){const Ne=Math.max(0,Math.min(A,_+K));b.current.currentTime=Ne,y(Ne)}},En=()=>{b.current&&(y(b.current.currentTime),l==null||l(b.current.currentTime))},wt=()=>{if(b.current){P(b.current.duration);const K=b.current,Ne=K.videoWidth,ct=K.videoHeight;if(Ne&&ct){const ht=ct>Ne;Bn(ht?"vertical":"horizontal"),console.log(`Orientación del video: ${ht?"vertical":"horizontal"} (${Ne}x${ct})`),console.log(`Aspect ratio: ${Ne}:${ct} = ${(Ne/ct).toFixed(2)}`);const qn=Math.max(Ne,ct);let Sn="480p";qn>=3840?Sn="4k":qn>=1920?Sn="1080p":qn>=1280?Sn="720p":qn>=854?Sn="480p":Sn="360p",Mt(Sn),console.log(`Resolución máxima del video: ${Sn} (${Ne}x${ct})`)}i&&(K.play(),v(!0))}},$=()=>{me&&!q?b.current&&(b.current.currentTime=0,b.current.play()):q?b.current&&(b.current.currentTime=G,b.current.play()):v(!1),u==null||u()},ne=K=>{if(b.current){const Ne=K.currentTarget.getBoundingClientRect(),ht=(K.clientX-Ne.left)/Ne.width*A;b.current.currentTime=ht,y(ht)}},te=()=>{if(console.log("Toggle mute clicked!"),b.current){const K=!w;b.current.muted=K,I(K),K?b.current.volume=0:b.current.volume=O}},X=K=>{const Ne=parseFloat(K.target.value);console.log("Volume changed to:",Ne),b.current&&(b.current.volume=Ne,N(Ne),Ne===0?(b.current.muted=!0,I(!0)):(b.current.muted=!1,I(!1)))},Ye=()=>{try{document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),H(!1)):(R.current.requestFullscreen?R.current.requestFullscreen():R.current.webkitRequestFullscreen?R.current.webkitRequestFullscreen():R.current.msRequestFullscreen&&R.current.msRequestFullscreen(),H(!0))}catch(K){console.error("Error toggling fullscreen:",K)}},ln=K=>{K==="start"?ie?(_e(!1),B(0),console.log("Punto A eliminado")):(_e(!0),B(_),V(_),console.log(`Punto A establecido en: ${qt(_)}`)):ve?(Se(!1),we(0),console.log("Punto B eliminado")):(Se(!0),we(_),oe(_),console.log(`Punto B establecido en: ${qt(_)}`))},qt=K=>{const Ne=Math.floor(K/60),ct=Math.floor(K%60);return`${Ne}:${ct.toString().padStart(2,"0")}`},Pr=K=>{Ke(K),he(!1),K==="auto"&&qe?Tt(qe):K!=="auto"&&Tt(null),g==null||g(K)},It=K=>{b.current&&(b.current.playbackRate=K,je(K)),vt(!1)},Rs=K=>K===1?"Normal":`${K}x`,Dr=K=>{switch(K){case"auto":return Nt?`Auto (${Nt})`:"Auto";case"4k":return"4K";case"1080p":return"1080p";case"720p":return"720p";case"480p":return"480p";case"360p":return"360p";default:return K}},es=K=>{if(!qe)return!0;const Ne=["360p","480p","720p","1080p","4k"],ct=Ne.indexOf(qe);return Ne.indexOf(K)<=ct},fo=()=>{let K="";switch(e){case"small":K="max-w-xs";break;case"medium":K="max-w-md";break;case"large":K="max-w-2xl";break;case"fullscreen":return"w-full h-full";default:K="max-w-md"}return e==="fullscreen"?K:`${K} ${gt==="vertical"?"aspect-[9/16]":"aspect-video"}`},mo=async()=>{try{if(console.log("Iniciando descarga de video:",x),t&&(t.includes("firebase")||t.includes("googleapis"))){console.log("Detectada URL de Firebase Storage, descargando...");const K=await fetch(t);if(!K.ok)throw new Error(`HTTP error! status: ${K.status}`);const Ne=await K.blob();console.log("Blob descargado:",Ne.size,"bytes");const ct=URL.createObjectURL(Ne),ht=document.createElement("a");ht.href=ct,ht.download=x||"video.mp4",ht.style.display="none",document.body.appendChild(ht),ht.click(),document.body.removeChild(ht),setTimeout(()=>{URL.revokeObjectURL(ct)},1e3),console.log("Descarga completada exitosamente")}else{console.log("Usando método de descarga directa para URL no-Firebase");const K=document.createElement("a");K.href=t,K.download=x||"video.mp4",K.style.display="none",document.body.appendChild(K),K.click(),document.body.removeChild(K)}}catch(K){console.error("Error en descarga:",K),alert(`Error al descargar el video: ${K.message}`)}};return o.jsxs("div",{ref:R,className:`relative bg-black rounded-lg overflow-hidden video-player-container ${fo()} ${d} ${gt==="vertical"?"video-player-vertical":""}`,onMouseMove:Z,onMouseLeave:()=>{if(T){const K=setTimeout(()=>{pe(!1)},4e3);Le(K)}},onTouchStart:Z,onTouchMove:Z,onClick:Bt,onDoubleClick:Rr,children:[o.jsx("video",{ref:b,src:t,className:`w-full h-full cursor-pointer ${e==="fullscreen"?"object-contain":"object-cover"}`,muted:w,loop:me&&!q,onTimeUpdate:En,onLoadedMetadata:wt,onEnded:$,onPlay:()=>v(!0),onPause:()=>v(!1),onClick:Bt,onDoubleClick:Rr,onTouchStart:Z,onTouchMove:Z}),be&&o.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent",onMouseMove:Z,onTouchStart:Z,onTouchMove:Z,children:[o.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-end items-center",children:o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("button",{onClick:Ye,onTouchStart:Z,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:ce?o.jsx(fS,{className:"w-4 h-4"}):o.jsx(hS,{className:"w-4 h-4"})})})}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>Te(-10),onTouchStart:Z,className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:o.jsx(sp,{className:"w-3 h-3"})}),o.jsx("span",{className:"text-sm font-medium",children:"10"})]})}),o.jsx("button",{onClick:re,onTouchStart:Z,className:"p-4 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:T?o.jsx(mS,{className:"w-8 h-8"}):o.jsx(kr,{className:"w-8 h-8"})}),o.jsx("button",{onClick:()=>Te(10),onTouchStart:Z,className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{className:"text-sm font-medium",children:"10"}),o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:o.jsx(ip,{className:"w-3 h-3"})})]})})]})}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[o.jsxs("div",{className:"flex justify-end mb-2 space-x-2",children:[o.jsx("button",{onClick:()=>ue(!me),onTouchStart:Z,className:`p-2 rounded-full transition-colors z-10 ${me?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Bucle",children:o.jsx(pS,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>{const K=!q;Y(K),K?(Qe>0&&(_e(!0),B(Qe)),le>0&&(Se(!0),we(le))):(_e(!1),Se(!1),B(0),we(0)),console.log(`Modo A-B ${K?"activado":"desactivado"}`)},onTouchStart:Z,className:`p-2 rounded-full transition-colors z-10 ${q?"bg-green-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Segmento A-B",children:o.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:"A-B"})}),f&&f.length>0&&o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>he(!Xe),onTouchStart:Z,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Resolución",children:o.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:Dr(Oe)})}),Xe&&o.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",onTouchStart:Z,onTouchMove:Z,children:f.map(K=>{const Ne=es(K);return o.jsxs("button",{onClick:()=>Ne&&Pr(K),className:`w-full text-left px-3 py-1 rounded text-xs transition-colors ${Ne?Oe===K?"bg-blue-500 text-white":"text-white hover:bg-white/20":"text-gray-500 cursor-not-allowed opacity-50"}`,disabled:!Ne,children:[Dr(K),!Ne&&o.jsx("span",{className:"ml-1 text-[10px] opacity-75",children:"(no disponible)"})]},K)})})]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>vt(!it),onTouchStart:Z,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Velocidad de reproducción",children:o.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:Me===1?"1x":`${Me}x`})}),it&&o.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",onTouchStart:Z,onTouchMove:Z,children:Qt.map(K=>o.jsx("button",{onClick:()=>It(K),className:`w-full text-left px-3 py-1 rounded text-xs transition-colors ${Me===K?"bg-blue-500 text-white":"text-white hover:bg-white/20"}`,children:Rs(K)},K))})]}),o.jsx("button",{onClick:mo,onTouchStart:Z,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Descargar video",children:o.jsx(Is,{className:"w-4 h-4"})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:te,onTouchStart:Z,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",onMouseEnter:()=>D(!0),onMouseLeave:()=>{const K=setTimeout(()=>D(!1),1e3);j(K)},children:w?o.jsx(yS,{className:"w-4 h-4"}):o.jsx(gS,{className:"w-4 h-4"})}),k&&o.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/80 rounded-lg p-3 z-20",onMouseEnter:()=>{L&&(clearTimeout(L),j(null))},onMouseLeave:()=>{const K=setTimeout(()=>D(!1),1e3);j(K)},onTouchStart:Z,onTouchMove:Z,children:o.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:O,onChange:X,onTouchStart:Z,onTouchMove:Z,className:"w-2 h-20 bg-gray-600 rounded-lg appearance-none cursor-pointer slider-vertical",style:{background:`linear-gradient(to top, #3b82f6 0%, #3b82f6 ${O*100}%, #4b5563 ${O*100}%, #4b5563 100%)`},orient:"vertical"}),o.jsxs("span",{className:"text-white text-xs",children:[Math.round(O*100),"%"]})]})})]})]}),o.jsx("div",{className:"relative mb-4",children:o.jsxs("div",{className:"w-full h-2 bg-white/20 rounded-full cursor-pointer relative",onClick:ne,onTouchStart:Z,onTouchMove:Z,children:[o.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${_/A*100}%`}}),q&&ie&&o.jsx("div",{className:"absolute top-0 w-1 h-full bg-green-500 z-10",style:{left:`${G/A*100}%`}}),q&&ve&&o.jsx("div",{className:"absolute top-0 w-1 h-full bg-red-500 z-10",style:{left:`${ae/A*100}%`}})]})}),o.jsxs("div",{className:"flex items-center justify-between text-white text-sm",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("span",{children:[qt(_)," / ",qt(A)]}),Me!==1&&o.jsxs("span",{className:"text-blue-400 font-medium",children:[Me,"x"]}),q&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{onClick:()=>ln("start"),onTouchStart:Z,className:`px-2 py-1 rounded text-xs transition-colors ${ie?"bg-green-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["A: ",ie?qt(G):"--:--"]}),o.jsxs("button",{onClick:()=>ln("end"),onTouchStart:Z,className:`px-2 py-1 rounded text-xs transition-colors ${ve?"bg-red-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["B: ",ve?qt(ae):"--:--"]})]})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("div",{className:"text-xs opacity-75",children:me&&(q&&ie&&ve?"Bucle A-B":"Bucle completo")})})]})]})]})]})},AD=async t=>{try{console.log("🎵 Iniciando detección de BPM para:",t.name);const e=new(window.AudioContext||window.webkitAudioContext),n=await t.arrayBuffer(),r=await e.decodeAudioData(n);if(!jD(r))return console.log("🎵 Video sin audio significativo, usando BPM por defecto"),{success:!1,bpm:null,originalBPM:null,error:"Video sin audio significativo"};console.log("🎵 Audio decodificado, detectando BPM...");const i=await RD(r),a=Math.round(i);return console.log(`✅ BPM detectado: ${a} para ${t.name}`),{success:!0,bpm:a,originalBPM:i,error:null}}catch(e){return console.error("❌ Error al detectar BPM:",e),{success:!1,bpm:null,originalBPM:null,error:e.message}}},jD=t=>{const e=t.getChannelData(0),n=t.sampleRate,r=Math.min(5*n,e.length),s=e.slice(0,r),i=Math.sqrt(s.reduce((a,l)=>a+l*l,0)/s.length);return console.log(`🎵 Nivel de audio RMS: ${i.toFixed(4)}`),i>.01},RD=async t=>{const e=t.sampleRate,n=t.getChannelData(0),r=Math.min(10*e,n.length),s=n.slice(0,r),i=PD(s,e),a=[];for(let l=1;l<i.length;l++)a.push(i[l]-i[l-1]);if(a.length>0){const l=a.reduce((f,m)=>f+m,0)/a.length,u=60*e/l;if(console.log(`🎵 BPM calculado: ${u}, intervalos: ${a.length}, promedio: ${l}`),u>300)return console.log(`🎵 BPM demasiado alto (${u}), probablemente error de detección`),120;const d=Math.max(80,Math.min(180,u));return u!==d&&console.log(`🎵 BPM ajustado de ${u} a ${d}`),d>=175&&(console.log(`🎵 BPM muy alto (${d}), verificando si es real...`),a.filter(m=>Math.abs(m-l)<l*.3).length<a.length*.7)?(console.log("🎵 BPM alto pero intervalos inconsistentes, usando BPM por defecto"),120):d}return console.log("🎵 No se detectaron intervalos, usando BPM por defecto: 120"),120},PD=(t,e)=>{const n=[],r=t.map(u=>u*u),s=r.reduce((u,d)=>u+d,0)/r.length,i=Math.max(.01,Math.min(.5,s*3)),a=e*.5;console.log(`🎵 Detectando picos con umbral: ${i.toFixed(4)}, energía promedio: ${s.toFixed(4)}`);const l=Math.floor(e*.1);for(let u=l;u<t.length-l;u++){const d=t.slice(u-l,u+l),f=Math.max(...d);t[u]===f&&t[u]>i&&(n.length===0||u-n[n.length-1]>a)&&n.push(u)}if(console.log(`🎵 Picos detectados: ${n.length}`),n.length<3){console.log("🎵 Pocos picos detectados, reduciendo umbral...");const u=i*.5;n.length=0;for(let d=l;d<t.length-l;d++){const f=t.slice(d-l,d+l),m=Math.max(...f);t[d]===m&&t[d]>u&&(n.length===0||d-n[n.length-1]>a)&&n.push(d)}console.log(`🎵 Picos detectados con umbral reducido: ${n.length}`)}return n},DD=t=>t<80||t>180?(console.warn(`⚠️ BPM fuera de rango para salsa: ${t} (rango esperado: 80-180)`),!1):!0,OD=({isOpen:t,onClose:e,onVideoUploaded:n,page:r="figuras",style:s="salsa"})=>{const{user:i}=gr(),{currentCategories:a,categoriesList:l}=Uc(r,s),u=S.useRef(null),[d,f]=S.useState([]),[m,g]=S.useState(!1),[x,b]=S.useState({}),[R,T]=S.useState(1),[v,_]=S.useState({}),[y,A]=S.useState([]),[P,O]=S.useState({}),N=S.useRef({}),[w,I]=S.useState(new Set);S.useEffect(()=>{t?T(1):k()},[t]),S.useEffect(()=>{if(a){const V={};Object.keys(a).forEach(le=>{V[le]=[]}),O(V)}},[a]);const k=()=>{Object.values(v).forEach(V=>{V.videoPreview&&URL.revokeObjectURL(V.videoPreview),V.thumbnailPreview&&URL.revokeObjectURL(V.thumbnailPreview)}),f([]),_({}),I(new Set),b({}),g(!1),T(1),u.current&&(u.current.value="")},D=(V,le="success")=>{const oe=Date.now();A(be=>[...be,{id:oe,message:V,type:le}])},L=V=>{A(le=>le.filter(oe=>oe.id!==V))},j=V=>{I(le=>{const oe=new Set(le);return oe.has(V)?oe.delete(V):oe.add(V),oe})},ce=V=>{I(V?new Set(d.map(le=>le.name)):new Set)},H=V=>{const oe=Array.from(V.target.files).filter(pe=>pe.type.startsWith("video/"));if(oe.length===0){D("Por favor selecciona archivos de video válidos","error");return}const be=oe.filter(pe=>!d.some(Ae=>Ae.name===pe.name));if(be.length===0){D("Algunos archivos ya están seleccionados","warning");return}f(pe=>[...pe,...be]),be.forEach(async pe=>{const Ae=URL.createObjectURL(pe);try{const Le=await B(pe),Xe=URL.createObjectURL(Le);_(he=>({...he,[pe.name]:{...he[pe.name],videoPreview:Ae,thumbnailPreview:Xe}}))}catch(Le){console.warn("Error generando thumbnail para vista previa:",Le),_(Xe=>({...Xe,[pe.name]:{...Xe[pe.name],videoPreview:Ae}}))}}),D(`${be.length} video(s) agregado(s)`,"success")},me=V=>{const le=d[V];le&&v[le.name]&&(v[le.name].videoPreview&&URL.revokeObjectURL(v[le.name].videoPreview),v[le.name].thumbnailPreview&&URL.revokeObjectURL(v[le.name].thumbnailPreview)),f(oe=>oe.filter((be,pe)=>pe!==V)),_(oe=>{const be={...oe};return delete be[le.name],be}),I(oe=>{const be=new Set(oe);return be.delete(le.name),be})},ue=(V,le)=>{O(oe=>{const be=oe[V]||[];if(be.includes(le))return{...oe,[V]:be.filter(Ae=>Ae!==le)};{const Ae=[...new Set([...be,le])];return{...oe,[V]:Ae}}})},G=async V=>{var le;try{if((le=v[V.name])!=null&&le.customThumbnailFile){const oe=v[V.name].customThumbnailFile,be=`thumbnails/${r}/${s}/${Date.now()}_${V.name.replace(/\.[^/.]+$/,".jpg")}`,pe=await ta(oe,be);if(pe.success)return{url:pe.url,path:pe.path}}try{const oe=await Promise.race([F5(V),new Promise((be,pe)=>setTimeout(()=>pe(new Error("Timeout")),15e3))]);if(oe.success&&oe.blob){const be=`thumbnails/${r}/${s}/${Date.now()}_${V.name.replace(/\.[^/.]+$/,".jpg")}`,pe=await ta(oe.blob,be);if(pe.success)return oe.thumbnailURL&&URL.revokeObjectURL(oe.thumbnailURL),{url:pe.url,path:pe.path}}}catch(oe){console.warn("Error generando thumbnail automático:",oe)}try{const oe=await B(V);if(oe){const be=`thumbnails/${r}/${s}/${Date.now()}_${V.name.replace(/\.[^/.]+$/,".jpg")}`,pe=await ta(oe,be);if(pe.success)return{url:pe.url,path:pe.path}}}catch(oe){console.warn("Error generando thumbnail por defecto:",oe)}return{url:null,path:null}}catch(oe){return console.error("Error en generateThumbnail:",oe),{url:null,path:null}}},B=async V=>new Promise((le,oe)=>{try{const be=URL.createObjectURL(V),pe=document.createElement("video");pe.crossOrigin="anonymous",pe.muted=!0,pe.playsInline=!0;const Ae=document.createElement("canvas"),Le=Ae.getContext("2d");Ae.width=1280,Ae.height=720,pe.onloadedmetadata=()=>{try{pe.currentTime=.1,pe.onseeked=()=>{try{Le.drawImage(pe,0,0,Ae.width,Ae.height),Ae.toBlob(Xe=>{Xe?(URL.revokeObjectURL(be),pe.remove(),Ae.remove(),le(Xe)):oe(new Error("No se pudo generar el thumbnail por defecto"))},"image/jpeg",.95)}catch(Xe){oe(new Error(`Error al capturar frame por defecto: ${Xe.message}`))}},pe.onerror=()=>{oe(new Error("Error al cargar el video para thumbnail por defecto"))}}catch(Xe){oe(new Error(`Error al procesar metadata por defecto: ${Xe.message}`))}},pe.onerror=()=>{URL.revokeObjectURL(be),pe.remove(),Ae.remove(),oe(new Error("Error al cargar el video por defecto"))},pe.src=be}catch(be){oe(new Error(`Error al generar thumbnail por defecto: ${be.message}`))}}),ae=async(V,le)=>{var oe,be,pe,Ae;try{if((await D5(V.name)).isDuplicate)return D(`Video "${V.name}" ya existe en la base de datos`,"warning"),null;const Xe=await G(V),he=`videos/${r}/${s}/${Date.now()}_${V.name}`,Oe=await $5(V,he,Z=>{b(Bt=>({...Bt,[le]:Z}))});if(!Oe.success)return D(`Error al subir ${V.name}: ${Oe.error}`,"error"),null;const Ke={...P,estilo:P.estilo||[]},qe=N.current[`${V.name}-title`],Mt=N.current[`${V.name}-description`],Nt=((oe=qe==null?void 0:qe.value)==null?void 0:oe.trim())||((be=v[V.name])==null?void 0:be.title)||V.name.replace(/\.[^/.]+$/,""),Tt=((pe=Mt==null?void 0:Mt.value)==null?void 0:pe.trim())||((Ae=v[V.name])==null?void 0:Ae.description)||"";let it=null,vt=null,Me=null;try{const Z=document.createElement("video");Z.src=URL.createObjectURL(V),await new Promise((Bt,bn)=>{Z.onloadedmetadata=()=>{vt=Z.videoWidth,Me=Z.videoHeight;const He=Math.max(vt,Me);He>=3840?it="4K":He>=1920?it="1080p":He>=1280?it="720p":He>=854?it="480p":it="360p",URL.revokeObjectURL(Z.src),Bt()},Z.onerror=bn})}catch(Z){console.warn("No se pudo detectar la resolución del video:",Z),it="Unknown"}let je=null,gt=!1;try{console.log("🎵 Detectando BPM para:",V.name);const Z=await AD(V);Z.success&&DD(Z.bpm)?(je=Z.bpm,gt=!0,console.log(`✅ BPM detectado: ${je} para ${V.name}`)):console.warn(`⚠️ No se pudo detectar BPM válido para ${V.name}`)}catch(Z){console.error("❌ Error al detectar BPM:",Z)}const Bn={title:Nt,originalTitle:V.name,description:Tt,videoUrl:Oe.url,thumbnailUrl:Xe.url||null,videoPath:Oe.path,thumbnailPath:Xe.path||null,fileSize:V.size,fileType:V.type,duration:0,resolution:it,videoWidth:vt,videoHeight:Me,style:s,tags:Ke,uploadedBy:(i==null?void 0:i.uid)||"anonymous",uploadedAt:new Date().toISOString(),views:0,likes:0,likedBy:[],bpm:je,bpmDetected:gt},Qt=await A5(Bn);return Qt.success?(D(`${V.name} subido exitosamente`,"success"),{...Bn,id:Qt.id}):(D(`Error al guardar metadatos de ${V.name}`,"error"),null)}catch(Le){return console.error("Error uploading video:",Le),D(`Error inesperado al subir ${V.name}`,"error"),null}},we=async()=>{if(d.length===0){D("Selecciona al menos un video","error");return}g(!0);const V=[];for(let le=0;le<d.length;le++){const oe=d[le],be=await ae(oe,le);be&&V.push(be)}g(!1),V.length>0&&(D(`${V.length} video(s) subido(s) correctamente`,"success"),V.forEach(le=>n(le)),e())},q=()=>o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Seleccionar Videos"}),o.jsx("p",{className:"text-gray-600",children:"Selecciona uno o varios videos para subir"})]}),o.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-pink-400 transition-colors duration-200",children:[o.jsx("input",{ref:u,type:"file",multiple:!0,accept:"video/*",onChange:H,className:"hidden"}),o.jsxs("button",{onClick:()=>{var V;return(V=u.current)==null?void 0:V.click()},className:"w-full flex flex-col items-center justify-center space-y-2 text-gray-600 hover:text-pink-500 transition-colors duration-200",children:[o.jsx(uc,{className:"h-12 w-12"}),o.jsx("span",{className:"font-medium text-center",children:"Haz clic para seleccionar videos"}),o.jsx("span",{className:"text-sm text-center",children:"MP4, AVI, MOV, etc. (máx. 100MB cada uno)"})]})]}),d.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("h4",{className:"font-medium text-gray-900",children:["Videos seleccionados (",d.length,")"]}),d.map((V,le)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-medium text-gray-900",children:V.name}),o.jsxs("p",{className:"text-sm text-gray-500",children:[(V.size/(1024*1024)).toFixed(2)," MB"]})]}),o.jsx("button",{onClick:()=>me(le),className:"p-1 text-red-500 hover:text-red-700 transition-colors duration-200",children:o.jsx(ks,{className:"h-4 w-4"})})]},le))]})]}),Y=()=>o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Configurar Videos"}),o.jsx("p",{className:"text-gray-600",children:"Personaliza la información de tus videos antes de subirlos"})]}),d.length>1&&o.jsxs("div",{className:"flex justify-center space-x-2",children:[o.jsxs("button",{onClick:()=>ce(!0),className:"flex items-center space-x-1 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[o.jsx(rD,{className:"h-4 w-4"}),o.jsx("span",{children:"Plegar Todo"})]}),o.jsxs("button",{onClick:()=>ce(!1),className:"flex items-center space-x-1 px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[o.jsx(sD,{className:"h-4 w-4"}),o.jsx("span",{children:"Desplegar Todo"})]})]}),d.map((V,le)=>{var be,pe,Ae,Le,Xe;const oe=w.has(V.name);return o.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"w-12 h-9 bg-gray-100 rounded flex items-center justify-center relative overflow-hidden",children:[(be=v[V.name])!=null&&be.thumbnailPreview?o.jsx("img",{src:v[V.name].thumbnailPreview,alt:"Vista previa del video",className:"w-full h-full object-cover",onError:he=>{he.target.style.display="none",he.target.nextSibling.style.display="flex"}}):null,o.jsx("span",{className:"text-xs text-gray-500",style:{display:(pe=v[V.name])!=null&&pe.thumbnailPreview?"none":"flex"},children:"VIDEO"})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-gray-900",children:V.name}),o.jsxs("p",{className:"text-sm text-gray-500",children:[(V.size/(1024*1024)).toFixed(2)," MB"]})]})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("button",{onClick:()=>j(V.name),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",title:oe?"Desplegar":"Plegar",children:oe?o.jsx(lc,{className:"h-4 w-4"}):o.jsx(zd,{className:"h-4 w-4"})})})]}),!oe&&o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h4",{className:"font-medium text-gray-900",children:"Vista previa del video"}),o.jsx("div",{className:"flex justify-center",children:o.jsx(dc,{src:((Ae=v[V.name])==null?void 0:Ae.videoPreview)||URL.createObjectURL(V),size:"medium",loop:!0,showControls:!0,autoplay:!1,muted:!1,className:"w-full max-w-2xl",resolutions:["auto","4k","1080p","720p","480p","360p"],currentResolution:"auto",videoTitle:((Le=v[V.name])==null?void 0:Le.title)||V.name.replace(/\.[^/.]+$/,""),onResolutionChange:he=>{console.log(`Resolución cambiada a: ${he}`)}})}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[o.jsx("span",{children:V.name}),o.jsxs("span",{children:[(V.size/(1024*1024)).toFixed(2)," MB"]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre del video"}),o.jsx("input",{type:"text","data-file":V.name,"data-field":"title",ref:he=>{var Oe;he&&(N.current[`${V.name}-title`]=he,he.value||(he.value=((Oe=v[V.name])==null?void 0:Oe.title)||V.name.replace(/\.[^/.]+$/,"")))},onBlur:he=>{var Ke;const Oe=he.target.value.trim();Oe!==(((Ke=v[V.name])==null?void 0:Ke.title)||V.name.replace(/\.[^/.]+$/,""))&&_(qe=>({...qe,[V.name]:{...qe[V.name],title:Oe}}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"Ingresa un nombre para el video"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descripción (opcional)"}),o.jsx("textarea",{"data-file":V.name,"data-field":"description",ref:he=>{var Oe;he&&(N.current[`${V.name}-description`]=he,he.value||(he.value=((Oe=v[V.name])==null?void 0:Oe.description)||""))},onBlur:he=>{var Ke;const Oe=he.target.value.trim();Oe!==(((Ke=v[V.name])==null?void 0:Ke.description)||"")&&_(qe=>({...qe,[V.name]:{...qe[V.name],description:Oe}}))},rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"Describe brevemente el contenido del video..."})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Thumbnail personalizado (opcional)"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-40 h-24 bg-gray-100 rounded border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden",children:(Xe=v[V.name])!=null&&Xe.customThumbnail?o.jsx("img",{src:v[V.name].customThumbnail,alt:"Thumbnail personalizado",className:"w-full h-full object-cover rounded"}):o.jsx("span",{className:"text-xs text-gray-500",children:"IMG"})}),o.jsx("input",{type:"file",accept:"image/*",onChange:he=>{const Oe=he.target.files[0];if(Oe){const Ke=new FileReader;Ke.onload=qe=>{_(Mt=>({...Mt,[V.name]:{...Mt[V.name],customThumbnail:qe.target.result,customThumbnailFile:Oe}}))},Ke.readAsDataURL(Oe)}},className:"flex-1 text-sm text-gray-500 file:mr-4 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-sm file:font-medium file:bg-pink-50 file:text-pink-700 hover:file:bg-pink-100"})]})]})]})]},le)}),o.jsxs("div",{className:"border-t pt-6",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Etiquetas para todos los videos"}),l.map(V=>o.jsxs("div",{className:"space-y-3 mb-4",children:[o.jsx("h5",{className:"font-medium text-gray-700 capitalize",children:V.name}),o.jsx("div",{className:"flex flex-wrap gap-2",children:V.tags.map(le=>{var oe;return o.jsx("button",{onClick:()=>ue(V.key,le),className:`px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 ${(oe=P[V.key])!=null&&oe.includes(le)?"bg-gradient-to-r from-pink-500 to-orange-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:le},le)})})]},V.key))]}),o.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Ts,{className:"h-5 w-5 text-blue-500 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Información"}),o.jsx("p",{className:"text-sm text-blue-700",children:"Personaliza cada video individualmente y aplica etiquetas que se usarán para todos los videos seleccionados."})]})]})})]}),ie=()=>o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Subiendo Videos"}),o.jsxs("p",{className:"text-gray-600",children:["Procesando ",d.length," video(s)..."]})]}),d.map((V,le)=>o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"font-medium text-gray-900",children:V.name}),o.jsxs("span",{className:"text-sm text-gray-500",children:[x[le]||0,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-gradient-to-r from-pink-500 to-orange-500 h-2 rounded-full transition-all duration-300",style:{width:`${x[le]||0}%`}})})]},le))]}),_e=()=>{switch(R){case 1:return o.jsx(q,{});case 2:return o.jsx(Y,{});case 3:return o.jsx(ie,{});default:return o.jsx(q,{})}},ve=()=>{switch(R){case 1:return d.length>0;case 2:return!0;case 3:return!1;default:return!1}},Se=()=>{R===2?we():(T(V=>V+1),R===1&&I(new Set(d.map(V=>V.name))))},Qe=()=>{T(V=>Math.max(1,V-1))};return t?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full",children:o.jsx(uc,{className:"h-6 w-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Subir Videos"}),o.jsxs("p",{className:"text-sm text-gray-500",children:["Paso ",R," de 3"]})]})]}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:o.jsx(Cr,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:_e()}),o.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[o.jsx("button",{onClick:Qe,disabled:R===1||m,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Atrás"}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:e,disabled:m,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),R<3&&o.jsx("button",{onClick:Se,disabled:!ve()||m,className:"px-6 py-2 bg-gradient-to-r from-pink-500 to-orange-500 text-white rounded-lg font-medium hover:shadow-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:R===2?"Subir Videos":"Siguiente"})]})]})]})}),y.map(V=>o.jsx(Fc,{message:V.message,type:V.type,onClose:()=>L(V.id)},V.id))]}):null},LD=({isOpen:t,onClose:e,video:n,onVideoUpdated:r,page:s="figuras",style:i="salsa"})=>{const{user:a}=gr(),{currentCategories:l,categoriesList:u}=Uc(s,i),[d,f]=S.useState(!1),[m,g]=S.useState([]),[x,b]=S.useState(""),[R,T]=S.useState(""),[v,_]=S.useState(null),[y,A]=S.useState(null),[P,O]=S.useState({}),[N,w]=S.useState({}),[I,k]=S.useState({}),[D,L]=S.useState(new Set(["tags-iniciales","tags-finales"]));S.useEffect(()=>{if(!(!t||!n)&&(b(n.title||""),T(n.description||""),_(n.thumbnailUrl||null),A(null),l)){const q={},Y={},ie={};Object.keys(l).forEach(_e=>{var ve,Se,Qe;q[_e]=((ve=n.tags)==null?void 0:ve[_e])||[],Y[_e]=((Se=n.tagsIniciales)==null?void 0:Se[_e])||[],ie[_e]=((Qe=n.tagsFinales)==null?void 0:Qe[_e])||[]}),O(q),w(Y),k(ie)}},[t,n,l]),S.useEffect(()=>{t||(b(""),T(""),_(null),A(null),O({}),w({}),k({}))},[t]);const j=(q,Y="success")=>{const ie=Date.now();g(_e=>[..._e,{id:ie,message:q,type:Y}])},ce=q=>{g(Y=>Y.filter(ie=>ie.id!==q))},H=q=>{L(Y=>{const ie=new Set(Y);return ie.has(q)?ie.delete(q):ie.add(q),ie})},me=(q,Y)=>{O(ie=>{const _e=ie[q]||[];if(_e.includes(Y))return{...ie,[q]:_e.filter(Se=>Se!==Y)};{const Se=[...new Set([..._e,Y])];return{...ie,[q]:Se}}})},ue=(q,Y)=>{w(ie=>{const _e=ie[q]||[];if(_e.includes(Y))return{...ie,[q]:_e.filter(Se=>Se!==Y)};{const Se=[...new Set([..._e,Y])];return{...ie,[q]:Se}}})},G=(q,Y)=>{k(ie=>{const _e=ie[q]||[];if(_e.includes(Y))return{...ie,[q]:_e.filter(Se=>Se!==Y)};{const Se=[...new Set([..._e,Y])];return{...ie,[q]:Se}}})},B=q=>{const Y=q.target.files[0];if(Y){const ie=new FileReader;ie.onload=_e=>{_(_e.target.result),A(Y)},ie.readAsDataURL(Y)}},ae=async q=>{try{const Y=document.createElement("video");Y.src=q,await new Promise((ie,_e)=>{Y.onloadedmetadata=()=>{const ve=Y.videoWidth,Se=Y.videoHeight,Qe=Math.max(ve,Se);let V="Unknown";Qe>=3840?V="4K":Qe>=1920?V="1080p":Qe>=1280?V="720p":Qe>=854?V="480p":V="360p",ie({resolution:V,videoWidth:ve,videoHeight:Se})},Y.onerror=_e,setTimeout(()=>_e(new Error("Timeout")),1e4)})}catch(Y){return console.warn("No se pudo detectar la resolución del video:",Y),{resolution:"Unknown",videoWidth:null,videoHeight:null}}},we=async()=>{if(n){f(!0);try{let q=n.thumbnailUrl,Y=n.thumbnailPath;if(y){const le=`thumbnails/${Date.now()}_${n.originalTitle.replace(/\.[^/.]+$/,".jpg")}`,oe=await ta(y,le);if(oe.success)q=oe.url,Y=oe.path;else{j("Error al subir el nuevo thumbnail","error"),f(!1);return}}const ie={...P,estilo:P.estilo||[]};let _e=n.resolution,ve=n.videoWidth,Se=n.videoHeight;if(!_e||_e==="Unknown")try{const le=await ae(n.videoUrl);_e=le.resolution,ve=le.videoWidth,Se=le.videoHeight,console.log(`Resolución detectada: ${_e} (${ve}x${Se})`)}catch(le){console.warn("No se pudo detectar la resolución:",le),_e="Unknown"}const Qe={title:x.trim(),description:R.trim(),thumbnailUrl:q,thumbnailPath:Y,resolution:_e,videoWidth:ve,videoHeight:Se,tags:ie,tagsIniciales:N,tagsFinales:I,updatedBy:(a==null?void 0:a.uid)||"anonymous",updatedAt:new Date().toISOString()},V=await Gu(n.id,Qe);V.success?(j("Video actualizado exitosamente","success"),r({...n,...Qe}),e()):j(`Error al actualizar video: ${V.error}`,"error")}catch(q){console.error("Error updating video:",q),j("Error inesperado al actualizar video","error")}f(!1)}};return!t||!n?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full",children:o.jsx(cc,{className:"h-6 w-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Editar Video"}),o.jsx("p",{className:"text-sm text-gray-500",children:n.title})]})]}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:o.jsx(Cr,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h4",{className:"font-medium text-gray-900",children:"Vista previa del video"}),o.jsx("div",{className:"flex justify-center",children:o.jsx(dc,{src:n.videoUrl,size:"medium",loop:!0,showControls:!0,autoplay:!1,muted:!1,className:"w-full max-w-2xl",resolutions:["auto","4k","1080p","720p","480p","360p"],currentResolution:"auto",videoTitle:n.title||"video",onResolutionChange:q=>{console.log(`Resolución cambiada a: ${q}`)}})}),o.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{children:n.originalTitle}),o.jsx("span",{className:"text-gray-400",children:"•"}),o.jsxs("span",{children:[(n.fileSize/(1024*1024)).toFixed(2)," MB"]}),n.resolution&&n.resolution!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-gray-400",children:"•"}),o.jsx("span",{children:n.resolution})]})]})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Título del video"}),o.jsx("input",{type:"text",value:x,onChange:q=>b(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 placeholder-gray-500",placeholder:"Ingresa un título para el video"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descripción"}),o.jsx("textarea",{value:R,onChange:q=>T(q.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 placeholder-gray-500",placeholder:"Describe brevemente el contenido del video..."})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Thumbnail personalizado"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-40 h-24 bg-gray-100 rounded border-2 border-dashed border-gray-300 flex items-center justify-center",children:v?o.jsx("img",{src:v,alt:"Thumbnail",className:"w-full h-full object-cover rounded"}):o.jsx("span",{className:"text-xs text-gray-500",children:"IMG"})}),o.jsx("input",{type:"file",accept:"image/*",onChange:B,className:"flex-1 text-sm text-gray-500 file:mr-4 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("h4",{className:"font-medium text-gray-900",children:"Tags Normales"}),u.map(q=>o.jsxs("div",{className:"space-y-3",children:[o.jsx("h5",{className:"font-medium text-gray-700 capitalize",children:q.name}),o.jsx("div",{className:"flex flex-wrap gap-2",children:q.tags.map(Y=>{var ie;return o.jsx("button",{onClick:()=>me(q.key,Y),className:`px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 ${(ie=P[q.key])!=null&&ie.includes(Y)?"bg-gradient-to-r from-pink-500 to-orange-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Y},Y)})})]},q.key))]}),o.jsxs("div",{className:"border-t pt-6",children:[o.jsxs("button",{onClick:()=>H("tags-iniciales"),className:"flex items-center justify-between w-full p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg hover:from-blue-100 hover:to-purple-100 transition-all duration-200",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(op,{className:"h-5 w-5 text-blue-600"}),o.jsx("h4",{className:"font-medium text-gray-900",children:"Tags Iniciales (cómo empieza la figura)"})]}),D.has("tags-iniciales")?o.jsx(lc,{className:"h-5 w-5 text-gray-500"}):o.jsx(zd,{className:"h-5 w-5 text-gray-500"})]}),o.jsx("div",{className:`mt-4 transition-all duration-300 ease-in-out overflow-hidden ${D.has("tags-iniciales")?"max-h-0 opacity-0":"max-h-96 opacity-100"}`,children:o.jsx("div",{className:"space-y-4 bg-blue-50 rounded-lg p-4",children:u.map(q=>o.jsxs("div",{className:"space-y-2",children:[o.jsx("h6",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:q.name}),o.jsx("div",{className:"flex flex-wrap gap-2",children:q.tags.map(Y=>{var ie;return o.jsx("button",{onClick:()=>ue(q.key,Y),className:`px-2 py-1 rounded-full text-xs font-medium transition-all duration-200 ${(ie=N[q.key])!=null&&ie.includes(Y)?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"bg-white text-gray-700 hover:bg-blue-100"}`,children:Y},`inicial-${Y}`)})})]},`inicial-${q.key}`))})})]}),o.jsxs("div",{className:"border-t pt-6",children:[o.jsxs("button",{onClick:()=>H("tags-finales"),className:"flex items-center justify-between w-full p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-lg hover:from-green-100 hover:to-teal-100 transition-all duration-200",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(op,{className:"h-5 w-5 text-green-600"}),o.jsx("h4",{className:"font-medium text-gray-900",children:"Tags Finales (cómo termina la figura)"})]}),D.has("tags-finales")?o.jsx(lc,{className:"h-5 w-5 text-gray-500"}):o.jsx(zd,{className:"h-5 w-5 text-gray-500"})]}),o.jsx("div",{className:`mt-4 transition-all duration-300 ease-in-out overflow-hidden ${D.has("tags-finales")?"max-h-0 opacity-0":"max-h-96 opacity-100"}`,children:o.jsx("div",{className:"space-y-4 bg-green-50 rounded-lg p-4",children:u.map(q=>o.jsxs("div",{className:"space-y-2",children:[o.jsx("h6",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:q.name}),o.jsx("div",{className:"flex flex-wrap gap-2",children:q.tags.map(Y=>{var ie;return o.jsx("button",{onClick:()=>G(q.key,Y),className:`px-2 py-1 rounded-full text-xs font-medium transition-all duration-200 ${(ie=I[q.key])!=null&&ie.includes(Y)?"bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-lg":"bg-white text-gray-700 hover:bg-green-100"}`,children:Y},`final-${Y}`)})})]},`final-${q.key}`))})})]}),o.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Ts,{className:"h-5 w-5 text-blue-500 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Información"}),o.jsx("p",{className:"text-sm text-blue-700",children:"Los tags iniciales y finales ayudarán a crear secuencias lógicas conectando figuras."})]})]})})]})}),o.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[o.jsx("button",{onClick:e,disabled:d,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),o.jsx("button",{onClick:we,disabled:d||!x.trim(),className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg font-medium hover:shadow-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:d?"Guardando...":"Guardar Cambios"})]})]})}),m.map(q=>o.jsx(Fc,{message:q.message,type:q.type,onClose:()=>ce(q.id)},q.id))]})};var tt;(function(t){t.LOAD="LOAD",t.EXEC="EXEC",t.FFPROBE="FFPROBE",t.WRITE_FILE="WRITE_FILE",t.READ_FILE="READ_FILE",t.DELETE_FILE="DELETE_FILE",t.RENAME="RENAME",t.CREATE_DIR="CREATE_DIR",t.LIST_DIR="LIST_DIR",t.DELETE_DIR="DELETE_DIR",t.ERROR="ERROR",t.DOWNLOAD="DOWNLOAD",t.PROGRESS="PROGRESS",t.LOG="LOG",t.MOUNT="MOUNT",t.UNMOUNT="UNMOUNT"})(tt||(tt={}));const MD=(()=>{let t=0;return()=>t++})(),VD=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),UD=new Error("called FFmpeg.terminate()");var Wn,Gs,is,Mi,Vi,qd,kn;class FD{constructor(){Ms(this,Wn,null);Ms(this,Gs,{});Ms(this,is,{});Ms(this,Mi,[]);Ms(this,Vi,[]);Tn(this,"loaded",!1);Ms(this,qd,()=>{De(this,Wn)&&(De(this,Wn).onmessage=({data:{id:e,type:n,data:r}})=>{switch(n){case tt.LOAD:this.loaded=!0,De(this,Gs)[e](r);break;case tt.MOUNT:case tt.UNMOUNT:case tt.EXEC:case tt.FFPROBE:case tt.WRITE_FILE:case tt.READ_FILE:case tt.DELETE_FILE:case tt.RENAME:case tt.CREATE_DIR:case tt.LIST_DIR:case tt.DELETE_DIR:De(this,Gs)[e](r);break;case tt.LOG:De(this,Mi).forEach(s=>s(r));break;case tt.PROGRESS:De(this,Vi).forEach(s=>s(r));break;case tt.ERROR:De(this,is)[e](r);break}delete De(this,Gs)[e],delete De(this,is)[e]})});Ms(this,kn,({type:e,data:n},r=[],s)=>De(this,Wn)?new Promise((i,a)=>{const l=MD();De(this,Wn)&&De(this,Wn).postMessage({id:l,type:e,data:n},r),De(this,Gs)[l]=i,De(this,is)[l]=a,s==null||s.addEventListener("abort",()=>{a(new DOMException(`Message # ${l} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(VD));Tn(this,"load",({classWorkerURL:e,...n}={},{signal:r}={})=>(De(this,Wn)||(Wa(this,Wn,e?new Worker(new URL(e,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),De(this,qd).call(this)),De(this,kn).call(this,{type:tt.LOAD,data:n},void 0,r)));Tn(this,"exec",(e,n=-1,{signal:r}={})=>De(this,kn).call(this,{type:tt.EXEC,data:{args:e,timeout:n}},void 0,r));Tn(this,"ffprobe",(e,n=-1,{signal:r}={})=>De(this,kn).call(this,{type:tt.FFPROBE,data:{args:e,timeout:n}},void 0,r));Tn(this,"terminate",()=>{const e=Object.keys(De(this,is));for(const n of e)De(this,is)[n](UD),delete De(this,is)[n],delete De(this,Gs)[n];De(this,Wn)&&(De(this,Wn).terminate(),Wa(this,Wn,null),this.loaded=!1)});Tn(this,"writeFile",(e,n,{signal:r}={})=>{const s=[];return n instanceof Uint8Array&&s.push(n.buffer),De(this,kn).call(this,{type:tt.WRITE_FILE,data:{path:e,data:n}},s,r)});Tn(this,"mount",(e,n,r)=>{const s=[];return De(this,kn).call(this,{type:tt.MOUNT,data:{fsType:e,options:n,mountPoint:r}},s)});Tn(this,"unmount",e=>{const n=[];return De(this,kn).call(this,{type:tt.UNMOUNT,data:{mountPoint:e}},n)});Tn(this,"readFile",(e,n="binary",{signal:r}={})=>De(this,kn).call(this,{type:tt.READ_FILE,data:{path:e,encoding:n}},void 0,r));Tn(this,"deleteFile",(e,{signal:n}={})=>De(this,kn).call(this,{type:tt.DELETE_FILE,data:{path:e}},void 0,n));Tn(this,"rename",(e,n,{signal:r}={})=>De(this,kn).call(this,{type:tt.RENAME,data:{oldPath:e,newPath:n}},void 0,r));Tn(this,"createDir",(e,{signal:n}={})=>De(this,kn).call(this,{type:tt.CREATE_DIR,data:{path:e}},void 0,n));Tn(this,"listDir",(e,{signal:n}={})=>De(this,kn).call(this,{type:tt.LIST_DIR,data:{path:e}},void 0,n));Tn(this,"deleteDir",(e,{signal:n}={})=>De(this,kn).call(this,{type:tt.DELETE_DIR,data:{path:e}},void 0,n))}on(e,n){e==="log"?De(this,Mi).push(n):e==="progress"&&De(this,Vi).push(n)}off(e,n){e==="log"?Wa(this,Mi,De(this,Mi).filter(r=>r!==n)):e==="progress"&&Wa(this,Vi,De(this,Vi).filter(r=>r!==n))}}Wn=new WeakMap,Gs=new WeakMap,is=new WeakMap,Mi=new WeakMap,Vi=new WeakMap,qd=new WeakMap,kn=new WeakMap;var Uv;(function(t){t.MEMFS="MEMFS",t.NODEFS="NODEFS",t.NODERAWFS="NODERAWFS",t.IDBFS="IDBFS",t.WORKERFS="WORKERFS",t.PROXYFS="PROXYFS"})(Uv||(Uv={}));const $D=t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const{result:s}=r;s instanceof ArrayBuffer?e(new Uint8Array(s)):e(new Uint8Array)},r.onerror=s=>{var i,a;n(Error(`File could not be read! Code=${((a=(i=s==null?void 0:s.target)==null?void 0:i.error)==null?void 0:a.code)||-1}`))},r.readAsArrayBuffer(t)}),y0=async t=>{let e;if(typeof t=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(n=>n.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(t instanceof URL)e=await(await fetch(t)).arrayBuffer();else if(t instanceof File||t instanceof Blob)e=await $D(t);else return new Uint8Array;return new Uint8Array(e)};let ki=null;const Oh=async()=>{if(ki&&ki.FS)return console.log("✅ FFmpeg ya inicializado, reutilizando instancia"),ki;console.log("🎬 Inicializando FFmpeg..."),ki=new FD;try{return await ki.load(),console.log("✅ FFmpeg inicializado correctamente"),ki}catch(t){throw console.error("❌ Error al inicializar FFmpeg:",t),ki=null,new Error("No se pudo inicializar FFmpeg")}},zD=async(t,e,n="output.mp4")=>{try{console.log(`🎬 Ajustando velocidad del video: factor ${e}`);const r=await Oh();if(!r||!r.FS)throw new Error("FFmpeg no está correctamente inicializado");r.FS("writeFile","input.mp4",await y0(t));try{await r.run("-i","input.mp4","-filter:v",`setpts=${1/e}*PTS`,"-filter:a",`atempo=${e}`,"-c:v","libx264","-c:a","aac","-preset","fast",n)}catch(i){console.log("⚠️ Error con audio, procesando solo video:",i.message),await r.run("-i","input.mp4","-filter:v",`setpts=${1/e}*PTS`,"-c:v","libx264","-an","-preset","fast",n)}const s=r.FS("readFile",n);try{r.FS("unlink","input.mp4"),r.FS("unlink",n)}catch{console.warn("⚠️ No se pudieron limpiar archivos temporales")}return console.log("✅ Velocidad ajustada correctamente"),{success:!0,data:s,error:null}}catch(r){return console.error("❌ Error al ajustar velocidad:",r),{success:!1,data:null,error:r.message}}},BD=async(t,e=!1,n=null)=>{try{console.log(`🎬 Creando preview de secuencia con ${t.length} videos...`),console.log(`🎬 Control BPM: ${e?"Activado":"Desactivado"}`),e&&n&&console.log(`🎬 BPM objetivo: ${n}`);const r=await Oh(),s=[],i=e&&n;for(let u=0;u<t.length;u++){const d=t[u];let f;if(d.file)f=d.file,console.log(`✅ Video ${u+1}/${t.length}: ${d.title} (archivo local)`);else if(d.videoUrl){console.log(`📥 Descargando video ${u+1}/${t.length} desde URL...`);try{const m=await fetch(d.videoUrl,{mode:"cors",credentials:"omit",headers:{Accept:"video/*,*/*;q=0.9","Cache-Control":"no-cache"}});if(!m.ok)throw new Error(`HTTP ${m.status}: ${m.statusText}`);f=await m.blob(),console.log(`✅ Video ${u+1}/${t.length}: ${d.title} descargado (${f.size} bytes)`)}catch(m){console.warn(`⚠️ Error en fetch directo: ${m.message}`);try{const{getStorage:g,ref:x,getDownloadURL:b}=await fs(async()=>{const{getStorage:A,ref:P,getDownloadURL:O}=await Promise.resolve().then(()=>ac);return{getStorage:A,ref:P,getDownloadURL:O}},void 0),R=g();let T=d.videoUrl;if(d.videoUrl.includes("firebasestorage.googleapis.com")){const A=d.videoUrl.split("/o/");A.length>1&&(T=decodeURIComponent(A[1].split("?")[0]))}const v=x(R,T),_=await b(v),y=await fetch(_);if(!y.ok)throw new Error(`HTTP ${y.status}: ${y.statusText}`);f=await y.blob(),console.log(`✅ Video ${u+1}/${t.length}: ${d.title} descargado via Firebase (${f.size} bytes)`)}catch(g){throw new Error(`Error descargando video ${u+1} (${d.title}): ${g.message}`)}}}else throw new Error(`Video ${u+1} (${d.title}) no tiene archivo ni URL asociada`);if(i&&d.bpm){const m=n/d.bpm;console.log(`🎬 Procesando video ${u+1}/${t.length}: ${d.title} (BPM: ${d.bpm} → ${n}, factor: ${m.toFixed(2)}x)`);const g=await zD(f,m,`preview${u}.mp4`);if(!g.success)throw new Error(`Error al procesar video ${u+1} (${d.title}): ${g.error}`);s.push(g.data)}else console.log(`🎬 Usando video ${u+1}/${t.length}: ${d.title} (sin procesamiento)`),s.push(f)}console.log("🎬 Concatenando videos para preview...");for(let u=0;u<s.length;u++){const d=s[u],f=d instanceof Blob?await y0(d):d;r.FS("writeFile",`preview${u}.mp4`,f),console.log(`📝 Video ${u+1}/${s.length} escrito al sistema de archivos`)}const a=s.map((u,d)=>`file preview${d}.mp4`).join(`
`);r.FS("writeFile","filelist.txt",a),console.log("📋 Lista de archivos creada"),console.log("🔗 Iniciando concatenación..."),await r.run("-f","concat","-safe","0","-i","filelist.txt","-c","copy","-avoid_negative_ts","make_zero","sequence_preview.mp4"),console.log("✅ Concatenación completada");const l=r.FS("readFile","sequence_preview.mp4");for(let u=0;u<s.length;u++)try{r.FS("unlink",`preview${u}.mp4`)}catch{console.warn(`⚠️ No se pudo limpiar archivo temporal preview${u}.mp4`)}try{r.FS("unlink","filelist.txt"),r.FS("unlink","sequence_preview.mp4")}catch{console.warn("⚠️ No se pudieron limpiar algunos archivos temporales")}return console.log("✅ Preview de secuencia creado correctamente"),{success:!0,data:l,error:null}}catch(r){return console.error("❌ Error al crear preview de secuencia:",r),{success:!1,data:null,error:r.message}}},xS=async(t,e="mp4",n="720p")=>{try{console.log(`🎬 Convirtiendo video a formato ${e} con resolución ${n}...`);const r=await Oh();r.FS("writeFile","input.mp4",await y0(t));let s=[],i=[];switch(n){case"360p":s=["-vf","scale=-1:360"],i=["-crf","28","-preset","ultrafast"];break;case"480p":s=["-vf","scale=-1:480"],i=["-crf","25","-preset","fast"];break;case"720p":s=["-vf","scale=-1:720"],i=["-crf","23","-preset","fast"];break;case"1080p":s=["-vf","scale=-1:1080"],i=["-crf","20","-preset","medium"];break;case"4k":s=["-vf","scale=-1:2160"],i=["-crf","18","-preset","medium"];break;default:s=["-vf","scale=-1:720"],i=["-crf","23","-preset","fast"]}await r.run("-i","input.mp4",...s,...i,`output.${e}`);const a=r.FS("readFile",`output.${e}`);return r.FS("unlink","input.mp4"),r.FS("unlink",`output.${e}`),console.log("✅ Video convertido correctamente"),{success:!0,data:a,format:e,error:null}}catch(r){return console.error("❌ Error al convertir video:",r),{success:!1,data:null,format:null,error:r.message}}},Fv=async t=>{try{if(console.log(`📥 Descarga directa de secuencia: ${t.name}`),!t.videos||t.videos.length===0)throw new Error("La secuencia no tiene videos");if(t.videos.length===1){const i=t.videos[0];if(i.file)return{success:!0,data:i.file,format:"mp4",error:null};if(i.videoUrl){const a=await fetch(i.videoUrl);if(!a.ok)throw new Error("Error descargando video");return{success:!0,data:await a.blob(),format:"mp4",error:null}}}const e=await fs(()=>import("./jszip.min-DlByXKuS.js").then(i=>i.j),[]),n=new e.default,r=(t.name||t.title||"secuencia").replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_").toLowerCase();for(let i=0;i<t.videos.length;i++){const a=t.videos[i];let l;if(a.file)l=a.file;else if(a.videoUrl){const d=await fetch(a.videoUrl);if(!d.ok)throw new Error(`Error descargando video ${i+1}`);l=await d.blob()}else throw new Error(`Video ${i+1} no tiene archivo ni URL`);const u=`${r}_${i+1}.mp4`;n.file(u,l),console.log(`📁 Agregando al ZIP: ${u}`)}return{success:!0,data:await n.generateAsync({type:"blob"}),format:"zip",error:null}}catch(e){return console.error("❌ Error en descarga directa:",e),{success:!1,data:null,format:null,error:e.message}}},qD=async(t,e="mp4",n="720p")=>{try{if(console.log(`🎬 Generando video de secuencia: ${t.name}`),console.log(`📹 Formato: ${e}, Resolución: ${n}`),!t.videos||t.videos.length===0)throw new Error("La secuencia no tiene videos");const r=t.useBPMControl||!1,s=t.targetBPM||null;if(console.log(`🎵 Configuración BPM: ${r?"Activado":"Desactivado"}, BPM: ${s}`),!r||!s)return console.log("🚀 Usando descarga directa (sin FFmpeg)"),await Fv(t);console.log("🎬 Intentando inicializar FFmpeg...");const i=Oh(),a=new Promise((u,d)=>setTimeout(()=>d(new Error("Timeout inicializando FFmpeg")),1e4));try{await Promise.race([i,a])}catch{return console.warn("⚠️ FFmpeg no pudo inicializarse, usando descarga directa"),await Fv(t)}const l=await BD(t.videos,r,s);if(!l.success)throw new Error(`Error generando video: ${l.error}`);if(e!=="mp4"||n!=="720p"){console.log(`🔄 Convirtiendo a formato ${e} con resolución ${n}...`);const u=await xS(new Blob([l.data],{type:"video/mp4"}),e,n);if(!u.success)throw new Error(`Error convirtiendo formato: ${u.error}`);return{success:!0,data:u.data,format:e,error:null}}return{success:!0,data:l.data,format:"mp4",error:null}}catch(r){return console.error("❌ Error generando video de secuencia:",r),{success:!1,data:null,format:null,error:r.message}}},HD=({isOpen:t,onClose:e,video:n,onDownloadComplete:r})=>{const[s,i]=S.useState("mp4"),[a,l]=S.useState("720p"),[u,d]=S.useState(!1),[f,m]=S.useState(0),g=[{value:"mp4",label:"MP4",description:"Formato estándar, compatible con todo"},{value:"avi",label:"AVI",description:"Formato clásico, buena calidad"},{value:"mov",label:"MOV",description:"Formato Apple, alta calidad"},{value:"webm",label:"WebM",description:"Formato web, archivos pequeños"}],x=[{value:"360p",label:"360p",description:"Calidad baja, archivo pequeño"},{value:"480p",label:"480p",description:"Calidad estándar, balance"},{value:"720p",label:"720p",description:"HD, buena calidad"},{value:"1080p",label:"1080p",description:"Full HD, alta calidad"},{value:"4k",label:"4K",description:"Ultra HD, máxima calidad"}],b=async()=>{if(!n){console.error("No hay video para descargar");return}d(!0),m(0);try{console.log(`🎬 Iniciando descarga: ${s}, resolución: ${a}`);const v=setInterval(()=>{m(y=>y>=90?(clearInterval(v),90):y+10)},500);let _;try{if(n.videos&&Array.isArray(n.videos))console.log("🎬 Procesando secuencia..."),_=await qD(n,s,a);else if(n.file)console.log("🎬 Procesando video individual..."),_=await xS(n.file,s,a);else throw new Error("Formato de video no válido");clearInterval(v),m(100),await new Promise(y=>setTimeout(y,200))}catch(y){throw clearInterval(v),y}if(_.success){const y=_.format==="zip"?"application/zip":`video/${_.format||s}`,A=new Blob([_.data],{type:y});try{const P=await R();if(P){const O=_.format==="zip"?"zip":_.format||s,N=`${n.title||n.name}_${a}.${O}`,I=await(await P.getFileHandle(N,{create:!0})).createWritable();await I.write(A),await I.close(),console.log("✅ Archivo guardado en carpeta seleccionada")}else{const O=URL.createObjectURL(A),N=document.createElement("a");N.href=O;const w=_.format==="zip"?"zip":_.format||s;N.download=`${n.title||n.name}_${a}.${w}`,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(O),console.log("✅ Archivo descargado correctamente")}r&&r(),e()}catch(P){throw console.error("Error al guardar archivo:",P),new Error("Error al guardar el archivo")}}else throw new Error(_.error)}catch(v){console.error("❌ Error al descargar video:",v),alert(`Error al procesar video: ${v.message}`)}finally{d(!1),m(0)}},R=async()=>{try{return"showDirectoryPicker"in window?await window.showDirectoryPicker():(console.log("API de File System Access no disponible, usando descarga normal"),null)}catch(v){return console.log("Usuario canceló la selección de carpeta o error:",v),null}},T=async()=>{if(!n||!n.file){console.error("No hay video para descargar");return}try{const v=await R();if(v){const _=`${n.title||n.name}.mp4`,A=await(await v.getFileHandle(_,{create:!0})).createWritable();await A.write(n.file),await A.close(),console.log("✅ Archivo guardado en carpeta seleccionada")}else{const _=URL.createObjectURL(n.file),y=document.createElement("a");y.href=_,y.download=n.title||"video",document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(_)}e()}catch(v){console.error("Error en descarga directa:",v),alert("Error al descargar el archivo")}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Is,{className:"h-5 w-5 text-blue-600"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:n!=null&&n.videos?"Descargar Secuencia":"Descargar Video"})]}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Cr,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Dh,{className:"h-8 w-8 text-gray-400"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-medium text-gray-800 truncate",children:(n==null?void 0:n.title)||(n==null?void 0:n.name)||"Sin título"}),n!=null&&n.videos?o.jsxs("div",{className:"space-y-1",children:[o.jsxs("p",{className:"text-sm text-gray-500",children:[n.videos.length," videos • Duración aproximada: ",Math.floor(n.videos.length*30/60),":",(n.videos.length*30%60).toString().padStart(2,"0")]}),n.useBPMControl&&n.targetBPM&&o.jsxs("p",{className:"text-sm text-purple-600",children:["BPM ajustado: ",n.targetBPM]}),n.description&&o.jsx("p",{className:"text-sm text-gray-600",children:n.description})]}):o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm text-gray-500",children:n!=null&&n.fileSize?`${(n.fileSize/(1024*1024)).toFixed(2)} MB`:"Tamaño desconocido"}),(n==null?void 0:n.bpm)&&o.jsxs("p",{className:"text-sm text-purple-600",children:["BPM: ",n.bpm]})]})]})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Formato de salida"}),o.jsx("div",{className:"space-y-2",children:g.map(v=>o.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${s===v.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"format",value:v.value,checked:s===v.value,onChange:_=>i(_.target.value),className:"sr-only"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${s===v.value?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:s===v.value&&o.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-800",children:v.label}),o.jsx("div",{className:"text-sm text-gray-500",children:v.description})]})]})]},v.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Resolución"}),o.jsx("div",{className:"space-y-2",children:x.map(v=>o.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${a===v.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:"resolution",value:v.value,checked:a===v.value,onChange:_=>l(_.target.value),className:"sr-only"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${a===v.value?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:a===v.value&&o.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-800",children:v.label}),o.jsx("div",{className:"text-sm text-gray-500",children:v.description})]})]})]},v.value))})]}),u&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[o.jsx("span",{children:"Procesando video..."}),o.jsxs("span",{children:[f,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${f}%`}})})]})]}),o.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[o.jsx("button",{onClick:T,disabled:u,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",children:"Descargar original"}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:e,disabled:u,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",children:"Cancelar"}),o.jsx("button",{onClick:b,disabled:u,className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${u?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:u?"Procesando...":"Descargar"})]})]})]})}):null},Cl=({isOpen:t,onClose:e,onConfirm:n,title:r="Confirmar acción",message:s="¿Estás seguro de que quieres realizar esta acción?",confirmText:i="Confirmar",cancelText:a="Cancelar",type:l="warning"})=>{if(!t)return null;const u=()=>{switch(l){case"danger":return o.jsx(Su,{className:"w-8 h-8 text-red-500"});case"warning":return o.jsx(Su,{className:"w-8 h-8 text-orange-500"});case"info":return o.jsx(Su,{className:"w-8 h-8 text-blue-500"});default:return o.jsx(Su,{className:"w-8 h-8 text-orange-500"})}},d=()=>{switch(l){case"danger":return"bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600";case"warning":return"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600";case"info":return"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600";default:return"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600"}};return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:e}),o.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[u(),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r})]}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Cr,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-6",children:o.jsx("div",{className:"text-gray-600 leading-relaxed whitespace-pre-line",children:s})}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors font-medium",children:a}),o.jsx("button",{onClick:()=>{n(),e()},className:`px-4 py-2 text-white rounded-lg transition-all font-medium ${d()}`,children:i})]})]})]})},Lh="sequences",WD=async t=>{console.log("🔥 Firebase: Creando secuencia..."),console.log("📦 Datos de secuencia:",t);try{const e={...t,createdAt:Dn(),updatedAt:Dn()};console.log("⏰ Secuencia con timestamps:",e);const n=await n4(eo(at,Lh),e);console.log("📄 Documento creado con ID:",n.id);const r={id:n.id,...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return console.log("✅ Secuencia creada exitosamente:",r),r}catch(e){throw console.error("❌ Error al crear secuencia:",e),new Error("No se pudo crear la secuencia")}},GD=async(t,e)=>{try{const n=zt(at,Lh,t),r={...e,updatedAt:Dn()};return await Pa(n,r),{id:t,...e,updatedAt:new Date().toISOString()}}catch(n){throw console.error("Error al actualizar secuencia:",n),new Error("No se pudo actualizar la secuencia")}},KD=async t=>{try{const e=zt(at,Lh,t);return await A1(e),{success:!0}}catch(e){throw console.error("Error al eliminar secuencia:",e),new Error("No se pudo eliminar la secuencia")}},$v=(t,e)=>{console.log("🎬 Firebase: Suscribiéndose a secuencias para estilo:",t);try{const n=ic(eo(at,Lh),Zg("style","==",t),Md("createdAt","desc"));return ep(n,r=>{console.log(`🎬 Firebase: Actualización recibida - ${r.size} secuencias para ${t}`);const s=[];r.forEach(i=>{var u,d,f,m,g,x,b;const a=i.data(),l={id:i.id,...a,createdAt:((f=(d=(u=a.createdAt)==null?void 0:u.toDate)==null?void 0:d.call(u))==null?void 0:f.toISOString())||a.createdAt,updatedAt:((x=(g=(m=a.updatedAt)==null?void 0:m.toDate)==null?void 0:g.call(m))==null?void 0:x.toISOString())||a.updatedAt};s.push(l),console.log(`📋 Secuencia cargada: ${l.name} (${((b=l.videos)==null?void 0:b.length)||0} videos)`)}),console.log(`🎉 Total de secuencias cargadas: ${s.length}`),e(s)})}catch(n){throw console.error("❌ Error al suscribirse a secuencias por estilo:",n),new Error("No se pudo suscribir a las secuencias")}},QD=t=>{const[e,n]=S.useState(null),[r,s]=S.useState(null),i=S.useCallback(g=>{n(g)},[]),a=S.useCallback((g,x)=>{g.preventDefault(),s(x)},[]),l=S.useCallback((g,x)=>{g.preventDefault(),s(x)},[]),u=S.useCallback(g=>{g.preventDefault(),s(null)},[]),d=S.useCallback((g,x)=>{g.preventDefault(),e!==null&&e!==x&&t(e,x),n(null),s(null)},[e,t]),f=S.useCallback(()=>{n(null),s(null)},[]),m=S.useCallback(g=>{const x={cursor:"grab",transition:"all 0.2s ease",transform:"scale(1)",opacity:1};return e===g&&(x.cursor="grabbing",x.transform="scale(1.05) rotate(2deg)",x.opacity=.7,x.zIndex=1e3),r===g&&e!==g&&(x.transform="scale(1.02)",x.borderLeft="4px solid #3b82f6",x.backgroundColor="#f0f9ff"),x},[e,r]);return{draggedIndex:e,dragOverIndex:r,handleDragStart:i,handleDragOver:a,handleDragEnter:l,handleDragLeave:u,handleDrop:d,handleDragEnd:f,getDragStyles:m}},ap=({videos:t,currentBPM:e=null,className:n="",showControls:r=!0,autoplay:s=!1,loop:i=!1,muted:a=!1})=>{const[l,u]=S.useState(0),[d,f]=S.useState(!1),[m,g]=S.useState(a),[x,b]=S.useState(!1),[R,T]=S.useState(r),[v,_]=S.useState(0),[y,A]=S.useState(0),[P,O]=S.useState(1),[N,w]=S.useState(1),[I,k]=S.useState(!1),[D,L]=S.useState(null),[j,ce]=S.useState(!1),[H,me]=S.useState(0),[ue,G]=S.useState(0),[B,ae]=S.useState(!1),[we,q]=S.useState(!1),[Y,ie]=S.useState(!1),[_e,ve]=S.useState(0),[Se,Qe]=S.useState(0),[V,le]=S.useState(null),[oe,be]=S.useState(!1),[pe,Ae]=S.useState(1),[Le,Xe]=S.useState(!0),he=S.useRef(null),Oe=S.useRef(null),Ke=t[l],qe=[.25,.5,.75,1,1.25,1.5,2];S.useEffect(()=>{O(1),he.current&&(he.current.playbackRate=1)},[l]),S.useEffect(()=>{if(he.current&&B&&d&&we&&Y){const re=he.current,Te=()=>{re.currentTime>=ue&&(re.currentTime=H)};return re.addEventListener("timeupdate",Te),()=>re.removeEventListener("timeupdate",Te)}},[B,H,ue,d,we,Y]),S.useEffect(()=>{if(r&&d){V&&clearTimeout(V);const re=setTimeout(()=>{T(!1)},4e3);le(re)}return()=>{V&&clearTimeout(V)}},[d,r]),S.useEffect(()=>()=>{V&&clearTimeout(V),D&&clearTimeout(D)},[]),S.useEffect(()=>{const re=Te=>{oe&&be(!1)};return document.addEventListener("click",re),()=>document.removeEventListener("click",re)},[oe]);const Mt=()=>{T(!0),V&&clearTimeout(V)},Nt=()=>{j&&!B?he.current&&(he.current.currentTime=0,he.current.play()):B&&we&&Y?he.current&&(he.current.currentTime=H,he.current.play()):f(!1)},Tt=()=>{he.current&&_(he.current.currentTime)},it=()=>{he.current&&(A(he.current.duration),he.current.playbackRate=pe,O(pe))},vt=()=>{he.current&&(d?he.current.pause():he.current.play(),f(!d))},Me=()=>{l>0&&(u(re=>re-1),_(0),he.current&&(he.current.currentTime=0))},je=()=>{l<t.length-1&&(u(re=>re+1),_(0),he.current&&(he.current.currentTime=0))},gt=re=>{if(he.current){const Te=Math.max(0,Math.min(y,v+re));he.current.currentTime=Te,_(Te)}},Bn=()=>{if(he.current){const re=!m;he.current.muted=re,g(re),re?he.current.volume=0:he.current.volume=N}},Qt=re=>{const Te=parseFloat(re.target.value);he.current&&(he.current.volume=Te,w(Te),Te===0?(he.current.muted=!0,g(!0)):(he.current.muted=!1,g(!1)))},Z=()=>{try{document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),b(!1)):(Oe.current.requestFullscreen?Oe.current.requestFullscreen():Oe.current.webkitRequestFullscreen?Oe.current.webkitRequestFullscreen():Oe.current.msRequestFullscreen&&Oe.current.msRequestFullscreen(),b(!0))}catch(re){console.error("Error toggling fullscreen:",re)}},Bt=re=>{if(he.current){const Te=re.currentTarget.getBoundingClientRect(),$=(re.clientX-Te.left)/Te.width*y;he.current.currentTime=$,_($)}},bn=re=>{re==="start"?we?(q(!1),me(0),console.log("Punto A eliminado")):(q(!0),me(v),ve(v),console.log(`Punto A establecido en: ${He(v)}`)):Y?(ie(!1),G(0),console.log("Punto B eliminado")):(ie(!0),G(v),Qe(v),console.log(`Punto B establecido en: ${He(v)}`))},He=re=>{const Te=Math.floor(re/60),En=Math.floor(re%60);return`${Te}:${En.toString().padStart(2,"0")}`},an=re=>{Ae(re),he.current&&(he.current.playbackRate=re,O(re)),be(!1)},nr=re=>re===1?"Normal":`${re}x`,Rr=async()=>{try{if(console.log("Iniciando descarga de video:",Ke.title),Ke.videoUrl&&(Ke.videoUrl.includes("firebase")||Ke.videoUrl.includes("googleapis"))){console.log("Detectada URL de Firebase Storage, descargando...");const re=await fetch(Ke.videoUrl);if(!re.ok)throw new Error(`HTTP error! status: ${re.status}`);const Te=await re.blob();console.log("Blob descargado:",Te.size,"bytes");const En=URL.createObjectURL(Te),wt=document.createElement("a");wt.href=En,wt.download=Ke.title||"video.mp4",wt.style.display="none",document.body.appendChild(wt),wt.click(),document.body.removeChild(wt),setTimeout(()=>{URL.revokeObjectURL(En)},1e3),console.log("Descarga completada exitosamente")}else{console.log("Usando método de descarga directa para URL no-Firebase");const re=document.createElement("a");re.href=Ke.videoUrl,re.download=Ke.title||"video.mp4",re.style.display="none",document.body.appendChild(re),re.click(),document.body.removeChild(re)}}catch(re){console.error("Error en descarga:",re),alert(`Error al descargar el video: ${re.message}`)}};return S.useEffect(()=>{const re=Te=>{if(Te.target.tagName!=="INPUT")switch(Te.code){case"Space":Te.preventDefault(),vt();break;case"KeyF":Te.preventDefault(),Z();break;case"KeyM":Te.preventDefault(),Bn();break;case"ArrowLeft":Te.preventDefault(),Te.ctrlKey||Te.metaKey?Me():gt(-10);break;case"ArrowRight":Te.preventDefault(),Te.ctrlKey||Te.metaKey?je():gt(10);break;case"KeyA":Te.preventDefault(),bn("start");break;case"KeyB":Te.preventDefault(),bn("end");break;case"KeyL":Te.preventDefault(),ce(!j);break;case"KeyS":Te.preventDefault();const wt=(qe.indexOf(pe)+1)%qe.length;an(qe[wt]);break}};return document.addEventListener("keydown",re),()=>document.removeEventListener("keydown",re)},[v,y,l,j,pe]),Ke?o.jsxs("div",{ref:Oe,className:`relative bg-black rounded-lg overflow-hidden ${n}`,onMouseEnter:Mt,onMouseLeave:()=>{if(d){const re=setTimeout(()=>{T(!1)},4e3);le(re)}},onTouchStart:Mt,onTouchMove:Mt,children:[o.jsx("video",{ref:he,src:Ke.videoUrl,className:"w-full h-full object-contain cursor-pointer",onEnded:Nt,onTimeUpdate:Tt,onLoadedMetadata:it,onPlay:()=>f(!0),onPause:()=>f(!1),muted:m,autoPlay:s,loop:!1,onClick:Mt}),o.jsxs("div",{className:"absolute top-2 left-2 bg-black bg-opacity-75 text-white px-3 py-2 rounded-lg text-sm",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("span",{className:"font-medium",children:[l+1," / ",t.length]}),o.jsx("span",{className:"text-gray-300",children:"|"}),o.jsx("span",{className:"max-w-xs truncate",children:Ke.title}),P!==1&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-gray-300",children:"|"}),o.jsxs("span",{className:"text-blue-400 font-medium",children:[P.toFixed(2),"x"]})]})]}),t.length>1&&o.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Usa Ctrl+←/→ para cambiar de video"})]}),R&&o.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent flex flex-col justify-end",children:[o.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-end items-center",children:o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("button",{onClick:Z,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:x?o.jsx(fS,{className:"w-4 h-4"}):o.jsx(hS,{className:"w-4 h-4"})})})}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:Me,disabled:l===0,className:`p-2 rounded-full transition-colors z-10 ${l===0?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-black/60 text-white hover:bg-black/80"}`,title:"Video anterior (Ctrl+←)",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-current flex items-center justify-center",children:o.jsx(sp,{className:"w-1.5 h-1.5"})}),o.jsx("span",{className:"text-xs font-medium",children:"Anterior"})]})}),o.jsx("button",{onClick:()=>gt(-10),className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",title:"Retroceder 10s (←)",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:o.jsx(sp,{className:"w-3 h-3"})}),o.jsx("span",{className:"text-sm font-medium",children:"10"})]})}),o.jsx("button",{onClick:vt,className:"p-4 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Play/Pause (Espacio)",children:d?o.jsx(mS,{className:"w-8 h-8"}):o.jsx(kr,{className:"w-8 h-8"})}),o.jsx("button",{onClick:()=>gt(10),className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",title:"Adelantar 10s (→)",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{className:"text-sm font-medium",children:"10"}),o.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:o.jsx(ip,{className:"w-3 h-3"})})]})}),o.jsx("button",{onClick:je,disabled:l===t.length-1,className:`p-2 rounded-full transition-colors z-10 ${l===t.length-1?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-black/60 text-white hover:bg-black/80"}`,title:"Siguiente video (Ctrl+→)",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{className:"text-xs font-medium",children:"Siguiente"}),o.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-current flex items-center justify-center",children:o.jsx(ip,{className:"w-1.5 h-1.5"})})]})})]})}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[o.jsxs("div",{className:"flex justify-end mb-2 space-x-2",children:[o.jsx("button",{onClick:()=>ce(!j),className:`p-2 rounded-full transition-colors z-10 ${j?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Bucle",children:o.jsx(pS,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>{const re=!B;ae(re),re?(_e>0&&(q(!0),me(_e)),Se>0&&(ie(!0),G(Se))):(q(!1),ie(!1),me(0),G(0))},className:`p-2 rounded-full transition-colors z-10 ${B?"bg-green-500 text-white":"bg-white/20 text-white hover:bg-white/30"}`,title:"Segmento A-B",children:o.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:"A-B"})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>be(!oe),className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Velocidad de reproducción",children:o.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:pe===1?"1x":`${pe}x`})}),oe&&o.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",children:qe.map(re=>o.jsx("button",{onClick:()=>an(re),className:`w-full text-left px-3 py-1 rounded text-xs transition-colors ${pe===re?"bg-blue-500 text-white":"text-white hover:bg-white/20"}`,children:nr(re)},re))})]}),o.jsx("button",{onClick:Rr,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Descargar video",children:o.jsx(Is,{className:"w-4 h-4"})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:Bn,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",onMouseEnter:()=>k(!0),onMouseLeave:()=>{const re=setTimeout(()=>k(!1),1e3);L(re)},children:m?o.jsx(yS,{className:"w-4 h-4"}):o.jsx(gS,{className:"w-4 h-4"})}),I&&o.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/80 rounded-lg p-3 z-20",onMouseEnter:()=>{D&&(clearTimeout(D),L(null))},onMouseLeave:()=>{const re=setTimeout(()=>k(!1),1e3);L(re)},children:o.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:N,onChange:Qt,className:"w-2 h-20 bg-gray-600 rounded-lg appearance-none cursor-pointer slider-vertical",style:{background:`linear-gradient(to top, #3b82f6 0%, #3b82f6 ${N*100}%, #4b5563 ${N*100}%, #4b5563 100%)`},orient:"vertical"}),o.jsxs("span",{className:"text-white text-xs",children:[Math.round(N*100),"%"]})]})})]})]}),o.jsx("div",{className:"relative mb-4",children:o.jsxs("div",{className:"w-full h-2 bg-white/20 rounded-full cursor-pointer relative",onClick:Bt,children:[o.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${v/y*100}%`}}),B&&we&&o.jsx("div",{className:"absolute top-0 w-1 h-full bg-green-500 z-10",style:{left:`${H/y*100}%`}}),B&&Y&&o.jsx("div",{className:"absolute top-0 w-1 h-full bg-red-500 z-10",style:{left:`${ue/y*100}%`}})]})}),o.jsxs("div",{className:"flex items-center justify-between text-white text-sm",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("span",{children:[He(v)," / ",He(y)]}),P!==1&&o.jsxs("span",{className:"text-blue-400 font-medium",children:[P.toFixed(2),"x"]}),B&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{onClick:()=>bn("start"),className:`px-2 py-1 rounded text-xs transition-colors ${we?"bg-green-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["A: ",we?He(H):"--:--"]}),o.jsxs("button",{onClick:()=>bn("end"),className:`px-2 py-1 rounded text-xs transition-colors ${Y?"bg-red-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"}`,children:["B: ",Y?He(ue):"--:--"]})]})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("div",{className:"text-xs opacity-75",children:j&&(B&&we&&Y?"Bucle A-B":"Bucle completo")})})]}),t.length>1&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-300 mb-1",children:[o.jsx("span",{children:"Progreso de la secuencia"}),o.jsxs("span",{children:[l+1," de ",t.length]})]}),o.jsx("div",{className:"w-full h-1 bg-gray-600 rounded-full",children:o.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300",style:{width:`${(l+1)/t.length*100}%`}})})]})]})]})]}):o.jsx("div",{className:`bg-black rounded-lg flex items-center justify-center ${n}`,children:o.jsx("div",{className:"text-white text-center",children:o.jsx("p",{children:"No hay videos en la secuencia"})})})};class XD{constructor(){this.isLoaded=!0}async load(){return Promise.resolve()}async combineVideos(e,n){try{console.log("Iniciando combinación con MediaRecorder optimizado..."),n&&n({stage:"init",current:0,total:100,message:"Iniciando MediaRecorder..."});const r=[];for(let i=0;i<e.length;i++){const a=e[i];console.log(`Descargando video ${i+1}/${e.length}: ${a.title}`),n&&n({stage:"download",current:(i+1)/e.length*50,total:100,message:`Descargando: ${a.title}`});try{const{ref:l,getDownloadURL:u}=await fs(async()=>{const{ref:b,getDownloadURL:R}=await Promise.resolve().then(()=>ac);return{ref:b,getDownloadURL:R}},void 0),{storage:d}=await fs(async()=>{const{storage:b}=await Promise.resolve().then(()=>rS);return{storage:b}},void 0),f=l(d,a.videoPath),m=await u(f);console.log(`URL de descarga obtenida para ${a.title}:`,m);const g=await fetch(m);if(!g.ok)throw new Error(`Error descargando video: ${g.statusText}`);const x=await g.blob();r.push(x),console.log(`Video ${i+1} descargado: ${a.title}`)}catch(l){throw console.error(`Error con video ${a.title}:`,l),new Error(`Error procesando video ${a.title}: ${l.message}`)}}n&&n({stage:"combine",current:50,total:100,message:"Combinando videos..."});const s=await this.combineVideoBlobs(r);return n&&n({stage:"complete",current:100,total:100,message:"¡Combinación completada!"}),console.log("Combinación completada, archivo creado"),s}catch(r){throw console.error("Error combinando videos:",r),new Error(`Error combinando videos: ${r.message}`)}}async combineVideoBlobs(e){return new Promise((n,r)=>{try{const s=document.createElement("canvas"),i=s.getContext("2d");s.width=1920,s.height=1080;const a=s.captureStream(60),l=new MediaRecorder(a,{mimeType:"video/webm;codecs=vp9",videoBitsPerSecond:3e7}),u=[];l.ondataavailable=m=>{m.data.size>0&&u.push(m.data)},l.onstop=()=>{const m=new Blob(u,{type:"video/webm"});n(m)},l.onerror=m=>{r(m)},l.start();let d=0;const f=()=>{if(d>=e.length){l.stop();return}const m=e[d],g=URL.createObjectURL(m),x=document.createElement("video");x.onloadedmetadata=()=>{x.currentTime=0,x.muted=!1,x.volume=1,x.play()},x.ontimeupdate=()=>{i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.clearRect(0,0,s.width,s.height);const b=x.videoWidth/x.videoHeight,R=s.width/s.height;let T,v,_,y;b>R?(T=s.width,v=s.width/b,_=0,y=(s.height-v)/2):(v=s.height,T=s.height*b,_=(s.width-T)/2,y=0),i.drawImage(x,_,y,T,v)},x.onplay=()=>{const b=()=>{if(!x.paused&&!x.ended){i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.clearRect(0,0,s.width,s.height);const R=x.videoWidth/x.videoHeight,T=s.width/s.height;let v,_,y,A;R>T?(v=s.width,_=s.width/R,y=0,A=(s.height-_)/2):(_=s.height,v=s.height*R,y=(s.width-v)/2,A=0),i.drawImage(x,y,A,v,_),requestAnimationFrame(b)}};requestAnimationFrame(b)},x.onended=()=>{URL.revokeObjectURL(g),d++,setTimeout(f,100)},x.src=g};f()}catch(s){r(s)}})}async combineVideosSimple(e,n){return this.combineVideos(e,n)}async cleanup(e){try{console.log("Limpiando archivos temporales...");for(const n of e)await this.ffmpeg.deleteFile(n);await this.ffmpeg.deleteFile("filelist.txt"),await this.ffmpeg.deleteFile("output.mp4"),console.log("Archivos temporales eliminados")}catch(n){console.warn("Error limpiando archivos temporales:",n)}}async getVideoInfo(e){try{const r=await(await fetch(e)).blob();return{size:r.size,type:r.type,duration:null}}catch(n){return console.error("Error obteniendo información del video:",n),null}}}const YD=({isOpen:t,onClose:e,videos:n,sequenceName:r="Secuencia"})=>{const[s,i]=S.useState(null),[a,l]=S.useState(!1),[u,d]=S.useState(null),[f,m]=S.useState(null),[g,x]=S.useState("fast"),b=new XD;S.useEffect(()=>{t&&(i(null),d(null),m(null),l(!1))},[t]);const R=async()=>{if(!n||n.length===0){d("No hay videos para combinar");return}l(!0),d(null),i({stage:"init",current:0,total:100,message:"Iniciando FFmpeg.wasm..."});try{console.log("Iniciando combinación con FFmpeg.wasm...");const P=await b.combineVideos(n,i),O=URL.createObjectURL(P);m(O),i({stage:"complete",current:100,total:100,message:"¡Videos combinados exitosamente!"})}catch(P){console.error("Error en descarga:",P),d(`Error combinando videos: ${P.message}`),i(null)}finally{l(!1)}},T=()=>{if(f){const P=document.createElement("a");P.href=f,P.download=`${r}.webm`,document.body.appendChild(P),P.click(),document.body.removeChild(P)}},v=()=>u?"text-red-500":(s==null?void 0:s.stage)==="complete"?"text-green-500":"text-blue-500",_=()=>u?o.jsx(Ts,{className:"h-5 w-5"}):(s==null?void 0:s.stage)==="complete"?o.jsx(yi,{className:"h-5 w-5"}):o.jsx(hD,{className:"h-5 w-5 animate-spin"}),y=()=>u?"bg-red-500":(s==null?void 0:s.stage)==="complete"?"bg-green-500":"bg-blue-500",A=()=>{switch(s==null?void 0:s.stage){case"init":return"Inicializando FFmpeg.wasm...";case"download":return"Descargando videos...";case"combine":return"Combinando videos con FFmpeg...";case"finalize":return"Finalizando archivo...";case"complete":return"¡Proceso completado!";default:return"Preparando..."}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Descargar Secuencia"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:a,children:o.jsx(Cr,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsxs("strong",{children:[(n==null?void 0:n.length)||0," videos"]})," serán combinados en uno solo"]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Duración total: ",n==null?void 0:n.reduce((P,O)=>P+(O.duration||0),0).toFixed(1),"s",(n==null?void 0:n.some(P=>!P.duration))&&" (calculando...)"]}),o.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Formato: WebM (calidad optimizada con MediaRecorder)"})]}),s&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[_(),o.jsx("span",{className:`text-sm font-medium ${v()}`,children:s.message})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${y()}`,style:{width:`${s.current}%`}})}),o.jsx("p",{className:"text-xs text-gray-500",children:A()})]}),u&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ts,{className:"h-5 w-5 text-red-500"}),o.jsx("span",{className:"text-sm text-red-700",children:u})]})}),f&&o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(yi,{className:"h-5 w-5 text-green-500"}),o.jsx("span",{className:"text-sm text-green-700",children:"¡Videos combinados exitosamente!"})]})})]}),o.jsxs("div",{className:"flex space-x-3 mt-6",children:[!a&&!f&&o.jsxs("button",{onClick:R,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[o.jsx(Is,{className:"h-4 w-4"}),o.jsx("span",{children:"Combinar Videos"})]}),f&&o.jsxs("button",{onClick:T,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[o.jsx(Is,{className:"h-4 w-4"}),o.jsx("span",{children:"Descargar WebM"})]}),o.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:a,children:f?"Cerrar":"Cancelar"})]})]})}):null},JD=({isOpen:t,onClose:e,videos:n,onSaveSequence:r,onToggleShowAll:s,showAllVideos:i,style:a="salsa",isIntegrated:l=!1,onToggleBuilder:u})=>{const{categoriesList:d,getColorClasses:f}=Uc("figuras",a),{user:m}=gr(),[g,x]=S.useState(null),[b,R]=S.useState(!1),[T,v]=S.useState(!1),[_,y]=S.useState(null),[A,P]=S.useState(null),[O,N]=S.useState(null),[w,I]=S.useState({}),[k,D]=S.useState(!0),[L,j]=S.useState(!1),[ce,H]=S.useState(null),me=$=>{if(console.log("🏷️ getOrderedTags - video:",$.title,"tags:",$.tags),!$.tags||Object.keys($.tags).length===0)return console.log("❌ No hay tags en el video"),[];const ne=[];return d.forEach(te=>{const X=$.tags[te.key];Array.isArray(X)&&(console.log(`📋 Categoría ${te.key}:`,X),X.forEach(Ye=>{ne.push({tag:Ye,categoryKey:te.key,color:te.color})}))}),console.log("✅ Tags ordenados:",ne),ne},ue=$=>{if(console.log("🏷️ getOrderedTagsIniciales - video:",$.title,"tagsIniciales:",$.tagsIniciales),!$.tagsIniciales||Object.keys($.tagsIniciales).length===0)return console.log("❌ No hay tagsIniciales en el video"),[];const ne=[];return d.forEach(te=>{const X=$.tagsIniciales[te.key];Array.isArray(X)&&(console.log(`📋 Categoría inicial ${te.key}:`,X),X.forEach(Ye=>{ne.push({tag:Ye,categoryKey:te.key,color:te.color,type:"inicial"})}))}),console.log("✅ Tags iniciales ordenados:",ne),ne},G=$=>{if(console.log("🏷️ getOrderedTagsFinales - video:",$.title,"tagsFinales:",$.tagsFinales),!$.tagsFinales||Object.keys($.tagsFinales).length===0)return console.log("❌ No hay tagsFinales en el video"),[];const ne=[];return d.forEach(te=>{const X=$.tagsFinales[te.key];Array.isArray(X)&&(console.log(`📋 Categoría final ${te.key}:`,X),X.forEach(Ye=>{ne.push({tag:Ye,categoryKey:te.key,color:te.color,type:"final"})}))}),console.log("✅ Tags finales ordenados:",ne),ne},{sequence:B,sequenceName:ae,sequenceDescription:we,editingSequenceId:q,addVideoToSequence:Y,removeVideoFromSequence:ie,reorderSequence:_e,generateRandomSequence:ve,clearSequence:Se,setSequenceName:Qe,setSequenceDescription:V,isVideoCompatible:le,isVideoInSequence:oe,toggleBuilder:be,checkCompatibility:pe}=oS();S.useEffect(()=>{const $=B.filter(ne=>ne.bpm);if($.length>0){const ne=$.map(X=>X.bpm),te=ne.reduce((X,Ye)=>X+Ye,0)/ne.length;H(Math.round(te))}else H(null)},[B]);const{handleDragStart:Ae,handleDragOver:Le,handleDragEnter:Xe,handleDragLeave:he,handleDrop:Oe,handleDragEnd:Ke,getDragStyles:qe}=QD(_e),[Mt,Nt]=S.useState([]),[Tt,it]=S.useState({isOpen:!1,type:null}),[vt,Me]=S.useState(5),je=($,ne="success")=>{const te=Date.now();Nt(X=>[...X,{id:te,message:$,type:ne}])},gt=$=>{Nt(ne=>ne.filter(te=>te.id!==$))},Bn=async $=>{if(!m){je("Debes iniciar sesión para dar like","error");return}try{const ne=await np($.id,m.uid);ne.success?je(`Has ${ne.userLiked?"dado like a":"quitado like de"} "${$.title}"`,"success"):je("Error al actualizar like","error")}catch(ne){console.error("Error al manejar like:",ne),je("Error al actualizar like","error")}},Qt=()=>{const $=vt-B.length;if($<=0){je("La secuencia ya tiene suficientes videos","info");return}if(B.length>0){const ne=B[B.length-1],te=n.filter(X=>!B.some(Ye=>Ye.id===X.id)&&pe(ne,X));if(te.length===0){je("No hay videos compatibles disponibles para continuar la secuencia","warning");return}if(te.length<$){je(`Solo hay ${te.length} videos compatibles disponibles de los ${$} necesarios`,"info"),ve(n,B.length+te.length),je(`Secuencia completada con ${te.length} videos adicionales`);return}}ve(n,vt),je(`Secuencia completada hasta ${vt} videos`)},Z=async()=>{if(console.log("💾 Intentando guardar secuencia..."),console.log("📝 Nombre:",ae),console.log("📋 Videos en secuencia:",B.length),console.log("🎨 Estilo:",a),console.log("🔄 Editando secuencia ID:",q),!ae.trim()){je("Por favor, añade un nombre a la secuencia","error");return}if(B.length===0){je("La secuencia debe tener al menos un video","error");return}try{const $=await wt(),ne={name:ae,description:we,videos:B,style:a,tags:w,thumbnailUrl:$,resolution:B.length>0?B[0].resolution:"HD",createdAt:new Date().toISOString()};q?(ne.id=q,console.log("🔄 Guardando como EDICIÓN de secuencia existente:",q)):console.log("🆕 Guardando como NUEVA secuencia"),console.log("📦 Datos de secuencia a guardar:",ne),await r(ne),je(q?"✅ Secuencia actualizada exitosamente":'✅ Secuencia guardada exitosamente. Ve a "GALERÍA DE SECUENCIAS" para verla.'),Se(),u&&u()}catch($){console.error("❌ Error al guardar secuencia:",$),je("Error al guardar la secuencia","error")}},Bt=()=>{B.length>0||ae.trim()||we.trim()?it({isOpen:!0,type:"cancel"}):u&&u()},bn=()=>{it({isOpen:!0,type:"clear"})},He=()=>{Tt.type==="cancel"?(Se(),u&&u()):Tt.type==="clear"&&Se(),it({isOpen:!1,type:null})};S.useEffect(()=>{const $=setTimeout(()=>{Rr()},500);return()=>clearTimeout($)},[B]),S.useEffect(()=>()=>{_&&URL.revokeObjectURL(_)},[_]);const an=$=>{if(!$||!$.resolution)return["auto","360p","480p","720p","1080p"];const ne=$.resolution.toLowerCase(),te=["auto"];return ne.includes("4k")||ne.includes("2160p")?te.push("360p","480p","720p","1080p","4k"):ne.includes("1080p")||ne.includes("1920")?te.push("360p","480p","720p","1080p"):ne.includes("720p")||ne.includes("1280")?te.push("360p","480p","720p"):ne.includes("480p")||ne.includes("854")?te.push("360p","480p"):te.push("360p"),te},nr=$=>{console.log("🎬 Reproduciendo video individual:",$.title),x($),R(!0),je(`🎬 Reproduciendo: ${$.title}`,"info")},Rr=async()=>{if(!B||B.length===0){y(null),P(null);return}const $=JSON.stringify({videos:B.map(ne=>ne.id),sequenceLength:B.length});if(!(O===$&&_)){v(!0),P(null);try{if(console.log("🎬 Generando preview en tiempo real..."),B.filter(te=>te.videoUrl).length===0)throw new Error("No hay videos válidos en la secuencia");y("sequence-timeline"),N($),console.log("✅ Preview en tiempo real generado (modo timeline)")}catch(ne){console.error("❌ Error al generar preview en tiempo real:",ne),P(ne.message)}finally{v(!1)}}},re=($,ne)=>{I(te=>{const X=te[$]||[];if(X.includes(ne)){const ln=X.filter(qt=>qt!==ne);if(ln.length===0){const{[$]:qt,...Pr}=te;return Pr}else return{...te,[$]:ln}}else return{...te,[$]:[...X,ne]}})},Te=($,ne)=>{var te;return((te=w[$])==null?void 0:te.includes(ne))||!1},En=()=>{const $=[];return d.forEach(ne=>{const te=w[ne.key];Array.isArray(te)&&te.forEach(X=>{$.push({tag:X,categoryKey:ne.key,color:ne.color})})}),$},wt=async()=>{if(B.length===0)return null;try{const $=B[0];if($.thumbnailUrl)return $.thumbnailUrl;const{getStorage:ne,ref:te,getDownloadURL:X}=await fs(async()=>{const{getStorage:Pr,ref:It,getDownloadURL:Rs}=await Promise.resolve().then(()=>ac);return{getStorage:Pr,ref:It,getDownloadURL:Rs}},void 0),Ye=ne(),ln=te(Ye,$.videoUrl);return await X(ln)}catch($){return console.error("Error al generar thumbnail:",$),null}};return t?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Constructor de Secuencias"}),o.jsxs("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:[B.length," videos"]})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(Cr,{className:"w-5 h-5"})})})]}),o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{className:"md:col-span-2 space-y-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("input",{type:"text",placeholder:"Nombre de la secuencia...",value:ae,onChange:$=>Qe($.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),!ae.trim()&&B.length>0&&o.jsx("p",{className:"text-xs text-orange-600",children:"⚠️ Añade un nombre para poder guardar la secuencia"})]}),o.jsx("textarea",{placeholder:"Descripción (opcional)...",value:we,onChange:$=>V($.target.value),rows:"2",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),o.jsxs("div",{className:"flex flex-col space-y-3",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Número de videos:"}),o.jsx("input",{type:"number",value:vt,onChange:$=>Me(Math.max(1,parseInt($.target.value)||5)),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center text-sm",placeholder:"5"}),B.length>0&&o.jsx("div",{className:"text-xs text-gray-500 text-center",children:(()=>{const $=B[B.length-1],ne=n.filter(X=>!B.some(Ye=>Ye.id===X.id)&&pe($,X)),te=vt-B.length;return`${ne.length} compatibles disponibles (necesitas ${te})`})()})]}),o.jsxs("button",{onClick:Qt,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors",children:[o.jsx(rp,{className:"w-4 h-4"}),o.jsxs("span",{children:["Completar hasta ",vt]})]}),o.jsxs("button",{onClick:bn,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:[o.jsx(ks,{className:"w-4 h-4"}),o.jsx("span",{children:"Limpiar"})]})]})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[o.jsx(kr,{className:"h-5 w-5 text-blue-600 mr-2"}),"Preview en Tiempo Real"]}),T&&o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),o.jsx("span",{className:"text-gray-600",children:"Generando preview..."})]}),A&&o.jsx("div",{className:"flex items-center justify-center py-8 text-red-600",children:o.jsxs("span",{children:["❌ Error: ",A]})}),!T&&!A&&_&&o.jsx("div",{className:"space-y-4",children:_==="sequence-timeline"?o.jsx(ap,{videos:B,currentBPM:ce,className:"w-full h-96",showControls:!0,autoplay:!1,loop:!1,muted:!1}):o.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:o.jsx(dc,{src:_,className:"w-full h-96 object-contain",showControls:!0,autoplay:!1,loop:!1,muted:!1,size:"medium",videoTitle:"Preview de Secuencia"})})}),!T&&!A&&B.length===0&&o.jsx("div",{className:"flex items-center justify-center py-8 text-gray-500",children:o.jsx("span",{children:"Añade videos a la secuencia para ver el preview"})})]})}),o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:"text-lg font-semibold text-gray-700",children:["Secuencia Actual (",B.length," videos)"]})}),B.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[o.jsx(ro,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"No hay videos en la secuencia"}),o.jsx("p",{className:"text-sm",children:"Selecciona videos de la galería para comenzar"})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:B.map(($,ne)=>o.jsxs("div",{draggable:!0,onDragStart:()=>Ae(ne),onDragOver:te=>Le(te,ne),onDragEnter:te=>Xe(te,ne),onDragLeave:he,onDrop:te=>Oe(te,ne),onDragEnd:Ke,style:qe(ne),className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] relative",children:[o.jsxs("div",{className:"absolute top-2 left-2 z-10 flex items-center space-x-2",children:[o.jsxs("div",{className:"bg-purple-500 text-white px-2 py-1 rounded-full text-sm font-bold shadow-lg",children:["#",ne+1]}),o.jsx("button",{onClick:()=>ie(ne),className:"bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition-colors shadow-lg",title:"Eliminar de la secuencia",children:o.jsx(ks,{className:"w-3 h-3"})})]}),o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsx(lD,{className:"w-5 h-5 text-gray-400 cursor-grab hover:text-gray-600 transition-colors"})}),o.jsx("div",{className:"relative group",children:o.jsxs("div",{className:"w-full aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center",children:[$.thumbnailUrl&&$.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?o.jsx("img",{src:$.thumbnailUrl,alt:$.title,className:"w-full h-full object-cover",loading:"lazy",onError:te=>{te.target.style.display="none",te.target.nextSibling.style.display="flex"}}):null,o.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${$.thumbnailUrl&&$.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?"hidden":"flex"}`,children:[o.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),o.jsx("span",{className:"text-sm font-medium",children:$.title})]}),o.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:$.resolution&&$.resolution!=="Unknown"?$.resolution:"HD"}),o.jsx("button",{onClick:()=>nr($),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:o.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M8 5v14l11-7z"})})})]})}),o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-semibold text-gray-800 text-lg truncate",children:$.title}),o.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(te=>{const X=($.rating||0)>=te;return o.jsx("svg",{className:`h-4 w-4 ${X?"text-yellow-400 fill-current":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},te)}),o.jsxs("span",{className:"text-xs font-medium text-gray-500 ml-1",children:["(",$.rating||0,")"]})]})]}),o.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:$.description||"Sin descripción"}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const te=me($);return te.length>0?te.map(({tag:X,categoryKey:Ye,color:ln})=>o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(ln)}`,children:X},`${Ye}-${X}`)):o.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),(()=>{const te=ue($);return te.length>0?o.jsxs("div",{className:"mb-3",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-2",children:o.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:"Iniciales:"})}),o.jsx("div",{className:"flex flex-wrap gap-2",children:te.map(({tag:X,categoryKey:Ye,color:ln})=>o.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-sm",children:X},`inicial-${Ye}-${X}`))})]}):null})(),(()=>{const te=G($);return te.length>0?o.jsxs("div",{className:"mb-3",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-2",children:o.jsx("span",{className:"text-xs font-medium text-green-600 uppercase tracking-wide",children:"Finales:"})}),o.jsx("div",{className:"flex flex-wrap gap-2",children:te.map(({tag:X,categoryKey:Ye,color:ln})=>o.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-sm",children:X},`final-${Ye}-${X}`))})]}):null})(),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-2 border-t border-gray-100",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("span",{className:"font-medium",children:[($.fileSize/(1024*1024)).toFixed(2)," MB"]}),o.jsx("span",{className:"text-gray-400",children:"•"}),o.jsx("span",{className:"text-gray-600",children:$.resolution&&$.resolution!=="Unknown"?$.resolution:"HD"}),o.jsx("span",{className:"text-gray-400",children:"•"}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(dr,{className:"h-3 w-3 text-purple-500"}),o.jsxs("span",{className:"font-medium text-purple-600",children:[$.bpm||"N/A"," BPM"]})]})]}),o.jsxs("button",{onClick:()=>Bn($),className:`flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 ${$.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"}`,title:$.userLiked?"Quitar like":"Dar like",children:[o.jsx(ys,{className:`h-4 w-4 ${$.userLiked?"fill-current":""}`}),o.jsx("span",{className:"font-medium",children:$.likes||0})]})]})]})]},`${$.id}-${ne}`))})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 border border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("svg",{className:"h-5 w-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Tags de Secuencia"})]}),o.jsx("button",{onClick:()=>D(!k),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",title:k?"Expandir tags":"Colapsar tags",children:o.jsx("svg",{className:`w-4 h-4 transform transition-transform ${k?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(()=>{const $=En();return $.length>0?o.jsx("div",{className:"mb-3",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:$.map(({tag:ne,categoryKey:te,color:X})=>o.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${f(X)} flex items-center space-x-1`,children:[o.jsx("span",{children:ne}),o.jsx("button",{onClick:()=>re(te,ne),className:"ml-1 hover:bg-black hover:bg-opacity-20 rounded-full p-0.5",children:o.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},`${te}-${ne}`))})}):null})(),o.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${k?"max-h-0 opacity-0":"max-h-96 opacity-100"}`,children:o.jsx("div",{className:"space-y-4",children:d.map($=>o.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[o.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center space-x-2",children:[o.jsx("span",{className:`w-3 h-3 rounded-full ${f($.color).replace("text-","bg-")}`}),o.jsx("span",{children:$.name})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:$.tags.map(ne=>o.jsx("button",{onClick:()=>re($.key,ne),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${Te($.key,ne)?f($.color):"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:ne},ne))})]},$.key))})})]})}),o.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[o.jsxs("button",{onClick:Z,disabled:B.length===0||!ae.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:[o.jsx(Bd,{className:"w-4 h-4"}),o.jsx("span",{children:q?"Actualizar Secuencia":"Guardar Secuencia"})]}),o.jsx("button",{onClick:Bt,className:"px-6 py-2 border border-gray-300 hover:bg-gray-50 rounded-lg transition-colors",children:"Cancelar"})]})]})]}),b&&g&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-95 flex items-center justify-center z-50 p-4",onClick:()=>R(!1),children:o.jsxs("div",{className:"bg-black rounded-lg overflow-hidden w-full max-w-6xl max-h-[95vh] flex flex-col",onClick:$=>$.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-900",children:[o.jsx("h3",{className:"text-xl font-semibold text-white",children:g.title}),o.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-white text-2xl font-bold p-2 hover:bg-gray-800 rounded transition-colors",children:"×"})]}),o.jsx("div",{className:"flex-1 bg-black flex items-center justify-center p-4",children:o.jsx("div",{className:"w-full h-full flex items-center justify-center",children:o.jsx(dc,{src:g.videoUrl,className:"max-w-full max-h-full object-contain",showControls:!0,autoplay:!1,loop:!1,muted:!1,resolutions:an(g),currentResolution:"auto",videoTitle:g.title,size:"fullscreen"})})})]})}),o.jsx(Cl,{isOpen:Tt.isOpen,onClose:()=>it({isOpen:!1,type:null}),onConfirm:He,title:Tt.type==="cancel"?"¿Cancelar secuencia?":"¿Limpiar secuencia?",message:Tt.type==="cancel"?"¿Estás seguro de que quieres cancelar? Se perderán todos los cambios.":"¿Estás seguro de que quieres limpiar la secuencia actual?",confirmText:"Confirmar",cancelText:"Cancelar"}),Mt.map($=>o.jsx(Fc,{message:$.message,type:$.type,onClose:()=>gt($.id)},$.id)),o.jsx(YD,{isOpen:L,onClose:()=>j(!1),videos:B,sequenceName:ae||"Secuencia"})]}):null},ZD=({src:t,alt:e,className:n="",fallbackSrc:r="/placeholder-video.svg",showPlayIcon:s=!1,...i})=>{const[a,l]=S.useState(!1),[u,d]=S.useState(!0),f=()=>{d(!1),l(!1)},m=()=>{d(!1),l(!0)},g=!t||t===null||t===void 0||t==="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"||t==="https://via.placeholder.com/300x200/1a1a1a/ffffff?text=EVENTO",x=g||a?r:t;return o.jsxs("div",{className:`relative ${n}`,...i,children:[u&&o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 animate-pulse flex items-center justify-center",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-8 h-8 border-3 border-gray-300 border-t-pink-500 rounded-full animate-spin"}),o.jsx("div",{className:"absolute inset-0 w-8 h-8 border-3 border-transparent border-t-pink-300 rounded-full animate-spin",style:{animationDelay:"-0.5s"}})]})}),o.jsx("img",{src:x,alt:e,className:`w-full h-full object-cover transition-all duration-300 ${u?"opacity-0 scale-95":"opacity-100 scale-100"}`,onLoad:f,onError:m,loading:"lazy",decoding:"async",fetchPriority:"high"}),s&&!u&&o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center",children:o.jsx("div",{className:"w-8 h-8 bg-white bg-opacity-90 rounded-full flex items-center justify-center",children:o.jsx(kr,{className:"w-4 h-4 text-gray-800 fill-current"})})}),(a||g)&&!u&&o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(dS,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Sin miniatura"}),s&&o.jsx("div",{className:"mt-2 w-6 h-6 bg-white bg-opacity-90 rounded-full flex items-center justify-center mx-auto",children:o.jsx(kr,{className:"w-3 h-3 text-gray-600 fill-current"})})]})})]})},eO=({sequences:t,onDeleteSequence:e,onPlaySequence:n,onEditSequence:r,onEditThumbnail:s,onDownloadSequence:i})=>{var y;const[a,l]=S.useState([]),[u,d]=S.useState({isOpen:!1,sequence:null}),{getColorClasses:f}=Uc("figuras","salsa"),{getSequenceConfig:m}=g0(),g=(A,P="success")=>{const O=Date.now();l(N=>[...N,{id:O,message:A,type:P}])},x=A=>{l(P=>P.filter(O=>O.id!==A))},b=A=>{d({isOpen:!0,sequence:A})},R=async()=>{try{await e(u.sequence.id),g("Secuencia eliminada exitosamente")}catch{g("Error al eliminar la secuencia","error")}d({isOpen:!1,sequence:null})},T=A=>{try{n(A),g("Reproduciendo secuencia")}catch{g("Error al reproducir la secuencia","error")}},v=A=>{try{i?(i(A),g("Abriendo opciones de descarga")):g("Funcionalidad de descarga no disponible","warning")}catch{g("Error al abrir descarga","error")}},_=A=>{if(!A.tags||Object.keys(A.tags).length===0)return[];const P=[];return[{key:"dificultad",color:"red"},{key:"estilo",color:"blue"},{key:"nivel",color:"green"},{key:"figura",color:"purple"},{key:"posicion",color:"orange"},{key:"transicion",color:"teal"}].forEach(N=>{const w=A.tags[N.key];Array.isArray(w)&&w.forEach(I=>{P.push({tag:I,categoryKey:N.key,color:N.color})})}),P};return t.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(kr,{className:"w-8 h-8 text-gray-400"})}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay secuencias guardadas"}),o.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primera secuencia usando el constructor de secuencias"}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:[o.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"¿Cómo crear una secuencia?"}),o.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 text-left",children:[o.jsx("li",{children:'1. Haz clic en "CREAR SECUENCIA"'}),o.jsx("li",{children:'2. Añade videos con el botón "+" de la galería'}),o.jsx("li",{children:"3. Escribe un nombre para la secuencia"}),o.jsx("li",{children:'4. Haz clic en "Guardar Secuencia"'}),o.jsx("li",{children:"5. ¡Listo! Aparecerá aquí automáticamente"})]})]})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:`grid gap-6 ${m().grid}`,children:t.map(A=>o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02]",children:[o.jsx("div",{className:"relative group",children:o.jsxs("div",{className:`w-full ${m().aspect} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[A.thumbnailUrl?o.jsx(ZD,{src:A.thumbnailUrl,alt:A.name,className:"w-full h-full object-cover"}):o.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500",children:[o.jsx(kr,{className:"w-12 h-12 mb-2 text-gray-400"}),o.jsx("span",{className:"text-sm font-medium",children:A.name})]}),o.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:A.resolution&&A.resolution!=="Unknown"?A.resolution:"HD"}),o.jsx("button",{onClick:P=>{P.stopPropagation(),s&&s(A)},className:"absolute top-2 right-2 bg-black bg-opacity-75 text-white p-1 rounded hover:bg-opacity-90 transition-colors",title:"Editar thumbnail",children:o.jsx(dS,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>T(A),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:o.jsx(kr,{className:"w-12 h-12 text-white"})})]})}),o.jsxs("div",{className:`${m().compact?"p-2":"p-4"}`,children:[o.jsxs("div",{className:`flex items-center justify-between ${m().compact?"mb-1":"mb-2"}`,children:[o.jsx("h3",{className:`font-semibold text-gray-800 ${m().titleSize} truncate`,children:A.name}),o.jsx("div",{className:"flex items-center space-x-1",children:o.jsxs("span",{className:`bg-blue-100 text-blue-800 px-2 py-1 rounded-full ${m().compact,"text-xs"} font-medium`,children:[A.videos.length," videos"]})})]}),m().showIcons?o.jsx("div",{className:"flex items-center justify-center text-gray-500 mb-2",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(_a,{className:"w-3 h-3"}),o.jsxs("span",{className:"text-xs font-medium",children:[A.videos.length," videos"]})]})}):o.jsx("p",{className:`text-gray-600 text-sm ${m().compact?"mb-2":"mb-3"} ${m().descriptionLines===1?"line-clamp-1":m().descriptionLines===2?"line-clamp-2":m().descriptionLines===3?"line-clamp-3":"line-clamp-4"}`,children:A.description||"Sin descripción"}),m().showTags&&o.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const P=_(A);return P.length>0?P.map(({tag:O,categoryKey:N,color:w})=>o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(w)}`,children:O},`${N}-${O}`)):o.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),m().showStats&&o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-2 border-t border-gray-100",children:[!m().compact&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(_a,{className:"w-4 h-4"}),o.jsxs("span",{className:"font-medium",children:[A.videos.length," videos"]}),o.jsx("span",{className:"text-gray-400",children:"•"}),o.jsx("span",{className:"text-gray-600",children:A.resolution&&A.resolution!=="Unknown"?A.resolution:"HD"})]}),o.jsxs("div",{className:`flex items-center space-x-2 ${m().compact?"w-full justify-center":""}`,children:[o.jsx("button",{onClick:()=>v(A),className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar secuencia",children:o.jsx(Is,{className:`${m().compact?"h-3 w-3":"h-4 w-4"}`})}),o.jsx("button",{onClick:()=>r(A),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar secuencia",children:o.jsx(vD,{className:`${m().compact?"h-3 w-3":"h-4 w-4"}`})}),o.jsx("button",{onClick:()=>b(A),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar secuencia",children:o.jsx(ks,{className:`${m().compact?"h-3 w-3":"h-4 w-4"}`})})]})]})]})]},A.id))}),o.jsx(Cl,{isOpen:u.isOpen,onClose:()=>d({isOpen:!1,sequence:null}),onConfirm:R,title:"¿Eliminar secuencia?",message:`¿Estás seguro de que quieres eliminar la secuencia "${(y=u.sequence)==null?void 0:y.name}"? Esta acción no se puede deshacer.`,confirmText:"Eliminar",cancelText:"Cancelar",confirmClassName:"bg-red-500 hover:bg-red-600"}),a.map(A=>o.jsx(Fc,{message:A.message,type:A.type,onClose:()=>x(A.id)},A.id))]})},zv=({type:t="video"})=>{const{videoCardSize:e,sequenceCardSize:n,setVideoCardSize:r,setSequenceCardSize:s,availableSizes:i,sizeLabels:a}=g0(),l=t==="video"?e:n,u=t==="video"?r:s,d={small:o.jsx(dD,{className:"h-4 w-4"}),medium:o.jsx(Lv,{className:"h-4 w-4"}),large:o.jsx(Lv,{className:"h-4 w-4"}),"extra-large":o.jsx(wD,{className:"h-4 w-4"})},f={small:"from-gray-400 to-gray-500",medium:"from-blue-400 to-blue-500",large:"from-purple-400 to-purple-500","extra-large":"from-pink-400 to-pink-500"};return o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Tamaño:"}),o.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:i.map(m=>o.jsxs("button",{onClick:()=>u(m),className:`flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${l===m?`bg-gradient-to-r ${f[m]} text-white shadow-lg transform scale-105`:"text-gray-600 hover:text-gray-800 hover:bg-white"}`,title:`${a[m]} - ${m} cards`,children:[d[m],o.jsx("span",{className:"hidden sm:inline",children:a[m]})]},m))})]})},tO=({video:t,onLike:e,onEdit:n,onDelete:r,onAddToSequence:s,onDownload:i,onPlay:a,isVideoInSequence:l,isBuilderOpen:u,isVideoCompatible:d,type:f="video"})=>f==="video"?o.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-2",children:[o.jsx("button",{onClick:a,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Reproducir",children:o.jsx(kr,{className:"h-3 w-3"})}),o.jsx("button",{onClick:e,className:`p-1 transition-colors rounded ${t.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"}`,title:t.userLiked?"Quitar like":"Dar like",children:o.jsx(ys,{className:`h-3 w-3 ${t.userLiked?"fill-current":""}`})}),o.jsx("button",{onClick:s,disabled:l,className:`p-1 transition-colors rounded ${l?"text-gray-300 cursor-not-allowed":u&&!d?"text-red-400 hover:text-red-500":"text-gray-400 hover:text-purple-500"}`,title:l?"Ya en secuencia":u&&!d?"Añadir forzadamente":"Añadir a secuencia",children:o.jsx(ro,{className:"h-3 w-3"})}),o.jsx("button",{onClick:i,className:"p-1 text-gray-400 hover:text-green-500 transition-colors rounded",title:"Descargar",children:o.jsx(Is,{className:"h-3 w-3"})}),o.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Editar",children:o.jsx(cc,{className:"h-3 w-3"})}),o.jsx("button",{onClick:r,className:"p-1 text-gray-400 hover:text-red-500 transition-colors rounded",title:"Eliminar",children:o.jsx(ks,{className:"h-3 w-3"})})]}):o.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-2",children:[o.jsx("button",{onClick:a,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Reproducir secuencia",children:o.jsx(kr,{className:"h-3 w-3"})}),o.jsx("button",{onClick:i,className:"p-1 text-gray-400 hover:text-green-500 transition-colors rounded",title:"Descargar secuencia",children:o.jsx(Is,{className:"h-3 w-3"})}),o.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors rounded",title:"Editar secuencia",children:o.jsx(cc,{className:"h-3 w-3"})}),o.jsx("button",{onClick:r,className:"p-1 text-gray-400 hover:text-red-500 transition-colors rounded",title:"Eliminar secuencia",children:o.jsx(ks,{className:"h-3 w-3"})})]}),nO=()=>{var xo,vo;const[t,e]=S.useState(!1),[n,r]=S.useState({isOpen:!1,video:null}),[s,i]=S.useState([]),[a,l]=S.useState(!0),[u,d]=S.useState([]),[f,m]=S.useState({isOpen:!1,video:null}),[g,x]=S.useState([]),[b,R]=S.useState(""),[T,v]=S.useState(!1),[_,y]=S.useState("videos"),[A,P]=S.useState("idle"),[O,N]=S.useState({isOpen:!1,type:null}),[w,I]=S.useState({isOpen:!1,sequence:null}),[k,D]=S.useState({isOpen:!1,sequence:null}),[L,j]=S.useState({isOpen:!1}),[ce,H]=S.useState(!1),[me,ue]=S.useState(null),[G,B]=S.useState(!1),[ae,we]=S.useState(null),[q,Y]=S.useState(!1),[ie,_e]=S.useState([]),[ve,Se]=S.useState("none"),[Qe,V]=S.useState(!1),[le,oe]=S.useState([]),[be,pe]=S.useState(!0),{user:Ae}=gr(),{getVideoConfig:Le,getSequenceConfig:Xe}=g0(),{addVideoToSequence:he,removeVideoFromSequence:Oe,sequence:Ke,sequenceName:qe,clearSequence:Mt,isBuilderOpen:Nt,toggleBuilder:Tt,showAllVideos:it,toggleShowAllVideos:vt,getFilteredVideos:Me,isVideoInSequence:je,isVideoCompatible:gt,checkCompatibility:Bn,loadSequence:Qt}=oS(),[Z,Bt]=S.useState("salsa"),{availableStyles:bn,getGradientClasses:He,categoriesList:an,getColorClasses:nr}=Uc("figuras",Z),Rr=C=>{_e(U=>U.includes(C)?U.filter(ee=>ee!==C):[...U,C])},re=C=>{he(C),Nt||Tt()},Te={Music:dr,Heart:ys,Star:wa,Zap:Vc};S.useEffect(()=>{console.log("🔄 Iniciando sincronización en tiempo real para:",Z),P("syncing");const C=O5(Z,U=>{console.log(`🔄 Actualización en tiempo real recibida: ${U.length} videos para ${Z}`),i(U),l(!1),P("idle")});return()=>{console.log("🔄 Desuscribiendo de sincronización en tiempo real"),C()}},[Z]),S.useEffect(()=>{s.length>0&&Ae&&(console.log("❤️ Verificando estado de likes y favoritos del usuario para",s.length,"videos"),(async()=>{const U=await Promise.all(s.map(async ee=>{try{const[fe,ke]=await Promise.all([j5(ee.id,Ae.uid),R5(ee.id,Ae.uid)]);return{...ee,userLiked:fe.userLiked,isFavorite:ke.isFavorite}}catch(fe){return console.error("Error al verificar like/favorito para video:",ee.id,fe),{...ee,userLiked:!1,isFavorite:!1}}}));i(U)})())},[s.length,Ae]),S.useEffect(()=>{if(console.log("🎬 FigurasPage: useEffect de secuencias ejecutándose"),console.log("🎬 selectedStyle actual:",Z),console.log("🎬 subscribeToSequencesByStyle disponible:",typeof $v),!Z){console.log("⚠️ No hay selectedStyle, saltando suscripción");return}console.log("🎬 Iniciando sincronización de secuencias para:",Z),pe(!0);try{const C=$v(Z,U=>{console.log(`🎬 Actualización de secuencias recibida: ${U.length} secuencias para ${Z}`),oe(U),pe(!1)});return()=>{console.log("🎬 Desuscribiendo de sincronización de secuencias"),C()}}catch(C){console.error("❌ Error al suscribirse a secuencias:",C),pe(!1)}},[Z]);const En=async C=>{console.log("Video subido:",C),X(`${C.title} subido exitosamente`,"success")},wt=C=>{r({isOpen:!0,video:C})},$=()=>{r({isOpen:!1,video:null})},ne=C=>{i(U=>U.map(ee=>ee.id===C.id?C:ee)),X(`${C.title} actualizado exitosamente`,"success")},te=async C=>{if(!Ae){X("Debes iniciar sesión para dar like","error");return}try{const U=await np(C.id,Ae.uid);if(U.success){i(ke=>ke.map(ot=>ot.id===C.id?{...ot,likes:U.likes,likedBy:U.likedBy,userLiked:U.userLiked,isFavorite:U.isFavorite}:ot));const ee=U.userLiked?"dado like a":"quitado like de",fe=U.isFavorite?"y agregado a favoritos":"y removido de favoritos";X(`Has ${ee} "${C.title}" ${fe}`,"success")}else X("Error al actualizar like","error")}catch(U){console.error("Error al manejar like:",U),X("Error al actualizar like","error")}},X=(C,U="success")=>{const ee=Date.now();d(fe=>[...fe,{id:ee,message:C,type:U}])},Ye=C=>{d(U=>U.filter(ee=>ee.id!==C))},ln=async C=>{console.log("🎬 FigurasPage: Recibida solicitud de guardar secuencia"),console.log("📦 Datos recibidos:",C);try{const U={...C,style:Z};if(console.log("🎨 Secuencia con estilo:",U),C.id){console.log("🔄 Actualizando secuencia existente:",C.id);const ee=await GD(C.id,U);console.log("✅ Secuencia actualizada exitosamente:",ee),X("✅ Secuencia actualizada exitosamente")}else{console.log("🆕 Creando nueva secuencia");const ee=await WD(U);console.log("✅ Secuencia creada exitosamente:",ee),X('✅ Secuencia guardada exitosamente. Ve a "GALERÍA DE SECUENCIAS" para verla.')}}catch(U){throw console.error("❌ Error al guardar secuencia:",U),X("Error al guardar la secuencia","error"),U}},qt=async C=>{try{await KD(C),X("Secuencia eliminada exitosamente")}catch(U){throw console.error("Error al eliminar secuencia:",U),X("Error al eliminar la secuencia","error"),U}},Pr=C=>{console.log("🎬 Reproduciendo secuencia:",C.name),we(C),Y(!0),X(`🎬 Reproduciendo secuencia: ${C.name}`,"info")},It=C=>{console.log("🎬 Editando secuencia:",C),Ke.length>0||qe.trim()?I({isOpen:!0,sequence:C}):(Qt(C),X(`Secuencia "${C.name}" cargada para edición`))},Rs=()=>{const C=w.sequence;C&&(Qt(C),X(`Secuencia "${C.name}" cargada para edición`)),I({isOpen:!1,sequence:null})},Dr=()=>{console.log("❌ Usuario canceló la carga de secuencia"),I({isOpen:!1,sequence:null})},es=C=>{console.log("📥 Abriendo descarga de secuencia:",C),D({isOpen:!0,sequence:C})},fo=()=>{D({isOpen:!1,sequence:null})},mo=C=>{console.log("🎬 Reproduciendo video individual:",C.title),ue(C),B(!0),X(`🎬 Reproduciendo: ${C.title}`,"info")},K=()=>{B(!1),ue(null)},Ne=()=>{Y(!1),we(null)},ct=async C=>{try{console.log("🗑️ Iniciando eliminación de video:",C),console.log("📁 Video path:",C.videoPath),console.log("🖼️ Thumbnail path:",C.thumbnailPath),console.log("🆔 Video ID:",C.id);const U=await Av(C.videoPath,C.thumbnailPath);if(console.log("📦 Resultado eliminación Storage:",U),!U.success)if(console.log("⚠️ Error eliminando archivos, intentando solo eliminar video..."),U.error&&U.error.includes("thumbnails")){if(!(await Av(C.videoPath,null)).success){X(`Error al eliminar archivos: ${U.error}`,"error");return}}else{X(`Error al eliminar archivos: ${U.error}`,"error");return}console.log("🔥 Intentando eliminar documento de Firestore con ID:",C.id);const ee=await P5(C.id);if(console.log("🔥 Resultado eliminación Firestore:",ee),!ee.success){X(`Error al eliminar metadatos: ${ee.error}`,"error");return}console.log("🔄 Actualizando lista local, eliminando video con ID:",C.id),i(fe=>{const ke=fe.filter(ot=>ot.id!==C.id);return console.log(`📊 Lista actualizada: ${fe.length} -> ${ke.length} videos`),ke}),X(`${C.title} eliminado correctamente`,"success"),console.log("✅ Eliminación completada exitosamente")}catch(U){console.error("❌ Error deleting video:",U),X("Error inesperado al eliminar video","error")}},ht=C=>{console.log("🔘 Botón eliminar clickeado para video:",C),m({isOpen:!0,video:C})},qn=()=>{m({isOpen:!1,video:null})},Sn=async C=>{try{if(P("syncing"),X("Iniciando limpieza de datos...","info"),C==="update"){const U=await M5();U.success?X(`✅ ${U.updatedCount} videos actualizados`,"success"):X(`❌ Error: ${U.error}`,"error")}else if(C==="cleanup"){const U=await ya(),ee=await B5(U);ee.success?X(`🧹 ${ee.orphanedVideosDeleted} videos y ${ee.orphanedThumbnailsDeleted} thumbnails huérfanos eliminados`,"success"):X(`❌ Error: ${ee.error}`,"error")}else if(C==="cleanup-tags"){const U=await U5();U.success?X(`🏷️ ${U.updatedCount} videos actualizados con tags limpios`,"success"):X(`❌ Error: ${U.error}`,"error")}else if(C==="delete-all"){if(!window.confirm("¿Estás seguro de que quieres eliminar TODOS los videos? Esta acción no se puede deshacer.")){P("idle");return}const ee=await L5();if(!ee.success){X(`❌ Error eliminando documentos: ${ee.error}`,"error"),P("idle");return}const fe=await z5();if(!fe.success){X(`❌ Error eliminando archivos: ${fe.error}`,"error"),P("idle");return}X(`🗑️ ${ee.deletedCount} videos eliminados completamente`,"success")}P("idle"),N({isOpen:!1,type:null})}catch(U){console.error("Error en limpieza:",U),X(`❌ Error inesperado: ${U.message}`,"error"),P("idle")}},ts=C=>{N({isOpen:!0,type:C})},Or=()=>{N({isOpen:!1,type:null})},$c=async()=>{try{X("Ejecutando diagnóstico de videos...","info");const C=await V5();if(C.success){console.log("🔍 Resultado del diagnóstico:",C);let U=`Diagnóstico: ${C.totalVideos} videos total, ${C.salsaVideos} de salsa`;C.fig003Found?U+=" ✅ Fig003 encontrado":U+=" ❌ Fig003 NO encontrado",C.videosWithoutResolution>0&&(U+=` ⚠️ ${C.videosWithoutResolution} sin resolución`),X(U,"success")}else X(`Error en diagnóstico: ${C.error}`,"error")}catch(C){console.error("Error ejecutando diagnóstico:",C),X("Error al ejecutar diagnóstico","error")}},zc=async()=>{try{X("🔄 Actualizando resoluciones de videos...","info");const U=(await ya()).filter(fe=>!fe.resolution||fe.resolution==="Unknown");if(U.length===0){X("✅ Todos los videos ya tienen resolución detectada","success");return}let ee=0;for(const fe of U)try{const ke=document.createElement("video");ke.crossOrigin="anonymous",await new Promise((ot,Je)=>{ke.onloadedmetadata=()=>{const Ze=ke.videoWidth,Xt=ke.videoHeight,sr=Math.max(Ze,Xt);let Nn="Unknown";sr>=3840?Nn="4K":sr>=1920?Nn="1080p":sr>=1280?Nn="720p":sr>=854?Nn="480p":Nn="360p",Gu(fe.id,{resolution:Nn,videoWidth:Ze,videoHeight:Xt}),ee++,ot()},ke.onerror=Je,ke.src=fe.videoUrl}),ke.remove()}catch(ke){console.error(`Error actualizando resolución para video ${fe.id}:`,ke)}X(`✅ Resoluciones actualizadas: ${ee} videos`,"success")}catch(C){console.error("Error al actualizar resoluciones:",C),X("Error al actualizar resoluciones","error")}},La=async()=>{try{X("🔄 Iniciando migración REAL de videos a estructura organizada...","info");const C=await q5(s);if(C.success){let U=`✅ Migración REAL completada: ${C.successfulMigrations} videos movidos físicamente`;C.alreadyOrganized>0&&(U+=`, ${C.alreadyOrganized} ya organizados`),C.failedMigrations>0&&(U+=`, ${C.failedMigrations} fallidos`),X(U,"success"),console.log("📊 Resultados de migración REAL:",C.results),window.location.reload()}else X(`❌ Error en migración: ${C.error}`,"error")}catch(C){console.error("Error ejecutando migración:",C),X("❌ Error al ejecutar migración","error")}},Ma=C=>{x(U=>U.includes(C)?U.filter(fe=>fe!==C):[...U,C])},Bc=()=>{x([]),R("")},Va=C=>{Se(C)},Mh=(C,U)=>{if(!C.tags||!an.find(ke=>ke.key===U))return!1;const fe=C.tags[U];return fe&&Array.isArray(fe)&&fe.length>0},po=C=>{if(ve==="none")return C;const U=[...C];switch(ve){case"name":return U.sort((ee,fe)=>ee.title.localeCompare(fe.title));case"name-desc":return U.sort((ee,fe)=>fe.title.localeCompare(ee.title));case"rating":return U.sort((ee,fe)=>(fe.rating||0)-(ee.rating||0));case"rating-desc":return U.sort((ee,fe)=>(ee.rating||0)-(fe.rating||0));case"likes":return U.sort((ee,fe)=>(fe.likes||0)-(ee.likes||0));case"likes-desc":return U.sort((ee,fe)=>(ee.likes||0)-(fe.likes||0));default:return U}},Ua=C=>{if(!C.tags||Object.keys(C.tags).length===0)return[];const U=[];return an.forEach(ee=>{const fe=C.tags[ee.key];Array.isArray(fe)&&fe.forEach(ke=>{U.push({tag:ke,categoryKey:ee.key,color:ee.color})})}),U},go=C=>{if(!C.tagsIniciales||Object.keys(C.tagsIniciales).length===0)return[];const U=[];return an.forEach(ee=>{const fe=C.tagsIniciales[ee.key];Array.isArray(fe)&&fe.forEach(ke=>{U.push({tag:ke,categoryKey:ee.key,color:ee.color,type:"inicial"})})}),U},Ps=C=>{if(!C.tagsFinales||Object.keys(C.tagsFinales).length===0)return[];const U=[];return an.forEach(ee=>{const fe=C.tagsFinales[ee.key];Array.isArray(fe)&&fe.forEach(ke=>{U.push({tag:ke,categoryKey:ee.key,color:ee.color,type:"final"})})}),U},rr=C=>C.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),Fa=(C,U)=>{if(!U||U.length===0)return!0;const ee=rr(C.title||""),fe=rr(C.description||""),ke=[];return C.tags&&Object.values(C.tags).forEach(ot=>{Array.isArray(ot)&&ot.forEach(Je=>{ke.push(rr(Je))})}),U.every(ot=>{const Je=rr(ot);return!!(ee.includes(Je)||fe.includes(Je)||ke.some(Ze=>Ze.includes(Je)))})},Vh=s.filter(C=>{const U=b.split(" ").map(Je=>Je.trim()).filter(Je=>Je.length>0),ee=Fa(C,U),fe=g.length===0||g.every(Je=>C.tags?Object.values(C.tags).some(Ze=>Array.isArray(Ze)&&Ze.includes(Je)):!1),ke=ie.length===0||ie.some(Je=>Mh(C,Je)),ot=!Qe||C.isFavorite;return ee&&fe&&ke&&ot}),qc=Me(Vh),Ni=po(qc),yo=async C=>{try{console.log("Iniciando descarga de video individual:",C.title);const{ref:U}=await fs(async()=>{const{ref:Ze}=await Promise.resolve().then(()=>ac);return{ref:Ze}},void 0),{storage:ee}=await fs(async()=>{const{storage:Ze}=await Promise.resolve().then(()=>rS);return{storage:Ze}},void 0),fe=U(ee,C.videoPath),{getDownloadURL:ke}=await fs(async()=>{const{getDownloadURL:Ze}=await Promise.resolve().then(()=>ac);return{getDownloadURL:Ze}},void 0),ot=await ke(fe);console.log("URL de descarga obtenida:",ot);const Je=document.createElement("a");Je.href=ot,Je.download=C.title||"video",Je.target="_blank",Je.rel="noopener noreferrer",document.body.appendChild(Je),Je.click(),document.body.removeChild(Je),X("Descarga iniciada","success")}catch(U){console.error("Error en descarga:",U),X("Error al descargar el video","error")}};return o.jsxs("div",{className:"min-h-screen bg-white",children:[o.jsxs("div",{className:`${ce?"w-full px-0":"max-w-6xl mx-auto px-6"} py-8`,children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[o.jsx("span",{className:"text-pink-500",children:"FIGURAS"}),o.jsxs("span",{className:`bg-gradient-to-r ${He(Z)} bg-clip-text text-transparent`,children:[" - ",Z.toUpperCase()]})]}),o.jsxs("p",{className:"text-gray-600 text-lg",children:["Galería de videos de figuras de ",Z.toLowerCase()]})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:bn.map(C=>{const U=Te[C.icon],ee=Z===C.key,fe=He(C.color);return o.jsxs("button",{onClick:()=>Bt(C.key),className:`relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${ee?`bg-gradient-to-r ${fe} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[U&&o.jsx(U,{className:"h-4 w-4"}),o.jsx("span",{children:C.name})]},C.name)})}),o.jsxs("div",{className:"max-w-2xl mx-auto mb-8",children:[o.jsxs("div",{className:"relative",children:[o.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),o.jsx("input",{type:"text",placeholder:`Buscar en ${Z.toLowerCase()}... (múltiples palabras, sin tildes)`,value:b,onChange:C=>R(C.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]}),b.trim()&&o.jsx("div",{className:"mt-3 text-center",children:o.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsx(va,{className:"h-4 w-4 text-blue-500"}),o.jsxs("span",{className:"text-sm text-blue-700",children:["Buscando: ",o.jsxs("span",{className:"font-medium",children:['"',b,'"']})]}),o.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded",children:[Ni.length," resultado",Ni.length!==1?"s":""]})]})})]}),an.length>0&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("button",{onClick:()=>v(!T),className:"flex items-center justify-center space-x-2 mx-auto px-6 py-3 bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[o.jsx(oD,{className:"h-5 w-5"}),o.jsxs("span",{children:["Filtros Avanzados por Tags - ",Z]}),T?o.jsx(zd,{className:"h-5 w-5"}):o.jsx(lc,{className:"h-5 w-5"})]}),o.jsx("div",{className:`mt-4 transition-all duration-300 ease-in-out overflow-hidden ${T?"max-h-96 opacity-100":"max-h-0 opacity-0"}`,children:o.jsx("div",{className:"space-y-4 bg-gray-50 rounded-lg p-6 border border-gray-200",children:an.map(C=>o.jsxs("div",{className:"space-y-2",children:[o.jsx("button",{onClick:()=>Rr(C.key),className:`w-full text-center font-medium py-2 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 ${ie.includes(C.key)?`bg-gradient-to-r ${He(Z)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("span",{children:C.name}),ie.includes(C.key)&&o.jsx("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:"ACTIVO"})]})}),o.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:C.tags.map(U=>o.jsx("button",{onClick:()=>Ma(U),className:`px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 ${g.includes(U)?`bg-gradient-to-r ${He(Z)} text-white shadow-lg`:`${nr(C.color)} hover:bg-opacity-80`}`,children:U},U))})]},C.key))})})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:[o.jsxs("button",{onClick:()=>e(!0),className:`flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r ${He(Z)} text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105`,children:[o.jsx(uc,{className:"h-5 w-5"}),o.jsxs("span",{children:["SUBIR VIDEO(S) A ",Z.toUpperCase()]})]}),o.jsxs("button",{onClick:Tt,className:`flex items-center justify-center space-x-2 px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 ${Nt?"bg-gradient-to-r from-red-500 to-pink-500 text-white":`bg-gradient-to-r ${He(Z)} hover:opacity-90 text-white`}`,children:[o.jsx(rp,{className:"h-5 w-5"}),o.jsx("span",{children:Nt?"OCULTAR SECUENCIA":"CREAR SECUENCIA"})]})]}),o.jsxs("div",{className:"flex flex-wrap justify-center gap-3 mb-6",children:[o.jsx("button",{onClick:()=>Va(ve==="name"?"name-desc":"name"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${ve==="name"||ve==="name-desc"?`bg-gradient-to-r ${He(Z)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:o.jsx("span",{children:ve==="name"?"A-Z":ve==="name-desc"?"Z-A":"A-Z"})}),o.jsxs("button",{onClick:()=>Va(ve==="rating"?"rating-desc":"rating"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${ve==="rating"||ve==="rating-desc"?`bg-gradient-to-r ${He(Z)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(wa,{className:"h-4 w-4"}),o.jsx("span",{children:ve==="rating"?"Puntuación ↓":ve==="rating-desc"?"Puntuación ↑":"Puntuación"})]}),o.jsxs("button",{onClick:()=>{Qe?ve==="likes"?Se("likes-desc"):ve==="likes-desc"?Se("likes"):(V(!1),Se("none")):(V(!0),Se("likes"))},className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${Qe?`bg-gradient-to-r ${He(Z)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(ys,{className:"h-4 w-4"}),o.jsx("span",{children:Qe?ve==="likes"?"Favoritos ↓":ve==="likes-desc"?"Favoritos ↑":"Ocultar Favoritos":"Mostrar Favoritos"})]})]}),Nt&&o.jsx(JD,{isOpen:!0,videos:s,onSaveSequence:ln,onToggleShowAll:vt,showAllVideos:it,style:Z,onToggleBuilder:Tt}),o.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:`w-3 h-3 rounded-full ${A==="idle"?"bg-green-500":A==="syncing"?"bg-yellow-500 animate-pulse":"bg-red-500"}`}),o.jsx("span",{className:"text-sm text-gray-600",children:A==="idle"?"✅ Sincronizado con Firebase":A==="syncing"?"🔄 Sincronizando...":"❌ Error de sincronización"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx("button",{onClick:$c,disabled:A==="syncing",className:"px-3 py-1 text-xs bg-purple-500 text-white rounded hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"🔍 Diagnóstico"}),o.jsx("button",{onClick:zc,disabled:A==="syncing",className:"px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"📐 Actualizar Resoluciones"}),o.jsx("button",{onClick:()=>ts("update"),disabled:A==="syncing",className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"🔧 Actualizar Rutas"}),o.jsx("button",{onClick:()=>ts("cleanup"),disabled:A==="syncing",className:"px-3 py-1 text-xs bg-yellow-500 text-white rounded hover:bg-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"🧹 Limpiar Huérfanos"}),o.jsx("button",{onClick:()=>ts("cleanup-tags"),disabled:A==="syncing",className:"px-3 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"🏷️ Limpiar Tags"}),o.jsx("button",{onClick:La,disabled:A==="syncing",className:"px-3 py-1 text-xs bg-indigo-500 text-white rounded hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",title:"Mover físicamente videos existentes a estructura organizada (videos/page/style/)",children:"📁 Migrar Videos REAL"}),o.jsx("button",{onClick:()=>ts("delete-all"),disabled:A==="syncing",className:"px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"🗑️ Eliminar Todo"})]})]})}),o.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[o.jsxs("button",{onClick:()=>y("videos"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${_==="videos"?`bg-gradient-to-r ${He(Z)} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(dr,{className:"h-6 w-6"}),o.jsx("span",{children:"GALERÍA DE VIDEOS"})]}),o.jsxs("button",{onClick:()=>y("secuencias"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${_==="secuencias"?`bg-gradient-to-r ${He(Z)} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(ro,{className:"h-6 w-6"}),o.jsxs("span",{children:["GALERÍA DE SECUENCIAS (",le.length,")"]})]})]}),_==="videos"&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Videos de ",Z.toLowerCase()," (",Ni.length,")"]}),(ie.length>0||ve!=="none"||Qe)&&o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[ie.length>0&&`Filtrado por: ${ie.join(", ")} `,ve!=="none"&&`• Ordenado por: ${ve} `,Qe&&"• Solo favoritos"]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(zv,{type:"video"}),o.jsxs("button",{onClick:()=>H(!ce),className:`flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 ${ce?`bg-gradient-to-r ${He(Z)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,title:ce?"Modo compacto":"Modo ancho completo",children:[ce?o.jsx(gD,{className:"h-4 w-4"}):o.jsx(pD,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:ce?"Compacto":"Ancho completo"})]}),Nt&&o.jsx("button",{onClick:vt,className:`flex items-center space-x-2 px-3 py-1 rounded-lg text-sm font-medium transition-colors ${it?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,title:it?"Mostrar solo videos compatibles":"Mostrar todos los videos",children:it?o.jsxs(o.Fragment,{children:[o.jsx(jh,{className:"h-4 w-4"}),o.jsx("span",{children:"Ocultar Incompatibles"})]}):o.jsxs(o.Fragment,{children:[o.jsx(Lc,{className:"h-4 w-4"}),o.jsx("span",{children:"Mostrar Todos"})]})}),(g.length>0||ie.length>0||ve!=="none"||Qe)&&o.jsxs("button",{onClick:()=>{Bc(),_e([]),Se("none"),V(!1)},className:"text-sm text-gray-500 hover:text-gray-700 transition-colors duration-200",children:["Limpiar todos los filtros ",o.jsx(Cr,{className:"h-4 w-4 ml-1"})]})]})]}),a?o.jsxs("div",{className:"flex justify-center items-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),o.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando videos..."})]}):s.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsxs("p",{className:"text-gray-500 text-lg",children:["No hay videos de ",Z.toLowerCase()," aún"]}),o.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Sube tu primer video de ",Z.toLowerCase()," usando el botón de arriba"]})]}):o.jsx("div",{className:`grid gap-6 ${Le().grid}`,children:Ni.map(C=>o.jsxs("div",{className:`bg-white rounded-lg shadow-md overflow-hidden border hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] ${Nt&&!gt(C)?"border-red-200 opacity-75":"border-gray-100"}`,children:[o.jsxs("div",{className:"relative group",children:[o.jsxs("div",{className:`w-full ${Le().aspect} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[C.thumbnailUrl&&C.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?o.jsx("img",{src:C.thumbnailUrl,alt:C.title,className:"w-full h-full object-cover",loading:"lazy",onError:U=>{U.target.style.display="none",U.target.nextSibling.style.display="flex"}}):null,o.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${C.thumbnailUrl&&C.thumbnailUrl!=="https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"?"hidden":"flex"}`,children:[o.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),o.jsx("span",{className:"text-sm font-medium",children:C.title})]}),o.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:C.resolution&&C.resolution!=="Unknown"?C.resolution:"HD"}),Nt&&o.jsx("div",{className:`absolute top-2 right-2 p-1 rounded-full text-xs font-bold ${gt(C)?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:gt(C)?"✅":"❌"})]}),o.jsx("button",{onClick:async()=>{try{const U=document.createElement("div");U.className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50";const ee=document.createElement("div");ee.className="bg-white rounded-lg p-6 max-w-5xl w-full mx-4 max-h-[95vh] overflow-y-auto",ee.onclick=$e=>$e.stopPropagation();const fe=document.createElement("div");fe.className="flex items-center justify-between mb-4",fe.innerHTML=`
                             <h3 class="text-xl font-semibold text-gray-900">${C.title}</h3>
                             <button class="text-gray-400 hover:text-gray-600 transition-colors">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                               </svg>
                             </button>
                           `;const ke=document.createElement("div");ke.id="video-player-container",ke.className="w-full flex justify-center mb-6";const ot=document.createElement("div");ot.className="w-full max-w-3xl mx-auto";const Je=document.createElement("div");Je.className="mb-4",Je.innerHTML=`
                             <p class="text-gray-600 text-sm">${C.description||"Sin descripción"}</p>
                           `;const Ze=document.createElement("div");Ze.className="flex items-center justify-between mb-4 p-3 bg-gray-50 rounded-lg",Ze.innerHTML=`
                              <div class="flex items-center space-x-4 text-sm text-gray-600">
                                <span class="font-medium">${(C.fileSize/(1024*1024)).toFixed(2)} MB</span>
                                <span class="text-gray-400">•</span>
                                <span class="font-medium">${C.resolution&&C.resolution!=="Unknown"?C.resolution:"HD"}</span>
                                <span class="text-gray-400">•</span>
                                <span class="font-medium">${C.duration?Math.floor(C.duration/60)+":"+String(Math.floor(C.duration%60)).padStart(2,"0"):"N/A"}</span>
                              </div>
                              <div class="flex items-center space-x-2">
                                <div class="flex items-center space-x-1">
                                  <div class="flex items-center space-x-1" title="Puntuación: ${C.rating||0}/5">
                                    ${[1,2,3,4,5].map($e=>`<svg class="w-4 h-4 ${(C.rating||0)>=$e?"text-yellow-400 fill-current":"text-gray-300"}" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                      </svg>`).join("")}
                                    <span class="text-sm font-medium text-gray-600">${C.rating||0}</span>
                                  </div>
                                </div>
                                <button class="flex items-center space-x-1 ${C.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"} transition-colors duration-200 p-2 rounded hover:bg-red-50" title="${C.userLiked?"Quitar like":"Dar like"}">
                                  <svg class="w-5 h-5 ${C.userLiked?"fill-current":""}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                  </svg>
                                  <span class="text-sm font-medium">${C.likes||0}</span>
                                </button>
                                <button class="text-gray-400 hover:text-green-500 transition-colors duration-200 p-2 rounded hover:bg-green-50" title="Descargar video">
                                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                  </svg>
                                </button>
                                <button class="text-gray-400 hover:text-blue-500 transition-colors duration-200 p-2 rounded hover:bg-blue-50" title="Editar video">
                                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                  </svg>
                                </button>
                              </div>
                            `;const Xt=document.createElement("div");Xt.className="mb-4";const sr=Ua(C);if(sr.length>0){const $e=sr.map(({tag:Rt,categoryKey:Vt,color:Yt})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium ${nr(Yt)} mr-2 mb-2">${Rt}</span>`).join("");Xt.innerHTML=`
                               <h4 class="text-sm font-medium text-gray-700 mb-2">Etiquetas:</h4>
                               <div class="flex flex-wrap">${$e}</div>
                             `}else Xt.innerHTML=`
                               <h4 class="text-sm font-medium text-gray-700 mb-2">Etiquetas:</h4>
                               <span class="text-gray-400 text-sm">Sin etiquetas</span>
                             `;const Nn=document.createElement("div");Nn.className="mb-4";const wo=go(C);if(wo.length>0){const $e=wo.map(({tag:Rt})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white mr-2 mb-2">${Rt}</span>`).join("");Nn.innerHTML=`
                               <h4 class="text-sm font-medium text-blue-600 uppercase tracking-wide mb-2">Etiquetas Iniciales:</h4>
                               <div class="flex flex-wrap">${$e}</div>
                             `}const et=document.createElement("div");et.className="mb-4";const Ds=Ps(C);if(Ds.length>0){const $e=Ds.map(({tag:Rt})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white mr-2 mb-2">${Rt}</span>`).join("");et.innerHTML=`
                               <h4 class="text-sm font-medium text-green-600 uppercase tracking-wide mb-2">Etiquetas Finales:</h4>
                               <div class="flex flex-wrap">${$e}</div>
                             `}ot.appendChild(Je),ot.appendChild(Ze),ot.appendChild(Xt),wo.length>0&&ot.appendChild(Nn),Ds.length>0&&ot.appendChild(et),ee.appendChild(fe),ee.appendChild(ke),ee.appendChild(ot),U.appendChild(ee),document.body.appendChild(U);const{createRoot:Ti}=await fs(async()=>{const{createRoot:$e}=await Promise.resolve().then(()=>iT);return{createRoot:$e}},void 0),Os=Ti(ke);Os.render(hp.createElement(dc,{src:C.videoUrl,size:"large",loop:!0,initialShowControls:!0,autoplay:!0,muted:!1,className:"w-full max-w-3xl",resolutions:["auto","4k","1080p","720p","480p","360p"],currentResolution:"auto",videoTitle:C.title||"video",onResolutionChange:$e=>{console.log(`Resolución cambiada a: ${$e}`)}})),U._root=Os;const $a=()=>{U._root&&U._root.unmount(),document.body.contains(U)&&document.body.removeChild(U)};fe.querySelector("button").onclick=$a,U.onclick=$e=>{$e.target===U&&$a()},Ze.querySelector('button[title="Descargar video"]').onclick=()=>{yo(C)},Ze.querySelector('button[title="Editar video"]').onclick=()=>{$a(),wt(C)};const _o=Ze.querySelector('div[title*="Puntuación"]'),bo=_o.querySelectorAll("svg"),Uh=_o.querySelector("span");bo.forEach(($e,Rt)=>{const Vt=Rt+1;$e.addEventListener("mouseenter",()=>{bo.forEach((Yt,cn)=>{cn<=Rt&&(Yt.classList.add("text-yellow-400","fill-current"),Yt.classList.remove("text-gray-300"))})}),$e.addEventListener("mouseleave",()=>{bo.forEach((Yt,cn)=>{const yr=C.rating||0;cn<yr?(Yt.classList.add("text-yellow-400","fill-current"),Yt.classList.remove("text-gray-300")):(Yt.classList.remove("text-yellow-400","fill-current"),Yt.classList.add("text-gray-300"))})}),$e.addEventListener("click",async()=>{try{const cn=(C.rating||0)>=Vt?0:Vt;await Gu(C.id,{rating:cn}),C.rating=cn,bo.forEach((yr,ir)=>{ir<cn?(yr.classList.add("text-yellow-400","fill-current"),yr.classList.remove("text-gray-300")):(yr.classList.remove("text-yellow-400","fill-current"),yr.classList.add("text-gray-300"))}),Uh.textContent=cn,_o.title=`Puntuación: ${cn}/5`,console.log(`Video "${C.title}" puntuado con ${cn} estrellas`)}catch(Yt){console.error("Error al actualizar puntuación:",Yt)}})});const Eo=Ze.querySelector('button[title*="like"]');Eo.onclick=async()=>{if(!Ae){alert("Debes iniciar sesión para dar like");return}try{const $e=await np(C.id,Ae.uid);if($e.success){C.likes=$e.likes,C.likedBy=$e.likedBy,C.userLiked=$e.userLiked,i(yr=>yr.map(ir=>ir.id===C.id?{...ir,likes:$e.likes,likedBy:$e.likedBy,userLiked:$e.userLiked}:ir));const Rt=Eo.querySelector("svg"),Vt=Eo,Yt=Eo.querySelector("span");$e.userLiked?(Rt.classList.add("fill-current","text-red-500"),Rt.classList.remove("text-gray-400"),Vt.classList.add("text-red-500"),Vt.classList.remove("text-gray-400"),Vt.title="Quitar like"):(Rt.classList.remove("fill-current","text-red-500"),Rt.classList.add("text-gray-400"),Vt.classList.remove("text-red-500"),Vt.classList.add("text-gray-400"),Vt.title="Dar like"),Yt.textContent=$e.likes;const cn=$e.userLiked?"dado like a":"quitado like de";console.log(`Has ${cn} "${C.title}"`)}else console.error("Error al actualizar like")}catch($e){console.error("Error al actualizar like:",$e)}}}catch(U){console.error("Error al abrir modal de video:",U)}},className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:o.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M8 5v14l11-7z"})})})]}),o.jsxs("div",{className:`${Le().compact?"p-2":"p-4"}`,children:[o.jsxs("div",{className:`flex items-center justify-between ${Le().compact?"mb-1":"mb-2"}`,children:[o.jsx("h3",{className:`font-semibold text-gray-800 ${Le().titleSize}`,children:C.title}),o.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(U=>{const ee=(C.rating||0)>=U;return o.jsx("svg",{className:`${Le().compact?"h-3 w-3":"h-4 w-4"} ${ee?"text-yellow-400 fill-current":"text-gray-300"} cursor-pointer`,fill:"currentColor",viewBox:"0 0 24 24",onClick:async()=>{try{const ke=(C.rating||0)>=U?0:U;await Gu(C.id,{rating:ke}),C.rating=ke,console.log(`Video "${C.title}" rated ${ke} stars`)}catch(fe){console.error("Error updating rating:",fe)}},children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},U)}),o.jsxs("span",{className:`${Le().compact,"text-xs"} font-medium text-gray-500 ml-1`,children:["(",C.rating||0,")"]})]})]}),o.jsx("p",{className:`text-gray-600 text-sm ${Le().compact?"mb-2":"mb-3"} ${Le().descriptionLines===1?"line-clamp-1":Le().descriptionLines===2?"line-clamp-2":Le().descriptionLines===3?"line-clamp-3":"line-clamp-4"}`,children:C.description||"Sin descripción"}),Le().showTags&&o.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const U=Ua(C);return U.length>0?U.map(({tag:ee,categoryKey:fe,color:ke})=>o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${nr(ke)}`,children:ee},`${fe}-${ee}`)):o.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),Le().showTags&&(()=>{const U=go(C);return U.length>0?o.jsxs("div",{className:"mb-3",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-2",children:o.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:"Iniciales:"})}),o.jsx("div",{className:"flex flex-wrap gap-2",children:U.map(({tag:ee,categoryKey:fe,color:ke})=>o.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-sm",children:ee},`inicial-${fe}-${ee}`))})]}):null})(),Le().showTags&&(()=>{const U=Ps(C);return U.length>0?o.jsxs("div",{className:"mb-3",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-2",children:o.jsx("span",{className:"text-xs font-medium text-green-600 uppercase tracking-wide",children:"Finales:"})}),o.jsx("div",{className:"flex flex-wrap gap-2",children:U.map(({tag:ee,categoryKey:fe,color:ke})=>o.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-sm",children:ee},`final-${fe}-${ee}`))})]}):null})(),Le().compact?o.jsx(tO,{video:C,onLike:()=>te(C),onEdit:()=>wt(C),onDelete:()=>ht(C),onAddToSequence:()=>re(C),onDownload:()=>yo(C),onPlay:()=>mo(C),isVideoInSequence:je(C),isBuilderOpen:Nt,isVideoCompatible:gt(C),type:"video"}):o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("span",{className:"font-medium",children:[(C.fileSize/(1024*1024)).toFixed(2)," MB"]}),o.jsx("span",{className:"text-gray-400",children:"•"}),o.jsx("span",{className:"text-gray-600",children:C.resolution&&C.resolution!=="Unknown"?C.resolution:"HD"}),C.bpm&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-gray-400",children:"•"}),o.jsxs("span",{className:"text-purple-600 font-medium flex items-center space-x-1",children:[o.jsx(dr,{className:"h-3 w-3"}),o.jsxs("span",{children:[C.bpm," BPM"]})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:()=>mo(C),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Reproducir video",children:o.jsx(kr,{className:"h-4 w-4"})}),o.jsxs("button",{onClick:()=>te(C),className:`flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 ${C.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"}`,title:C.userLiked?"Quitar like":"Dar like",children:[o.jsx(ys,{className:`h-4 w-4 ${C.userLiked?"fill-current":""}`}),o.jsx("span",{className:"font-medium",children:C.likes||0})]}),o.jsx("button",{onClick:()=>wt(C),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar video",children:o.jsx(cc,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>ht(C),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar video",children:o.jsx(ks,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>re(C),disabled:je(C),className:`transition-colors duration-200 p-1 rounded ${je(C)?"text-gray-300 cursor-not-allowed":Nt&&!gt(C)?"text-red-400 hover:text-red-500 hover:bg-red-50":"text-gray-400 hover:text-purple-500 hover:bg-purple-50"}`,title:je(C)?"Ya en secuencia":Nt&&!gt(C)?"Añadir forzadamente (incompatible)":"Añadir a secuencia",children:o.jsx(ro,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>{yo(C)},className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar video",children:o.jsx(Is,{className:"h-4 w-4"})})]})]})]})]},C.id))})]}),_==="secuencias"&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Secuencias de ",Z.toLowerCase()," (",le.length,")"]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(zv,{type:"sequence"}),o.jsxs("button",{onClick:Tt,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[o.jsx(rp,{className:"h-4 w-4"}),o.jsx("span",{children:"CREAR SECUENCIA"})]})]})]}),be?o.jsxs("div",{className:"flex justify-center items-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),o.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando secuencias..."})]}):o.jsx(eO,{sequences:le,onDeleteSequence:qt,onPlaySequence:Pr,onEditSequence:It,onDownloadSequence:es})]})]}),o.jsx(OD,{isOpen:t,onClose:()=>e(!1),onVideoUploaded:En,page:"figuras",style:Z}),o.jsx(LD,{isOpen:n.isOpen,onClose:$,video:n.video,onVideoUpdated:ne,page:"figuras",style:Z}),o.jsx(Cl,{isOpen:O.isOpen,onClose:Or,onConfirm:()=>Sn(O.type),title:O.type==="update"?"Actualizar Rutas de Thumbnails":O.type==="cleanup"?"Limpiar Archivos Huérfanos":O.type==="cleanup-tags"?"Limpiar Tags Duplicados":"Eliminar Todos los Videos",message:O.type==="update"?"¿Actualizar las rutas de thumbnails de videos existentes? Esto corregirá problemas de eliminación.":O.type==="cleanup"?"¿Limpiar archivos huérfanos? Esto eliminará archivos que no tienen documento en Firestore.":O.type==="cleanup-tags"?"¿Limpiar tags duplicados? Esto eliminará etiquetas repetidas en todos los videos manteniendo solo una instancia de cada tag.":"¿Eliminar TODOS los videos de Firebase y Storage? Esta acción es IRREVERSIBLE y eliminará todos los datos.",confirmText:O.type==="update"?"Actualizar":O.type==="cleanup"?"Limpiar":O.type==="cleanup-tags"?"Limpiar Tags":"Eliminar Todo",cancelText:"Cancelar"}),o.jsx(Cl,{isOpen:w.isOpen,onClose:Dr,onConfirm:Rs,title:"🎬 Cargar Secuencia",message:`¿Deseas cargar la secuencia "${(xo=w.sequence)==null?void 0:xo.name}"?

Esto reemplazará la secuencia actual en construcción y perderás todos los cambios no guardados.

¿Estás seguro de que quieres continuar?`,confirmText:"Sí, Cargar",cancelText:"Cancelar",type:"warning"}),o.jsx(Cl,{isOpen:f.isOpen,onClose:qn,onConfirm:()=>ct(f.video),title:"🗑️ Eliminar Video",message:`¿Estás seguro de que quieres eliminar el video "${(vo=f.video)==null?void 0:vo.title}"?

Esta acción eliminará permanentemente:
• El archivo de video de Firebase Storage
• El thumbnail del video
• Los metadatos de Firestore

Esta acción NO se puede deshacer.`,confirmText:"Sí, Eliminar",cancelText:"Cancelar",type:"danger"}),G&&me&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["🎬 ",me.title]}),o.jsx("button",{onClick:K,className:"text-gray-500 hover:text-gray-700 transition-colors",children:o.jsx(Cr,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"flex-1 min-h-0 p-4",children:o.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:o.jsx("div",{className:"w-full max-w-md",children:o.jsx(ap,{videos:[me],className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})]})}),q&&ae&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["🎬 Secuencia: ",ae.name]}),o.jsx("button",{onClick:Ne,className:"text-gray-500 hover:text-gray-700 transition-colors",children:o.jsx(Cr,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"flex-1 min-h-0 p-4",children:o.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:o.jsx("div",{className:"w-full max-w-md",children:o.jsx(ap,{videos:ae.videos,className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})]})}),o.jsx(HD,{isOpen:k.isOpen,onClose:fo,video:k.sequence?{...k.sequence,title:k.sequence.name,file:null}:null,onDownloadComplete:()=>{X("Secuencia descargada correctamente","success"),fo()}}),u.map(C=>o.jsx(Fc,{message:C.message,type:C.type,onClose:()=>Ye(C.id)},C.id))]})},rO=()=>{const[t,e]=S.useState("SALSA"),[n,r]=S.useState("cursos"),s=[{name:"SALSA",icon:dr,hasNotification:!0},{name:"BACHATA",icon:ys},{name:"KIZOMBA",icon:Vc},{name:"ZOUK",icon:wa},{name:"MERENGUE",icon:Ph}],i=[{id:1,title:"Fundamentos de Salsa Cubana",description:"Aprende los pasos básicos y la técnica fundamental",instructor:"Carlos Rodríguez",duration:"8 semanas",students:156,level:"Principiante",thumbnail:"https://via.placeholder.com/300x200/1a1a1a/ffffff?text=CURSO+SALSA+CUBANA",progress:0,tags:["Básico","Cubano","Fundamentos","Principiante"]},{id:2,title:"Salsa Avanzada - Técnicas de Giro",description:"Domina las técnicas de giro y combinaciones complejas",instructor:"María González",duration:"6 semanas",students:89,level:"Avanzado",thumbnail:"https://via.placeholder.com/300x200/1a1a1a/ffffff?text=TÉCNICAS+DE+GIRO",progress:25,tags:["Avanzado","Giros","Técnica","LA Style"]}],a={Básico:"bg-green-500",Cubano:"bg-purple-500",Fundamentos:"bg-blue-500",Principiante:"bg-green-500",Avanzado:"bg-red-500",Giros:"bg-blue-500",Técnica:"bg-orange-500","LA Style":"bg-purple-500"};return o.jsx("div",{className:"min-h-screen bg-white",children:o.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[o.jsx("span",{className:"text-pink-500",children:"ESCUELA"}),o.jsx("span",{className:"text-pink-600",children:" - SALSA"})]}),o.jsx("p",{className:"text-gray-600 text-lg",children:"Cursos y tutoriales estructurados para aprender salsa"})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:s.map(l=>o.jsxs("button",{onClick:()=>e(l.name),className:`relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${t===l.name?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[o.jsx(l.icon,{className:"h-4 w-4"}),o.jsx("span",{children:l.name}),l.hasNotification&&o.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-pink-500 rounded-full animate-pulse"})]},l.name))}),o.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:o.jsxs("div",{className:"relative",children:[o.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),o.jsx("input",{type:"text",placeholder:"Buscar cursos en salsa...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[o.jsxs("button",{className:"flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-orange-500 to-pink-500 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[o.jsx(uc,{className:"h-5 w-5"}),o.jsx("span",{children:"CREAR NUEVO CURSO"})]}),o.jsxs("button",{className:"flex items-center justify-center space-x-2 px-6 py-3 bg-pink-500 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[o.jsx(ro,{className:"h-5 w-5"}),o.jsx("span",{children:"GESTIÓN DE INSTRUCTORES"})]})]}),o.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[o.jsxs("button",{onClick:()=>r("cursos"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${n==="cursos"?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(cS,{className:"h-4 w-4"}),o.jsx("span",{children:"GALERÍA DE CURSOS (2)"})]}),o.jsxs("button",{onClick:()=>r("tutoriales"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${n==="tutoriales"?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(Dh,{className:"h-4 w-4"}),o.jsx("span",{children:"GALERÍA DE TUTORIALES (0)"})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Cursos de salsa (2)"}),o.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:i.map(l=>o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02]",children:[o.jsxs("div",{className:"relative group",children:[o.jsxs("div",{className:"w-full aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center",children:[l.thumbnail&&l.thumbnail!=="https://via.placeholder.com/300x200/1a1a1a/ffffff?text=CURSO"?o.jsx("img",{src:l.thumbnail,alt:l.title,className:"w-full h-full object-cover",loading:"lazy",onError:u=>{u.target.style.display="none",u.target.nextSibling.style.display="flex"}}):null,o.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${l.thumbnail&&l.thumbnail!=="https://via.placeholder.com/300x200/1a1a1a/ffffff?text=CURSO"?"hidden":"flex"}`,children:[o.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),o.jsx("span",{className:"text-sm font-medium",children:l.title})]})]}),o.jsx("div",{className:"absolute top-2 right-2 bg-pink-500 text-white px-2 py-1 rounded text-sm font-medium",children:l.level})]}),o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"font-semibold text-gray-800 mb-2 text-lg",children:l.title}),o.jsx("p",{className:"text-gray-600 text-sm mb-3",children:l.description}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.tags.map(u=>o.jsx("span",{className:`px-3 py-1 text-white text-xs rounded-full font-medium ${a[u]||"bg-gray-500"}`,children:u},u))}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(_a,{className:"h-4 w-4"}),o.jsxs("span",{className:"font-medium",children:[l.students," estudiantes"]})]}),o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(qo,{className:"h-4 w-4"}),o.jsx("span",{className:"font-medium",children:l.duration})]})]}),o.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:o.jsxs("span",{className:"font-medium",children:["Instructor: ",l.instructor]})}),l.progress>0&&o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[o.jsx("span",{children:"Progreso"}),o.jsxs("span",{children:[l.progress,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-pink-500 h-2 rounded-full transition-all duration-300",style:{width:`${l.progress}%`}})})]}),o.jsx("button",{className:"w-full bg-pink-500 text-white py-2 px-4 rounded-lg font-medium hover:bg-pink-600 transition-colors duration-200",children:l.progress>0?"Continuar Curso":"Empezar Curso"})]})]},l.id))})]})]})})},sO=()=>{const[t,e]=S.useState("SALSA"),[n,r]=S.useState("eventos"),s=[{name:"SALSA",icon:dr,hasNotification:!0},{name:"BACHATA",icon:ys},{name:"KIZOMBA",icon:Vc},{name:"ZOUK",icon:wa},{name:"MERENGUE",icon:Ph}],i=[{id:1,title:"Festival de Salsa Madrid 2024",description:"El evento más grande de salsa en la capital española",organizer:"Salsa Madrid Events",date:"15-17 Marzo 2024",location:"Madrid",attendees:450,type:"Festival",thumbnail:"https://via.placeholder.com/300x200/1a1a1a/ffffff?text=FESTIVAL+SALSA+MADRID",tags:["Festival","Madrid","Internacional","Workshops"]},{id:2,title:"Competición Nacional de Salsa",description:"Competición amateur y profesional de salsa",organizer:"Federación Española de Baile",date:"22 Abril 2024",location:"Barcelona",attendees:200,type:"Competición",thumbnail:"https://via.placeholder.com/300x200/1a1a1a/ffffff?text=COMPETICIÓN+NACIONAL",tags:["Competición","Barcelona","Nacional","Amateur"]}],a={Festival:"bg-purple-500",Madrid:"bg-red-500",Internacional:"bg-blue-500",Workshops:"bg-green-500",Competición:"bg-orange-500",Barcelona:"bg-red-500",Nacional:"bg-blue-500",Amateur:"bg-green-500"};return o.jsx("div",{className:"min-h-screen bg-white",children:o.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[o.jsx("span",{className:"text-pink-500",children:"EVENTOS"}),o.jsx("span",{className:"text-pink-600",children:" - SALSA"})]}),o.jsx("p",{className:"text-gray-600 text-lg",children:"Eventos, competiciones y encuentros de salsa"})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:s.map(l=>o.jsxs("button",{onClick:()=>e(l.name),className:`relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${t===l.name?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[o.jsx(l.icon,{className:"h-4 w-4"}),o.jsx("span",{children:l.name}),l.hasNotification&&o.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-pink-500 rounded-full animate-pulse"})]},l.name))}),o.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:o.jsxs("div",{className:"relative",children:[o.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),o.jsx("input",{type:"text",placeholder:"Buscar eventos en salsa...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[o.jsxs("button",{className:"flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-orange-500 to-pink-500 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[o.jsx(uc,{className:"h-5 w-5"}),o.jsx("span",{children:"CREAR NUEVO EVENTO"})]}),o.jsxs("button",{className:"flex items-center justify-center space-x-2 px-6 py-3 bg-pink-500 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[o.jsx(ro,{className:"h-5 w-5"}),o.jsx("span",{children:"CALENDARIO DE EVENTOS"})]})]}),o.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[o.jsxs("button",{onClick:()=>r("eventos"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${n==="eventos"?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(Oa,{className:"h-4 w-4"}),o.jsx("span",{children:"GALERÍA DE EVENTOS (2)"})]}),o.jsxs("button",{onClick:()=>r("competiciones"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ${n==="competiciones"?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg transform scale-105":"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"}`,children:[o.jsx(wa,{className:"h-4 w-4"}),o.jsx("span",{children:"GALERÍA DE COMPETICIONES (0)"})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Eventos de salsa (2)"}),o.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:i.map(l=>o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02]",children:[o.jsxs("div",{className:"relative group",children:[o.jsxs("div",{className:"w-full aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center",children:[l.thumbnailUrl&&l.thumbnailUrl!=="https://via.placeholder.com/300x200/1a1a1a/ffffff?text=EVENTO"?o.jsx("img",{src:l.thumbnailUrl,alt:l.title,className:"w-full h-full object-cover",loading:"lazy",onError:u=>{u.target.style.display="none",u.target.nextSibling.style.display="flex"}}):null,o.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${l.thumbnailUrl&&l.thumbnailUrl!=="https://via.placeholder.com/300x200/1a1a1a/ffffff?text=EVENTO"?"hidden":"flex"}`,children:[o.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o.jsx("span",{className:"text-sm font-medium",children:l.title})]})]}),o.jsx("div",{className:"absolute top-2 right-2 bg-pink-500 text-white px-2 py-1 rounded text-sm font-medium",children:l.type})]}),o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"font-semibold text-gray-800 mb-2 text-lg",children:l.title}),o.jsx("p",{className:"text-gray-600 text-sm mb-3",children:l.description}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.tags.map(u=>o.jsx("span",{className:`px-3 py-1 text-white text-xs rounded-full font-medium ${a[u]||"bg-gray-500"}`,children:u},u))}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(_a,{className:"h-4 w-4"}),o.jsxs("span",{className:"font-medium",children:[l.attendees," asistentes"]})]}),o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(qo,{className:"h-4 w-4"}),o.jsx("span",{className:"font-medium",children:l.date})]})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(mD,{className:"h-4 w-4"}),o.jsx("span",{className:"font-medium",children:l.location})]}),o.jsxs("span",{className:"font-medium",children:["Organiza: ",l.organizer]})]}),o.jsx("button",{className:"w-full bg-pink-500 text-white py-2 px-4 rounded-lg font-medium hover:bg-pink-600 transition-colors duration-200",children:"Inscribirse al Evento"})]})]},l.id))})]})]})})},iO=()=>{const{userProfile:t,isSuperAdmin:e,hasPermission:n,createInvitation:r}=gr(),[s,i]=S.useState(!1),[a,l]=S.useState({type:"",text:""}),[u,d]=S.useState([]),[f,m]=S.useState([]),[g,x]=S.useState(null),[b,R]=S.useState("users"),[T,v]=S.useState({email:"",displayName:"",username:"",role:z.POLLITO,expiresIn:"7"}),_=[{id:"YvT9KXqQA5TQbAmAe4IFkYh0LDY2",email:"david_exile_92@hotmail.com",displayName:"David",username:"david",role:z.SUPER_ADMIN,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!0},{id:"gkjNUPbjpUbGGVArXEO3Izxn",email:"admin@salsahacks.com",displayName:"Admin",username:"admin",role:z.SUPER_ADMIN,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!0},{id:"IM3g8N6XuyQKFLwozPqv6Ei1",email:"maese@salsahacks.com",displayName:"Maese",username:"maese",role:z.MAESE,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!1},{id:"hljlH3bbIDS6hwPZ9fzfFnzbOk",email:"soldado@salsahacks.com",displayName:"Soldado",username:"soldado",role:z.USER,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!1},{id:"plJ9SnLFEKdJHZunlbATscuW",email:"pollito@salsahacks.com",displayName:"Pollito",username:"pollito",role:z.POLLITO,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!1}];if(S.useEffect(()=>{d(_)},[]),!e&&!n("MANAGE_USERS"))return o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Acceso Denegado"}),o.jsx("p",{className:"text-gray-600",children:"No tienes permisos para acceder a esta página"})]})});const y=H=>{v({...T,[H.target.name]:H.target.value})},A=async H=>{H.preventDefault(),i(!0),l({type:"",text:""});try{const me=await r(T.email,T.displayName,T.role,T.username,parseInt(T.expiresIn));if(me.success){const ue={id:Date.now(),...T,invitationCode:me.invitationCode,invitationUrl:me.invitationUrl,createdAt:new Date,status:"pending",expiresAt:new Date(Date.now()+parseInt(T.expiresIn)*24*60*60*1e3)};m(G=>[...G,ue]),v({email:"",displayName:"",username:"",role:z.POLLITO,expiresIn:"7"}),l({type:"success",text:`Invitación creada exitosamente para ${T.displayName} con rol de ${cr[T.role]}`})}else l({type:"error",text:me.error})}catch(me){l({type:"error",text:me.message})}finally{i(!1)}},P=async H=>{try{await navigator.clipboard.writeText(H),x(H),setTimeout(()=>x(null),2e3)}catch{const ue=document.createElement("textarea");ue.value=H,document.body.appendChild(ue),ue.select(),document.execCommand("copy"),document.body.removeChild(ue),x(H),setTimeout(()=>x(null),2e3)}},O=H=>{window.confirm("¿Estás seguro de que quieres eliminar esta invitación?")&&(m(me=>me.filter(ue=>ue.id!==H)),l({type:"success",text:"Invitación eliminada exitosamente"}))},N=H=>{window.confirm("¿Estás seguro de que quieres bloquear este usuario?")&&(d(me=>me.map(ue=>ue.id===H?{...ue,status:"blocked"}:ue)),l({type:"success",text:"Usuario bloqueado exitosamente"}))},w=H=>{window.confirm("¿Estás seguro de que quieres desbloquear este usuario?")&&(d(me=>me.map(ue=>ue.id===H?{...ue,status:"active"}:ue)),l({type:"success",text:"Usuario desbloqueado exitosamente"}))},I=H=>{if(u.find(ue=>ue.id===H).isSuperAdmin){l({type:"error",text:"No puedes eliminar un Super Administrador"});return}window.confirm("¿Estás seguro de que quieres eliminar este usuario? Esta acción no se puede deshacer.")&&(d(ue=>ue.filter(G=>G.id!==H)),l({type:"success",text:"Usuario eliminado exitosamente"}))},k=(H,me)=>{const ue=u.find(G=>G.id===H);if(ue.isSuperAdmin&&me!==z.SUPER_ADMIN){l({type:"error",text:"No puedes cambiar el rol de un Super Administrador"});return}window.confirm(`¿Estás seguro de que quieres cambiar el rol de ${ue.displayName} a ${cr[me]}?`)&&(d(G=>G.map(B=>B.id===H?{...B,role:me}:B)),l({type:"success",text:`Rol de ${ue.displayName} cambiado a ${cr[me]}`}))},D=H=>new Date(H).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),L=H=>new Date(H)<new Date,j=H=>{switch(H){case"active":return"bg-green-500";case"blocked":return"bg-red-500";case"pending":return"bg-yellow-500";default:return"bg-gray-500"}},ce=H=>{switch(H){case"active":return"Activo";case"blocked":return"Bloqueado";case"pending":return"Pendiente";default:return"Desconocido"}};return o.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Panel de Administración"}),o.jsx("p",{className:"text-gray-600",children:"Gestiona usuarios y permisos del sistema"})]}),a.text&&o.jsx("div",{className:`p-4 rounded-lg flex items-center space-x-2 mb-6 ${a.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:o.jsx("span",{className:"text-sm font-medium",children:a.text})}),o.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg mb-8",children:[o.jsx("button",{onClick:()=>R("users"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 ${b==="users"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx(_a,{className:"h-4 w-4"}),o.jsxs("span",{children:["Usuarios (",u.length,")"]})]})}),o.jsx("button",{onClick:()=>R("invitations"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 ${b==="invitations"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx(rl,{className:"h-4 w-4"}),o.jsxs("span",{children:["Invitaciones (",f.length,")"]})]})})]}),b==="users"&&o.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(_a,{className:"h-6 w-6 text-blue-600"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Gestión de Usuarios"})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[u.filter(H=>H.status==="active").length," activos, ",u.filter(H=>H.status==="blocked").length," bloqueados"]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha de Creación"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Último Acceso"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(H=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center",children:o.jsx(Yn,{className:"h-5 w-5 text-white"})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.displayName}),o.jsx("div",{className:"text-sm text-gray-500",children:H.email}),o.jsxs("div",{className:"text-xs text-gray-400",children:["@",H.username]})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ui[H.role]||"bg-gray-500 text-white"}`,children:[o.jsx(Kn,{className:"h-3 w-3 mr-1"}),cr[H.role]||H.role]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${j(H.status)} text-white`,children:ce(H.status)})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.createdAt}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.lastLogin}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[o.jsx("button",{onClick:()=>k(H.id,z.POLLITO),className:"text-blue-600 hover:text-blue-900 p-1",title:"Cambiar a Pollito",children:o.jsx(Kn,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>k(H.id,z.USER),className:"text-green-600 hover:text-green-900 p-1",title:"Cambiar a Soldado",children:o.jsx(Kn,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>k(H.id,z.MAESE),className:"text-purple-600 hover:text-purple-900 p-1",title:"Cambiar a Maese",children:o.jsx(Kn,{className:"h-4 w-4"})}),H.status==="active"?o.jsx("button",{onClick:()=>N(H.id),className:"text-red-600 hover:text-red-900 p-1",title:"Bloquear usuario",children:o.jsx(Z5,{className:"h-4 w-4"})}):o.jsx("button",{onClick:()=>w(H.id),className:"text-green-600 hover:text-green-900 p-1",title:"Desbloquear usuario",children:o.jsx(_D,{className:"h-4 w-4"})}),!H.isSuperAdmin&&o.jsx("button",{onClick:()=>I(H.id),className:"text-red-600 hover:text-red-900 p-1",title:"Eliminar usuario",children:o.jsx(ks,{className:"h-4 w-4"})})]})})]},H.id))})]})})]}),b==="invitations"&&o.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[o.jsx(rl,{className:"h-6 w-6 text-blue-600"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Crear Invitación"})]}),o.jsxs("form",{onSubmit:A,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo electrónico"}),o.jsxs("div",{className:"relative",children:[o.jsx(Rh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:T.email,onChange:y,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"usuario@email.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo"}),o.jsxs("div",{className:"relative",children:[o.jsx(Yn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{id:"displayName",name:"displayName",type:"text",required:!0,value:T.displayName,onChange:y,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Nombre completo"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de usuario"}),o.jsxs("div",{className:"relative",children:[o.jsx(Yn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:T.username,onChange:y,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"nombreusuario",pattern:"[a-zA-Z0-9_]+",title:"Solo letras, números y guiones bajos"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),o.jsxs("div",{className:"relative",children:[o.jsx(Kn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsxs("select",{id:"role",name:"role",value:T.role,onChange:y,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[o.jsx("option",{value:z.POLLITO,children:"Pollito (Nivel 1)"}),o.jsx("option",{value:z.USER,children:"Soldado (Nivel 2)"}),o.jsx("option",{value:z.MAESE,children:"Maese (Nivel 3)"}),e&&o.jsx("option",{value:z.SUPER_ADMIN,children:"Super Administrador (Nivel 4)"})]})]}),o.jsx("div",{className:"mt-2",children:o.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ui[T.role]||"bg-gray-500 text-white"}`,children:[o.jsx(Kn,{className:"h-3 w-3 mr-1"}),cr[T.role]||T.role]})})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"expiresIn",className:"block text-sm font-medium text-gray-700 mb-1",children:"Expira en (días)"}),o.jsxs("div",{className:"relative",children:[o.jsx(uD,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsxs("select",{id:"expiresIn",name:"expiresIn",value:T.expiresIn,onChange:y,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[o.jsx("option",{value:"1",children:"1 día"}),o.jsx("option",{value:"3",children:"3 días"}),o.jsx("option",{value:"7",children:"7 días"}),o.jsx("option",{value:"14",children:"14 días"}),o.jsx("option",{value:"30",children:"30 días"})]})]})]}),o.jsx("button",{type:"submit",disabled:s,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:s?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Procesando..."})]}):o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(rl,{className:"h-4 w-4"}),o.jsx("span",{children:"Crear Invitación"})]})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[o.jsx(rl,{className:"h-6 w-6 text-green-600"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Invitaciones Activas"})]}),o.jsx("div",{className:"space-y-4",children:f.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(rl,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"No hay invitaciones creadas aún"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Las invitaciones que crees aparecerán aquí"})]}):f.map(H=>o.jsxs("div",{className:`p-4 border rounded-lg ${L(H.expiresAt)?"border-red-200 bg-red-50":"border-gray-200"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center",children:o.jsx(Yn,{className:"h-5 w-5 text-white"})}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:H.displayName}),o.jsx("p",{className:"text-sm text-gray-500",children:H.email}),o.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mt-1 ${ui[H.role]||"bg-gray-500 text-white"}`,children:[o.jsx(Kn,{className:"h-3 w-3 mr-1"}),cr[H.role]||H.role]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>P(H.invitationUrl),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Copiar enlace de invitación",children:g===H.invitationUrl?o.jsx(tD,{className:"h-4 w-4"}):o.jsx(iD,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>O(H.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar invitación",children:o.jsx(ks,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-xs text-gray-600 mb-2",children:o.jsx("strong",{children:"Enlace de invitación:"})}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"text",value:H.invitationUrl,readOnly:!0,className:"flex-1 text-xs bg-white border border-gray-300 rounded px-2 py-1"}),o.jsx("button",{onClick:()=>P(H.invitationUrl),className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 transition-colors",children:g===H.invitationUrl?"Copiado!":"Copiar"})]}),o.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Expira: ",D(H.expiresAt),L(H.expiresAt)&&o.jsx("span",{className:"text-red-500 ml-2",children:"(Expirada)"})]})]})]},H.id))})]})]}),o.jsx("div",{className:"mt-8 bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Oc,{className:"h-8 w-8 text-purple-600"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-purple-800",children:"Panel de Administración Completo"}),o.jsx("p",{className:"text-sm text-purple-600",children:"Gestiona usuarios existentes, crea invitaciones únicas y controla el acceso al sistema. Como Super Administrador tienes control total sobre roles, permisos y estado de usuarios."})]})]})})]})},oO=()=>{const[t,e]=S.useState(!1),[n,r]=S.useState(!1),[s,i]=S.useState({type:"",text:""}),[a,l]=S.useState({email:"",password:""}),{login:u,loginWithGoogle:d}=gr(),f=x=>{l({...a,[x.target.name]:x.target.value})},m=async x=>{x.preventDefault(),r(!0),i({type:"",text:""});try{const b=await u(a.email,a.password);b.success?(i({type:"success",text:"¡Inicio de sesión exitoso!"}),l({email:"",password:""})):i({type:"error",text:b.error})}catch(b){i({type:"error",text:b.message})}finally{r(!1)}},g=async()=>{r(!0),i({type:"",text:""});try{const x=await d();x.success?i({type:"success",text:"¡Inicio de sesión con Google exitoso!"}):i({type:"error",text:x.error})}catch(x){i({type:"error",text:x.message})}finally{r(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-orange-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-md w-full space-y-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Iniciar Sesión"}),o.jsx("p",{className:"text-gray-600",children:"Accede a tu cuenta de SalsaHacks"})]}),s.text&&o.jsxs("div",{className:`p-4 rounded-lg flex items-center space-x-2 ${s.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:[s.type==="success"?o.jsx(yi,{className:"h-5 w-5"}):o.jsx(Ts,{className:"h-5 w-5"}),o.jsx("span",{className:"text-sm font-medium",children:s.text})]}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Oc,{className:"h-5 w-5 text-blue-600"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Registro por Invitación"}),o.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"El registro de nuevas cuentas está restringido. Solo el Super Administrador puede crear nuevas cuentas con roles específicos."})]})]})}),o.jsxs("form",{className:"mt-8 space-y-6",onSubmit:m,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo electrónico"}),o.jsxs("div",{className:"relative",children:[o.jsx(Rh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:a.email,onChange:f,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200",placeholder:"tu@email.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña"}),o.jsxs("div",{className:"relative",children:[o.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{id:"password",name:"password",type:t?"text":"password",required:!0,value:a.password,onChange:f,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200",placeholder:"••••••••",minLength:6}),o.jsx("button",{type:"button",onClick:()=>e(!t),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t?o.jsx(jh,{className:"h-5 w-5"}):o.jsx(Lc,{className:"h-5 w-5"})})]})]})]}),o.jsx("button",{type:"submit",disabled:n,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-pink-500 to-orange-500 hover:from-pink-600 hover:to-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:n?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Procesando..."})]}):"Iniciar Sesión"}),o.jsx("div",{className:"mt-4",children:o.jsxs("button",{type:"button",onClick:g,disabled:n,className:"w-full flex justify-center items-center py-3 px-4 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:[o.jsxs("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuar con Google"]})}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"¿Necesitas una cuenta? Contacta al Super Administrador"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Solo se pueden crear cuentas por invitación directa"})]})]})]})})},aO=()=>{const{user:t,userProfile:e,updateUserProfile:n,getUserUsername:r,getUserPhoto:s}=gr(),[i,a]=S.useState(!1),[l,u]=S.useState(!1),d=S.useRef(null),[f,m]=S.useState({displayName:(e==null?void 0:e.displayName)||"",bio:(e==null?void 0:e.bio)||"",location:(e==null?void 0:e.location)||"",phone:(e==null?void 0:e.phone)||"",photoURL:(e==null?void 0:e.photoURL)||"",username:(e==null?void 0:e.username)||""}),g=async T=>{const v=T.target.files[0];if(v){if(!v.type.startsWith("image/")){alert("Por favor selecciona una imagen válida");return}if(v.size>5*1024*1024){alert("La imagen debe ser menor a 5MB");return}u(!0);try{const _=new FileReader;_.onload=y=>{m({...f,photoURL:y.target.result}),u(!1)},_.readAsDataURL(v)}catch(_){console.error("Error al subir foto:",_),u(!1)}}},x=async()=>{try{const T=await n(f);T.success?a(!1):alert("Error al actualizar perfil: "+T.error)}catch(T){console.error("Error al actualizar perfil:",T),alert("Error al actualizar perfil")}},b=()=>{m({displayName:(e==null?void 0:e.displayName)||"",bio:(e==null?void 0:e.bio)||"",location:(e==null?void 0:e.location)||"",phone:(e==null?void 0:e.phone)||"",photoURL:(e==null?void 0:e.photoURL)||"",username:(e==null?void 0:e.username)||""}),a(!1)},R=async()=>{try{console.log("Actualizando rol a Super Admin..."),console.log("Rol actual:",e==null?void 0:e.role),console.log("Email:",t.email);const T=await n({...e,role:z.SUPER_ADMIN,permissions:["MANAGE_USERS","MANAGE_SYSTEM","ACCESS_PREMIUM_CONTENT","UPLOAD_VIDEOS","DELETE_CONTENT"]});T.success?(alert("¡Rol actualizado a Super Administrador! Recargando página..."),setTimeout(()=>{window.location.reload()},1e3)):alert("Error al actualizar rol: "+T.error)}catch(T){console.error("Error al actualizar rol:",T),alert("Error al actualizar rol: "+T.message)}};return t?o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"}),o.jsxs("div",{className:"flex space-x-2",children:[t.email==="david_exile_92@hotmail.com"&&o.jsxs("div",{className:"text-xs text-gray-500 mr-4",children:[o.jsxs("p",{children:["Email: ",t.email]}),o.jsxs("p",{children:["Rol actual: ",(e==null?void 0:e.role)||"No definido"]}),o.jsxs("p",{children:["Es Super Admin: ",(e==null?void 0:e.role)===z.SUPER_ADMIN?"SÍ":"NO"]})]}),t.email==="david_exile_92@hotmail.com"&&(e==null?void 0:e.role)!==z.SUPER_ADMIN&&o.jsxs("button",{onClick:R,className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[o.jsx(Vc,{className:"h-4 w-4"}),o.jsx("span",{children:"Actualizar a Super Admin"})]}),i?o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:x,className:"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[o.jsx(Bd,{className:"h-4 w-4"}),o.jsx("span",{children:"Guardar"})]}),o.jsxs("button",{onClick:b,className:"flex items-center space-x-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:[o.jsx(Cr,{className:"h-4 w-4"}),o.jsx("span",{children:"Cancelar"})]})]}):o.jsxs("button",{onClick:()=>a(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[o.jsx(cc,{className:"h-4 w-4"}),o.jsx("span",{children:"Editar"})]})]})]})}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[o.jsx("div",{className:"md:col-span-1",children:o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"relative inline-block mb-4",children:[o.jsx("div",{className:"w-32 h-32 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:s()?o.jsx("img",{src:s(),alt:"Foto de perfil",className:"w-32 h-32 object-cover"}):o.jsx(Yn,{className:"h-16 w-16 text-white"})}),i&&o.jsxs("div",{className:"absolute bottom-0 right-0",children:[o.jsx("button",{onClick:()=>{var T;return(T=d.current)==null?void 0:T.click()},disabled:l,className:"w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors shadow-lg",children:l?o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):o.jsx(eD,{className:"h-4 w-4"})}),o.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:g,className:"hidden"})]})]}),i?o.jsx("input",{type:"text",value:f.displayName,onChange:T=>m({...f,displayName:T.target.value}),className:"text-2xl font-semibold text-gray-800 mb-2 bg-transparent border-b border-gray-300 focus:border-blue-500 outline-none text-center",placeholder:"Tu nombre"}):o.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:(e==null?void 0:e.displayName)||t.displayName||"Usuario"}),o.jsx("p",{className:"text-gray-600 mb-4",children:t.email}),(e==null?void 0:e.role)&&o.jsx("div",{className:"mb-4",children:o.jsxs("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${ui[e.role]||"bg-gray-500 text-white"}`,children:[o.jsx(Kn,{className:"h-4 w-4 mr-2"}),cr[e.role]||e.role]})}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Nombre de usuario"}),i?o.jsx("input",{type:"text",value:f.username,onChange:T=>m({...f,username:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none text-center",placeholder:"nombreusuario",pattern:"[a-zA-Z0-9_]+",title:"Solo letras, números y guiones bajos"}):o.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:o.jsx("span",{className:"text-gray-700 font-medium",children:r()})})]})]})}),o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[o.jsx(Yn,{className:"h-5 w-5 mr-2"}),"Información Básica"]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[o.jsx(Rh,{className:"h-4 w-4 text-gray-500"}),o.jsx("span",{className:"text-gray-700",children:t.email})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Miembro desde"}),o.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[o.jsx(Oa,{className:"h-4 w-4 text-gray-500"}),o.jsx("span",{className:"text-gray-700",children:e!=null&&e.createdAt?new Date(e.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"Fecha no disponible"})]})]})]})]}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[o.jsx(Mc,{className:"h-5 w-5 mr-2"}),"Información Adicional"]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ubicación"}),i?o.jsx("input",{type:"text",value:f.location,onChange:T=>m({...f,location:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu ubicación"}):o.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:o.jsx("span",{className:"text-gray-700",children:(e==null?void 0:e.location)||"No especificada"})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono"}),i?o.jsx("input",{type:"tel",value:f.phone,onChange:T=>m({...f,phone:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu teléfono"}):o.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:o.jsx("span",{className:"text-gray-700",children:(e==null?void 0:e.phone)||"No especificado"})})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biografía"}),i?o.jsx("textarea",{value:f.bio,onChange:T=>m({...f,bio:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none min-h-[100px] resize-vertical",placeholder:"Cuéntanos sobre ti..."}):o.jsx("div",{className:"p-3 bg-gray-50 rounded-lg min-h-[100px]",children:o.jsx("span",{className:"text-gray-700",children:(e==null?void 0:e.bio)||"No hay biografía disponible"})})]})]}),(e==null?void 0:e.permissions)&&e.permissions.length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[o.jsx(Oc,{className:"h-5 w-5 mr-2"}),"Mis Permisos"]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:e.permissions.map((T,v)=>o.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full font-medium",children:T.replace(/_/g," ")},v))})]})]})})]})})]})}):o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Perfil de Usuario"}),o.jsx("p",{className:"text-gray-600",children:"Debes iniciar sesión para ver tu perfil"})]})})},lO=()=>{const{user:t,userProfile:e,updateUserProfile:n}=gr(),{theme:r,changeTheme:s}=gb(),[i,a]=S.useState("profile"),[l,u]=S.useState(!1),[d,f]=S.useState({displayName:(e==null?void 0:e.displayName)||"",bio:(e==null?void 0:e.bio)||"",location:(e==null?void 0:e.location)||"",phone:(e==null?void 0:e.phone)||""}),[m,g]=S.useState({email:!0,push:!0,events:!0,updates:!1}),x=async()=>{try{await n(d),alert("Perfil actualizado correctamente")}catch(T){console.error("Error al actualizar perfil:",T),alert("Error al actualizar el perfil")}},b=()=>{alert("Preferencias de notificaciones guardadas")},R=[{id:"profile",label:"Perfil",icon:Yn},{id:"notifications",label:"Notificaciones",icon:lS},{id:"appearance",label:"Apariencia",icon:xD},{id:"security",label:"Seguridad",icon:xa}];return t?o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200",children:[o.jsx("div",{className:"p-6 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Mc,{className:"h-8 w-8 text-salsa-primary"}),o.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Configuración"})]})}),o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"w-64 border-r border-gray-200",children:o.jsx("nav",{className:"p-4",children:R.map(T=>{const v=T.icon;return o.jsxs("button",{onClick:()=>a(T.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg mb-2 transition-colors ${i===T.id?"bg-salsa-primary text-white":"text-gray-700 hover:bg-gray-100"}`,children:[o.jsx(v,{className:"h-5 w-5"}),o.jsx("span",{children:T.label})]},T.id)})})}),o.jsxs("div",{className:"flex-1 p-6",children:[i==="profile"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Información del Perfil"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de usuario"}),o.jsx("input",{type:"text",value:d.displayName,onChange:T=>f({...d,displayName:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu nombre de usuario"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Biografía"}),o.jsx("textarea",{value:d.bio,onChange:T=>f({...d,bio:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none min-h-[100px] resize-vertical",placeholder:"Cuéntanos sobre ti..."})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ubicación"}),o.jsx("input",{type:"text",value:d.location,onChange:T=>f({...d,location:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu ubicación"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono"}),o.jsx("input",{type:"tel",value:d.phone,onChange:T=>f({...d,phone:T.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu teléfono"})]})]}),o.jsxs("button",{onClick:x,className:"flex items-center space-x-2 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[o.jsx(Bd,{className:"h-4 w-4"}),o.jsx("span",{children:"Guardar Cambios"})]})]})]}),i==="notifications"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Preferencias de Notificaciones"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-gray-800",children:"Notificaciones por email"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Recibe actualizaciones importantes por email"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:m.email,onChange:T=>g({...m,email:T.target.checked}),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-gray-800",children:"Notificaciones push"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Recibe notificaciones en tiempo real"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:m.push,onChange:T=>g({...m,push:T.target.checked}),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-gray-800",children:"Eventos y talleres"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Notificaciones sobre nuevos eventos"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:m.events,onChange:T=>g({...m,events:T.target.checked}),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-gray-800",children:"Actualizaciones del sistema"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Notificaciones sobre nuevas funcionalidades"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:m.updates,onChange:T=>g({...m,updates:T.target.checked}),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),o.jsxs("button",{onClick:b,className:"flex items-center space-x-2 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[o.jsx(Bd,{className:"h-4 w-4"}),o.jsx("span",{children:"Guardar Preferencias"})]})]})]}),i==="appearance"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Apariencia"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Tema de la aplicación"}),o.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:["light","dark","salsa"].map(T=>o.jsx("button",{onClick:()=>s(T),className:`p-4 border-2 rounded-lg transition-colors ${r===T?"border-salsa-primary bg-salsa-light":"border-gray-200 hover:border-gray-300"}`,children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:`w-8 h-8 rounded-full mx-auto mb-2 ${T==="light"?"bg-gray-200":T==="dark"?"bg-gray-800":"bg-gradient-to-r from-pink-500 to-orange-500"}`}),o.jsx("span",{className:"font-medium capitalize",children:T})]})},T))})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Tamaño de fuente"}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Pequeño"}),o.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Mediano"}),o.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Grande"})]})]})]})]}),i==="security"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Seguridad"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Cambiar contraseña"}),o.jsxs("div",{className:"space-y-4 max-w-md",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contraseña actual"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:l?"text":"password",className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none pr-10",placeholder:"Tu contraseña actual"}),o.jsx("button",{type:"button",onClick:()=>u(!l),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:l?o.jsx(jh,{className:"h-5 w-5 text-gray-400"}):o.jsx(Lc,{className:"h-5 w-5 text-gray-400"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nueva contraseña"}),o.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Nueva contraseña"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar nueva contraseña"}),o.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Confirmar nueva contraseña"})]}),o.jsxs("button",{className:"flex items-center space-x-2 px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[o.jsx(xa,{className:"h-4 w-4"}),o.jsx("span",{children:"Cambiar Contraseña"})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Sesiones activas"}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsx("p",{className:"text-sm text-gray-600",children:"No hay sesiones activas para mostrar"})})]})]})]})]})]})]})}):o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Configuración"}),o.jsx("p",{className:"text-gray-600",children:"Debes iniciar sesión para acceder a la configuración"})]})})},cO=()=>{var y,A,P;const{invitationCode:t}=OT(),e=ub(),{validateInvitation:n,createUserByInvitation:r}=gr(),[s,i]=S.useState(!0),[a,l]=S.useState(!1),[u,d]=S.useState(!1),[f,m]=S.useState({type:"",text:""}),[g,x]=S.useState(null),[b,R]=S.useState({password:"",confirmPassword:""});S.useEffect(()=>{T()},[t]);const T=async()=>{try{const O=await n(t);O.success?(x(O.invitation),m({type:"",text:""})):m({type:"error",text:O.error})}catch{m({type:"error",text:"Error al validar la invitación"})}finally{i(!1)}},v=O=>{R({...b,[O.target.name]:O.target.value})},_=async O=>{if(O.preventDefault(),l(!0),m({type:"",text:""}),b.password!==b.confirmPassword){m({type:"error",text:"Las contraseñas no coinciden"}),l(!1);return}if(b.password.length<6){m({type:"error",text:"La contraseña debe tener al menos 6 caracteres"}),l(!1);return}try{const N=await r(t,b.password);N.success?(m({type:"success",text:"¡Cuenta creada exitosamente! Redirigiendo..."}),setTimeout(()=>{e("/auth")},2e3)):m({type:"error",text:N.error})}catch(N){m({type:"error",text:N.message})}finally{l(!1)}};return s?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-orange-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Validando invitación..."})]})}):g?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-orange-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-md w-full space-y-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center mb-4",children:o.jsx(Oc,{className:"h-8 w-8 text-white"})}),o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"¡Bienvenido a SalsaHacks!"}),o.jsx("p",{className:"text-gray-600",children:"Completa tu registro para acceder a la plataforma"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx(Yn,{className:"h-8 w-8 text-blue-600"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:g.displayName}),o.jsx("p",{className:"text-sm text-gray-500",children:g.email})]})]}),o.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[o.jsx(Kn,{className:"h-5 w-5 text-gray-400"}),o.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${ui[g.role]||"bg-gray-500 text-white"}`,children:cr[g.role]||g.role})]}),o.jsxs("div",{className:"text-xs text-gray-500",children:[o.jsxs("p",{children:["Usuario: ",o.jsx("strong",{children:g.username})]}),o.jsxs("p",{children:["Expira: ",o.jsx("strong",{children:((P=(A=(y=g.expiresAt)==null?void 0:y.toDate)==null?void 0:A.call(y))==null?void 0:P.toLocaleDateString("es-ES"))||"Próximamente"})]})]})]}),f.text&&o.jsxs("div",{className:`p-4 rounded-lg flex items-center space-x-2 ${f.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:[f.type==="success"?o.jsx(yi,{className:"h-5 w-5"}):o.jsx(Ts,{className:"h-5 w-5"}),o.jsx("span",{className:"text-sm font-medium",children:f.text})]}),o.jsxs("form",{className:"mt-8 space-y-6",onSubmit:_,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña"}),o.jsxs("div",{className:"relative",children:[o.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{id:"password",name:"password",type:u?"text":"password",required:!0,value:b.password,onChange:v,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200",placeholder:"••••••••",minLength:6}),o.jsx("button",{type:"button",onClick:()=>d(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:u?o.jsx(jh,{className:"h-5 w-5"}):o.jsx(Lc,{className:"h-5 w-5"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Contraseña"}),o.jsxs("div",{className:"relative",children:[o.jsx(xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:u?"text":"password",required:!0,value:b.confirmPassword,onChange:v,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200",placeholder:"••••••••",minLength:6})]})]})]}),o.jsx("button",{type:"submit",disabled:a,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-pink-500 to-orange-500 hover:from-pink-600 hover:to-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:a?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Creando cuenta..."})]}):o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{children:"Crear Cuenta"}),o.jsx(J5,{className:"h-4 w-4"})]})})]}),o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-xs text-gray-500",children:"Al crear tu cuenta, aceptas los términos y condiciones de SalsaHacks"})})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-orange-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"max-w-md w-full space-y-8",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ts,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Invitación Inválida"}),o.jsx("p",{className:"text-gray-600 mb-6",children:f.text||"Esta invitación no es válida o ha expirado"}),o.jsx("button",{onClick:()=>e("/auth"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-pink-500 to-orange-500 hover:from-pink-600 hover:to-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 transition-all duration-200",children:"Ir al Login"})]})})})};function uO(){const e=Ta().pathname==="/figuras";return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-salsa-light to-white",children:[o.jsx(ED,{}),o.jsx("main",{className:e?"w-full":"container mx-auto px-4 py-8",children:o.jsxs(YT,{children:[o.jsx(or,{path:"/",element:o.jsx(ND,{})}),o.jsx(or,{path:"/auth",element:o.jsx(oO,{})}),o.jsx(or,{path:"/invite/:invitationCode",element:o.jsx(cO,{})}),o.jsx(or,{path:"/profile",element:o.jsx(aO,{})}),o.jsx(or,{path:"/settings",element:o.jsx(lO,{})}),o.jsx(or,{path:"/notas",element:o.jsx(TD,{})}),o.jsx(or,{path:"/categorias",element:o.jsx(ID,{})}),o.jsx(or,{path:"/figuras",element:o.jsx(nO,{})}),o.jsx(or,{path:"/escuela",element:o.jsx(rO,{})}),o.jsx(or,{path:"/eventos",element:o.jsx(sO,{})}),o.jsx(or,{path:"/admin",element:o.jsx(iO,{})})]})})]})}function dO(){return o.jsx(lI,{children:o.jsx(G5,{children:o.jsx(K5,{children:o.jsx(Q5,{children:o.jsx(sI,{children:o.jsx(uO,{})})})})})})}Ku.createRoot(document.getElementById("root")).render(o.jsx(hp.StrictMode,{children:o.jsx(dO,{})}));export{fO as c,jS as g};
//# sourceMappingURL=index-D8LJyKuh.js.map
