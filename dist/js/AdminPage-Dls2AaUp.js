var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,n=(e,s)=>{for(var t in s||(s={}))r.call(s,t)&&l(e,t,s[t]);if(a)for(var t of a(s))i.call(s,t)&&l(e,t,s[t]);return e},d=(e,a)=>s(e,t(a)),o=(e,s,t)=>new Promise((a,r)=>{var i=e=>{try{n(t.next(e))}catch(s){r(s)}},l=e=>{try{n(t.throw(e))}catch(s){r(s)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,l);n((t=t.apply(e,s)).next())});import{u as c,R as m,j as x,n as u,o as p}from"../assets/index-Chz8dIcY.js";import{r as h}from"./vendor-react-4yEUTM44.js";import{LucideUsers as g,Link as b,LucideUser as j,LucideShield as y,Ban as N,LucideUnlock as v,LucideTrash2 as f,LucideMail as w,Key as A,Check as S,Copy as k,Crown as E}from"./vendor-icons-DyUK-N1U.js";import"./vendor-router-Bt5THCHr.js";import"./vendor-firebase-DVYjp8kH.js";const C=()=>{const{userProfile:e,isSuperAdmin:s,hasPermission:t,createInvitation:a}=c(),[r,i]=h.useState(!1),[l,C]=h.useState({type:"",text:""}),[I,P]=h.useState([]),[L,U]=h.useState([]),[q,O]=h.useState(null),[D,M]=h.useState("users"),[R,T]=h.useState({email:"",displayName:"",username:"",role:m.POLLITO,expiresIn:"7"}),F=[{id:"YvT9KXqQA5TQbAmAe4IFkYh0LDY2",email:"david_exile_92@hotmail.com",displayName:"David",username:"david",role:m.SUPER_ADMIN,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!0},{id:"gkjNUPbjpUbGGVArXEO3Izxn",email:"admin@salsahacks.com",displayName:"Admin",username:"admin",role:m.SUPER_ADMIN,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!0},{id:"IM3g8N6XuyQKFLwozPqv6Ei1",email:"maese@salsahacks.com",displayName:"Maese",username:"maese",role:m.MAESE,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!1},{id:"hljlH3bbIDS6hwPZ9fzfFnzbOk",email:"soldado@salsahacks.com",displayName:"Soldado",username:"soldado",role:m.USER,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!1},{id:"plJ9SnLFEKdJHZunlbATscuW",email:"pollito@salsahacks.com",displayName:"Pollito",username:"pollito",role:m.POLLITO,createdAt:"2025-01-27",lastLogin:"2025-01-27",status:"active",isSuperAdmin:!1}];if(h.useEffect(()=>{P(F)},[]),!s&&!t("MANAGE_USERS"))return x.jsx("div",{className:"max-w-4xl mx-auto p-6",children:x.jsxs("div",{className:"text-center",children:[x.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Acceso Denegado"}),x.jsx("p",{className:"text-gray-600",children:"No tienes permisos para acceder a esta página"})]})});const $=e=>{T(d(n({},R),{[e.target.name]:e.target.value}))},_=e=>o(void 0,null,function*(){try{yield navigator.clipboard.writeText(e),O(e),setTimeout(()=>O(null),2e3)}catch(s){const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),O(e),setTimeout(()=>O(null),2e3)}}),G=(e,s)=>{const t=I.find(s=>s.id===e);t.isSuperAdmin&&s!==m.SUPER_ADMIN?C({type:"error",text:"No puedes cambiar el rol de un Super Administrador"}):window.confirm(`¿Estás seguro de que quieres cambiar el rol de ${t.displayName} a ${u[s]}?`)&&(P(t=>t.map(t=>t.id===e?d(n({},t),{role:s}):t)),C({type:"success",text:`Rol de ${t.displayName} cambiado a ${u[s]}`}))},z=e=>new Date(e)<new Date,K=e=>{switch(e){case"active":return"bg-green-500";case"blocked":return"bg-red-500";case"pending":return"bg-yellow-500";default:return"bg-gray-500"}},Q=e=>{switch(e){case"active":return"Activo";case"blocked":return"Bloqueado";case"pending":return"Pendiente";default:return"Desconocido"}};return x.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[x.jsxs("div",{className:"mb-8",children:[x.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Panel de Administración"}),x.jsx("p",{className:"text-gray-600",children:"Gestiona usuarios y permisos del sistema"})]}),l.text&&x.jsx("div",{className:"p-4 rounded-lg flex items-center space-x-2 mb-6 "+("success"===l.type?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"),children:x.jsx("span",{className:"text-sm font-medium",children:l.text})}),x.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg mb-8",children:[x.jsx("button",{onClick:()=>M("users"),className:"flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 "+("users"===D?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:x.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[x.jsx(g,{className:"h-4 w-4"}),x.jsxs("span",{children:["Usuarios (",I.length,")"]})]})}),x.jsx("button",{onClick:()=>M("invitations"),className:"flex-1 py-2 px-4 rounded-md font-medium transition-all duration-200 "+("invitations"===D?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:x.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[x.jsx(b,{className:"h-4 w-4"}),x.jsxs("span",{children:["Invitaciones (",L.length,")"]})]})})]}),"users"===D&&x.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx(g,{className:"h-6 w-6 text-blue-600"}),x.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Gestión de Usuarios"})]}),x.jsxs("div",{className:"text-sm text-gray-500",children:[I.filter(e=>"active"===e.status).length," activos, ",I.filter(e=>"blocked"===e.status).length," bloqueados"]})]}),x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[x.jsx("thead",{className:"bg-gray-50",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha de Creación"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Último Acceso"}),x.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),x.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.map(e=>x.jsxs("tr",{className:"hover:bg-gray-50",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center",children:x.jsx(j,{className:"h-5 w-5 text-white"})}),x.jsxs("div",{className:"ml-4",children:[x.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.displayName}),x.jsx("div",{className:"text-sm text-gray-500",children:e.email}),x.jsxs("div",{className:"text-xs text-gray-400",children:["@",e.username]})]})]})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p[e.role]||"bg-gray-500 text-white"}`,children:[x.jsx(y,{className:"h-3 w-3 mr-1"}),u[e.role]||e.role]})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${K(e.status)} text-white`,children:Q(e.status)})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.createdAt}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.lastLogin}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:x.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[x.jsx("button",{onClick:()=>G(e.id,m.POLLITO),className:"text-blue-600 hover:text-blue-900 p-1",title:"Cambiar a Pollito",children:x.jsx(y,{className:"h-4 w-4"})}),x.jsx("button",{onClick:()=>G(e.id,m.USER),className:"text-green-600 hover:text-green-900 p-1",title:"Cambiar a Soldado",children:x.jsx(y,{className:"h-4 w-4"})}),x.jsx("button",{onClick:()=>G(e.id,m.MAESE),className:"text-purple-600 hover:text-purple-900 p-1",title:"Cambiar a Maese",children:x.jsx(y,{className:"h-4 w-4"})}),"active"===e.status?x.jsx("button",{onClick:()=>{return s=e.id,void(window.confirm("¿Estás seguro de que quieres bloquear este usuario?")&&(P(e=>e.map(e=>e.id===s?d(n({},e),{status:"blocked"}):e)),C({type:"success",text:"Usuario bloqueado exitosamente"})));var s},className:"text-red-600 hover:text-red-900 p-1",title:"Bloquear usuario",children:x.jsx(N,{className:"h-4 w-4"})}):x.jsx("button",{onClick:()=>{return s=e.id,void(window.confirm("¿Estás seguro de que quieres desbloquear este usuario?")&&(P(e=>e.map(e=>e.id===s?d(n({},e),{status:"active"}):e)),C({type:"success",text:"Usuario desbloqueado exitosamente"})));var s},className:"text-green-600 hover:text-green-900 p-1",title:"Desbloquear usuario",children:x.jsx(v,{className:"h-4 w-4"})}),!e.isSuperAdmin&&x.jsx("button",{onClick:()=>{return s=e.id,void(I.find(e=>e.id===s).isSuperAdmin?C({type:"error",text:"No puedes eliminar un Super Administrador"}):window.confirm("¿Estás seguro de que quieres eliminar este usuario? Esta acción no se puede deshacer.")&&(P(e=>e.filter(e=>e.id!==s)),C({type:"success",text:"Usuario eliminado exitosamente"})));var s},className:"text-red-600 hover:text-red-900 p-1",title:"Eliminar usuario",children:x.jsx(f,{className:"h-4 w-4"})})]})})]},e.id))})]})})]}),"invitations"===D&&x.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[x.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[x.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[x.jsx(b,{className:"h-6 w-6 text-blue-600"}),x.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Crear Invitación"})]}),x.jsxs("form",{onSubmit:e=>o(void 0,null,function*(){e.preventDefault(),i(!0),C({type:"",text:""});try{const e=yield a(R.email,R.displayName,R.role,R.username,parseInt(R.expiresIn));if(e.success){const s=d(n({id:Date.now()},R),{invitationCode:e.invitationCode,invitationUrl:e.invitationUrl,createdAt:new Date,status:"pending",expiresAt:new Date(Date.now()+24*parseInt(R.expiresIn)*60*60*1e3)});U(e=>[...e,s]),T({email:"",displayName:"",username:"",role:m.POLLITO,expiresIn:"7"}),C({type:"success",text:`Invitación creada exitosamente para ${R.displayName} con rol de ${u[R.role]}`})}else C({type:"error",text:e.error})}catch(s){C({type:"error",text:s.message})}finally{i(!1)}}),className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo electrónico"}),x.jsxs("div",{className:"relative",children:[x.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),x.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:R.email,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"usuario@email.com"})]})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo"}),x.jsxs("div",{className:"relative",children:[x.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),x.jsx("input",{id:"displayName",name:"displayName",type:"text",required:!0,value:R.displayName,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Nombre completo"})]})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de usuario"}),x.jsxs("div",{className:"relative",children:[x.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),x.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:R.username,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"nombreusuario",pattern:"[a-zA-Z0-9_]+",title:"Solo letras, números y guiones bajos"})]})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),x.jsxs("div",{className:"relative",children:[x.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),x.jsxs("select",{id:"role",name:"role",value:R.role,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[x.jsx("option",{value:m.POLLITO,children:"Pollito (Nivel 1)"}),x.jsx("option",{value:m.USER,children:"Soldado (Nivel 2)"}),x.jsx("option",{value:m.MAESE,children:"Maese (Nivel 3)"}),s&&x.jsx("option",{value:m.SUPER_ADMIN,children:"Super Administrador (Nivel 4)"})]})]}),x.jsx("div",{className:"mt-2",children:x.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p[R.role]||"bg-gray-500 text-white"}`,children:[x.jsx(y,{className:"h-3 w-3 mr-1"}),u[R.role]||R.role]})})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"expiresIn",className:"block text-sm font-medium text-gray-700 mb-1",children:"Expira en (días)"}),x.jsxs("div",{className:"relative",children:[x.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),x.jsxs("select",{id:"expiresIn",name:"expiresIn",value:R.expiresIn,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[x.jsx("option",{value:"1",children:"1 día"}),x.jsx("option",{value:"3",children:"3 días"}),x.jsx("option",{value:"7",children:"7 días"}),x.jsx("option",{value:"14",children:"14 días"}),x.jsx("option",{value:"30",children:"30 días"})]})]})]}),x.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),x.jsx("span",{children:"Procesando..."})]}):x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx(b,{className:"h-4 w-4"}),x.jsx("span",{children:"Crear Invitación"})]})})]})]}),x.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[x.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[x.jsx(b,{className:"h-6 w-6 text-green-600"}),x.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Invitaciones Activas"})]}),x.jsx("div",{className:"space-y-4",children:0===L.length?x.jsxs("div",{className:"text-center py-8",children:[x.jsx(b,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),x.jsx("p",{className:"text-gray-500",children:"No hay invitaciones creadas aún"}),x.jsx("p",{className:"text-sm text-gray-400",children:"Las invitaciones que crees aparecerán aquí"})]}):L.map(e=>{return x.jsxs("div",{className:"p-4 border rounded-lg "+(z(e.expiresAt)?"border-red-200 bg-red-50":"border-gray-200"),children:[x.jsxs("div",{className:"flex items-center justify-between mb-3",children:[x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center",children:x.jsx(j,{className:"h-5 w-5 text-white"})}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-gray-900",children:e.displayName}),x.jsx("p",{className:"text-sm text-gray-500",children:e.email}),x.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mt-1 ${p[e.role]||"bg-gray-500 text-white"}`,children:[x.jsx(y,{className:"h-3 w-3 mr-1"}),u[e.role]||e.role]})]})]}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("button",{onClick:()=>_(e.invitationUrl),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Copiar enlace de invitación",children:q===e.invitationUrl?x.jsx(S,{className:"h-4 w-4"}):x.jsx(k,{className:"h-4 w-4"})}),x.jsx("button",{onClick:()=>{return s=e.id,void(window.confirm("¿Estás seguro de que quieres eliminar esta invitación?")&&(U(e=>e.filter(e=>e.id!==s)),C({type:"success",text:"Invitación eliminada exitosamente"})));var s},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar invitación",children:x.jsx(f,{className:"h-4 w-4"})})]})]}),x.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[x.jsx("p",{className:"text-xs text-gray-600 mb-2",children:x.jsx("strong",{children:"Enlace de invitación:"})}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("input",{type:"text",value:e.invitationUrl,readOnly:!0,className:"flex-1 text-xs bg-white border border-gray-300 rounded px-2 py-1"}),x.jsx("button",{onClick:()=>_(e.invitationUrl),className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 transition-colors",children:q===e.invitationUrl?"Copiado!":"Copiar"})]}),x.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Expira: ",(s=e.expiresAt,new Date(s).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})),z(e.expiresAt)&&x.jsx("span",{className:"text-red-500 ml-2",children:"(Expirada)"})]})]})]},e.id);var s})})]})]}),x.jsx("div",{className:"mt-8 bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6",children:x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx(E,{className:"h-8 w-8 text-purple-600"}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-lg font-semibold text-purple-800",children:"Panel de Administración Completo"}),x.jsx("p",{className:"text-sm text-purple-600",children:"Gestiona usuarios existentes, crea invitaciones únicas y controla el acceso al sistema. Como Super Administrador tienes control total sobre roles, permisos y estado de usuarios."})]})]})})]})};export{C as default};
