const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/VideoUploadModal-D5RIWvhs.js","assets/index-BgmWhXhd.js","js/vendor-react-4yEUTM44.js","js/vendor-router-Bt5THCHr.js","js/vendor-firebase-DVYjp8kH.js","js/vendor-icons-DyUK-N1U.js","css/index-CLnZnxZk.css","js/index-Cef-5B3O.js","js/CompactCardActions-4ElLycK8.js","js/Toast-BchDI-us.js","js/VideoPlayer-D3jT_9FO.js","js/VideoEditModal-4npoNvWM.js","js/DownloadModal-3oiWfpjo.js","js/videoCombiner-16CEYwu5.js","js/SequenceBuilder-yR3Kqg0Q.js","js/ConfirmModal-BH5xG-OP.js","js/SequenceVideoPlayer-DY8asD91.js","js/vendor-ffmpeg-BflpXDox.js","js/SequenceGallery-DAlhM2Ut.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,a=(e,t)=>{for(var r in t||(t={}))i.call(t,r)&&o(e,r,t[r]);if(s)for(var r of s(t))n.call(t,r)&&o(e,r,t[r]);return e},l=(e,s)=>t(e,r(s)),c=(e,t,r)=>new Promise((s,i)=>{var n=e=>{try{a(r.next(e))}catch(t){i(t)}},o=e=>{try{a(r.throw(e))}catch(t){i(t)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);a((r=r.apply(e,t)).next())});import{j as d,u,a as h,s as m,d as p,e as f,f as g,_ as x,t as v,m as y}from"../assets/index-BgmWhXhd.js";import{r as b}from"./vendor-react-4yEUTM44.js";import{u as w,C as j,a as S}from"./CompactCardActions-4ElLycK8.js";import C from"./ConfirmModal-BH5xG-OP.js";import N from"./Toast-BchDI-us.js";import{a as _}from"./index-Cef-5B3O.js";import{LucideZap as k,LucideStar as L,Heart as I,LucideMusic as O,LucideSearch as R,Filter as E,ChevronUp as T,ChevronDown as M,LucideUpload as P,LucideX as D,LucideMinimize2 as z,LucideMaximize2 as A,LucidePlay as $,Download as F,Edit as W,LucideTrash2 as H,Loader as U}from"./vendor-icons-DyUK-N1U.js";import"./vendor-router-Bt5THCHr.js";import"./vendor-firebase-DVYjp8kH.js";function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},V.apply(null,arguments)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Z=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function G(e,t){return e===t||!(!Z(e)||!Z(t))}function J(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!G(e[r],t[r]))return!1;return!0}function K(e,t){var r;void 0===t&&(t=J);var s,i=[],n=!1;return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n&&r===this&&t(o,i)||(s=e.apply(this,o),n=!0,r=this,i=o),s}}var Q="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function X(e){cancelAnimationFrame(e.id)}var Y=-1;var ee=null;function te(e){if(void 0===e&&(e=!1),null===ee||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var s=document.createElement("div"),i=s.style;return i.width="100px",i.height="100px",t.appendChild(s),document.body.appendChild(t),t.scrollLeft>0?ee="positive-descending":(t.scrollLeft=1,ee=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),ee}return ee}var re=function(e){var t=e.columnIndex;return e.data,e.rowIndex+":"+t};function se(e){var t,r=e.getColumnOffset,s=e.getColumnStartIndexForOffset,i=e.getColumnStopIndexForStartIndex,n=e.getColumnWidth,o=e.getEstimatedTotalHeight,a=e.getEstimatedTotalWidth,l=e.getOffsetForColumnAndAlignment,c=e.getOffsetForRowAndAlignment,d=e.getRowHeight,u=e.getRowOffset,h=e.getRowStartIndexForOffset,m=e.getRowStopIndexForStartIndex,p=e.initInstanceProps,f=e.shouldResetStyleCacheOnItemSizeChange,g=e.validateProps;return(t=function(e){var t,x;function v(t){var s;return(s=e.call(this,t)||this)._instanceProps=p(s.props,q(s)),s._resetIsScrollingTimeoutId=null,s._outerRef=void 0,s.state={instance:q(s),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:"number"==typeof s.props.initialScrollLeft?s.props.initialScrollLeft:0,scrollTop:"number"==typeof s.props.initialScrollTop?s.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},s._callOnItemsRendered=void 0,s._callOnItemsRendered=K(function(e,t,r,i,n,o,a,l){return s.props.onItemsRendered({overscanColumnStartIndex:e,overscanColumnStopIndex:t,overscanRowStartIndex:r,overscanRowStopIndex:i,visibleColumnStartIndex:n,visibleColumnStopIndex:o,visibleRowStartIndex:a,visibleRowStopIndex:l})}),s._callOnScroll=void 0,s._callOnScroll=K(function(e,t,r,i,n){return s.props.onScroll({horizontalScrollDirection:r,scrollLeft:e,scrollTop:t,verticalScrollDirection:i,scrollUpdateWasRequested:n})}),s._getItemStyle=void 0,s._getItemStyle=function(e,t){var i,o=s.props,a=o.columnWidth,l=o.direction,c=o.rowHeight,h=s._getItemStyleCache(f&&a,f&&l,f&&c),m=e+":"+t;if(h.hasOwnProperty(m))i=h[m];else{var p=r(s.props,t,s._instanceProps),g="rtl"===l;h[m]=i={position:"absolute",left:g?void 0:p,right:g?p:void 0,top:u(s.props,e,s._instanceProps),height:d(s.props,e,s._instanceProps),width:n(s.props,t,s._instanceProps)}}return i},s._getItemStyleCache=void 0,s._getItemStyleCache=K(function(e,t,r){return{}}),s._onScroll=function(e){var t=e.currentTarget,r=t.clientHeight,i=t.clientWidth,n=t.scrollLeft,o=t.scrollTop,a=t.scrollHeight,l=t.scrollWidth;s.setState(function(e){if(e.scrollLeft===n&&e.scrollTop===o)return null;var t=s.props.direction,c=n;if("rtl"===t)switch(te()){case"negative":c=-n;break;case"positive-descending":c=l-i-n}c=Math.max(0,Math.min(c,l-i));var d=Math.max(0,Math.min(o,a-r));return{isScrolling:!0,horizontalScrollDirection:e.scrollLeft<n?"forward":"backward",scrollLeft:c,scrollTop:d,verticalScrollDirection:e.scrollTop<o?"forward":"backward",scrollUpdateWasRequested:!1}},s._resetIsScrollingDebounced)},s._outerRefSetter=function(e){var t=s.props.outerRef;s._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},s._resetIsScrollingDebounced=function(){var e,t,r,i;null!==s._resetIsScrollingTimeoutId&&X(s._resetIsScrollingTimeoutId),s._resetIsScrollingTimeoutId=(e=s._resetIsScrolling,t=150,r=Q(),i={id:requestAnimationFrame(function s(){Q()-r>=t?e.call(null):i.id=requestAnimationFrame(s)})})},s._resetIsScrolling=function(){s._resetIsScrollingTimeoutId=null,s.setState({isScrolling:!1},function(){s._getItemStyleCache(-1)})},s}x=e,(t=v).prototype=Object.create(x.prototype),t.prototype.constructor=t,B(t,x),v.getDerivedStateFromProps=function(e,t){return ie(e,t),g(e),null};var y=v.prototype;return y.scrollTo=function(e){var t=e.scrollLeft,r=e.scrollTop;void 0!==t&&(t=Math.max(0,t)),void 0!==r&&(r=Math.max(0,r)),this.setState(function(e){return void 0===t&&(t=e.scrollLeft),void 0===r&&(r=e.scrollTop),e.scrollLeft===t&&e.scrollTop===r?null:{horizontalScrollDirection:e.scrollLeft<t?"forward":"backward",scrollLeft:t,scrollTop:r,scrollUpdateWasRequested:!0,verticalScrollDirection:e.scrollTop<r?"forward":"backward"}},this._resetIsScrollingDebounced)},y.scrollToItem=function(e){var t=e.align,r=void 0===t?"auto":t,s=e.columnIndex,i=e.rowIndex,n=this.props,d=n.columnCount,u=n.height,h=n.rowCount,m=n.width,p=this.state,f=p.scrollLeft,g=p.scrollTop,x=function(e){if(void 0===e&&(e=!1),-1===Y||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),Y=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Y}();void 0!==s&&(s=Math.max(0,Math.min(s,d-1))),void 0!==i&&(i=Math.max(0,Math.min(i,h-1)));var v=o(this.props,this._instanceProps),y=a(this.props,this._instanceProps)>m?x:0,b=v>u?x:0;this.scrollTo({scrollLeft:void 0!==s?l(this.props,s,r,f,this._instanceProps,b):f,scrollTop:void 0!==i?c(this.props,i,r,g,this._instanceProps,y):g})},y.componentDidMount=function(){var e=this.props,t=e.initialScrollLeft,r=e.initialScrollTop;if(null!=this._outerRef){var s=this._outerRef;"number"==typeof t&&(s.scrollLeft=t),"number"==typeof r&&(s.scrollTop=r)}this._callPropsCallbacks()},y.componentDidUpdate=function(){var e=this.props.direction,t=this.state,r=t.scrollLeft,s=t.scrollTop;if(t.scrollUpdateWasRequested&&null!=this._outerRef){var i=this._outerRef;if("rtl"===e)switch(te()){case"negative":i.scrollLeft=-r;break;case"positive-ascending":i.scrollLeft=r;break;default:var n=i.clientWidth,o=i.scrollWidth;i.scrollLeft=o-n-r}else i.scrollLeft=Math.max(0,r);i.scrollTop=Math.max(0,s)}this._callPropsCallbacks()},y.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&X(this._resetIsScrollingTimeoutId)},y.render=function(){var e=this.props,t=e.children,r=e.className,s=e.columnCount,i=e.direction,n=e.height,l=e.innerRef,c=e.innerElementType,d=e.innerTagName,u=e.itemData,h=e.itemKey,m=void 0===h?re:h,p=e.outerElementType,f=e.outerTagName,g=e.rowCount,x=e.style,v=e.useIsScrolling,y=e.width,w=this.state.isScrolling,j=this._getHorizontalRangeToRender(),S=j[0],C=j[1],N=this._getVerticalRangeToRender(),_=N[0],k=N[1],L=[];if(s>0&&g)for(var I=_;I<=k;I++)for(var O=S;O<=C;O++)L.push(b.createElement(t,{columnIndex:O,data:u,isScrolling:v?w:void 0,key:m({columnIndex:O,data:u,rowIndex:I}),rowIndex:I,style:this._getItemStyle(I,O)}));var R=o(this.props,this._instanceProps),E=a(this.props,this._instanceProps);return b.createElement(p||f||"div",{className:r,onScroll:this._onScroll,ref:this._outerRefSetter,style:V({position:"relative",height:n,width:y,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:i},x)},b.createElement(c||d||"div",{children:L,ref:l,style:{height:R,pointerEvents:w?"none":void 0,width:E}}))},y._callPropsCallbacks=function(){var e=this.props,t=e.columnCount,r=e.onItemsRendered,s=e.onScroll,i=e.rowCount;if("function"==typeof r&&t>0&&i>0){var n=this._getHorizontalRangeToRender(),o=n[0],a=n[1],l=n[2],c=n[3],d=this._getVerticalRangeToRender(),u=d[0],h=d[1],m=d[2],p=d[3];this._callOnItemsRendered(o,a,u,h,l,c,m,p)}if("function"==typeof s){var f=this.state,g=f.horizontalScrollDirection,x=f.scrollLeft,v=f.scrollTop,y=f.scrollUpdateWasRequested,b=f.verticalScrollDirection;this._callOnScroll(x,v,g,b,y)}},y._getHorizontalRangeToRender=function(){var e=this.props,t=e.columnCount,r=e.overscanColumnCount,n=e.overscanColumnsCount,o=e.overscanCount,a=e.rowCount,l=this.state,c=l.horizontalScrollDirection,d=l.isScrolling,u=l.scrollLeft,h=r||n||o||1;if(0===t||0===a)return[0,0,0,0];var m=s(this.props,u,this._instanceProps),p=i(this.props,m,u,this._instanceProps),f=d&&"backward"!==c?1:Math.max(1,h),g=d&&"forward"!==c?1:Math.max(1,h);return[Math.max(0,m-f),Math.max(0,Math.min(t-1,p+g)),m,p]},y._getVerticalRangeToRender=function(){var e=this.props,t=e.columnCount,r=e.overscanCount,s=e.overscanRowCount,i=e.overscanRowsCount,n=e.rowCount,o=this.state,a=o.isScrolling,l=o.verticalScrollDirection,c=o.scrollTop,d=s||i||r||1;if(0===t||0===n)return[0,0,0,0];var u=h(this.props,c,this._instanceProps),p=m(this.props,u,c,this._instanceProps),f=a&&"backward"!==l?1:Math.max(1,d),g=a&&"forward"!==l?1:Math.max(1,d);return[Math.max(0,u-f),Math.max(0,Math.min(n-1,p+g)),u,p]},v}(b.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},t}var ie=function(e,t){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,t.instance},ne=se({getColumnOffset:function(e,t){return t*e.columnWidth},getColumnWidth:function(e,t){return e.columnWidth},getRowOffset:function(e,t){return t*e.rowHeight},getRowHeight:function(e,t){return e.rowHeight},getEstimatedTotalHeight:function(e){var t=e.rowCount;return e.rowHeight*t},getEstimatedTotalWidth:function(e){var t=e.columnCount;return e.columnWidth*t},getOffsetForColumnAndAlignment:function(e,t,r,s,i,n){var o=e.columnCount,a=e.columnWidth,l=e.width,c=Math.max(0,o*a-l),d=Math.min(c,t*a),u=Math.max(0,t*a-l+n+a);switch("smart"===r&&(r=s>=u-l&&s<=d+l?"auto":"center"),r){case"start":return d;case"end":return u;case"center":var h=Math.round(u+(d-u)/2);return h<Math.ceil(l/2)?0:h>c+Math.floor(l/2)?c:h;default:return s>=u&&s<=d?s:u>d||s<u?u:d}},getOffsetForRowAndAlignment:function(e,t,r,s,i,n){var o=e.rowHeight,a=e.height,l=e.rowCount,c=Math.max(0,l*o-a),d=Math.min(c,t*o),u=Math.max(0,t*o-a+n+o);switch("smart"===r&&(r=s>=u-a&&s<=d+a?"auto":"center"),r){case"start":return d;case"end":return u;case"center":var h=Math.round(u+(d-u)/2);return h<Math.ceil(a/2)?0:h>c+Math.floor(a/2)?c:h;default:return s>=u&&s<=d?s:u>d||s<u?u:d}},getColumnStartIndexForOffset:function(e,t){var r=e.columnWidth,s=e.columnCount;return Math.max(0,Math.min(s-1,Math.floor(t/r)))},getColumnStopIndexForStartIndex:function(e,t,r){var s=e.columnWidth,i=e.columnCount,n=e.width,o=t*s,a=Math.ceil((n+r-o)/s);return Math.max(0,Math.min(i-1,t+a-1))},getRowStartIndexForOffset:function(e,t){var r=e.rowHeight,s=e.rowCount;return Math.max(0,Math.min(s-1,Math.floor(t/r)))},getRowStopIndexForStartIndex:function(e,t,r){var s=e.rowHeight,i=e.rowCount,n=e.height,o=t*s,a=Math.ceil((n+r-o)/s);return Math.max(0,Math.min(i-1,t+a-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.columnWidth,e.rowHeight}});const oe=({videos:e,containerWidth:t,containerHeight:r=600,cardWidth:s=320,cardHeight:i=400,gap:n=24,renderCard:o})=>{const c=b.useMemo(()=>{const e=t-n,r=s+n;return Math.max(1,Math.floor(e/r))},[t,s,n]),u=b.useMemo(()=>Math.ceil(e.length/c),[e.length,c]),h=b.useCallback(({columnIndex:t,rowIndex:r,style:s})=>{const i=r*c+t,u=e[i];if(!u)return d.jsx("div",{style:s});const h=l(a({},s),{left:s.left+n/2,top:s.top+n/2,width:s.width-n,height:s.height-n});return d.jsx("div",{style:h,children:o(u,i)})},[e,c,n,o]);return 0===e.length?d.jsx("div",{className:"flex items-center justify-center text-gray-500",style:{height:r},children:d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-lg font-medium",children:"No hay videos para mostrar"}),d.jsx("p",{className:"text-sm mt-2",children:"Prueba ajustando los filtros"})]})}):d.jsxs("div",{className:"virtualized-grid-container",children:[d.jsx(ne,{columnCount:c,columnWidth:s+n,height:r,rowCount:u,rowHeight:i+n,width:t,style:{marginLeft:t>c*(s+n)?(t-c*(s+n))/2:0},children:h}),!1]})},ae=({videos:e,threshold:t=150,cardWidth:r=320,cardHeight:s=400,gap:i=24,renderCard:n})=>{const{containerRef:o,width:a,height:l}=(()=>{const[e,t]=b.useState({width:0,height:0}),[r,s]=b.useState(!0),i=b.useRef(null),n=b.useRef(null),o=b.useCallback(()=>{if(i.current){const n=i.current.getBoundingClientRect(),o={width:n.width,height:n.height};(Math.abs(o.width-e.width)>1||Math.abs(o.height-e.height)>1)&&t(o),r&&o.width>0&&s(!1)}},[e.width,e.height,r]);return b.useEffect(()=>("undefined"!=typeof window&&window.ResizeObserver?(n.current=new ResizeObserver(e=>{for(const i of e){const{width:e,height:n}=i.contentRect;t({width:e,height:n}),r&&e>0&&s(!1)}}),i.current&&n.current.observe(i.current)):(o(),window.addEventListener("resize",o)),()=>{n.current&&n.current.disconnect(),"undefined"!=typeof window&&window.removeEventListener("resize",o)}),[o,r]),b.useEffect(()=>{i.current&&o()},[o]),{containerRef:i,width:e.width,height:e.height,isLoading:r}})(),c=e.length>t;return d.jsx("div",{ref:o,className:"w-full",children:c?d.jsx(oe,{videos:e,containerWidth:Math.max(300,a||0),containerHeight:Math.max(400,l||700),cardWidth:r,cardHeight:s,gap:i,renderCard:n}):d.jsx("div",{className:"grid gap-6",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${r}px, 1fr))`},children:e.map((e,t)=>d.jsx("div",{children:n(e,t)},e.id||t))})})},le=b.lazy(()=>x(()=>import("./VideoUploadModal-D5RIWvhs.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ce=b.lazy(()=>x(()=>import("./VideoEditModal-4npoNvWM.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10])));b.lazy(()=>x(()=>import("./VideoPlayer-D3jT_9FO.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),b.lazy(()=>x(()=>import("./DownloadModal-3oiWfpjo.js"),__vite__mapDeps([12,1,2,3,4,5,6,13]))),b.lazy(()=>x(()=>import("./SequenceBuilder-yR3Kqg0Q.js"),__vite__mapDeps([14,1,2,3,4,5,6,8,9,15,10,16,13,17]))),b.lazy(()=>x(()=>import("./SequenceGallery-DAlhM2Ut.js"),__vite__mapDeps([18,1,2,3,4,5,6,15,9,8])));const de=b.lazy(()=>x(()=>import("./SequenceVideoPlayer-DY8asD91.js"),__vite__mapDeps([16,1,2,3,4,5,6]))),ue=()=>d.jsxs("div",{className:"flex items-center justify-center py-8",children:[d.jsx(U,{className:"w-6 h-6 animate-spin text-blue-500"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Cargando..."})]}),he=(e,t)=>{var r;try{const s=localStorage.getItem("escuela-filters");return null!=(r=(s?JSON.parse(s):{})[e])?r:t}catch(s){return t}},me=()=>{var e;const[t,r]=b.useState(!1),[s,i]=b.useState({isOpen:!1,video:null}),[n,o]=b.useState([]),[U,V]=b.useState(!0),[q,B]=b.useState([]),[Z,G]=b.useState({isOpen:!1,video:null}),[J,K]=b.useState(()=>he("selectedTags",[])),[Q,X]=b.useState(()=>he("searchTerm","")),[Y,ee]=b.useState(()=>he("showFilters",!1)),[te,re]=b.useState("videos"),[se,ie]=b.useState("idle"),[ne,oe]=b.useState({isOpen:!1,type:null}),[me,pe]=b.useState({isOpen:!1,sequence:null}),[fe,ge]=b.useState({isOpen:!1,sequence:null}),[xe,ve]=b.useState({isOpen:!1}),[ye,be]=b.useState(!1),[we,je]=b.useState(null),[Se,Ce]=b.useState(!1),[Ne,_e]=b.useState(null),[ke,Le]=b.useState(!1),[Ie,Oe]=b.useState(()=>he("activeCategoryChips",[])),[Re,Ee]=b.useState(()=>he("sortBy","none")),[Te,Me]=b.useState(()=>he("showFavorites",!1)),{user:Pe,userProfile:De}=u(),{getVideoConfig:ze,getSequenceConfig:Ae}=h(),[$e,Fe]=b.useState(()=>he("selectedStyle","salsa")),{availableStyles:We,getGradientClasses:He,categoriesList:Ue,getColorClasses:Ve}=w("escuela",$e),qe={Music:O,Heart:I,Star:L,Zap:k};b.useEffect(()=>{ie("syncing");const e=m($e,e=>{o(e),V(!1),ie("idle")},"escuela");return()=>{e()}},[$e]),b.useEffect(()=>{(e=>{try{localStorage.setItem("escuela-filters",JSON.stringify(e))}catch(t){}})({selectedStyle:$e,selectedTags:J,searchTerm:Q,showFilters:Y,activeCategoryChips:Ie,sortBy:Re,showFavorites:Te})},[$e,J,Q,Y,Ie,Re,Te]),b.useEffect(()=>{if(n.length>0&&Pe){(()=>c(void 0,null,function*(){const e=yield Promise.all(n.map(e=>c(void 0,null,function*(){try{const[t,r]=yield Promise.all([f(e.id,Pe.uid),g(e.id,Pe.uid)]);return l(a({},e),{userLiked:t.userLiked,isFavorite:r.isFavorite})}catch(t){return l(a({},e),{userLiked:!1,isFavorite:!1})}})));o(e)}))()}},[n.length,Pe]);const Be=e=>{i({isOpen:!0,video:e})},Ze=e=>{je(e),Ce(!0)},Ge=e=>c(void 0,null,function*(){if(Pe&&De)if("maese"===De.role||"super_admin"===De.role)try{Qe(`Iniciando descarga de ${e.title}...`,"info");const{ref:t,getDownloadURL:r}=yield x(()=>c(void 0,null,function*(){const{ref:e,getDownloadURL:t}=yield import("./vendor-firebase-DVYjp8kH.js").then(e=>e.J);return{ref:e,getDownloadURL:t}}),[]),{storage:s}=yield x(()=>c(void 0,null,function*(){const{storage:e}=yield import("../assets/index-BgmWhXhd.js").then(e=>e.N);return{storage:e}}),__vite__mapDeps([1,2,3,4,5,6])),i=t(s,e.videoPath),n=yield r(i),o=new AbortController,a=setTimeout(()=>o.abort(),3e4),l=yield fetch(n,{signal:o.signal});if(clearTimeout(a),!l.ok)throw new Error(`Error HTTP: ${l.status} ${l.statusText}`);const d=yield l.blob();if(0===d.size)throw new Error("Archivo de video vacío");const u=URL.createObjectURL(d),h=document.createElement("a");h.href=u,h.download=`${e.title||"video"}.mp4`,h.target="_blank",h.rel="noopener noreferrer",document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(u),Qe("✅ Descarga completada exitosamente","success")}catch(t){"AbortError"===t.name?Qe("❌ Descarga cancelada por timeout (30s)","error"):Qe(`❌ Error al descargar: ${t.message}`,"error")}else Qe("❌ Solo los maestros pueden descargar videos","error");else Qe("❌ Debes iniciar sesión para descargar videos","error")}),Je=e=>{G({isOpen:!0,video:e})},Ke=e=>c(void 0,null,function*(){if(Pe)try{const t=yield v(e.id,Pe.uid,"escuela");if(t.success){o(r=>r.map(r=>r.id===e.id?l(a({},r),{likes:t.likes,likedBy:t.likedBy,userLiked:t.userLiked,isFavorite:t.isFavorite}):r));const r=t.userLiked?"dado like a":"quitado like de",s=t.isFavorite?"y agregado a favoritos":"y removido de favoritos";Qe(`Has ${r} "${e.title}" ${s}`,"success")}else Qe("Error al actualizar like","error")}catch(t){Qe("Error al actualizar like","error")}else Qe("Debes iniciar sesión para dar like","error")}),Qe=(e,t="success")=>{const r=Date.now();B(s=>[...s,{id:r,message:e,type:t}])},Xe=e=>{Ee(e)},Ye=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),et=(e=>{if("none"===Re)return e;const t=[...e];switch(Re){case"name":return t.sort((e,t)=>e.title.localeCompare(t.title));case"name-desc":return t.sort((e,t)=>t.title.localeCompare(e.title));case"rating":return t.sort((e,t)=>(t.rating||0)-(e.rating||0));case"rating-desc":return t.sort((e,t)=>(e.rating||0)-(t.rating||0));case"likes":return t.sort((e,t)=>(t.likes||0)-(e.likes||0));case"likes-desc":return t.sort((e,t)=>(e.likes||0)-(t.likes||0));default:return t}})(n.filter(e=>{const t=Q.split(" ").map(e=>e.trim()).filter(e=>e.length>0),r=((e,t)=>{if(!t||0===t.length)return!0;const r=Ye(e.title||""),s=Ye(e.description||""),i=[];return e.tags&&Object.values(e.tags).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{i.push(Ye(e))})}),t.every(e=>{const t=Ye(e);return!!r.includes(t)||!!s.includes(t)||!!i.some(e=>e.includes(t))})})(e,t),s=0===J.length||J.every(t=>!!e.tags&&Object.values(e.tags).some(e=>Array.isArray(e)&&e.includes(t))),i=0===Ie.length||Ie.some(t=>((e,t)=>{if(!e.tags)return!1;if(!Ue.find(e=>e.key===t))return!1;const r=e.tags[t];return r&&Array.isArray(r)&&r.length>0})(e,t)),n=!Te||e.isFavorite;return r&&s&&i&&n}));return d.jsxs("div",{className:"min-h-screen bg-white",children:[d.jsxs("div",{className:(ye?"w-full px-0":"max-w-6xl mx-auto px-6")+" py-8",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[d.jsx("span",{className:"text-purple-500",children:"ESCUELA"}),d.jsxs("span",{className:`bg-gradient-to-r ${He($e)} bg-clip-text text-transparent`,children:[" - ",$e.toUpperCase()]})]}),d.jsxs("p",{className:"text-gray-600 text-lg",children:["Galería de videos de escuela de ",$e.toLowerCase()]})]}),d.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:We.map(e=>{const t=qe[e.icon],r=$e===e.key,s=He(e.color);return d.jsxs("button",{onClick:()=>Fe(e.key),className:"relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 "+(r?`bg-gradient-to-r ${s} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:[t&&d.jsx(t,{className:"h-4 w-4"}),d.jsx("span",{children:e.name})]},e.name)})}),d.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:d.jsxs("div",{className:"relative",children:[d.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),d.jsx("input",{type:"text",placeholder:`Buscar en ${$e.toLowerCase()}... (múltiples palabras, sin tildes)`,value:Q,onChange:e=>X(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]})}),Ue.length>0&&d.jsxs("div",{className:"mb-8",children:[d.jsxs("button",{onClick:()=>ee(!Y),className:"flex items-center justify-center space-x-2 mx-auto px-6 py-3 bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[d.jsx(E,{className:"h-5 w-5"}),d.jsxs("span",{children:["Filtros Avanzados por Tags - ",$e]}),Y?d.jsx(T,{className:"h-5 w-5"}):d.jsx(M,{className:"h-5 w-5"})]}),d.jsx("div",{className:"mt-4 transition-all duration-300 ease-in-out overflow-hidden "+(Y?"max-h-screen opacity-100":"max-h-0 opacity-0"),children:d.jsx("div",{className:"space-y-4 bg-gray-50 rounded-lg p-6 border border-gray-200 max-h-96 overflow-y-auto",children:Ue.map(e=>d.jsxs("div",{className:"space-y-2",children:[d.jsx("button",{onClick:()=>{return t=e.key,void Oe(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-full text-center font-medium py-2 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 "+(Ie.includes(e.key)?`bg-gradient-to-r ${He($e)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx("span",{children:e.name}),Ie.includes(e.key)&&d.jsx("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:"ACTIVO"})]})}),d.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:e.tags.map(t=>d.jsx("button",{onClick:()=>(e=>{K(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(t),className:"px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 "+(J.includes(t)?`bg-gradient-to-r ${He($e)} text-white shadow-lg`:`${Ve(e.color)} hover:bg-opacity-80`),children:t},t))})]},e.key))})})]}),("maese"===(null==De?void 0:De.role)||"super_admin"===(null==De?void 0:De.role))&&d.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:d.jsxs("button",{onClick:()=>r(!0),className:`flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r ${He($e)} text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-colors duration-200`,children:[d.jsx(P,{className:"h-5 w-5"}),d.jsxs("span",{children:["SUBIR VIDEO(S) A ",$e.toUpperCase()]})]})}),d.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:[d.jsx("button",{onClick:()=>Xe("name"===Re?"name-desc":"name"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("name"===Re||"name-desc"===Re?`bg-gradient-to-r ${He($e)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:d.jsx("span",{children:"name"===Re?"A-Z":"name-desc"===Re?"Z-A":"A-Z"})}),d.jsxs("button",{onClick:()=>Xe("rating"===Re?"rating-desc":"rating"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("rating"===Re||"rating-desc"===Re?`bg-gradient-to-r ${He($e)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[d.jsx(L,{className:"h-3 w-3"}),d.jsx("span",{children:"rating"===Re?"Puntuación ↓":"rating-desc"===Re?"Puntuación ↑":"Puntuación"})]}),d.jsxs("button",{onClick:()=>{Te?"likes"===Re?Ee("likes-desc"):"likes-desc"===Re?Ee("likes"):(Me(!1),Ee("none")):(Me(!0),Ee("likes"))},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+(Te?`bg-gradient-to-r ${He($e)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[d.jsx(I,{className:"h-3 w-3"}),d.jsx("span",{children:Te?"likes"===Re?"Favoritos ↓":"likes-desc"===Re?"Favoritos ↑":"Ocultar Favoritos":"Mostrar Favoritos"})]}),(Ie.length>0||"none"!==Re||Te||J.length>0||Q)&&d.jsxs("button",{onClick:()=>{K([]),X(""),Oe([]),Ee("none"),Me(!1)},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800 transition-colors duration-200",title:"Limpiar filtros de búsqueda, tags y ordenamiento",children:[d.jsx(D,{className:"h-3 w-3"}),d.jsx("span",{children:"Limpiar filtros"})]})]}),d.jsxs("div",{className:"mb-8",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Escuela de ",$e.toLowerCase()," (",et.length,")"]}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(j,{type:"video",styleColor:$e}),d.jsxs("button",{onClick:()=>be(!ye),className:"flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 "+(ye?`bg-gradient-to-r ${He($e)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),title:ye?"Modo compacto":"Modo ancho completo",children:[ye?d.jsx(z,{className:"w-4 h-4"}):d.jsx(A,{className:"w-4 h-4"}),d.jsx("span",{className:"hidden sm:inline",children:ye?"Compacto":"Ancho"})]})]})]}),U?d.jsxs("div",{className:"flex justify-center items-center py-12",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),d.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando videos..."})]}):0===n.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsxs("p",{className:"text-gray-500 text-lg",children:["No hay videos de ",$e.toLowerCase()," aún"]}),d.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Sube tu primer video de ",$e.toLowerCase()," usando el botón de arriba"]})]}):d.jsx(ae,{videos:et,threshold:150,cardWidth:ze(ye).compact||"text-xs"===ze(ye).titleSize?160:"text-sm"===ze(ye).titleSize?240:"text-xl"===ze(ye).titleSize?320:450,cardHeight:ze(ye).compact?240:380,gap:24,renderCard:e=>d.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] border-gray-100",children:d.jsxs("div",{className:"relative group",children:[d.jsxs("div",{className:`w-full ${ze(ye).aspect} ${ze(ye).thumbnailSize} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?d.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:`w-full h-full ${ze(ye).imageObject||"object-cover"}`,loading:"lazy",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,d.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 "+(e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?"hidden":"flex"),children:[d.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 002 2v8a2 2 0 002 2z"})}),d.jsx("span",{className:"text-sm font-medium",children:e.title})]}),d.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:e.resolution&&"Unknown"!==e.resolution?e.resolution:"HD"}),d.jsx("button",{onClick:()=>Ze(e),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 hover:bg-opacity-30 transition-all duration-200 group",children:d.jsx("div",{className:"w-16 h-16 rounded-full bg-white bg-opacity-90 flex items-center justify-center transform scale-0 group-hover:scale-100 transition-transform duration-200",children:d.jsx($,{className:"w-8 h-8 text-gray-800 ml-1"})})})]}),d.jsxs("div",{className:""+(ze(ye).compact?"p-2":"p-4"),children:[d.jsxs("div",{className:"flex items-center justify-between "+(ze(ye).compact?"mb-1":"mb-2"),children:[d.jsx("h3",{className:`font-semibold text-gray-800 ${ze(ye).titleSize}`,children:e.title}),d.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(t=>{const r=(e.rating||0)>=t;return d.jsx("svg",{className:`${ze(ye).compact?"h-3 w-3":"h-4 w-4"} ${r?"text-yellow-400 fill-current":"text-gray-300"} cursor-pointer`,fill:"currentColor",viewBox:"0 0 24 24",onClick:()=>c(void 0,null,function*(){try{const r=(e.rating||0)>=t?0:t;yield p(e.id,{rating:r},"escuela"),e.rating=r}catch(r){}}),children:d.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},t)}),d.jsxs("span",{className:(ze(ye).compact,"text-xs")+" font-medium text-gray-500 ml-1",children:["(",e.rating||0,")"]})]})]}),d.jsx("p",{className:`text-gray-600 text-sm ${ze(ye).compact?"mb-2":"mb-3"} ${1===ze(ye).descriptionLines?"line-clamp-1":2===ze(ye).descriptionLines?"line-clamp-2":3===ze(ye).descriptionLines?"line-clamp-3":"line-clamp-4"}`,children:e.description||"Sin descripción"}),ze(ye).showTags&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const t=(e=>{if(!e.tags||0===Object.keys(e.tags).length)return[];const t=[];return Ue.forEach(r=>{const s=e.tags[r.key];Array.isArray(s)&&s.forEach(e=>{t.push({tag:e,categoryKey:r.key,color:r.color})})}),t})(e);return t.length>0?t.map(({tag:e,categoryKey:t,color:r})=>d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ve(r)}`,children:e},`${t}-${e}`)):d.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),ze(ye).compact?d.jsx(S,{video:e,onLike:()=>Ke(e),onEdit:()=>Be(e),onDelete:()=>Je(e),onDownload:"maese"===(null==De?void 0:De.role)||"super_admin"===(null==De?void 0:De.role)?()=>Ge(e):void 0,onPlay:()=>Ze(e),type:"video"}):d.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("span",{className:"font-medium",children:[(e.fileSize/1048576).toFixed(2)," MB"]})}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>Ze(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Reproducir video",children:d.jsx($,{className:"h-4 w-4"})}),d.jsxs("button",{onClick:()=>Ke(e),className:"flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 "+(e.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"),title:e.userLiked?"Quitar like":"Dar like",children:[d.jsx(I,{className:"h-4 w-4 "+(e.userLiked?"fill-current":"")}),d.jsx("span",{className:"font-medium",children:e.likes||0})]}),("maese"===(null==De?void 0:De.role)||"super_admin"===(null==De?void 0:De.role))&&d.jsx("button",{onClick:()=>{Ge(e)},className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar video",children:d.jsx(F,{className:"h-4 w-4"})}),d.jsx("button",{onClick:()=>Be(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar video",children:d.jsx(W,{className:"h-4 w-4"})}),d.jsx("button",{onClick:()=>Je(e),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar video",children:d.jsx(H,{className:"h-4 w-4"})})]})]})]})]})},e.id)})]})]}),d.jsx(b.Suspense,{fallback:d.jsx(ue,{}),children:d.jsx(le,{isOpen:t,onClose:()=>r(!1),onVideoUploaded:e=>c(void 0,null,function*(){Qe(`${e.title} subido exitosamente`,"success")}),page:"escuela",style:$e})}),d.jsx(b.Suspense,{fallback:d.jsx(ue,{}),children:d.jsx(ce,{isOpen:s.isOpen,onClose:()=>{i({isOpen:!1,video:null})},video:s.video,onVideoUpdated:e=>{o(t=>t.map(t=>t.id===e.id?e:t)),Qe(`${e.title} actualizado exitosamente`,"success")},page:"escuela",style:$e})}),Se&&we&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["🎬 ",we.title]}),d.jsx("button",{onClick:()=>{Ce(!1),je(null)},className:"text-gray-500 hover:text-gray-700 transition-colors",children:d.jsx(D,{className:"h-6 w-6"})})]}),d.jsx("div",{className:"flex-1 min-h-0 p-4",children:d.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:d.jsx("div",{className:"w-full max-w-md",children:d.jsx(b.Suspense,{fallback:d.jsx(ue,{}),children:d.jsx(de,{videos:[we],className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})})]})}),d.jsx(b.Suspense,{fallback:d.jsx(ue,{}),children:d.jsx(C,{isOpen:Z.isOpen,onClose:()=>{G({isOpen:!1,video:null})},onConfirm:()=>{return e=Z.video,c(void 0,null,function*(){try{const t=yield _(e.videoPath,e.thumbnailPath);if(!t.success){if(!t.error||!t.error.includes("thumbnails"))return void Qe(`Error al eliminar archivos: ${t.error}`,"error");if(!(yield _(e.videoPath,null)).success)return void Qe(`Error al eliminar archivos: ${t.error}`,"error")}const r=yield y(e.id,"escuela");if(!r.success)return void Qe(`Error al eliminar metadatos: ${r.error}`,"error");o(t=>t.filter(t=>t.id!==e.id)),Qe(`${e.title} eliminado correctamente`,"success"),G({isOpen:!1,video:null})}catch(t){Qe("Error inesperado al eliminar video","error")}});var e},title:"🗑️ Eliminar Video",message:`¿Estás seguro de que quieres eliminar el video "${null==(e=Z.video)?void 0:e.title}"?\n\nEsta acción eliminará permanentemente:\n• El archivo de video de Firebase Storage\n• El thumbnail del video\n• Los metadatos de Firestore\n\nEsta acción NO se puede deshacer.`,confirmText:"Sí, Eliminar",cancelText:"Cancelar",type:"danger"})}),q.map(e=>d.jsx(N,{message:e.message,type:e.type,onClose:()=>{return t=e.id,void B(e=>e.filter(e=>e.id!==t));var t}},e.id))]})};export{me as default};
