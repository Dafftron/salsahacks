const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/VideoUploadModal-CuAKKcdP.js","assets/index-CMWpliaN.js","js/vendor-react-4yEUTM44.js","js/vendor-router-Bt5THCHr.js","js/vendor-firebase-DVYjp8kH.js","js/vendor-icons-DyUK-N1U.js","css/index-eMS82pKQ.css","js/index-CAUbUmAb.js","js/CompactCardActions-BQ-wwN8o.js","js/Toast-DZT-Y2Eq.js","js/VideoPlayer-grxpbV8P.js","js/VideoEditModal-Dc8QwAwW.js","js/DownloadModal-Di_1TmYT.js","js/videoCombiner-DicXMfnR.js","js/SequenceBuilder-C7uAnMjT.js","js/ConfirmModal-HpVEUCyE.js","js/SequenceVideoPlayer-LaJpChPq.js","js/vendor-ffmpeg-BflpXDox.js","js/SequenceGallery-CUN35G7Q.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,n=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&l(e,s,t[s]);if(r)for(var s of r(t))i.call(t,s)&&l(e,s,t[s]);return e},o=(e,r)=>t(e,s(r)),c=(e,t,s)=>new Promise((r,a)=>{var i=e=>{try{n(s.next(e))}catch(t){a(t)}},l=e=>{try{n(s.throw(e))}catch(t){a(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,l);n((s=s.apply(e,t)).next())});import{u as d,a as m,s as u,j as x,d as h,e as p,f as g,_ as f,t as y,m as v}from"../assets/index-CMWpliaN.js";import{r as b}from"./vendor-react-4yEUTM44.js";import{u as j,C as w,a as N}from"./CompactCardActions-BQ-wwN8o.js";import k from"./ConfirmModal-HpVEUCyE.js";import C from"./Toast-DZT-Y2Eq.js";import{a as S}from"./index-CAUbUmAb.js";import{LucideZap as E,LucideStar as L,Heart as O,LucideMusic as _,LucideSearch as $,Filter as A,ChevronUp as P,ChevronDown as D,LucideUpload as T,LucideX as z,LucideMinimize2 as V,LucideMaximize2 as U,LucidePlay as F,Download as I,Edit as R,LucideTrash2 as M,Loader as q}from"./vendor-icons-DyUK-N1U.js";import"./vendor-router-Bt5THCHr.js";import"./vendor-firebase-DVYjp8kH.js";const B=b.lazy(()=>f(()=>import("./VideoUploadModal-CuAKKcdP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),H=b.lazy(()=>f(()=>import("./VideoEditModal-Dc8QwAwW.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10])));b.lazy(()=>f(()=>import("./VideoPlayer-grxpbV8P.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),b.lazy(()=>f(()=>import("./DownloadModal-Di_1TmYT.js"),__vite__mapDeps([12,1,2,3,4,5,6,13]))),b.lazy(()=>f(()=>import("./SequenceBuilder-C7uAnMjT.js"),__vite__mapDeps([14,1,2,3,4,5,6,8,9,15,10,16,13,17]))),b.lazy(()=>f(()=>import("./SequenceGallery-CUN35G7Q.js"),__vite__mapDeps([18,1,2,3,4,5,6,15,9,8])));const Z=b.lazy(()=>f(()=>import("./SequenceVideoPlayer-LaJpChPq.js"),__vite__mapDeps([16,1,2,3,4,5,6]))),G=()=>x.jsxs("div",{className:"flex items-center justify-center py-8",children:[x.jsx(q,{className:"w-6 h-6 animate-spin text-blue-500"}),x.jsx("span",{className:"ml-2 text-gray-600",children:"Cargando..."})]}),J=(e,t)=>{var s;try{const r=localStorage.getItem("escuela-filters");return null!=(s=(r?JSON.parse(r):{})[e])?s:t}catch(r){return t}},K=()=>{var e;const[t,s]=b.useState(!1),[r,a]=b.useState({isOpen:!1,video:null}),[i,l]=b.useState([]),[q,K]=b.useState(!0),[Q,W]=b.useState([]),[X,Y]=b.useState({isOpen:!1,video:null}),[ee,te]=b.useState(()=>J("selectedTags",[])),[se,re]=b.useState(()=>J("searchTerm","")),[ae,ie]=b.useState(()=>J("showFilters",!1)),[le,ne]=b.useState("videos"),[oe,ce]=b.useState("idle"),[de,me]=b.useState({isOpen:!1,type:null}),[ue,xe]=b.useState({isOpen:!1,sequence:null}),[he,pe]=b.useState({isOpen:!1,sequence:null}),[ge,fe]=b.useState({isOpen:!1}),[ye,ve]=b.useState(!1),[be,je]=b.useState(null),[we,Ne]=b.useState(!1),[ke,Ce]=b.useState(null),[Se,Ee]=b.useState(!1),[Le,Oe]=b.useState(()=>J("activeCategoryChips",[])),[_e,$e]=b.useState(()=>J("sortBy","none")),[Ae,Pe]=b.useState(()=>J("showFavorites",!1)),{user:De}=d(),{getVideoConfig:Te,getSequenceConfig:ze}=m(),[Ve,Ue]=b.useState(()=>J("selectedStyle","salsa")),{availableStyles:Fe,getGradientClasses:Ie,categoriesList:Re,getColorClasses:Me}=j("escuela",Ve),qe={Music:_,Heart:O,Star:L,Zap:E};b.useEffect(()=>{ce("syncing");const e=u(Ve,e=>{l(e),K(!1),ce("idle")},"escuela");return()=>{e()}},[Ve]),b.useEffect(()=>{(e=>{try{localStorage.setItem("escuela-filters",JSON.stringify(e))}catch(t){}})({selectedStyle:Ve,selectedTags:ee,searchTerm:se,showFilters:ae,activeCategoryChips:Le,sortBy:_e,showFavorites:Ae})},[Ve,ee,se,ae,Le,_e,Ae]),b.useEffect(()=>{if(i.length>0&&De){(()=>c(void 0,null,function*(){const e=yield Promise.all(i.map(e=>c(void 0,null,function*(){try{const[t,s]=yield Promise.all([p(e.id,De.uid),g(e.id,De.uid)]);return o(n({},e),{userLiked:t.userLiked,isFavorite:s.isFavorite})}catch(t){return o(n({},e),{userLiked:!1,isFavorite:!1})}})));l(e)}))()}},[i.length,De]);const Be=e=>{a({isOpen:!0,video:e})},He=e=>{je(e),Ne(!0)},Ze=e=>c(void 0,null,function*(){try{Ke(`Iniciando descarga de ${e.title}...`,"info");const{ref:t,getDownloadURL:s}=yield f(()=>c(void 0,null,function*(){const{ref:e,getDownloadURL:t}=yield import("./vendor-firebase-DVYjp8kH.js").then(e=>e.J);return{ref:e,getDownloadURL:t}}),[]),{storage:r}=yield f(()=>c(void 0,null,function*(){const{storage:e}=yield import("../assets/index-CMWpliaN.js").then(e=>e.N);return{storage:e}}),__vite__mapDeps([1,2,3,4,5,6])),a=t(r,e.videoPath),i=yield s(a),l=new AbortController,n=setTimeout(()=>l.abort(),3e4),o=yield fetch(i,{signal:l.signal});if(clearTimeout(n),!o.ok)throw new Error(`Error HTTP: ${o.status} ${o.statusText}`);const d=yield o.blob();if(0===d.size)throw new Error("Archivo de video vacÃ­o");const m=URL.createObjectURL(d),u=document.createElement("a");u.href=m,u.download=`${e.title||"video"}.mp4`,u.target="_blank",u.rel="noopener noreferrer",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(m),Ke("âœ… Descarga completada exitosamente","success")}catch(t){"AbortError"===t.name?Ke("âŒ Descarga cancelada por timeout (30s)","error"):Ke(`âŒ Error al descargar: ${t.message}`,"error")}}),Ge=e=>{Y({isOpen:!0,video:e})},Je=e=>c(void 0,null,function*(){if(De)try{const t=yield y(e.id,De.uid,"escuela");if(t.success){l(s=>s.map(s=>s.id===e.id?o(n({},s),{likes:t.likes,likedBy:t.likedBy,userLiked:t.userLiked,isFavorite:t.isFavorite}):s));const s=t.userLiked?"dado like a":"quitado like de",r=t.isFavorite?"y agregado a favoritos":"y removido de favoritos";Ke(`Has ${s} "${e.title}" ${r}`,"success")}else Ke("Error al actualizar like","error")}catch(t){Ke("Error al actualizar like","error")}else Ke("Debes iniciar sesiÃ³n para dar like","error")}),Ke=(e,t="success")=>{const s=Date.now();W(r=>[...r,{id:s,message:e,type:t}])},Qe=e=>{$e(e)},We=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),Xe=(e=>{if("none"===_e)return e;const t=[...e];switch(_e){case"name":return t.sort((e,t)=>e.title.localeCompare(t.title));case"name-desc":return t.sort((e,t)=>t.title.localeCompare(e.title));case"rating":return t.sort((e,t)=>(t.rating||0)-(e.rating||0));case"rating-desc":return t.sort((e,t)=>(e.rating||0)-(t.rating||0));case"likes":return t.sort((e,t)=>(t.likes||0)-(e.likes||0));case"likes-desc":return t.sort((e,t)=>(e.likes||0)-(t.likes||0));default:return t}})(i.filter(e=>{const t=se.split(" ").map(e=>e.trim()).filter(e=>e.length>0),s=((e,t)=>{if(!t||0===t.length)return!0;const s=We(e.title||""),r=We(e.description||""),a=[];return e.tags&&Object.values(e.tags).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{a.push(We(e))})}),t.every(e=>{const t=We(e);return!!s.includes(t)||!!r.includes(t)||!!a.some(e=>e.includes(t))})})(e,t),r=0===ee.length||ee.every(t=>!!e.tags&&Object.values(e.tags).some(e=>Array.isArray(e)&&e.includes(t))),a=0===Le.length||Le.some(t=>((e,t)=>{if(!e.tags)return!1;if(!Re.find(e=>e.key===t))return!1;const s=e.tags[t];return s&&Array.isArray(s)&&s.length>0})(e,t)),i=!Ae||e.isFavorite;return s&&r&&a&&i}));return x.jsxs("div",{className:"min-h-screen bg-white",children:[x.jsxs("div",{className:(ye?"w-full px-0":"max-w-6xl mx-auto px-6")+" py-8",children:[x.jsxs("div",{className:"text-center mb-8",children:[x.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[x.jsx("span",{className:"text-purple-500",children:"ESCUELA"}),x.jsxs("span",{className:`bg-gradient-to-r ${Ie(Ve)} bg-clip-text text-transparent`,children:[" - ",Ve.toUpperCase()]})]}),x.jsxs("p",{className:"text-gray-600 text-lg",children:["GalerÃ­a de videos de escuela de ",Ve.toLowerCase()]})]}),x.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:Fe.map(e=>{const t=qe[e.icon],s=Ve===e.key,r=Ie(e.color);return x.jsxs("button",{onClick:()=>Ue(e.key),className:"relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 "+(s?`bg-gradient-to-r ${r} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:[t&&x.jsx(t,{className:"h-4 w-4"}),x.jsx("span",{children:e.name})]},e.name)})}),x.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:x.jsxs("div",{className:"relative",children:[x.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),x.jsx("input",{type:"text",placeholder:`Buscar en ${Ve.toLowerCase()}... (mÃºltiples palabras, sin tildes)`,value:se,onChange:e=>re(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]})}),Re.length>0&&x.jsxs("div",{className:"mb-8",children:[x.jsxs("button",{onClick:()=>ie(!ae),className:"flex items-center justify-center space-x-2 mx-auto px-6 py-3 bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[x.jsx(A,{className:"h-5 w-5"}),x.jsxs("span",{children:["Filtros Avanzados por Tags - ",Ve]}),ae?x.jsx(P,{className:"h-5 w-5"}):x.jsx(D,{className:"h-5 w-5"})]}),x.jsx("div",{className:"mt-4 transition-all duration-300 ease-in-out overflow-hidden "+(ae?"max-h-screen opacity-100":"max-h-0 opacity-0"),children:x.jsx("div",{className:"space-y-4 bg-gray-50 rounded-lg p-6 border border-gray-200 max-h-96 overflow-y-auto",children:Re.map(e=>x.jsxs("div",{className:"space-y-2",children:[x.jsx("button",{onClick:()=>{return t=e.key,void Oe(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-full text-center font-medium py-2 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 "+(Le.includes(e.key)?`bg-gradient-to-r ${Ie(Ve)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:x.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[x.jsx("span",{children:e.name}),Le.includes(e.key)&&x.jsx("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:"ACTIVO"})]})}),x.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:e.tags.map(t=>x.jsx("button",{onClick:()=>(e=>{te(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(t),className:"px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 "+(ee.includes(t)?`bg-gradient-to-r ${Ie(Ve)} text-white shadow-lg`:`${Me(e.color)} hover:bg-opacity-80`),children:t},t))})]},e.key))})})]}),x.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:x.jsxs("button",{onClick:()=>s(!0),className:`flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r ${Ie(Ve)} text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-colors duration-200`,children:[x.jsx(T,{className:"h-5 w-5"}),x.jsxs("span",{children:["SUBIR VIDEO(S) A ",Ve.toUpperCase()]})]})}),x.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:[x.jsx("button",{onClick:()=>Qe("name"===_e?"name-desc":"name"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("name"===_e||"name-desc"===_e?`bg-gradient-to-r ${Ie(Ve)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:x.jsx("span",{children:"name"===_e?"A-Z":"name-desc"===_e?"Z-A":"A-Z"})}),x.jsxs("button",{onClick:()=>Qe("rating"===_e?"rating-desc":"rating"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("rating"===_e||"rating-desc"===_e?`bg-gradient-to-r ${Ie(Ve)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[x.jsx(L,{className:"h-3 w-3"}),x.jsx("span",{children:"rating"===_e?"PuntuaciÃ³n â†“":"rating-desc"===_e?"PuntuaciÃ³n â†‘":"PuntuaciÃ³n"})]}),x.jsxs("button",{onClick:()=>{Ae?"likes"===_e?$e("likes-desc"):"likes-desc"===_e?$e("likes"):(Pe(!1),$e("none")):(Pe(!0),$e("likes"))},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+(Ae?`bg-gradient-to-r ${Ie(Ve)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[x.jsx(O,{className:"h-3 w-3"}),x.jsx("span",{children:Ae?"likes"===_e?"Favoritos â†“":"likes-desc"===_e?"Favoritos â†‘":"Ocultar Favoritos":"Mostrar Favoritos"})]}),(Le.length>0||"none"!==_e||Ae||ee.length>0||se)&&x.jsxs("button",{onClick:()=>{te([]),re(""),Oe([]),$e("none"),Pe(!1)},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800 transition-colors duration-200",title:"Limpiar filtros de bÃºsqueda, tags y ordenamiento",children:[x.jsx(z,{className:"h-3 w-3"}),x.jsx("span",{children:"Limpiar filtros"})]})]}),x.jsxs("div",{className:"mb-8",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Escuela de ",Ve.toLowerCase()," (",Xe.length,")"]}),x.jsxs("div",{className:"flex items-center space-x-4",children:[x.jsx(w,{type:"video",styleColor:Ve}),x.jsxs("button",{onClick:()=>ve(!ye),className:"flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 "+(ye?`bg-gradient-to-r ${Ie(Ve)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),title:ye?"Modo compacto":"Modo ancho completo",children:[ye?x.jsx(V,{className:"w-4 h-4"}):x.jsx(U,{className:"w-4 h-4"}),x.jsx("span",{className:"hidden sm:inline",children:ye?"Compacto":"Ancho"})]})]})]}),q?x.jsxs("div",{className:"flex justify-center items-center py-12",children:[x.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),x.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando videos..."})]}):0===i.length?x.jsxs("div",{className:"text-center py-12",children:[x.jsxs("p",{className:"text-gray-500 text-lg",children:["No hay videos de ",Ve.toLowerCase()," aÃºn"]}),x.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Sube tu primer video de ",Ve.toLowerCase()," usando el botÃ³n de arriba"]})]}):x.jsx("div",{className:"grid gap-6",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${Te(ye).compact||"text-xs"===Te(ye).titleSize?"160px":"text-sm"===Te(ye).titleSize?"240px":"text-xl"===Te(ye).titleSize?"320px":"450px"}, 1fr))`},children:Xe.map(e=>x.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] border-gray-100",children:x.jsxs("div",{className:"relative group",children:[x.jsxs("div",{className:`w-full ${Te(ye).aspect} ${Te(ye).thumbnailSize} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?x.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:`w-full h-full ${Te(ye).imageObject||"object-cover"}`,loading:"lazy",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,x.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 "+(e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?"hidden":"flex"),children:[x.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 002 2v8a2 2 0 002 2z"})}),x.jsx("span",{className:"text-sm font-medium",children:e.title})]}),x.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:e.resolution&&"Unknown"!==e.resolution?e.resolution:"HD"}),x.jsx("button",{onClick:()=>He(e),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 hover:bg-opacity-30 transition-all duration-200 group",children:x.jsx("div",{className:"w-16 h-16 rounded-full bg-white bg-opacity-90 flex items-center justify-center transform scale-0 group-hover:scale-100 transition-transform duration-200",children:x.jsx(F,{className:"w-8 h-8 text-gray-800 ml-1"})})})]}),x.jsxs("div",{className:""+(Te(ye).compact?"p-2":"p-4"),children:[x.jsxs("div",{className:"flex items-center justify-between "+(Te(ye).compact?"mb-1":"mb-2"),children:[x.jsx("h3",{className:`font-semibold text-gray-800 ${Te(ye).titleSize}`,children:e.title}),x.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(t=>{const s=(e.rating||0)>=t;return x.jsx("svg",{className:`${Te(ye).compact?"h-3 w-3":"h-4 w-4"} ${s?"text-yellow-400 fill-current":"text-gray-300"} cursor-pointer`,fill:"currentColor",viewBox:"0 0 24 24",onClick:()=>c(void 0,null,function*(){try{const s=(e.rating||0)>=t?0:t;yield h(e.id,{rating:s},"escuela"),e.rating=s}catch(s){}}),children:x.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},t)}),x.jsxs("span",{className:(Te(ye).compact,"text-xs")+" font-medium text-gray-500 ml-1",children:["(",e.rating||0,")"]})]})]}),x.jsx("p",{className:`text-gray-600 text-sm ${Te(ye).compact?"mb-2":"mb-3"} ${1===Te(ye).descriptionLines?"line-clamp-1":2===Te(ye).descriptionLines?"line-clamp-2":3===Te(ye).descriptionLines?"line-clamp-3":"line-clamp-4"}`,children:e.description||"Sin descripciÃ³n"}),Te(ye).showTags&&x.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const t=(e=>{if(!e.tags||0===Object.keys(e.tags).length)return[];const t=[];return Re.forEach(s=>{const r=e.tags[s.key];Array.isArray(r)&&r.forEach(e=>{t.push({tag:e,categoryKey:s.key,color:s.color})})}),t})(e);return t.length>0?t.map(({tag:e,categoryKey:t,color:s})=>x.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Me(s)}`,children:e},`${t}-${e}`)):x.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),Te(ye).compact?x.jsx(N,{video:e,onLike:()=>Je(e),onEdit:()=>Be(e),onDelete:()=>Ge(e),onDownload:()=>Ze(e),onPlay:()=>He(e),type:"video"}):x.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[x.jsx("div",{className:"flex items-center space-x-2",children:x.jsxs("span",{className:"font-medium",children:[(e.fileSize/1048576).toFixed(2)," MB"]})}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("button",{onClick:()=>He(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Reproducir video",children:x.jsx(F,{className:"h-4 w-4"})}),x.jsxs("button",{onClick:()=>Je(e),className:"flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 "+(e.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"),title:e.userLiked?"Quitar like":"Dar like",children:[x.jsx(O,{className:"h-4 w-4 "+(e.userLiked?"fill-current":"")}),x.jsx("span",{className:"font-medium",children:e.likes||0})]}),x.jsx("button",{onClick:()=>{Ze(e)},className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar video",children:x.jsx(I,{className:"h-4 w-4"})}),x.jsx("button",{onClick:()=>Be(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar video",children:x.jsx(R,{className:"h-4 w-4"})}),x.jsx("button",{onClick:()=>Ge(e),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar video",children:x.jsx(M,{className:"h-4 w-4"})})]})]})]})]})},e.id))})]})]}),x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(B,{isOpen:t,onClose:()=>s(!1),onVideoUploaded:e=>c(void 0,null,function*(){Ke(`${e.title} subido exitosamente`,"success")}),page:"escuela",style:Ve})}),x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(H,{isOpen:r.isOpen,onClose:()=>{a({isOpen:!1,video:null})},video:r.video,onVideoUpdated:e=>{l(t=>t.map(t=>t.id===e.id?e:t)),Ke(`${e.title} actualizado exitosamente`,"success")},page:"escuela",style:Ve})}),we&&be&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:x.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[x.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[x.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["ðŸŽ¬ ",be.title]}),x.jsx("button",{onClick:()=>{Ne(!1),je(null)},className:"text-gray-500 hover:text-gray-700 transition-colors",children:x.jsx(z,{className:"h-6 w-6"})})]}),x.jsx("div",{className:"flex-1 min-h-0 p-4",children:x.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:x.jsx("div",{className:"w-full max-w-md",children:x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(Z,{videos:[be],className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})})]})}),x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(k,{isOpen:X.isOpen,onClose:()=>{Y({isOpen:!1,video:null})},onConfirm:()=>{return e=X.video,c(void 0,null,function*(){try{const t=yield S(e.videoPath,e.thumbnailPath);if(!t.success){if(!t.error||!t.error.includes("thumbnails"))return void Ke(`Error al eliminar archivos: ${t.error}`,"error");if(!(yield S(e.videoPath,null)).success)return void Ke(`Error al eliminar archivos: ${t.error}`,"error")}const s=yield v(e.id,"escuela");if(!s.success)return void Ke(`Error al eliminar metadatos: ${s.error}`,"error");l(t=>t.filter(t=>t.id!==e.id)),Ke(`${e.title} eliminado correctamente`,"success"),Y({isOpen:!1,video:null})}catch(t){Ke("Error inesperado al eliminar video","error")}});var e},title:"ðŸ—‘ï¸ Eliminar Video",message:`Â¿EstÃ¡s seguro de que quieres eliminar el video "${null==(e=X.video)?void 0:e.title}"?\n\nEsta acciÃ³n eliminarÃ¡ permanentemente:\nâ€¢ El archivo de video de Firebase Storage\nâ€¢ El thumbnail del video\nâ€¢ Los metadatos de Firestore\n\nEsta acciÃ³n NO se puede deshacer.`,confirmText:"SÃ­, Eliminar",cancelText:"Cancelar",type:"danger"})}),Q.map(e=>x.jsx(C,{message:e.message,type:e.type,onClose:()=>{return t=e.id,void W(e=>e.filter(e=>e.id!==t));var t}},e.id))]})};export{K as default};
