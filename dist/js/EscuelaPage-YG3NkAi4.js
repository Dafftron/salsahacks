const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/VideoUploadModal-0lX66dnB.js","assets/index-B-R_tmV2.js","js/vendor-react-4yEUTM44.js","js/vendor-router-Bt5THCHr.js","js/vendor-firebase-DVYjp8kH.js","js/vendor-icons-DyUK-N1U.js","css/index-eMS82pKQ.css","js/index-D3P1SmjA.js","js/CompactCardActions-D4wm2qmw.js","js/Toast-Be1tw66C.js","js/VideoPlayer-y_Y5f_Va.js","js/VideoEditModal-BlQxr2Gz.js","js/DownloadModal-BpFaFUaj.js","js/videoCombiner-DnqqtNb9.js","js/SequenceBuilder-BKtyGR2v.js","js/ConfirmModal-qh63TAz-.js","js/SequenceVideoPlayer-KvQSKeoW.js","js/vendor-ffmpeg-BflpXDox.js","js/SequenceGallery-DWoJdJST.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,n=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&l(e,t,s[t]);if(r)for(var t of r(s))i.call(s,t)&&l(e,t,s[t]);return e},o=(e,r)=>s(e,t(r)),c=(e,s,t)=>new Promise((r,a)=>{var i=e=>{try{n(t.next(e))}catch(s){a(s)}},l=e=>{try{n(t.throw(e))}catch(s){a(s)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,l);n((t=t.apply(e,s)).next())});import{u as d,a as m,s as u,j as x,d as h,e as p,f as g,_ as f,t as y,m as v}from"../assets/index-B-R_tmV2.js";import{r as b}from"./vendor-react-4yEUTM44.js";import{u as j,C as w,a as N}from"./CompactCardActions-D4wm2qmw.js";import k from"./ConfirmModal-qh63TAz-.js";import C from"./Toast-Be1tw66C.js";import{a as S}from"./index-D3P1SmjA.js";import{LucideZap as E,LucideStar as L,Heart as _,LucideMusic as O,LucideSearch as $,Filter as P,ChevronUp as A,ChevronDown as D,LucideUpload as T,LucideX as z,LucideMinimize2 as V,LucideMaximize2 as U,LucidePlay as F,Download as I,Edit as R,LucideTrash2 as M,Loader as q}from"./vendor-icons-DyUK-N1U.js";import"./vendor-router-Bt5THCHr.js";import"./vendor-firebase-DVYjp8kH.js";const B=b.lazy(()=>f(()=>import("./VideoUploadModal-0lX66dnB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),H=b.lazy(()=>f(()=>import("./VideoEditModal-BlQxr2Gz.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10])));b.lazy(()=>f(()=>import("./VideoPlayer-y_Y5f_Va.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),b.lazy(()=>f(()=>import("./DownloadModal-BpFaFUaj.js"),__vite__mapDeps([12,1,2,3,4,5,6,13]))),b.lazy(()=>f(()=>import("./SequenceBuilder-BKtyGR2v.js"),__vite__mapDeps([14,1,2,3,4,5,6,8,9,15,10,16,13,17]))),b.lazy(()=>f(()=>import("./SequenceGallery-DWoJdJST.js"),__vite__mapDeps([18,1,2,3,4,5,6,15,9,8])));const Z=b.lazy(()=>f(()=>import("./SequenceVideoPlayer-KvQSKeoW.js"),__vite__mapDeps([16,1,2,3,4,5,6]))),G=()=>x.jsxs("div",{className:"flex items-center justify-center py-8",children:[x.jsx(q,{className:"w-6 h-6 animate-spin text-blue-500"}),x.jsx("span",{className:"ml-2 text-gray-600",children:"Cargando..."})]}),J=(e,s)=>{var t;try{const r=localStorage.getItem("escuela-filters");return null!=(t=(r?JSON.parse(r):{})[e])?t:s}catch(r){return s}},K=()=>{var e;const[s,t]=b.useState(!1),[r,a]=b.useState({isOpen:!1,video:null}),[i,l]=b.useState([]),[q,K]=b.useState(!0),[Q,W]=b.useState([]),[X,Y]=b.useState({isOpen:!1,video:null}),[ee,se]=b.useState(()=>J("selectedTags",[])),[te,re]=b.useState(()=>J("searchTerm","")),[ae,ie]=b.useState(()=>J("showFilters",!1)),[le,ne]=b.useState("videos"),[oe,ce]=b.useState("idle"),[de,me]=b.useState({isOpen:!1,type:null}),[ue,xe]=b.useState({isOpen:!1,sequence:null}),[he,pe]=b.useState({isOpen:!1,sequence:null}),[ge,fe]=b.useState({isOpen:!1}),[ye,ve]=b.useState(!1),[be,je]=b.useState(null),[we,Ne]=b.useState(!1),[ke,Ce]=b.useState(null),[Se,Ee]=b.useState(!1),[Le,_e]=b.useState(()=>J("activeCategoryChips",[])),[Oe,$e]=b.useState(()=>J("sortBy","none")),[Pe,Ae]=b.useState(()=>J("showFavorites",!1)),{user:De,userProfile:Te}=d(),{getVideoConfig:ze,getSequenceConfig:Ve}=m(),[Ue,Fe]=b.useState(()=>J("selectedStyle","salsa")),{availableStyles:Ie,getGradientClasses:Re,categoriesList:Me,getColorClasses:qe}=j("escuela",Ue),Be={Music:O,Heart:_,Star:L,Zap:E};b.useEffect(()=>{ce("syncing");const e=u(Ue,e=>{l(e),K(!1),ce("idle")},"escuela");return()=>{e()}},[Ue]),b.useEffect(()=>{(e=>{try{localStorage.setItem("escuela-filters",JSON.stringify(e))}catch(s){}})({selectedStyle:Ue,selectedTags:ee,searchTerm:te,showFilters:ae,activeCategoryChips:Le,sortBy:Oe,showFavorites:Pe})},[Ue,ee,te,ae,Le,Oe,Pe]),b.useEffect(()=>{if(i.length>0&&De){(()=>c(void 0,null,function*(){const e=yield Promise.all(i.map(e=>c(void 0,null,function*(){try{const[s,t]=yield Promise.all([p(e.id,De.uid),g(e.id,De.uid)]);return o(n({},e),{userLiked:s.userLiked,isFavorite:t.isFavorite})}catch(s){return o(n({},e),{userLiked:!1,isFavorite:!1})}})));l(e)}))()}},[i.length,De]);const He=e=>{a({isOpen:!0,video:e})},Ze=e=>{je(e),Ne(!0)},Ge=e=>c(void 0,null,function*(){if(De&&Te)if("maese"===Te.role||"super_admin"===Te.role)try{Qe(`Iniciando descarga de ${e.title}...`,"info");const{ref:s,getDownloadURL:t}=yield f(()=>c(void 0,null,function*(){const{ref:e,getDownloadURL:s}=yield import("./vendor-firebase-DVYjp8kH.js").then(e=>e.J);return{ref:e,getDownloadURL:s}}),[]),{storage:r}=yield f(()=>c(void 0,null,function*(){const{storage:e}=yield import("../assets/index-B-R_tmV2.js").then(e=>e.N);return{storage:e}}),__vite__mapDeps([1,2,3,4,5,6])),a=s(r,e.videoPath),i=yield t(a),l=new AbortController,n=setTimeout(()=>l.abort(),3e4),o=yield fetch(i,{signal:l.signal});if(clearTimeout(n),!o.ok)throw new Error(`Error HTTP: ${o.status} ${o.statusText}`);const d=yield o.blob();if(0===d.size)throw new Error("Archivo de video vacío");const m=URL.createObjectURL(d),u=document.createElement("a");u.href=m,u.download=`${e.title||"video"}.mp4`,u.target="_blank",u.rel="noopener noreferrer",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(m),Qe("✅ Descarga completada exitosamente","success")}catch(s){"AbortError"===s.name?Qe("❌ Descarga cancelada por timeout (30s)","error"):Qe(`❌ Error al descargar: ${s.message}`,"error")}else Qe("❌ Solo los maestros pueden descargar videos","error");else Qe("❌ Debes iniciar sesión para descargar videos","error")}),Je=e=>{Y({isOpen:!0,video:e})},Ke=e=>c(void 0,null,function*(){if(De)try{const s=yield y(e.id,De.uid,"escuela");if(s.success){l(t=>t.map(t=>t.id===e.id?o(n({},t),{likes:s.likes,likedBy:s.likedBy,userLiked:s.userLiked,isFavorite:s.isFavorite}):t));const t=s.userLiked?"dado like a":"quitado like de",r=s.isFavorite?"y agregado a favoritos":"y removido de favoritos";Qe(`Has ${t} "${e.title}" ${r}`,"success")}else Qe("Error al actualizar like","error")}catch(s){Qe("Error al actualizar like","error")}else Qe("Debes iniciar sesión para dar like","error")}),Qe=(e,s="success")=>{const t=Date.now();W(r=>[...r,{id:t,message:e,type:s}])},We=e=>{$e(e)},Xe=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),Ye=(e=>{if("none"===Oe)return e;const s=[...e];switch(Oe){case"name":return s.sort((e,s)=>e.title.localeCompare(s.title));case"name-desc":return s.sort((e,s)=>s.title.localeCompare(e.title));case"rating":return s.sort((e,s)=>(s.rating||0)-(e.rating||0));case"rating-desc":return s.sort((e,s)=>(e.rating||0)-(s.rating||0));case"likes":return s.sort((e,s)=>(s.likes||0)-(e.likes||0));case"likes-desc":return s.sort((e,s)=>(e.likes||0)-(s.likes||0));default:return s}})(i.filter(e=>{const s=te.split(" ").map(e=>e.trim()).filter(e=>e.length>0),t=((e,s)=>{if(!s||0===s.length)return!0;const t=Xe(e.title||""),r=Xe(e.description||""),a=[];return e.tags&&Object.values(e.tags).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{a.push(Xe(e))})}),s.every(e=>{const s=Xe(e);return!!t.includes(s)||!!r.includes(s)||!!a.some(e=>e.includes(s))})})(e,s),r=0===ee.length||ee.every(s=>!!e.tags&&Object.values(e.tags).some(e=>Array.isArray(e)&&e.includes(s))),a=0===Le.length||Le.some(s=>((e,s)=>{if(!e.tags)return!1;if(!Me.find(e=>e.key===s))return!1;const t=e.tags[s];return t&&Array.isArray(t)&&t.length>0})(e,s)),i=!Pe||e.isFavorite;return t&&r&&a&&i}));return x.jsxs("div",{className:"min-h-screen bg-white",children:[x.jsxs("div",{className:(ye?"w-full px-0":"max-w-6xl mx-auto px-6")+" py-8",children:[x.jsxs("div",{className:"text-center mb-8",children:[x.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[x.jsx("span",{className:"text-purple-500",children:"ESCUELA"}),x.jsxs("span",{className:`bg-gradient-to-r ${Re(Ue)} bg-clip-text text-transparent`,children:[" - ",Ue.toUpperCase()]})]}),x.jsxs("p",{className:"text-gray-600 text-lg",children:["Galería de videos de escuela de ",Ue.toLowerCase()]})]}),x.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:Ie.map(e=>{const s=Be[e.icon],t=Ue===e.key,r=Re(e.color);return x.jsxs("button",{onClick:()=>Fe(e.key),className:"relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 "+(t?`bg-gradient-to-r ${r} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:[s&&x.jsx(s,{className:"h-4 w-4"}),x.jsx("span",{children:e.name})]},e.name)})}),x.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:x.jsxs("div",{className:"relative",children:[x.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),x.jsx("input",{type:"text",placeholder:`Buscar en ${Ue.toLowerCase()}... (múltiples palabras, sin tildes)`,value:te,onChange:e=>re(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]})}),Me.length>0&&x.jsxs("div",{className:"mb-8",children:[x.jsxs("button",{onClick:()=>ie(!ae),className:"flex items-center justify-center space-x-2 mx-auto px-6 py-3 bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[x.jsx(P,{className:"h-5 w-5"}),x.jsxs("span",{children:["Filtros Avanzados por Tags - ",Ue]}),ae?x.jsx(A,{className:"h-5 w-5"}):x.jsx(D,{className:"h-5 w-5"})]}),x.jsx("div",{className:"mt-4 transition-all duration-300 ease-in-out overflow-hidden "+(ae?"max-h-screen opacity-100":"max-h-0 opacity-0"),children:x.jsx("div",{className:"space-y-4 bg-gray-50 rounded-lg p-6 border border-gray-200 max-h-96 overflow-y-auto",children:Me.map(e=>x.jsxs("div",{className:"space-y-2",children:[x.jsx("button",{onClick:()=>{return s=e.key,void _e(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},className:"w-full text-center font-medium py-2 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 "+(Le.includes(e.key)?`bg-gradient-to-r ${Re(Ue)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:x.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[x.jsx("span",{children:e.name}),Le.includes(e.key)&&x.jsx("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:"ACTIVO"})]})}),x.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:e.tags.map(s=>x.jsx("button",{onClick:()=>(e=>{se(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])})(s),className:"px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 "+(ee.includes(s)?`bg-gradient-to-r ${Re(Ue)} text-white shadow-lg`:`${qe(e.color)} hover:bg-opacity-80`),children:s},s))})]},e.key))})})]}),("maese"===(null==Te?void 0:Te.role)||"super_admin"===(null==Te?void 0:Te.role))&&x.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:x.jsxs("button",{onClick:()=>t(!0),className:`flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r ${Re(Ue)} text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-colors duration-200`,children:[x.jsx(T,{className:"h-5 w-5"}),x.jsxs("span",{children:["SUBIR VIDEO(S) A ",Ue.toUpperCase()]})]})}),x.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:[x.jsx("button",{onClick:()=>We("name"===Oe?"name-desc":"name"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("name"===Oe||"name-desc"===Oe?`bg-gradient-to-r ${Re(Ue)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:x.jsx("span",{children:"name"===Oe?"A-Z":"name-desc"===Oe?"Z-A":"A-Z"})}),x.jsxs("button",{onClick:()=>We("rating"===Oe?"rating-desc":"rating"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("rating"===Oe||"rating-desc"===Oe?`bg-gradient-to-r ${Re(Ue)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[x.jsx(L,{className:"h-3 w-3"}),x.jsx("span",{children:"rating"===Oe?"Puntuación ↓":"rating-desc"===Oe?"Puntuación ↑":"Puntuación"})]}),x.jsxs("button",{onClick:()=>{Pe?"likes"===Oe?$e("likes-desc"):"likes-desc"===Oe?$e("likes"):(Ae(!1),$e("none")):(Ae(!0),$e("likes"))},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+(Pe?`bg-gradient-to-r ${Re(Ue)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[x.jsx(_,{className:"h-3 w-3"}),x.jsx("span",{children:Pe?"likes"===Oe?"Favoritos ↓":"likes-desc"===Oe?"Favoritos ↑":"Ocultar Favoritos":"Mostrar Favoritos"})]}),(Le.length>0||"none"!==Oe||Pe||ee.length>0||te)&&x.jsxs("button",{onClick:()=>{se([]),re(""),_e([]),$e("none"),Ae(!1)},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800 transition-colors duration-200",title:"Limpiar filtros de búsqueda, tags y ordenamiento",children:[x.jsx(z,{className:"h-3 w-3"}),x.jsx("span",{children:"Limpiar filtros"})]})]}),x.jsxs("div",{className:"mb-8",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Escuela de ",Ue.toLowerCase()," (",Ye.length,")"]}),x.jsxs("div",{className:"flex items-center space-x-4",children:[x.jsx(w,{type:"video",styleColor:Ue}),x.jsxs("button",{onClick:()=>ve(!ye),className:"flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 "+(ye?`bg-gradient-to-r ${Re(Ue)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),title:ye?"Modo compacto":"Modo ancho completo",children:[ye?x.jsx(V,{className:"w-4 h-4"}):x.jsx(U,{className:"w-4 h-4"}),x.jsx("span",{className:"hidden sm:inline",children:ye?"Compacto":"Ancho"})]})]})]}),q?x.jsxs("div",{className:"flex justify-center items-center py-12",children:[x.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),x.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando videos..."})]}):0===i.length?x.jsxs("div",{className:"text-center py-12",children:[x.jsxs("p",{className:"text-gray-500 text-lg",children:["No hay videos de ",Ue.toLowerCase()," aún"]}),x.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Sube tu primer video de ",Ue.toLowerCase()," usando el botón de arriba"]})]}):x.jsx("div",{className:"grid gap-6",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${ze(ye).compact||"text-xs"===ze(ye).titleSize?"160px":"text-sm"===ze(ye).titleSize?"240px":"text-xl"===ze(ye).titleSize?"320px":"450px"}, 1fr))`},children:Ye.map(e=>x.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] border-gray-100",children:x.jsxs("div",{className:"relative group",children:[x.jsxs("div",{className:`w-full ${ze(ye).aspect} ${ze(ye).thumbnailSize} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?x.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:`w-full h-full ${ze(ye).imageObject||"object-cover"}`,loading:"lazy",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,x.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 "+(e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?"hidden":"flex"),children:[x.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 002 2v8a2 2 0 002 2z"})}),x.jsx("span",{className:"text-sm font-medium",children:e.title})]}),x.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:e.resolution&&"Unknown"!==e.resolution?e.resolution:"HD"}),x.jsx("button",{onClick:()=>Ze(e),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 hover:bg-opacity-30 transition-all duration-200 group",children:x.jsx("div",{className:"w-16 h-16 rounded-full bg-white bg-opacity-90 flex items-center justify-center transform scale-0 group-hover:scale-100 transition-transform duration-200",children:x.jsx(F,{className:"w-8 h-8 text-gray-800 ml-1"})})})]}),x.jsxs("div",{className:""+(ze(ye).compact?"p-2":"p-4"),children:[x.jsxs("div",{className:"flex items-center justify-between "+(ze(ye).compact?"mb-1":"mb-2"),children:[x.jsx("h3",{className:`font-semibold text-gray-800 ${ze(ye).titleSize}`,children:e.title}),x.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(s=>{const t=(e.rating||0)>=s;return x.jsx("svg",{className:`${ze(ye).compact?"h-3 w-3":"h-4 w-4"} ${t?"text-yellow-400 fill-current":"text-gray-300"} cursor-pointer`,fill:"currentColor",viewBox:"0 0 24 24",onClick:()=>c(void 0,null,function*(){try{const t=(e.rating||0)>=s?0:s;yield h(e.id,{rating:t},"escuela"),e.rating=t}catch(t){}}),children:x.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},s)}),x.jsxs("span",{className:(ze(ye).compact,"text-xs")+" font-medium text-gray-500 ml-1",children:["(",e.rating||0,")"]})]})]}),x.jsx("p",{className:`text-gray-600 text-sm ${ze(ye).compact?"mb-2":"mb-3"} ${1===ze(ye).descriptionLines?"line-clamp-1":2===ze(ye).descriptionLines?"line-clamp-2":3===ze(ye).descriptionLines?"line-clamp-3":"line-clamp-4"}`,children:e.description||"Sin descripción"}),ze(ye).showTags&&x.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const s=(e=>{if(!e.tags||0===Object.keys(e.tags).length)return[];const s=[];return Me.forEach(t=>{const r=e.tags[t.key];Array.isArray(r)&&r.forEach(e=>{s.push({tag:e,categoryKey:t.key,color:t.color})})}),s})(e);return s.length>0?s.map(({tag:e,categoryKey:s,color:t})=>x.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${qe(t)}`,children:e},`${s}-${e}`)):x.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),ze(ye).compact?x.jsx(N,{video:e,onLike:()=>Ke(e),onEdit:()=>He(e),onDelete:()=>Je(e),onDownload:"maese"===(null==Te?void 0:Te.role)||"super_admin"===(null==Te?void 0:Te.role)?()=>Ge(e):void 0,onPlay:()=>Ze(e),type:"video"}):x.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[x.jsx("div",{className:"flex items-center space-x-2",children:x.jsxs("span",{className:"font-medium",children:[(e.fileSize/1048576).toFixed(2)," MB"]})}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("button",{onClick:()=>Ze(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Reproducir video",children:x.jsx(F,{className:"h-4 w-4"})}),x.jsxs("button",{onClick:()=>Ke(e),className:"flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 "+(e.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"),title:e.userLiked?"Quitar like":"Dar like",children:[x.jsx(_,{className:"h-4 w-4 "+(e.userLiked?"fill-current":"")}),x.jsx("span",{className:"font-medium",children:e.likes||0})]}),("maese"===(null==Te?void 0:Te.role)||"super_admin"===(null==Te?void 0:Te.role))&&x.jsx("button",{onClick:()=>{Ge(e)},className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar video",children:x.jsx(I,{className:"h-4 w-4"})}),x.jsx("button",{onClick:()=>He(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar video",children:x.jsx(R,{className:"h-4 w-4"})}),x.jsx("button",{onClick:()=>Je(e),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar video",children:x.jsx(M,{className:"h-4 w-4"})})]})]})]})]})},e.id))})]})]}),x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(B,{isOpen:s,onClose:()=>t(!1),onVideoUploaded:e=>c(void 0,null,function*(){Qe(`${e.title} subido exitosamente`,"success")}),page:"escuela",style:Ue})}),x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(H,{isOpen:r.isOpen,onClose:()=>{a({isOpen:!1,video:null})},video:r.video,onVideoUpdated:e=>{l(s=>s.map(s=>s.id===e.id?e:s)),Qe(`${e.title} actualizado exitosamente`,"success")},page:"escuela",style:Ue})}),we&&be&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:x.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[x.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[x.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["🎬 ",be.title]}),x.jsx("button",{onClick:()=>{Ne(!1),je(null)},className:"text-gray-500 hover:text-gray-700 transition-colors",children:x.jsx(z,{className:"h-6 w-6"})})]}),x.jsx("div",{className:"flex-1 min-h-0 p-4",children:x.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:x.jsx("div",{className:"w-full max-w-md",children:x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(Z,{videos:[be],className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})})]})}),x.jsx(b.Suspense,{fallback:x.jsx(G,{}),children:x.jsx(k,{isOpen:X.isOpen,onClose:()=>{Y({isOpen:!1,video:null})},onConfirm:()=>{return e=X.video,c(void 0,null,function*(){try{const s=yield S(e.videoPath,e.thumbnailPath);if(!s.success){if(!s.error||!s.error.includes("thumbnails"))return void Qe(`Error al eliminar archivos: ${s.error}`,"error");if(!(yield S(e.videoPath,null)).success)return void Qe(`Error al eliminar archivos: ${s.error}`,"error")}const t=yield v(e.id,"escuela");if(!t.success)return void Qe(`Error al eliminar metadatos: ${t.error}`,"error");l(s=>s.filter(s=>s.id!==e.id)),Qe(`${e.title} eliminado correctamente`,"success"),Y({isOpen:!1,video:null})}catch(s){Qe("Error inesperado al eliminar video","error")}});var e},title:"🗑️ Eliminar Video",message:`¿Estás seguro de que quieres eliminar el video "${null==(e=X.video)?void 0:e.title}"?\n\nEsta acción eliminará permanentemente:\n• El archivo de video de Firebase Storage\n• El thumbnail del video\n• Los metadatos de Firestore\n\nEsta acción NO se puede deshacer.`,confirmText:"Sí, Eliminar",cancelText:"Cancelar",type:"danger"})}),Q.map(e=>x.jsx(C,{message:e.message,type:e.type,onClose:()=>{return s=e.id,void W(e=>e.filter(e=>e.id!==s));var s}},e.id))]})};export{K as default};
