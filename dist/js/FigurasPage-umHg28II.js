const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/VideoUploadModal-CdHBUzt2.js","assets/index-DlNQbxiw.js","js/vendor-react-4yEUTM44.js","js/vendor-router-Bt5THCHr.js","js/vendor-firebase-DVYjp8kH.js","js/vendor-icons-DyUK-N1U.js","css/index-CLnZnxZk.css","js/index-DVS0NbFa.js","js/CompactCardActions-BNZAxj1W.js","js/Toast-BAwXX7P8.js","js/VideoPlayer-VIDrPsDa.js","js/VideoEditModal-B6TsQw_X.js","js/DownloadModal-BaOMLQiD.js","js/videoCombiner-Dxl_3b6b.js","js/SequenceBuilder-D_4exC9q.js","js/ConfirmModal-DO4mP3dg.js","js/SequenceVideoPlayer-FBggOKfg.js","js/vendor-ffmpeg-BflpXDox.js","js/SequenceGallery-DW97Y4oZ.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,l=(e,s)=>{for(var t in s||(s={}))r.call(s,t)&&n(e,t,s[t]);if(a)for(var t of a(s))i.call(s,t)&&n(e,t,s[t]);return e},o=(e,a)=>s(e,t(a)),c=(e,s,t)=>new Promise((a,r)=>{var i=e=>{try{l(t.next(e))}catch(s){r(s)}},n=e=>{try{l(t.throw(e))}catch(s){r(s)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);l((t=t.apply(e,s)).next())});import{u as d,a as u,b as m,s as x,j as p,_ as h,d as g,t as f,e as y,f as v,g as b,h as j,i as w,k as N,l as k,m as E}from"../assets/index-DlNQbxiw.js";import{r as C,a as L}from"./vendor-react-4yEUTM44.js";import{u as S,C as $,a as O}from"./CompactCardActions-BNZAxj1W.js";import A from"./ConfirmModal-DO4mP3dg.js";import _ from"./Toast-BAwXX7P8.js";import{subscribeToSequencesByStyle as q,updateSequence as z,createSequence as T,deleteSequence as D}from"./sequences-CSk0lC7-.js";import{m as R,c as M,d as V,a as P}from"./index-DVS0NbFa.js";import{LucideZap as F,LucideStar as I,Heart as U,LucideMusic as B,LucideSearch as H,Filter as K,ChevronUp as G,ChevronDown as W,LucideUpload as Z,LucideShuffle as Q,LucidePlus as J,LucideX as X,LucideMinimize2 as Y,LucideMaximize2 as ee,EyeOff as se,Eye as te,LucidePlay as ae,Download as re,Edit as ie,LucideTrash2 as ne,Loader as le}from"./vendor-icons-DyUK-N1U.js";import"./vendor-router-Bt5THCHr.js";import"./vendor-firebase-DVYjp8kH.js";const oe=C.lazy(()=>h(()=>import("./VideoUploadModal-CdHBUzt2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ce=C.lazy(()=>h(()=>import("./VideoEditModal-B6TsQw_X.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10]))),de=C.lazy(()=>h(()=>import("./VideoPlayer-VIDrPsDa.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),ue=C.lazy(()=>h(()=>import("./DownloadModal-BaOMLQiD.js"),__vite__mapDeps([12,1,2,3,4,5,6,13]))),me=C.lazy(()=>h(()=>import("./SequenceBuilder-D_4exC9q.js"),__vite__mapDeps([14,1,2,3,4,5,6,8,9,15,10,16,13,17]))),xe=C.lazy(()=>h(()=>import("./SequenceGallery-DW97Y4oZ.js"),__vite__mapDeps([18,1,2,3,4,5,6,15,9,8]))),pe=C.lazy(()=>h(()=>import("./SequenceVideoPlayer-FBggOKfg.js"),__vite__mapDeps([16,1,2,3,4,5,6]))),he=()=>p.jsxs("div",{className:"flex items-center justify-center py-8",children:[p.jsx(le,{className:"w-6 h-6 animate-spin text-blue-500"}),p.jsx("span",{className:"ml-2 text-gray-600",children:"Cargando..."})]}),ge=()=>{var e,s;const[t,a]=C.useState(!1),[r,i]=C.useState({isOpen:!1,video:null}),[n,le]=C.useState([]),[ge,fe]=C.useState(!0),[ye,ve]=C.useState([]),[be,je]=C.useState({isOpen:!1,video:null}),[we,Ne]=C.useState([]),[ke,Ee]=C.useState(""),[Ce,Le]=C.useState(!1),[Se,$e]=C.useState("videos"),[Oe,Ae]=C.useState("idle"),[_e,qe]=C.useState({isOpen:!1,type:null}),[ze,Te]=C.useState({isOpen:!1,sequence:null}),[De,Re]=C.useState({isOpen:!1,sequence:null}),[Me,Ve]=C.useState({isOpen:!1}),[Pe,Fe]=C.useState(!1),[Ie,Ue]=C.useState(null),[Be,He]=C.useState(!1),[Ke,Ge]=C.useState(null),[We,Ze]=C.useState(!1),[Qe,Je]=C.useState([]),[Xe,Ye]=C.useState("none"),[es,ss]=C.useState(!1),[ts,as]=C.useState([]),[rs,is]=C.useState(!0),{user:ns,userProfile:ls}=d(),{getVideoConfig:os,getSequenceConfig:cs}=u(),{addVideoToSequence:ds,removeVideoFromSequence:us,sequence:ms,sequenceName:xs,clearSequence:ps,isBuilderOpen:hs,toggleBuilder:gs,showAllVideos:fs,toggleShowAllVideos:ys,getFilteredVideos:vs,isVideoInSequence:bs,isVideoCompatible:js,checkCompatibility:ws,loadSequence:Ns}=m(),[ks,Es]=C.useState("salsa"),{availableStyles:Cs,getGradientClasses:Ls,categoriesList:Ss,getColorClasses:$s}=S("figuras",ks),Os=e=>{ds(e),hs||gs()},As={Music:B,Heart:U,Star:I,Zap:F};C.useEffect(()=>{Ae("syncing");const e=x(ks,e=>{le(e),fe(!1),Ae("idle")});return()=>{e()}},[ks]),C.useEffect(()=>{if(n.length>0&&ns){(()=>c(void 0,null,function*(){const e=yield Promise.all(n.map(e=>c(void 0,null,function*(){try{const[s,t]=yield Promise.all([y(e.id,ns.uid),v(e.id,ns.uid)]);return o(l({},e),{userLiked:s.userLiked,isFavorite:t.isFavorite})}catch(s){return o(l({},e),{userLiked:!1,isFavorite:!1})}})));le(e)}))()}},[n.length,ns]),C.useEffect(()=>{if(ks){is(!0);try{const e=q(ks,e=>{as(e),is(!1)});return()=>{e()}}catch(e){is(!1)}}},[ks]);const _s=e=>{i({isOpen:!0,video:e})},qs=e=>c(void 0,null,function*(){if(ns)try{const s=yield f(e.id,ns.uid);if(s.success){le(t=>t.map(t=>t.id===e.id?o(l({},t),{likes:s.likes,likedBy:s.likedBy,userLiked:s.userLiked,isFavorite:s.isFavorite}):t));const t=s.userLiked?"dado like a":"quitado like de",a=s.isFavorite?"y agregado a favoritos":"y removido de favoritos";zs(`Has ${t} "${e.title}" ${a}`,"success")}else zs("Error al actualizar like","error")}catch(s){zs("Error al actualizar like","error")}else zs("Debes iniciar sesi√≥n para dar like","error")}),zs=(e,s="success")=>{const t=Date.now();ve(a=>[...a,{id:t,message:e,type:s}])},Ts=()=>{Re({isOpen:!1,sequence:null})},Ds=e=>{Ue(e),He(!0),zs(`üé¨ Reproduciendo: ${e.title}`,"info")},Rs=e=>{je({isOpen:!0,video:e})},Ms=e=>{qe({isOpen:!0,type:e})},Vs=e=>{Ye(e)},Ps=e=>{if(!e.tags||0===Object.keys(e.tags).length)return[];const s=[];return Ss.forEach(t=>{const a=e.tags[t.key];Array.isArray(a)&&a.forEach(e=>{s.push({tag:e,categoryKey:t.key,color:t.color})})}),s},Fs=e=>{if(!e.tagsIniciales||0===Object.keys(e.tagsIniciales).length)return[];const s=[];return Ss.forEach(t=>{const a=e.tagsIniciales[t.key];Array.isArray(a)&&a.forEach(e=>{s.push({tag:e,categoryKey:t.key,color:t.color,type:"inicial"})})}),s},Is=e=>{if(!e.tagsFinales||0===Object.keys(e.tagsFinales).length)return[];const s=[];return Ss.forEach(t=>{const a=e.tagsFinales[t.key];Array.isArray(a)&&a.forEach(e=>{s.push({tag:e,categoryKey:t.key,color:t.color,type:"final"})})}),s},Us=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),Bs=(e=>{if("none"===Xe)return e;const s=[...e];switch(Xe){case"name":return s.sort((e,s)=>e.title.localeCompare(s.title));case"name-desc":return s.sort((e,s)=>s.title.localeCompare(e.title));case"rating":return s.sort((e,s)=>(s.rating||0)-(e.rating||0));case"rating-desc":return s.sort((e,s)=>(e.rating||0)-(s.rating||0));case"likes":return s.sort((e,s)=>(s.likes||0)-(e.likes||0));case"likes-desc":return s.sort((e,s)=>(e.likes||0)-(s.likes||0));default:return s}})(vs(n.filter(e=>{const s=ke.split(" ").map(e=>e.trim()).filter(e=>e.length>0),t=((e,s)=>{if(!s||0===s.length)return!0;const t=Us(e.title||""),a=Us(e.description||""),r=[];return e.tags&&Object.values(e.tags).forEach(e=>{Array.isArray(e)&&e.forEach(e=>{r.push(Us(e))})}),s.every(e=>{const s=Us(e);return!!t.includes(s)||!!a.includes(s)||!!r.some(e=>e.includes(s))})})(e,s),a=0===we.length||we.every(s=>!!e.tags&&Object.values(e.tags).some(e=>Array.isArray(e)&&e.includes(s))),r=0===Qe.length||Qe.some(s=>((e,s)=>{if(!e.tags)return!1;if(!Ss.find(e=>e.key===s))return!1;const t=e.tags[s];return t&&Array.isArray(t)&&t.length>0})(e,s)),i=!es||e.isFavorite;return t&&a&&r&&i}))),Hs=e=>c(void 0,null,function*(){if(ns&&ls)if("maese"===ls.role||"super_admin"===ls.role)try{const{ref:s,getDownloadURL:t}=yield h(()=>c(void 0,null,function*(){const{ref:e,getDownloadURL:s}=yield import("./vendor-firebase-DVYjp8kH.js").then(e=>e.J);return{ref:e,getDownloadURL:s}}),[]),{storage:a}=yield h(()=>c(void 0,null,function*(){const{storage:e}=yield import("../assets/index-DlNQbxiw.js").then(e=>e.N);return{storage:e}}),__vite__mapDeps([1,2,3,4,5,6])),r=s(a,e.videoPath),i=yield t(r),n=new AbortController,l=setTimeout(()=>n.abort(),3e4),o=yield fetch(i,{signal:n.signal});if(clearTimeout(l),!o.ok)throw new Error(`Error HTTP: ${o.status} ${o.statusText}`);const d=yield o.blob();if(0===d.size)throw new Error("Archivo de video vac√≠o");const u=URL.createObjectURL(d),m=document.createElement("a");m.href=u,m.download=`${e.title||"video"}.mp4`,m.target="_blank",m.rel="noopener noreferrer",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(u),zs("‚úÖ Descarga completada exitosamente","success")}catch(s){zs(`‚ùå Error al descargar: ${s.message}`,"error")}else zs("‚ùå Solo los maestros pueden descargar videos","error");else zs("‚ùå Debes iniciar sesi√≥n para descargar videos","error")});return p.jsxs("div",{className:"min-h-screen bg-white",children:[p.jsxs("div",{className:(Pe?"w-full px-0":"max-w-6xl mx-auto px-6")+" py-8",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[p.jsx("span",{className:"text-pink-500",children:"FIGURAS"}),p.jsxs("span",{className:`bg-gradient-to-r ${Ls(ks)} bg-clip-text text-transparent`,children:[" - ",ks.toUpperCase()]})]}),p.jsxs("p",{className:"text-gray-600 text-lg",children:["Galer√≠a de videos de figuras de ",ks.toLowerCase()]})]}),p.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:Cs.map(e=>{const s=As[e.icon],t=ks===e.key,a=Ls(e.color);return p.jsxs("button",{onClick:()=>Es(e.key),className:"relative flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 "+(t?`bg-gradient-to-r ${a} text-white shadow-lg transform scale-105`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:[s&&p.jsx(s,{className:"h-4 w-4"}),p.jsx("span",{children:e.name})]},e.name)})}),p.jsxs("div",{className:"max-w-2xl mx-auto mb-8",children:[p.jsxs("div",{className:"relative",children:[p.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),p.jsx("input",{type:"text",placeholder:`Buscar en ${ks.toLowerCase()}... (m√∫ltiples palabras, sin tildes)`,value:ke,onChange:e=>Ee(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all duration-200"})]}),ke.trim()&&p.jsx("div",{className:"mt-3 text-center",children:p.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[p.jsx(H,{className:"h-4 w-4 text-blue-500"}),p.jsxs("span",{className:"text-sm text-blue-700",children:["Buscando: ",p.jsxs("span",{className:"font-medium",children:['"',ke,'"']})]}),p.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded",children:[Bs.length," resultado",1!==Bs.length?"s":""]})]})})]}),Ss.length>0&&p.jsxs("div",{className:"mb-8",children:[p.jsxs("button",{onClick:()=>Le(!Ce),className:"flex items-center justify-center space-x-2 mx-auto px-6 py-3 bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105",children:[p.jsx(K,{className:"h-5 w-5"}),p.jsxs("span",{children:["Filtros Avanzados por Tags - ",ks]}),Ce?p.jsx(G,{className:"h-5 w-5"}):p.jsx(W,{className:"h-5 w-5"})]}),p.jsx("div",{className:"mt-4 transition-all duration-300 ease-in-out overflow-hidden "+(Ce?"max-h-96 opacity-100":"max-h-0 opacity-0"),children:p.jsx("div",{className:"space-y-4 bg-gray-50 rounded-lg p-6 border border-gray-200",children:Ss.map(e=>p.jsxs("div",{className:"space-y-2",children:[p.jsx("button",{onClick:()=>{return s=e.key,void Je(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},className:"w-full text-center font-medium py-2 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 "+(Qe.includes(e.key)?`bg-gradient-to-r ${Ls(ks)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),children:p.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[p.jsx("span",{children:e.name}),Qe.includes(e.key)&&p.jsx("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:"ACTIVO"})]})}),p.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:e.tags.map(s=>p.jsx("button",{onClick:()=>(e=>{Ne(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])})(s),className:"px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 "+(we.includes(s)?`bg-gradient-to-r ${Ls(ks)} text-white shadow-lg`:`${$s(e.color)} hover:bg-opacity-80`),children:s},s))})]},e.key))})})]}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:[("maese"===(null==ls?void 0:ls.role)||"super_admin"===(null==ls?void 0:ls.role))&&p.jsxs("button",{onClick:()=>a(!0),className:`flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r ${Ls(ks)} text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-colors duration-200`,children:[p.jsx(Z,{className:"h-5 w-5"}),p.jsxs("span",{children:["SUBIR VIDEO(S) A ",ks.toUpperCase()]})]}),p.jsxs("button",{onClick:gs,className:"flex items-center justify-center space-x-2 px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-colors duration-200 "+(hs?"bg-gradient-to-r from-red-500 to-pink-500 text-white":`bg-gradient-to-r ${Ls(ks)} hover:opacity-90 text-white`),children:[p.jsx(Q,{className:"h-5 w-5"}),p.jsx("span",{children:hs?"OCULTAR SECUENCIA":"CREAR SECUENCIA"})]})]}),hs&&p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(me,{isOpen:!0,videos:n,onSaveSequence:e=>c(void 0,null,function*(){try{const s=o(l({},e),{style:ks});if(e.id){yield z(e.id,s);zs("‚úÖ Secuencia actualizada exitosamente")}else{yield T(s);zs('‚úÖ Secuencia guardada exitosamente. Ve a "GALER√çA DE SECUENCIAS" para verla.')}}catch(s){throw zs("Error al guardar la secuencia","error"),s}}),onToggleShowAll:ys,showAllVideos:fs,style:ks,onToggleBuilder:gs})}),p.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[p.jsxs("button",{onClick:()=>$e("videos"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors duration-200 "+("videos"===Se?`bg-gradient-to-r ${Ls(ks)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[p.jsx(B,{className:"h-6 w-6"}),p.jsx("span",{children:"GALER√çA DE VIDEOS"})]}),p.jsxs("button",{onClick:()=>$e("secuencias"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors duration-200 "+("secuencias"===Se?`bg-gradient-to-r ${Ls(ks)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[p.jsx(J,{className:"h-6 w-6"}),p.jsxs("span",{children:["GALER√çA DE SECUENCIAS (",ts.length,")"]})]})]}),p.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:[p.jsx("button",{onClick:()=>Vs("name"===Xe?"name-desc":"name"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("name"===Xe||"name-desc"===Xe?`bg-gradient-to-r ${Ls(ks)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:p.jsx("span",{children:"name"===Xe?"A-Z":"name-desc"===Xe?"Z-A":"A-Z"})}),p.jsxs("button",{onClick:()=>Vs("rating"===Xe?"rating-desc":"rating"),className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+("rating"===Xe||"rating-desc"===Xe?`bg-gradient-to-r ${Ls(ks)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[p.jsx(I,{className:"h-3 w-3"}),p.jsx("span",{children:"rating"===Xe?"Puntuaci√≥n ‚Üì":"rating-desc"===Xe?"Puntuaci√≥n ‚Üë":"Puntuaci√≥n"})]}),p.jsxs("button",{onClick:()=>{es?"likes"===Xe?Ye("likes-desc"):"likes-desc"===Xe?Ye("likes"):(ss(!1),Ye("none")):(ss(!0),Ye("likes"))},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 "+(es?`bg-gradient-to-r ${Ls(ks)} text-white shadow-md`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50"),children:[p.jsx(U,{className:"h-3 w-3"}),p.jsx("span",{children:es?"likes"===Xe?"Favoritos ‚Üì":"likes-desc"===Xe?"Favoritos ‚Üë":"Ocultar Favoritos":"Mostrar Favoritos"})]}),(Qe.length>0||"none"!==Xe||es)&&p.jsxs("button",{onClick:()=>{Je([]),Ye("none"),ss(!1)},className:"flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800 transition-colors duration-200",children:[p.jsx(X,{className:"h-3 w-3"}),p.jsx("span",{children:"Limpiar filtros"})]})]}),"videos"===Se&&p.jsxs("div",{className:"mb-8",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsxs("div",{children:[p.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Videos de ",ks.toLowerCase()," (",Bs.length,")"]}),(Qe.length>0||"none"!==Xe||es)&&p.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[Qe.length>0&&`Filtrado por: ${Qe.join(", ")} `,"none"!==Xe&&`‚Ä¢ Ordenado por: ${Xe} `,es&&"‚Ä¢ Solo favoritos"]})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx($,{type:"video",styleColor:ks}),p.jsxs("button",{onClick:()=>Fe(!Pe),className:"flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 "+(Pe?`bg-gradient-to-r ${Ls(ks)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),title:Pe?"Modo compacto":"Modo ancho completo",children:[Pe?p.jsx(Y,{className:"h-4 w-4"}):p.jsx(ee,{className:"h-4 w-4"}),p.jsx("span",{className:"hidden sm:inline",children:Pe?"Compacto":"Ancho completo"})]}),hs&&p.jsx("button",{onClick:ys,className:"flex items-center space-x-2 px-3 py-1 rounded-lg text-sm font-medium transition-colors "+(fs?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),title:fs?"Mostrar solo videos compatibles":"Mostrar todos los videos",children:fs?p.jsxs(p.Fragment,{children:[p.jsx(se,{className:"h-4 w-4"}),p.jsx("span",{children:"Ocultar Incompatibles"})]}):p.jsxs(p.Fragment,{children:[p.jsx(te,{className:"h-4 w-4"}),p.jsx("span",{children:"Mostrar Todos"})]})})]})]}),ge?p.jsxs("div",{className:"flex justify-center items-center py-12",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),p.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando videos..."})]}):0===n.length?p.jsxs("div",{className:"text-center py-12",children:[p.jsxs("p",{className:"text-gray-500 text-lg",children:["No hay videos de ",ks.toLowerCase()," a√∫n"]}),p.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Sube tu primer video de ",ks.toLowerCase()," usando el bot√≥n de arriba"]})]}):p.jsx("div",{className:`grid gap-6 ${os(Pe).grid}`,children:Bs.map(e=>p.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] "+(hs&&!js(e)?"border-red-200 opacity-75":"border-gray-100"),children:[p.jsxs("div",{className:"relative group",children:[p.jsxs("div",{className:`w-full ${os(Pe).aspect} ${os(Pe).thumbnailSize} bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center`,children:[e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?p.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:`w-full h-full ${os(Pe).imageObject||"object-cover"}`,loading:"lazy",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,p.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 "+(e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?"hidden":"flex"),children:[p.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),p.jsx("span",{className:"text-sm font-medium",children:e.title})]}),p.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:e.resolution&&"Unknown"!==e.resolution?e.resolution:"HD"}),hs&&p.jsx("div",{className:"absolute top-2 right-2 p-1 rounded-full text-xs font-bold "+(js(e)?"bg-green-500 text-white":"bg-red-500 text-white"),children:js(e)?"‚úÖ":"‚ùå"})]}),p.jsx("button",{onClick:()=>c(void 0,null,function*(){try{const s=document.createElement("div");s.className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50";const t=document.createElement("div");t.className="bg-white rounded-lg p-6 max-w-5xl w-full mx-4 max-h-[95vh] overflow-y-auto",t.onclick=e=>e.stopPropagation();const a=document.createElement("div");a.className="flex items-center justify-between mb-4",a.innerHTML=`\n                             <h3 class="text-xl font-semibold text-gray-900">${e.title}</h3>\n                             <button class="text-gray-400 hover:text-gray-600 transition-colors">\n                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>\n                               </svg>\n                             </button>\n                           `;const r=document.createElement("div");r.id="video-player-container",r.className="w-full flex justify-center mb-6";const i=document.createElement("div");i.className="w-full max-w-3xl mx-auto";const n=document.createElement("div");n.className="mb-4",n.innerHTML=`\n                             <p class="text-gray-600 text-sm">${e.description||"Sin descripci√≥n"}</p>\n                           `;const d=document.createElement("div");d.className="flex items-center justify-between mb-4 p-3 bg-gray-50 rounded-lg",d.innerHTML=`\n                              <div class="flex items-center space-x-4 text-sm text-gray-600">\n                                <span class="font-medium">${(e.fileSize/1048576).toFixed(2)} MB</span>\n                                <span class="text-gray-400">‚Ä¢</span>\n                                <span class="font-medium">${e.resolution&&"Unknown"!==e.resolution?e.resolution:"HD"}</span>\n                                <span class="text-gray-400">‚Ä¢</span>\n                                <span class="font-medium">${e.duration?Math.floor(e.duration/60)+":"+String(Math.floor(e.duration%60)).padStart(2,"0"):"N/A"}</span>\n                              </div>\n                              <div class="flex items-center space-x-2">\n                                <div class="flex items-center space-x-1">\n                                  <div class="flex items-center space-x-1" title="Puntuaci√≥n: ${e.rating||0}/5">\n                                    ${[1,2,3,4,5].map(s=>`<svg class="w-4 h-4 ${(e.rating||0)>=s?"text-yellow-400 fill-current":"text-gray-300"}" fill="currentColor" viewBox="0 0 24 24">\n                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>\n                                      </svg>`).join("")}\n                                    <span class="text-sm font-medium text-gray-600">${e.rating||0}</span>\n                                  </div>\n                                </div>\n                                <button class="flex items-center space-x-1 ${e.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"} transition-colors duration-200 p-2 rounded hover:bg-red-50" title="${e.userLiked?"Quitar like":"Dar like"}">\n                                  <svg class="w-5 h-5 ${e.userLiked?"fill-current":""}" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>\n                                  </svg>\n                                  <span class="text-sm font-medium">${e.likes||0}</span>\n                                </button>\n                                <button class="text-gray-400 hover:text-green-500 transition-colors duration-200 p-2 rounded hover:bg-green-50" title="Descargar video">\n                                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>\n                                  </svg>\n                                </button>\n                                <button class="text-gray-400 hover:text-blue-500 transition-colors duration-200 p-2 rounded hover:bg-blue-50" title="Editar video">\n                                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>\n                                  </svg>\n                                </button>\n                              </div>\n                            `;const u=document.createElement("div");u.className="mb-4";const m=Ps(e);if(m.length>0){const e=m.map(({tag:e,categoryKey:s,color:t})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium ${$s(t)} mr-2 mb-2">${e}</span>`).join("");u.innerHTML=`\n                               <h4 class="text-sm font-medium text-gray-700 mb-2">Etiquetas:</h4>\n                               <div class="flex flex-wrap">${e}</div>\n                             `}else u.innerHTML='\n                               <h4 class="text-sm font-medium text-gray-700 mb-2">Etiquetas:</h4>\n                               <span class="text-gray-400 text-sm">Sin etiquetas</span>\n                             ';const x=document.createElement("div");x.className="mb-4";const p=Fs(e);if(p.length>0){const e=p.map(({tag:e})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white mr-2 mb-2">${e}</span>`).join("");x.innerHTML=`\n                               <h4 class="text-sm font-medium text-blue-600 uppercase tracking-wide mb-2">Etiquetas Iniciales:</h4>\n                               <div class="flex flex-wrap">${e}</div>\n                             `}const y=document.createElement("div");y.className="mb-4";const v=Is(e);if(v.length>0){const e=v.map(({tag:e})=>`<span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white mr-2 mb-2">${e}</span>`).join("");y.innerHTML=`\n                               <h4 class="text-sm font-medium text-green-600 uppercase tracking-wide mb-2">Etiquetas Finales:</h4>\n                               <div class="flex flex-wrap">${e}</div>\n                             `}i.appendChild(n),i.appendChild(d),i.appendChild(u),p.length>0&&i.appendChild(x),v.length>0&&i.appendChild(y),t.appendChild(a),t.appendChild(r),t.appendChild(i),s.appendChild(t),document.body.appendChild(s);const{createRoot:b}=yield h(()=>c(void 0,null,function*(){const{createRoot:e}=yield import("../assets/index-DlNQbxiw.js").then(e=>e.c);return{createRoot:e}}),__vite__mapDeps([1,2,3,4,5,6])),j=b(r);j.render(L.createElement(de,{src:e.videoUrl,size:"large",loop:!0,initialShowControls:!0,autoplay:!0,muted:!1,className:"w-full max-w-3xl",resolutions:["auto","4k","1080p","720p","480p","360p"],currentResolution:"auto",videoTitle:e.title||"video",onResolutionChange:e=>{}})),s._root=j;const w=()=>{s._root&&s._root.unmount(),document.body.contains(s)&&document.body.removeChild(s)};a.querySelector("button").onclick=w,s.onclick=e=>{e.target===s&&w()};const N=d.querySelector('button[title="Descargar video"]');!N||"maese"!==(null==ls?void 0:ls.role)&&"super_admin"!==(null==ls?void 0:ls.role)?N&&(N.style.display="none"):N.onclick=()=>{Hs(e)},d.querySelector('button[title="Editar video"]').onclick=()=>{w(),_s(e)};const k=d.querySelector('div[title*="Puntuaci√≥n"]'),E=k.querySelectorAll("svg"),C=k.querySelector("span");E.forEach((s,t)=>{const a=t+1;s.addEventListener("mouseenter",()=>{E.forEach((e,s)=>{s<=t&&(e.classList.add("text-yellow-400","fill-current"),e.classList.remove("text-gray-300"))})}),s.addEventListener("mouseleave",()=>{E.forEach((s,t)=>{t<(e.rating||0)?(s.classList.add("text-yellow-400","fill-current"),s.classList.remove("text-gray-300")):(s.classList.remove("text-yellow-400","fill-current"),s.classList.add("text-gray-300"))})}),s.addEventListener("click",()=>c(void 0,null,function*(){try{const s=(e.rating||0)>=a?0:a;yield g(e.id,{rating:s}),e.rating=s,E.forEach((e,t)=>{t<s?(e.classList.add("text-yellow-400","fill-current"),e.classList.remove("text-gray-300")):(e.classList.remove("text-yellow-400","fill-current"),e.classList.add("text-gray-300"))}),C.textContent=s,k.title=`Puntuaci√≥n: ${s}/5`}catch(s){}}))});const S=d.querySelector('button[title*="like"]');S.onclick=()=>c(void 0,null,function*(){if(ns)try{const s=yield f(e.id,ns.uid);if(s.success){e.likes=s.likes,e.likedBy=s.likedBy,e.userLiked=s.userLiked,le(t=>t.map(t=>t.id===e.id?o(l({},t),{likes:s.likes,likedBy:s.likedBy,userLiked:s.userLiked}):t));const t=S.querySelector("svg"),a=S,r=S.querySelector("span");s.userLiked?(t.classList.add("fill-current","text-red-500"),t.classList.remove("text-gray-400"),a.classList.add("text-red-500"),a.classList.remove("text-gray-400"),a.title="Quitar like"):(t.classList.remove("fill-current","text-red-500"),t.classList.add("text-gray-400"),a.classList.remove("text-red-500"),a.classList.add("text-gray-400"),a.title="Dar like"),r.textContent=s.likes;s.userLiked}}catch(s){}else alert("Debes iniciar sesi√≥n para dar like")})}catch(s){}}),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:p.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{d:"M8 5v14l11-7z"})})})]}),p.jsxs("div",{className:""+(os(Pe).compact?"p-2":"p-4"),children:[p.jsxs("div",{className:"flex items-center justify-between "+(os(Pe).compact?"mb-1":"mb-2"),children:[p.jsx("h3",{className:`font-semibold text-gray-800 ${os(Pe).titleSize}`,children:e.title}),p.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(s=>{const t=(e.rating||0)>=s;return p.jsx("svg",{className:`${os(Pe).compact?"h-3 w-3":"h-4 w-4"} ${t?"text-yellow-400 fill-current":"text-gray-300"} cursor-pointer`,fill:"currentColor",viewBox:"0 0 24 24",onClick:()=>c(void 0,null,function*(){try{const t=(e.rating||0)>=s?0:s;yield g(e.id,{rating:t}),e.rating=t}catch(t){}}),children:p.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},s)}),p.jsxs("span",{className:(os(Pe).compact,"text-xs")+" font-medium text-gray-500 ml-1",children:["(",e.rating||0,")"]})]})]}),p.jsx("p",{className:`text-gray-600 text-sm ${os(Pe).compact?"mb-2":"mb-3"} ${1===os(Pe).descriptionLines?"line-clamp-1":2===os(Pe).descriptionLines?"line-clamp-2":3===os(Pe).descriptionLines?"line-clamp-3":"line-clamp-4"}`,children:e.description||"Sin descripci√≥n"}),os(Pe).showTags&&p.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const s=Ps(e);return s.length>0?s.map(({tag:e,categoryKey:s,color:t})=>p.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${$s(t)}`,children:e},`${s}-${e}`)):p.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),os(Pe).showTags&&(()=>{const s=Fs(e);return s.length>0?p.jsxs("div",{className:"mb-3",children:[p.jsx("div",{className:"flex items-center space-x-2 mb-2",children:p.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:"Iniciales:"})}),p.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(({tag:e,categoryKey:s,color:t})=>p.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-sm",children:e},`inicial-${s}-${e}`))})]}):null})(),os(Pe).showTags&&(()=>{const s=Is(e);return s.length>0?p.jsxs("div",{className:"mb-3",children:[p.jsx("div",{className:"flex items-center space-x-2 mb-2",children:p.jsx("span",{className:"text-xs font-medium text-green-600 uppercase tracking-wide",children:"Finales:"})}),p.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(({tag:e,categoryKey:s,color:t})=>p.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-sm",children:e},`final-${s}-${e}`))})]}):null})(),os(Pe).compact?p.jsx(O,{video:e,onLike:()=>qs(e),onEdit:()=>_s(e),onDelete:()=>Rs(e),onAddToSequence:()=>Os(e),onDownload:"maese"===(null==ls?void 0:ls.role)||"super_admin"===(null==ls?void 0:ls.role)?()=>Hs(e):void 0,onPlay:()=>Ds(e),isVideoInSequence:bs(e),isBuilderOpen:hs,isVideoCompatible:js(e),type:"video"}):p.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[p.jsx("div",{className:"flex items-center space-x-2",children:p.jsxs("span",{className:"font-medium",children:[(e.fileSize/1048576).toFixed(2)," MB"]})}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("button",{onClick:()=>Ds(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Reproducir video",children:p.jsx(ae,{className:"h-4 w-4"})}),p.jsxs("button",{onClick:()=>qs(e),className:"flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 "+(e.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"),title:e.userLiked?"Quitar like":"Dar like",children:[p.jsx(U,{className:"h-4 w-4 "+(e.userLiked?"fill-current":"")}),p.jsx("span",{className:"font-medium",children:e.likes||0})]}),p.jsx("button",{onClick:()=>Os(e),disabled:bs(e),className:"transition-colors duration-200 p-1 rounded "+(bs(e)?"text-gray-300 cursor-not-allowed":hs&&!js(e)?"text-red-400 hover:text-red-500 hover:bg-red-50":"text-gray-400 hover:text-purple-500 hover:bg-purple-50"),title:bs(e)?"Ya en secuencia":hs&&!js(e)?"A√±adir forzadamente (incompatible)":"A√±adir a secuencia",children:p.jsx(J,{className:"h-4 w-4"})}),("maese"===(null==ls?void 0:ls.role)||"super_admin"===(null==ls?void 0:ls.role))&&p.jsx("button",{onClick:()=>{Hs(e)},className:"text-gray-400 hover:text-green-500 transition-colors duration-200 p-1 rounded hover:bg-green-50",title:"Descargar video",children:p.jsx(re,{className:"h-4 w-4"})}),p.jsx("button",{onClick:()=>_s(e),className:"text-gray-400 hover:text-blue-500 transition-colors duration-200 p-1 rounded hover:bg-blue-50",title:"Editar video",children:p.jsx(ie,{className:"h-4 w-4"})}),p.jsx("button",{onClick:()=>Rs(e),className:"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded hover:bg-red-50",title:"Eliminar video",children:p.jsx(ne,{className:"h-4 w-4"})})]})]})]})]},e.id))})]}),"secuencias"===Se&&p.jsxs("div",{className:"mb-8",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Secuencias de ",ks.toLowerCase()," (",ts.length,")"]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx($,{type:"sequence",styleColor:ks}),p.jsxs("button",{onClick:()=>Fe(!Pe),className:"flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-colors duration-200 "+(Pe?`bg-gradient-to-r ${Ls(ks)} text-white shadow-lg`:"bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300"),title:Pe?"Modo compacto":"Modo ancho completo",children:[Pe?p.jsx(Y,{className:"h-4 w-4"}):p.jsx(ee,{className:"h-4 w-4"}),p.jsx("span",{className:"hidden sm:inline",children:Pe?"Compacto":"Ancho completo"})]})]})]}),rs?p.jsxs("div",{className:"flex justify-center items-center py-12",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"}),p.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando secuencias..."})]}):p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(xe,{sequences:ts,onDeleteSequence:e=>c(void 0,null,function*(){try{yield D(e),zs("Secuencia eliminada exitosamente")}catch(s){throw zs("Error al eliminar la secuencia","error"),s}}),onPlaySequence:e=>{Ge(e),Ze(!0),zs(`üé¨ Reproduciendo secuencia: ${e.name}`,"info")},onEditSequence:e=>{ms.length>0||xs.trim()?Te({isOpen:!0,sequence:e}):(Ns(e),zs(`Secuencia "${e.name}" cargada para edici√≥n`))},onDownloadSequence:e=>{ns&&ls?"maese"===ls.role||"super_admin"===ls.role?Re({isOpen:!0,sequence:e}):zs("‚ùå Solo los maestros pueden descargar secuencias","error"):zs("‚ùå Debes iniciar sesi√≥n para descargar secuencias","error")},isFullWidth:Pe,style:ks})})]}),p.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:p.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-3 h-3 rounded-full "+("idle"===Oe?"bg-green-500":"syncing"===Oe?"bg-yellow-500 animate-pulse":"bg-red-500")}),p.jsx("span",{className:"text-sm text-gray-600",children:"idle"===Oe?"‚úÖ Sincronizado con Firebase":"syncing"===Oe?"üîÑ Sincronizando...":"‚ùå Error de sincronizaci√≥n"})]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.jsx("button",{onClick:()=>c(void 0,null,function*(){try{zs("Ejecutando diagn√≥stico de videos...","info");const e=yield b();if(e.success){let s=`Diagn√≥stico: ${e.totalVideos} videos total, ${e.salsaVideos} de salsa`;e.fig003Found?s+=" ‚úÖ Fig003 encontrado":s+=" ‚ùå Fig003 NO encontrado",e.videosWithoutResolution>0&&(s+=` ‚ö†Ô∏è ${e.videosWithoutResolution} sin resoluci√≥n`),zs(s,"success")}else zs(`Error en diagn√≥stico: ${e.error}`,"error")}catch(e){zs("Error al ejecutar diagn√≥stico","error")}}),disabled:"syncing"===Oe,className:"px-3 py-1 text-xs bg-purple-500 text-white rounded hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üîç Diagn√≥stico"}),p.jsx("button",{onClick:()=>c(void 0,null,function*(){try{zs("üîÑ Actualizando resoluciones de videos...","info");const s=(yield j()).filter(e=>!e.resolution||"Unknown"===e.resolution);if(0===s.length)return void zs("‚úÖ Todos los videos ya tienen resoluci√≥n detectada","success");let t=0;for(const a of s)try{const e=document.createElement("video");e.crossOrigin="anonymous",yield new Promise((s,r)=>{e.onloadedmetadata=()=>{const r=e.videoWidth,i=e.videoHeight,n=Math.max(r,i);let l="Unknown";l=n>=3840?"4K":n>=1920?"1080p":n>=1280?"720p":n>=854?"480p":"360p",g(a.id,{resolution:l,videoWidth:r,videoHeight:i}),t++,s()},e.onerror=r,e.src=a.videoUrl}),e.remove()}catch(e){}zs(`‚úÖ Resoluciones actualizadas: ${t} videos`,"success")}catch(e){zs("Error al actualizar resoluciones","error")}}),disabled:"syncing"===Oe,className:"px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üìê Actualizar Resoluciones"}),p.jsx("button",{onClick:()=>Ms("update"),disabled:"syncing"===Oe,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üîß Actualizar Rutas"}),p.jsx("button",{onClick:()=>Ms("cleanup"),disabled:"syncing"===Oe,className:"px-3 py-1 text-xs bg-yellow-500 text-white rounded hover:bg-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üßπ Limpiar Hu√©rfanos"}),p.jsx("button",{onClick:()=>Ms("cleanup-tags"),disabled:"syncing"===Oe,className:"px-3 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üè∑Ô∏è Limpiar Tags"}),p.jsx("button",{onClick:()=>c(void 0,null,function*(){try{zs("üîÑ Iniciando migraci√≥n REAL de videos a estructura organizada...","info");const e=yield R(n);if(e.success){let s=`‚úÖ Migraci√≥n REAL completada: ${e.successfulMigrations} videos movidos f√≠sicamente`;e.alreadyOrganized>0&&(s+=`, ${e.alreadyOrganized} ya organizados`),e.failedMigrations>0&&(s+=`, ${e.failedMigrations} fallidos`),zs(s,"success"),window.location.reload()}else zs(`‚ùå Error en migraci√≥n: ${e.error}`,"error")}catch(e){zs("‚ùå Error al ejecutar migraci√≥n","error")}}),disabled:"syncing"===Oe,className:"px-3 py-1 text-xs bg-indigo-500 text-white rounded hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",title:"Mover f√≠sicamente videos existentes a estructura organizada (videos/page/style/)",children:"üìÅ Migrar Videos REAL"}),p.jsx("button",{onClick:()=>Ms("delete-all"),disabled:"syncing"===Oe,className:"px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"üóëÔ∏è Eliminar Todo"})]})]})})]}),p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(oe,{isOpen:t,onClose:()=>a(!1),onVideoUploaded:e=>c(void 0,null,function*(){zs(`${e.title} subido exitosamente`,"success")}),page:"figuras",style:ks})}),p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(ce,{isOpen:r.isOpen,onClose:()=>{i({isOpen:!1,video:null})},video:r.video,onVideoUpdated:e=>{le(s=>s.map(s=>s.id===e.id?e:s)),zs(`${e.title} actualizado exitosamente`,"success")},page:"figuras",style:ks})}),p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(A,{isOpen:_e.isOpen,onClose:()=>{qe({isOpen:!1,type:null})},onConfirm:()=>{return e=_e.type,c(void 0,null,function*(){try{if(Ae("syncing"),zs("Iniciando limpieza de datos...","info"),"update"===e){const e=yield w();e.success?zs(`‚úÖ ${e.updatedCount} videos actualizados`,"success"):zs(`‚ùå Error: ${e.error}`,"error")}else if("cleanup"===e){const e=yield j(),s=yield M(e);s.success?zs(`üßπ ${s.orphanedVideosDeleted} videos y ${s.orphanedThumbnailsDeleted} thumbnails hu√©rfanos eliminados`,"success"):zs(`‚ùå Error: ${s.error}`,"error")}else if("cleanup-tags"===e){const e=yield N();e.success?zs(`üè∑Ô∏è ${e.updatedCount} videos actualizados con tags limpios`,"success"):zs(`‚ùå Error: ${e.error}`,"error")}else if("delete-all"===e){if(!window.confirm("¬øEst√°s seguro de que quieres eliminar TODOS los videos? Esta acci√≥n no se puede deshacer."))return void Ae("idle");const e=yield k();if(!e.success)return zs(`‚ùå Error eliminando documentos: ${e.error}`,"error"),void Ae("idle");const s=yield V();if(!s.success)return zs(`‚ùå Error eliminando archivos: ${s.error}`,"error"),void Ae("idle");zs(`üóëÔ∏è ${e.deletedCount} videos eliminados completamente`,"success")}Ae("idle"),qe({isOpen:!1,type:null})}catch(s){zs(`‚ùå Error inesperado: ${s.message}`,"error"),Ae("idle")}});var e},title:"update"===_e.type?"Actualizar Rutas de Thumbnails":"cleanup"===_e.type?"Limpiar Archivos Hu√©rfanos":"cleanup-tags"===_e.type?"Limpiar Tags Duplicados":"Eliminar Todos los Videos",message:"update"===_e.type?"¬øActualizar las rutas de thumbnails de videos existentes? Esto corregir√° problemas de eliminaci√≥n.":"cleanup"===_e.type?"¬øLimpiar archivos hu√©rfanos? Esto eliminar√° archivos que no tienen documento en Firestore.":"cleanup-tags"===_e.type?"¬øLimpiar tags duplicados? Esto eliminar√° etiquetas repetidas en todos los videos manteniendo solo una instancia de cada tag.":"¬øEliminar TODOS los videos de Firebase y Storage? Esta acci√≥n es IRREVERSIBLE y eliminar√° todos los datos.",confirmText:"update"===_e.type?"Actualizar":"cleanup"===_e.type?"Limpiar":"cleanup-tags"===_e.type?"Limpiar Tags":"Eliminar Todo",cancelText:"Cancelar"})}),p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(A,{isOpen:ze.isOpen,onClose:()=>{Te({isOpen:!1,sequence:null})},onConfirm:()=>{const e=ze.sequence;e&&(Ns(e),zs(`Secuencia "${e.name}" cargada para edici√≥n`)),Te({isOpen:!1,sequence:null})},title:"üé¨ Cargar Secuencia",message:`¬øDeseas cargar la secuencia "${null==(e=ze.sequence)?void 0:e.name}"?\n\nEsto reemplazar√° la secuencia actual en construcci√≥n y perder√°s todos los cambios no guardados.\n\n¬øEst√°s seguro de que quieres continuar?`,confirmText:"S√≠, Cargar",cancelText:"Cancelar",type:"warning"})}),p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(A,{isOpen:be.isOpen,onClose:()=>{je({isOpen:!1,video:null})},onConfirm:()=>{return e=be.video,c(void 0,null,function*(){try{const s=yield P(e.videoPath,e.thumbnailPath);if(!s.success){if(!s.error||!s.error.includes("thumbnails"))return void zs(`Error al eliminar archivos: ${s.error}`,"error");if(!(yield P(e.videoPath,null)).success)return void zs(`Error al eliminar archivos: ${s.error}`,"error")}const t=yield E(e.id);if(!t.success)return void zs(`Error al eliminar metadatos: ${t.error}`,"error");le(s=>s.filter(s=>s.id!==e.id)),zs(`${e.title} eliminado correctamente`,"success")}catch(s){zs("Error inesperado al eliminar video","error")}});var e},title:"üóëÔ∏è Eliminar Video",message:`¬øEst√°s seguro de que quieres eliminar el video "${null==(s=be.video)?void 0:s.title}"?\n\nEsta acci√≥n eliminar√° permanentemente:\n‚Ä¢ El archivo de video de Firebase Storage\n‚Ä¢ El thumbnail del video\n‚Ä¢ Los metadatos de Firestore\n\nEsta acci√≥n NO se puede deshacer.`,confirmText:"S√≠, Eliminar",cancelText:"Cancelar",type:"danger"})}),Be&&Ie&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:p.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[p.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["üé¨ ",Ie.title]}),p.jsx("button",{onClick:()=>{He(!1),Ue(null)},className:"text-gray-500 hover:text-gray-700 transition-colors",children:p.jsx(X,{className:"h-6 w-6"})})]}),p.jsx("div",{className:"flex-1 min-h-0 p-4",children:p.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:p.jsx("div",{className:"w-full max-w-md",children:p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(pe,{videos:[Ie],className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})})]})}),We&&Ke&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:p.jsxs("div",{className:"relative w-full max-w-3xl h-auto max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-b flex-shrink-0",children:[p.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["üé¨ Secuencia: ",Ke.name]}),p.jsx("button",{onClick:()=>{Ze(!1),Ge(null)},className:"text-gray-500 hover:text-gray-700 transition-colors",children:p.jsx(X,{className:"h-6 w-6"})})]}),p.jsx("div",{className:"flex-1 min-h-0 p-4",children:p.jsx("div",{className:"w-full h-full max-h-[65vh] flex items-center justify-center",children:p.jsx("div",{className:"w-full max-w-md",children:p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(pe,{videos:Ke.videos,className:"w-full h-full",showControls:!0,autoplay:!0,loop:!1,muted:!1})})})})})]})}),p.jsx(C.Suspense,{fallback:p.jsx(he,{}),children:p.jsx(ue,{isOpen:De.isOpen,onClose:Ts,video:De.sequence?o(l({},De.sequence),{title:De.sequence.name,file:null}):null,onDownloadComplete:()=>{zs("Secuencia descargada correctamente","success"),Ts()}})}),ye.map(e=>p.jsx(_,{message:e.message,type:e.type,onClose:()=>{return s=e.id,void ve(e=>e.filter(e=>e.id!==s));var s}},e.id))]})};export{ge as default};
