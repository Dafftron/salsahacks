var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,t=(s,a,l)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[a]=l,n=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&t(e,a,s[a]);if(l)for(var a of l(s))i.call(s,a)&&t(e,a,s[a]);return e},o=(e,l)=>s(e,a(l)),d=(e,s,a)=>new Promise((l,r)=>{var i=e=>{try{n(a.next(e))}catch(s){r(s)}},t=e=>{try{n(a.throw(e))}catch(s){r(s)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,t);n((a=a.apply(e,s)).next())});import{u as c,j as m,R as x,n as u,o as h}from"../assets/index-mYjtELNp.js";import{r as p}from"./vendor-react-SlK7pBj5.js";import{LucideZap as b,Edit as g,LucideSave as j,LucideX as v,LucideUser as N,Camera as f,LucideShield as y,LucideMail as w,Calendar as E,LucideSettings as S,Crown as U}from"./vendor-icons-BWQzNHDY.js";import"./vendor-router-UcgXoTZX.js";import"./vendor-firebase-DVYjp8kH.js";const P=()=>{const{user:e,userProfile:s,updateUserProfile:a,getUserUsername:l,getUserPhoto:r}=c(),[i,t]=p.useState(!1),[P,A]=p.useState(!1),C=p.useRef(null),[L,R]=p.useState({displayName:(null==s?void 0:s.displayName)||"",bio:(null==s?void 0:s.bio)||"",location:(null==s?void 0:s.location)||"",phone:(null==s?void 0:s.phone)||"",photoURL:(null==s?void 0:s.photoURL)||"",username:(null==s?void 0:s.username)||""});return e?m.jsx("div",{className:"max-w-4xl mx-auto p-6",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200",children:[m.jsx("div",{className:"p-6 border-b border-gray-200",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Mi Perfil"}),m.jsxs("div",{className:"flex space-x-2",children:["david_exile_92@hotmail.com"===e.email&&m.jsxs("div",{className:"text-xs text-gray-500 mr-4",children:[m.jsxs("p",{children:["Email: ",e.email]}),m.jsxs("p",{children:["Rol actual: ",(null==s?void 0:s.role)||"No definido"]}),m.jsxs("p",{children:["Es Super Admin: ",(null==s?void 0:s.role)===x.SUPER_ADMIN?"SÍ":"NO"]})]}),"david_exile_92@hotmail.com"===e.email&&(null==s?void 0:s.role)!==x.SUPER_ADMIN&&m.jsxs("button",{onClick:()=>d(void 0,null,function*(){try{const e=yield a(o(n({},s),{role:x.SUPER_ADMIN,permissions:["MANAGE_USERS","MANAGE_SYSTEM","ACCESS_PREMIUM_CONTENT","UPLOAD_VIDEOS","DELETE_CONTENT"]}));e.success?(alert("¡Rol actualizado a Super Administrador! Recargando página..."),setTimeout(()=>{window.location.reload()},1e3)):alert("Error al actualizar rol: "+e.error)}catch(e){alert("Error al actualizar rol: "+e.message)}}),className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[m.jsx(b,{className:"h-4 w-4"}),m.jsx("span",{children:"Actualizar a Super Admin"})]}),i?m.jsxs(m.Fragment,{children:[m.jsxs("button",{onClick:()=>d(void 0,null,function*(){try{const e=yield a(L);e.success?t(!1):alert("Error al actualizar perfil: "+e.error)}catch(e){alert("Error al actualizar perfil")}}),className:"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[m.jsx(j,{className:"h-4 w-4"}),m.jsx("span",{children:"Guardar"})]}),m.jsxs("button",{onClick:()=>{R({displayName:(null==s?void 0:s.displayName)||"",bio:(null==s?void 0:s.bio)||"",location:(null==s?void 0:s.location)||"",phone:(null==s?void 0:s.phone)||"",photoURL:(null==s?void 0:s.photoURL)||"",username:(null==s?void 0:s.username)||""}),t(!1)},className:"flex items-center space-x-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:[m.jsx(v,{className:"h-4 w-4"}),m.jsx("span",{children:"Cancelar"})]})]}):m.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[m.jsx(g,{className:"h-4 w-4"}),m.jsx("span",{children:"Editar"})]})]})]})}),m.jsx("div",{className:"p-6",children:m.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[m.jsx("div",{className:"md:col-span-1",children:m.jsxs("div",{className:"text-center",children:[m.jsxs("div",{className:"relative inline-block mb-4",children:[m.jsx("div",{className:"w-32 h-32 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center mx-auto overflow-hidden",children:r()?m.jsx("img",{src:r(),alt:"Foto de perfil",className:"w-32 h-32 object-cover"}):m.jsx(N,{className:"h-16 w-16 text-white"})}),i&&m.jsxs("div",{className:"absolute bottom-0 right-0",children:[m.jsx("button",{onClick:()=>{var e;return null==(e=C.current)?void 0:e.click()},disabled:P,className:"w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors shadow-lg",children:P?m.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):m.jsx(f,{className:"h-4 w-4"})}),m.jsx("input",{ref:C,type:"file",accept:"image/*",onChange:e=>d(void 0,null,function*(){const s=e.target.files[0];if(s)if(s.type.startsWith("image/"))if(s.size>5242880)alert("La imagen debe ser menor a 5MB");else{A(!0);try{const e=new FileReader;e.onload=e=>{R(o(n({},L),{photoURL:e.target.result})),A(!1)},e.readAsDataURL(s)}catch(a){A(!1)}}else alert("Por favor selecciona una imagen válida")}),className:"hidden"})]})]}),i?m.jsx("input",{type:"text",value:L.displayName,onChange:e=>R(o(n({},L),{displayName:e.target.value})),className:"text-2xl font-semibold text-gray-800 mb-2 bg-transparent border-b border-gray-300 focus:border-blue-500 outline-none text-center",placeholder:"Tu nombre"}):m.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:(null==s?void 0:s.displayName)||e.displayName||"Usuario"}),m.jsx("p",{className:"text-gray-600 mb-4",children:e.email}),(null==s?void 0:s.role)&&m.jsx("div",{className:"mb-4",children:m.jsxs("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${h[s.role]||"bg-gray-500 text-white"}`,children:[m.jsx(y,{className:"h-4 w-4 mr-2"}),u[s.role]||s.role]})}),m.jsxs("div",{className:"mb-4",children:[m.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Nombre de usuario"}),i?m.jsx("input",{type:"text",value:L.username,onChange:e=>R(o(n({},L),{username:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none text-center",placeholder:"nombreusuario",pattern:"[a-zA-Z0-9_]+",title:"Solo letras, números y guiones bajos"}):m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:m.jsx("span",{className:"text-gray-700 font-medium",children:l()})})]})]})}),m.jsx("div",{className:"md:col-span-2",children:m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[m.jsx(N,{className:"h-5 w-5 mr-2"}),"Información Básica"]}),m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),m.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[m.jsx(w,{className:"h-4 w-4 text-gray-500"}),m.jsx("span",{className:"text-gray-700",children:e.email})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Miembro desde"}),m.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[m.jsx(E,{className:"h-4 w-4 text-gray-500"}),m.jsx("span",{className:"text-gray-700",children:(null==s?void 0:s.createdAt)?new Date(s.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"Fecha no disponible"})]})]})]})]}),m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[m.jsx(S,{className:"h-5 w-5 mr-2"}),"Información Adicional"]}),m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ubicación"}),i?m.jsx("input",{type:"text",value:L.location,onChange:e=>R(o(n({},L),{location:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu ubicación"}):m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:m.jsx("span",{className:"text-gray-700",children:(null==s?void 0:s.location)||"No especificada"})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono"}),i?m.jsx("input",{type:"tel",value:L.phone,onChange:e=>R(o(n({},L),{phone:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none",placeholder:"Tu teléfono"}):m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:m.jsx("span",{className:"text-gray-700",children:(null==s?void 0:s.phone)||"No especificado"})})]})]}),m.jsxs("div",{className:"mt-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biografía"}),i?m.jsx("textarea",{value:L.bio,onChange:e=>R(o(n({},L),{bio:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 outline-none min-h-[100px] resize-vertical",placeholder:"Cuéntanos sobre ti..."}):m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg min-h-[100px]",children:m.jsx("span",{className:"text-gray-700",children:(null==s?void 0:s.bio)||"No hay biografía disponible"})})]})]}),(null==s?void 0:s.permissions)&&s.permissions.length>0&&m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[m.jsx(U,{className:"h-5 w-5 mr-2"}),"Mis Permisos"]}),m.jsx("div",{className:"flex flex-wrap gap-2",children:s.permissions.map((e,s)=>m.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full font-medium",children:e.replace(/_/g," ")},s))})]})]})})]})})]})}):m.jsx("div",{className:"max-w-4xl mx-auto p-6",children:m.jsxs("div",{className:"text-center",children:[m.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Perfil de Usuario"}),m.jsx("p",{className:"text-gray-600",children:"Debes iniciar sesión para ver tu perfil"})]})})};export{P as default};
