var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,i=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&n(e,a,s[a]);if(t)for(var a of t(s))l.call(s,a)&&n(e,a,s[a]);return e},o=(e,t)=>s(e,a(t)),c=(e,s,a)=>new Promise((t,r)=>{var l=e=>{try{i(a.next(e))}catch(s){r(s)}},n=e=>{try{i(a.throw(e))}catch(s){r(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,n);i((a=a.apply(e,s)).next())});import{j as d,u,b as m,t as x,_ as h}from"../assets/index-CMWpliaN.js";import{r as g}from"./vendor-react-4yEUTM44.js";import"./vendor-firebase-DVYjp8kH.js";import{u as p}from"./CompactCardActions-BQ-wwN8o.js";import f from"./Toast-DZT-Y2Eq.js";import b from"./ConfirmModal-HpVEUCyE.js";import j from"./VideoPlayer-grxpbV8P.js";import y from"./SequenceVideoPlayer-LaJpChPq.js";import v from"./videoCombiner-DicXMfnR.js";import{LucideX as N,AlertCircle as w,CheckCircle as k,Download as C,Loader as S,LucideShuffle as L,LucideTrash2 as D,LucidePlay as E,LucidePlus as O,GripVertical as $,LucideMusic as q,Heart as A,LucideSave as z}from"./vendor-icons-DyUK-N1U.js";import"./vendor-ffmpeg-BflpXDox.js";import"./vendor-router-Bt5THCHr.js";const P=({isOpen:e,onClose:s,videos:a,sequenceName:t="Secuencia"})=>{const[r,l]=g.useState(null),[n,i]=g.useState(!1),[o,u]=g.useState(null),[m,x]=g.useState(null),[h,p]=g.useState("fast"),f=new v;g.useEffect(()=>{e&&(l(null),u(null),x(null),i(!1))},[e,a]);return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Descargar Secuencia"}),d.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:n,children:d.jsx(N,{className:"h-5 w-5"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[d.jsxs("p",{className:"text-sm text-gray-600",children:[d.jsxs("strong",{children:[(null==a?void 0:a.length)||0," videos"]})," serán combinados en uno solo"]}),d.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Formato: MP4 (Web Workers)"}),d.jsx("p",{className:"text-xs text-green-600 font-semibold mt-1",children:"✅ Procesamiento en segundo plano - sin bloqueos"})]}),r&&d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[o?d.jsx(w,{className:"h-5 w-5"}):"complete"===(null==r?void 0:r.stage)?d.jsx(k,{className:"h-5 w-5"}):d.jsx(S,{className:"h-5 w-5 animate-spin"}),d.jsx("span",{className:"text-sm font-medium "+(o?"text-red-500":"complete"===(null==r?void 0:r.stage)?"text-green-500":"text-blue-500"),children:r.message})]}),d.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:d.jsx("div",{className:"h-2 rounded-full transition-all duration-300 "+(o?"bg-red-500":"complete"===(null==r?void 0:r.stage)?"bg-green-500":"bg-blue-500"),style:{width:`${r.current}%`}})}),d.jsx("p",{className:"text-xs text-gray-500",children:(()=>{switch(null==r?void 0:r.stage){case"init":return"Inicializando FFmpeg.wasm...";case"download":return"Descargando videos...";case"combine":return"Combinando videos con FFmpeg...";case"finalize":return"Finalizando archivo...";case"complete":return"¡Proceso completado!";default:return"Preparando..."}})()})]}),o&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(w,{className:"h-5 w-5 text-red-500"}),d.jsx("span",{className:"text-sm text-red-700",children:o})]})}),m&&d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(k,{className:"h-5 w-5 text-green-500"}),d.jsx("span",{className:"text-sm text-green-700",children:"¡Videos combinados exitosamente!"})]})})]}),d.jsxs("div",{className:"flex space-x-3 mt-6",children:[!n&&!m&&d.jsxs("button",{onClick:()=>c(void 0,null,function*(){if(a&&0!==a.length){i(!0),u(null),l({stage:"init",current:0,total:100,message:"Iniciando procesamiento con Web Workers..."});try{const e=yield f.combineVideos(a,l),s=URL.createObjectURL(e);x(s),l({stage:"complete",current:100,total:100,message:"¡Videos combinados exitosamente!"})}catch(e){u(`Error combinando videos: ${e.message}`),l(null)}finally{i(!1)}}else u("No hay videos para combinar")}),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[d.jsx(C,{className:"h-4 w-4"}),d.jsx("span",{children:"Combinar Videos"})]}),m&&d.jsxs("button",{onClick:()=>{if(m){const e=document.createElement("a");e.href=m,e.download=`${t}.mp4`,document.body.appendChild(e),e.click(),document.body.removeChild(e)}},className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[d.jsx(C,{className:"h-4 w-4"}),d.jsx("span",{children:"Descargar MP4"})]}),d.jsx("button",{onClick:s,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:n,children:m?"Cerrar":"Cancelar"})]})]})}):null},U=({isOpen:e,onClose:s,videos:a,onSaveSequence:n,onToggleShowAll:v,showAllVideos:w,style:k="salsa",isIntegrated:C=!1,onToggleBuilder:S})=>{const{categoriesList:U,getColorClasses:I}=p("figuras",k),{user:V}=u(),[M,T]=g.useState(null),[F,R]=g.useState(!1),[B,W]=g.useState(!1),[K,_]=g.useState(null),[H,G]=g.useState(null),[J,Q]=g.useState(null),[X,Y]=g.useState({}),[Z,ee]=g.useState(!0),[se,ae]=g.useState(!1),{sequence:te,sequenceName:re,sequenceDescription:le,editingSequenceId:ne,addVideoToSequence:ie,removeVideoFromSequence:oe,reorderSequence:ce,generateRandomSequence:de,clearSequence:ue,setSequenceName:me,setSequenceDescription:xe,isVideoCompatible:he,isVideoInSequence:ge,toggleBuilder:pe,checkCompatibility:fe}=m(),{handleDragStart:be,handleDragOver:je,handleDragEnter:ye,handleDragLeave:ve,handleDrop:Ne,handleDragEnd:we,getDragStyles:ke}=(e=>{const[s,a]=g.useState(null),[t,r]=g.useState(null),l=g.useCallback(e=>{a(e)},[]),n=g.useCallback((e,s)=>{e.preventDefault(),r(s)},[]),i=g.useCallback((e,s)=>{e.preventDefault(),r(s)},[]),o=g.useCallback(e=>{e.preventDefault(),r(null)},[]),c=g.useCallback((t,l)=>{t.preventDefault(),null!==s&&s!==l&&e(s,l),a(null),r(null)},[s,e]),d=g.useCallback(()=>{a(null),r(null)},[]),u=g.useCallback(e=>{const a={cursor:"grab",transition:"all 0.2s ease",transform:"scale(1)",opacity:1};return s===e&&(a.cursor="grabbing",a.transform="scale(1.05) rotate(2deg)",a.opacity=.7,a.zIndex=1e3),t===e&&s!==e&&(a.transform="scale(1.02)",a.borderLeft="4px solid #3b82f6",a.backgroundColor="#f0f9ff"),a},[s,t]);return{draggedIndex:s,dragOverIndex:t,handleDragStart:l,handleDragOver:n,handleDragEnter:i,handleDragLeave:o,handleDrop:c,handleDragEnd:d,getDragStyles:u}})(ce),[Ce,Se]=g.useState([]),[Le,De]=g.useState({isOpen:!1,type:null}),[Ee,Oe]=g.useState(5),$e=(e,s="success")=>{const a=Date.now();Se(t=>[...t,{id:a,message:e,type:s}])},qe=g.useCallback(()=>{if(0===te.length)return{};const e={};return te.forEach((s,a)=>{s.tags&&"object"==typeof s.tags&&Object.keys(s.tags).forEach(a=>{const t=s.tags[a];Array.isArray(t)&&t.length>0&&(e[a]||(e[a]=[]),t.forEach(s=>{e[a].includes(s)||e[a].push(s)}))})}),e},[te]);g.useEffect(()=>{if(te.length>0){const e=qe();Object.keys(e).length>0&&Y(e)}else Y({})},[te,qe]);g.useEffect(()=>{const e=setTimeout(()=>{Ae()},500);return()=>clearTimeout(e)},[te]),g.useEffect(()=>()=>{K&&URL.revokeObjectURL(K)},[K]);const Ae=()=>c(void 0,null,function*(){if(!te||0===te.length)return _(null),void G(null);const e=JSON.stringify({videos:te.map(e=>e.id),sequenceLength:te.length});if(J!==e||!K){W(!0),G(null);try{if(0===te.filter(e=>e.videoUrl).length)throw new Error("No hay videos válidos en la secuencia");_("sequence-timeline"),Q(e)}catch(s){G(s.message)}finally{W(!1)}}}),ze=(e,s)=>{Y(a=>{const n=a[e]||[];if(n.includes(s)){const d=n.filter(e=>e!==s);if(0===d.length){const s=a,{[e]:n}=s;return((e,s)=>{var a={};for(var n in e)r.call(e,n)&&s.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&t)for(var n of t(e))s.indexOf(n)<0&&l.call(e,n)&&(a[n]=e[n]);return a})(s,[(c=e,"symbol"==typeof c?c:c+"")])}return o(i({},a),{[e]:d})}return o(i({},a),{[e]:[...n,s]});var c})},Pe=(e,s)=>{var a;return(null==(a=X[e])?void 0:a.includes(s))||!1},Ue=()=>c(void 0,null,function*(){if(0===te.length)return null;try{const e=te[0];if(e.thumbnailUrl)return e.thumbnailUrl;const{getStorage:s,ref:a,getDownloadURL:t}=yield h(()=>c(void 0,null,function*(){const{getStorage:e,ref:s,getDownloadURL:a}=yield import("./vendor-firebase-DVYjp8kH.js").then(e=>e.J);return{getStorage:e,ref:s,getDownloadURL:a}}),[]),r=a(s(),e.videoUrl);return yield t(r)}catch(e){return null}});return e?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm mb-6",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Constructor de Secuencias"}),d.jsxs("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:[te.length," videos"]})]}),d.jsx("div",{className:"flex items-center space-x-2",children:d.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx(N,{className:"w-5 h-5"})})})]}),d.jsxs("div",{className:"p-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[d.jsxs("div",{className:"md:col-span-2 space-y-3",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("input",{type:"text",placeholder:"Nombre de la secuencia...",value:re,onChange:e=>me(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),!re.trim()&&te.length>0&&d.jsx("p",{className:"text-xs text-orange-600",children:"⚠️ Añade un nombre para poder guardar la secuencia"})]}),d.jsx("textarea",{placeholder:"Descripción (opcional)...",value:le,onChange:e=>xe(e.target.value),rows:"2",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),d.jsxs("div",{className:"flex flex-col space-y-3",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Número de videos:"}),d.jsx("input",{type:"number",value:Ee,onChange:e=>Oe(Math.max(1,parseInt(e.target.value)||5)),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center text-sm",placeholder:"5"}),te.length>0&&d.jsx("div",{className:"text-xs text-gray-500 text-center",children:(()=>{const e=te[te.length-1],s=a.filter(s=>!te.some(e=>e.id===s.id)&&fe(e,s)),t=Ee-te.length;return`${s.length} compatibles disponibles (necesitas ${t})`})()})]}),d.jsxs("button",{onClick:()=>{const e=Ee-te.length;if(e<=0)$e("La secuencia ya tiene suficientes videos","info");else{if(te.length>0){const s=te[te.length-1],t=a.filter(e=>!te.some(s=>s.id===e.id)&&fe(s,e));if(0===t.length)return void $e("No hay videos compatibles disponibles para continuar la secuencia","warning");if(t.length<e)return $e(`Solo hay ${t.length} videos compatibles disponibles de los ${e} necesarios`,"info"),de(a,te.length+t.length),void $e(`Secuencia completada con ${t.length} videos adicionales`)}de(a,Ee),$e(`Secuencia completada hasta ${Ee} videos`)}},className:"flex items-center justify-center space-x-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors",children:[d.jsx(L,{className:"w-4 h-4"}),d.jsxs("span",{children:["Completar hasta ",Ee]})]}),d.jsxs("button",{onClick:()=>{De({isOpen:!0,type:"clear"})},className:"flex items-center justify-center space-x-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:[d.jsx(D,{className:"w-4 h-4"}),d.jsx("span",{children:"Limpiar"})]})]})]}),d.jsx("div",{className:"mb-6",children:d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[d.jsx(E,{className:"h-5 w-5 text-blue-600 mr-2"}),"Preview en Tiempo Real"]}),B&&d.jsxs("div",{className:"flex items-center justify-center py-8",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),d.jsx("span",{className:"text-gray-600",children:"Generando preview..."})]}),H&&d.jsx("div",{className:"flex items-center justify-center py-8 text-red-600",children:d.jsxs("span",{children:["❌ Error: ",H]})}),!B&&!H&&K&&d.jsx("div",{className:"space-y-4",children:"sequence-timeline"===K?d.jsx(y,{videos:te,className:"w-full h-96",showControls:!0,autoplay:!1,loop:!1,muted:!1}):d.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:d.jsx(j,{src:K,className:"w-full h-96 object-contain",showControls:!0,autoplay:!1,loop:!1,muted:!1,size:"medium",videoTitle:"Preview de Secuencia"})})}),!B&&!H&&0===te.length&&d.jsx("div",{className:"flex items-center justify-center py-8 text-gray-500",children:d.jsx("span",{children:"Añade videos a la secuencia para ver el preview"})})]})}),d.jsxs("div",{className:"mb-6",children:[d.jsx("div",{className:"flex items-center justify-between mb-4",children:d.jsxs("h3",{className:"text-lg font-semibold text-gray-700",children:["Secuencia Actual (",te.length," videos)"]})}),0===te.length?d.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[d.jsx(O,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),d.jsx("p",{children:"No hay videos en la secuencia"}),d.jsx("p",{className:"text-sm",children:"Selecciona videos de la galería para comenzar"})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:te.map((e,s)=>d.jsxs("div",{draggable:!0,onDragStart:()=>be(s),onDragOver:e=>je(e,s),onDragEnter:e=>ye(e,s),onDragLeave:ve,onDrop:e=>Ne(e,s),onDragEnd:we,style:ke(s),className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02] relative",children:[d.jsxs("div",{className:"absolute top-2 left-2 z-10 flex items-center space-x-2",children:[d.jsxs("div",{className:"bg-purple-500 text-white px-2 py-1 rounded-full text-sm font-bold shadow-lg",children:["#",s+1]}),d.jsx("button",{onClick:()=>oe(s),className:"bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition-colors shadow-lg",title:"Eliminar de la secuencia",children:d.jsx(D,{className:"w-3 h-3"})})]}),d.jsx("div",{className:"absolute top-2 right-2 z-10",children:d.jsx($,{className:"w-5 h-5 text-gray-400 cursor-grab hover:text-gray-600 transition-colors"})}),d.jsx("div",{className:"relative group",children:d.jsxs("div",{className:"w-full aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative overflow-hidden flex items-center justify-center",children:[e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?d.jsx("img",{src:e.thumbnailUrl,alt:e.title,className:"w-full h-full object-cover",loading:"lazy",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,d.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 "+(e.thumbnailUrl&&"https://via.placeholder.com/400x225/1a1a1a/ffffff?text=VIDEO"!==e.thumbnailUrl?"hidden":"flex"),children:[d.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),d.jsx("span",{className:"text-sm font-medium",children:e.title})]}),d.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm font-medium",children:e.resolution&&"Unknown"!==e.resolution?e.resolution:"HD"}),d.jsx("button",{onClick:()=>(e=>{T(e),R(!0),$e(`🎬 Reproduciendo: ${e.title}`,"info")})(e),className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:d.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{d:"M8 5v14l11-7z"})})})]})}),d.jsxs("div",{className:"p-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"font-semibold text-gray-800 text-lg truncate",children:e.title}),d.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(s=>{const a=(e.rating||0)>=s;return d.jsx("svg",{className:"h-4 w-4 "+(a?"text-yellow-400 fill-current":"text-gray-300"),fill:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})},s)}),d.jsxs("span",{className:"text-xs font-medium text-gray-500 ml-1",children:["(",e.rating||0,")"]})]})]}),d.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description||"Sin descripción"}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(()=>{const s=(e=>{if(!e.tags||0===Object.keys(e.tags).length)return[];const s=[];return U.forEach(a=>{const t=e.tags[a.key];Array.isArray(t)&&t.forEach(e=>{s.push({tag:e,categoryKey:a.key,color:a.color})})}),s})(e);return s.length>0?s.map(({tag:e,categoryKey:s,color:a})=>d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${I(a)}`,children:e},`${s}-${e}`)):d.jsx("span",{className:"text-gray-400 text-sm",children:"Sin etiquetas"})})()}),(()=>{const s=(e=>{if(!e.tagsIniciales||0===Object.keys(e.tagsIniciales).length)return[];const s=[];return U.forEach(a=>{const t=e.tagsIniciales[a.key];Array.isArray(t)&&t.forEach(e=>{s.push({tag:e,categoryKey:a.key,color:a.color,type:"inicial"})})}),s})(e);return s.length>0?d.jsxs("div",{className:"mb-3",children:[d.jsx("div",{className:"flex items-center space-x-2 mb-2",children:d.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:"Iniciales:"})}),d.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(({tag:e,categoryKey:s,color:a})=>d.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-sm",children:e},`inicial-${s}-${e}`))})]}):null})(),(()=>{const s=(e=>{if(!e.tagsFinales||0===Object.keys(e.tagsFinales).length)return[];const s=[];return U.forEach(a=>{const t=e.tagsFinales[a.key];Array.isArray(t)&&t.forEach(e=>{s.push({tag:e,categoryKey:a.key,color:a.color,type:"final"})})}),s})(e);return s.length>0?d.jsxs("div",{className:"mb-3",children:[d.jsx("div",{className:"flex items-center space-x-2 mb-2",children:d.jsx("span",{className:"text-xs font-medium text-green-600 uppercase tracking-wide",children:"Finales:"})}),d.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(({tag:e,categoryKey:s,color:a})=>d.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-sm",children:e},`final-${s}-${e}`))})]}):null})(),d.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 pt-2 border-t border-gray-100",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("span",{className:"font-medium",children:[(e.fileSize/1048576).toFixed(2)," MB"]}),d.jsx("span",{className:"text-gray-400",children:"•"}),d.jsx("span",{className:"text-gray-600",children:e.resolution&&"Unknown"!==e.resolution?e.resolution:"HD"}),d.jsx("span",{className:"text-gray-400",children:"•"}),d.jsxs("div",{className:"flex items-center space-x-1",children:[d.jsx(q,{className:"h-3 w-3 text-purple-500"}),d.jsxs("span",{className:"font-medium text-purple-600",children:["Video ",s+1]})]})]}),d.jsxs("button",{onClick:()=>(e=>c(void 0,null,function*(){if(V)try{const s=yield x(e.id,V.uid);s.success?$e(`Has ${s.userLiked?"dado like a":"quitado like de"} "${e.title}"`,"success"):$e("Error al actualizar like","error")}catch(s){$e("Error al actualizar like","error")}else $e("Debes iniciar sesión para dar like","error")}))(e),className:"flex items-center space-x-1 transition-colors duration-200 p-1 rounded hover:bg-red-50 "+(e.userLiked?"text-red-500":"text-gray-400 hover:text-red-500"),title:e.userLiked?"Quitar like":"Dar like",children:[d.jsx(A,{className:"h-4 w-4 "+(e.userLiked?"fill-current":"")}),d.jsx("span",{className:"font-medium",children:e.likes||0})]})]})]})]},`${e.id}-${s}`))})]}),d.jsx("div",{className:"mb-6",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 border border-gray-200",children:[d.jsxs("div",{className:"flex items-center justify-between mb-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("svg",{className:"h-5 w-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Tags de Secuencia"})]}),d.jsx("button",{onClick:()=>ee(!Z),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",title:Z?"Expandir tags":"Colapsar tags",children:d.jsx("svg",{className:"w-4 h-4 transform transition-transform "+(Z?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),d.jsx("div",{className:"mb-3",children:d.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg",children:[d.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),d.jsx("span",{className:"text-sm text-green-700 font-medium",children:te.length>0?`Tags generándose automáticamente desde ${te.length} video${1!==te.length?"s":""}`:"Los tags se generarán automáticamente al añadir videos"})]})}),(()=>{const e=(()=>{const e=[];return U.forEach(s=>{const a=X[s.key];Array.isArray(a)&&a.forEach(a=>{e.push({tag:a,categoryKey:s.key,color:s.color})})}),e})();return e.length>0?d.jsx("div",{className:"mb-3",children:d.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(({tag:e,categoryKey:s,color:a})=>d.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${I(a)} flex items-center space-x-1`,children:[d.jsx("span",{children:e}),d.jsx("button",{onClick:()=>ze(s,e),className:"ml-1 hover:bg-black hover:bg-opacity-20 rounded-full p-0.5",children:d.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},`${s}-${e}`))})}):null})(),d.jsx("div",{className:"overflow-hidden transition-all duration-300 ease-in-out "+(Z?"max-h-0 opacity-0":"max-h-96 opacity-100"),children:d.jsx("div",{className:"space-y-4",children:U.map(e=>d.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[d.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center space-x-2",children:[d.jsx("span",{className:`w-3 h-3 rounded-full ${I(e.color).replace("text-","bg-")}`}),d.jsx("span",{children:e.name})]}),d.jsx("div",{className:"flex flex-wrap gap-2",children:e.tags.map(s=>d.jsx("button",{onClick:()=>ze(e.key,s),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${Pe(e.key,s)?I(e.color):"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:s},s))})]},e.key))})})]})}),d.jsxs("div",{className:"flex space-x-3 pt-4 border-t",children:[d.jsxs("button",{onClick:()=>c(void 0,null,function*(){if(re.trim())if(0!==te.length)try{const e=yield Ue(),s={name:re,description:le,videos:te,style:k,tags:X,thumbnailUrl:e,resolution:te.length>0?te[0].resolution:"HD",createdAt:(new Date).toISOString()};ne&&(s.id=ne),yield n(s);$e(ne?"✅ Secuencia actualizada exitosamente":'✅ Secuencia guardada exitosamente. Ve a "GALERÍA DE SECUENCIAS" para verla.'),ue(),S&&S()}catch(e){$e("Error al guardar la secuencia","error")}else $e("La secuencia debe tener al menos un video","error");else $e("Por favor, añade un nombre a la secuencia","error")}),disabled:0===te.length||!re.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:[d.jsx(z,{className:"w-4 h-4"}),d.jsx("span",{children:ne?"Actualizar Secuencia":"Guardar Secuencia"})]}),d.jsx("button",{onClick:()=>{te.length>0||re.trim()||le.trim()?De({isOpen:!0,type:"cancel"}):S&&S()},className:"px-6 py-2 border border-gray-300 hover:bg-gray-50 rounded-lg transition-colors",children:"Cancelar"})]})]})]}),F&&M&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-95 flex items-center justify-center z-50 p-4",onClick:()=>R(!1),children:d.jsxs("div",{className:"bg-black rounded-lg overflow-hidden w-full max-w-6xl max-h-[95vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[d.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-900",children:[d.jsx("h3",{className:"text-xl font-semibold text-white",children:M.title}),d.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-white text-2xl font-bold p-2 hover:bg-gray-800 rounded transition-colors",children:"×"})]}),d.jsx("div",{className:"flex-1 bg-black flex items-center justify-center p-4",children:d.jsx("div",{className:"w-full h-full flex items-center justify-center",children:d.jsx(j,{src:M.videoUrl,className:"max-w-full max-h-full object-contain",showControls:!0,autoplay:!1,loop:!1,muted:!1,resolutions:(e=>{if(!e||!e.resolution)return["auto","360p","480p","720p","1080p"];const s=e.resolution.toLowerCase(),a=["auto"];return s.includes("4k")||s.includes("2160p")?a.push("360p","480p","720p","1080p","4k"):s.includes("1080p")||s.includes("1920")?a.push("360p","480p","720p","1080p"):s.includes("720p")||s.includes("1280")?a.push("360p","480p","720p"):s.includes("480p")||s.includes("854")?a.push("360p","480p"):a.push("360p"),a})(M),currentResolution:"auto",videoTitle:M.title,size:"fullscreen"})})})]})}),d.jsx(b,{isOpen:Le.isOpen,onClose:()=>De({isOpen:!1,type:null}),onConfirm:()=>{"cancel"===Le.type?(ue(),S&&S()):"clear"===Le.type&&ue(),De({isOpen:!1,type:null})},title:"cancel"===Le.type?"¿Cancelar secuencia?":"¿Limpiar secuencia?",message:"cancel"===Le.type?"¿Estás seguro de que quieres cancelar? Se perderán todos los cambios.":"¿Estás seguro de que quieres limpiar la secuencia actual?",confirmText:"Confirmar",cancelText:"Cancelar"}),Ce.map(e=>d.jsx(f,{message:e.message,type:e.type,onClose:()=>{return s=e.id,void Se(e=>e.filter(e=>e.id!==s));var s}},e.id)),d.jsx(P,{isOpen:se,onClose:()=>ae(!1),videos:te,sequenceName:re||"Secuencia"})]}):null};export{U as default};
