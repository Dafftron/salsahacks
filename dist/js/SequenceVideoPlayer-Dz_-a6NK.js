import{j as e}from"../assets/index-CCq4R7r3.js";import{r as t}from"./vendor-react-4yEUTM44.js";import{LucideMinimize as s,LucideMaximize as r,LucideSkipBack as l,LucidePause as n,LucidePlay as a,LucideSkipForward as c,LucideRotateCcw as i,Download as o,LucideVolumeX as u,LucideVolume2 as d}from"./vendor-icons-DyUK-N1U.js";import"./vendor-router-Bt5THCHr.js";import"./vendor-firebase-DVYjp8kH.js";const m=({videos:m,className:x="",showControls:h=!0,autoplay:b=!1,loop:f=!1,muted:p=!1})=>{const[v,g]=t.useState(0),[j,w]=t.useState(!1),[N,y]=t.useState(p),[k,S]=t.useState(!1),[C,T]=t.useState(h),[E,L]=t.useState(0),[F,z]=t.useState(0),[R,M]=t.useState(1),[U,P]=t.useState(1),[B,D]=t.useState(!1),[K,$]=t.useState(null),[A,q]=t.useState(!1),[V,O]=t.useState(0),[X,H]=t.useState(0),[I,G]=t.useState(!1),[J,Q]=t.useState(!1),[W,Y]=t.useState(!1),[Z,_]=t.useState(0),[ee,te]=t.useState(0),[se,re]=t.useState(null),[le,ne]=t.useState(!1),[ae,ce]=t.useState(1),[ie,oe]=t.useState(!0),ue=t.useRef(null),de=t.useRef(null),me=m[v],xe=[.25,.5,.75,1,1.25,1.5,2];t.useEffect(()=>{M(1),ue.current&&(ue.current.playbackRate=1)},[v]),t.useEffect(()=>{if(ue.current&&I&&j&&J&&W){const e=ue.current,t=()=>{e.currentTime>=X&&(e.currentTime=V)};return e.addEventListener("timeupdate",t),()=>e.removeEventListener("timeupdate",t)}},[I,V,X,j,J,W]),t.useEffect(()=>{if(h&&j){se&&clearTimeout(se);const e=setTimeout(()=>{T(!1)},4e3);re(e)}return()=>{se&&clearTimeout(se)}},[j,h]),t.useEffect(()=>()=>{se&&clearTimeout(se),K&&clearTimeout(K)},[]),t.useEffect(()=>{const e=e=>{le&&ne(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[le]);const he=()=>{T(!0),se&&clearTimeout(se)},be=()=>{ue.current&&(j?ue.current.pause():ue.current.play(),w(!j))},fe=()=>{v>0&&(g(e=>e-1),L(0),ue.current&&(ue.current.currentTime=0))},pe=()=>{v<m.length-1&&(g(e=>e+1),L(0),ue.current&&(ue.current.currentTime=0))},ve=e=>{if(ue.current){const t=Math.max(0,Math.min(F,E+e));ue.current.currentTime=t,L(t)}},ge=()=>{if(ue.current){const e=!N;ue.current.muted=e,y(e),ue.current.volume=e?0:U}},je=()=>{try{document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),S(!1)):(de.current.requestFullscreen?de.current.requestFullscreen():de.current.webkitRequestFullscreen?de.current.webkitRequestFullscreen():de.current.msRequestFullscreen&&de.current.msRequestFullscreen(),S(!0))}catch(e){}},we=e=>{"start"===e?J?(Q(!1),O(0)):(Q(!0),O(E),_(E)):W?(Y(!1),H(0)):(Y(!0),H(E),te(E))},Ne=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,ye=e=>{ce(e),ue.current&&(ue.current.playbackRate=e,M(e)),ne(!1)},ke=e=>1===e?"Normal":`${e}x`;return t.useEffect(()=>{const e=e=>{if("INPUT"!==e.target.tagName)switch(e.code){case"Space":e.preventDefault(),be();break;case"KeyF":e.preventDefault(),je();break;case"KeyM":e.preventDefault(),ge();break;case"ArrowLeft":e.preventDefault(),e.ctrlKey||e.metaKey?fe():ve(-10);break;case"ArrowRight":e.preventDefault(),e.ctrlKey||e.metaKey?pe():ve(10);break;case"KeyA":e.preventDefault(),we("start");break;case"KeyB":e.preventDefault(),we("end");break;case"KeyL":e.preventDefault(),q(!A);break;case"KeyS":{e.preventDefault();const t=(xe.indexOf(ae)+1)%xe.length;ye(xe[t]);break}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[E,F,v,A,ae]),me?e.jsxs("div",{ref:de,className:`relative bg-black rounded-lg overflow-hidden ${x}`,onMouseEnter:he,onMouseLeave:()=>{if(j){const e=setTimeout(()=>{T(!1)},4e3);re(e)}},onTouchStart:he,onTouchMove:he,children:[e.jsx("video",{ref:ue,src:me.videoUrl,className:"w-full h-full object-contain cursor-pointer",onEnded:()=>{A&&!I?ue.current&&(ue.current.currentTime=0,ue.current.play()):I&&J&&W?ue.current&&(ue.current.currentTime=V,ue.current.play()):w(!1)},onTimeUpdate:()=>{ue.current&&L(ue.current.currentTime)},onLoadedMetadata:()=>{ue.current&&(z(ue.current.duration),ue.current.playbackRate=ae,M(ae))},onPlay:()=>w(!0),onPause:()=>w(!1),muted:N,autoPlay:b,loop:!1,onClick:he}),e.jsxs("div",{className:"absolute top-2 left-2 bg-black bg-opacity-75 text-white px-3 py-2 rounded-lg text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"font-medium",children:[v+1," / ",m.length]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsx("span",{className:"max-w-xs truncate",children:me.title}),1!==R&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{className:"text-blue-400 font-medium",children:[R.toFixed(2),"x"]})]})]}),m.length>1&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Usa Ctrl+←/→ para cambiar de video"})]}),C&&e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent flex flex-col justify-end",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-end items-center",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:je,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:k?e.jsx(s,{className:"w-4 h-4"}):e.jsx(r,{className:"w-4 h-4"})})})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:fe,disabled:0===v,className:"p-2 rounded-full transition-colors z-10 "+(0===v?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-black/60 text-white hover:bg-black/80"),title:"Video anterior (Ctrl+←)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-current flex items-center justify-center",children:e.jsx(l,{className:"w-1.5 h-1.5"})}),e.jsx("span",{className:"text-xs font-medium",children:"Anterior"})]})}),e.jsx("button",{onClick:()=>ve(-10),className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",title:"Retroceder 10s (←)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(l,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm font-medium",children:"10"})]})}),e.jsx("button",{onClick:be,className:"p-4 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Play/Pause (Espacio)",children:j?e.jsx(n,{className:"w-8 h-8"}):e.jsx(a,{className:"w-8 h-8"})}),e.jsx("button",{onClick:()=>ve(10),className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",title:"Adelantar 10s (→)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"10"}),e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(c,{className:"w-3 h-3"})})]})}),e.jsx("button",{onClick:pe,disabled:v===m.length-1,className:"p-2 rounded-full transition-colors z-10 "+(v===m.length-1?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-black/60 text-white hover:bg-black/80"),title:"Siguiente video (Ctrl+→)",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs font-medium",children:"Siguiente"}),e.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-current flex items-center justify-center",children:e.jsx(c,{className:"w-1.5 h-1.5"})})]})})]})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[e.jsxs("div",{className:"flex justify-end mb-2 space-x-2",children:[e.jsx("button",{onClick:()=>q(!A),className:"p-2 rounded-full transition-colors z-10 "+(A?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"),title:"Bucle",children:e.jsx(i,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{const e=!I;G(e),e?(Z>0&&(Q(!0),O(Z)),ee>0&&(Y(!0),H(ee))):(Q(!1),Y(!1),O(0),H(0))},className:"p-2 rounded-full transition-colors z-10 "+(I?"bg-green-500 text-white":"bg-white/20 text-white hover:bg-white/30"),title:"Segmento A-B",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:"A-B"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>ne(!le),className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Velocidad de reproducción",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:1===ae?"1x":`${ae}x`})}),le&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",children:xe.map(t=>e.jsx("button",{onClick:()=>ye(t),className:"w-full text-left px-3 py-1 rounded text-xs transition-colors "+(ae===t?"bg-blue-500 text-white":"text-white hover:bg-white/20"),children:ke(t)},t))})]}),e.jsx("button",{onClick:()=>{return e=void 0,t=null,s=function*(){try{if(me.videoUrl&&(me.videoUrl.includes("firebase")||me.videoUrl.includes("googleapis"))){const e=yield fetch(me.videoUrl);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=yield e.blob(),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=me.title||"video.mp4",r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>{URL.revokeObjectURL(s)},1e3)}else{const e=document.createElement("a");e.href=me.videoUrl,e.download=me.title||"video.mp4",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}catch(e){alert(`Error al descargar el video: ${e.message}`)}},new Promise((r,l)=>{var n=e=>{try{c(s.next(e))}catch(t){l(t)}},a=e=>{try{c(s.throw(e))}catch(t){l(t)}},c=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,a);c((s=s.apply(e,t)).next())});var e,t,s},className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Descargar video",children:e.jsx(o,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:ge,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",onMouseEnter:()=>D(!0),onMouseLeave:()=>{const e=setTimeout(()=>D(!1),1e3);$(e)},children:N?e.jsx(u,{className:"w-4 h-4"}):e.jsx(d,{className:"w-4 h-4"})}),B&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/80 rounded-lg p-3 z-20",onMouseEnter:()=>{K&&(clearTimeout(K),$(null))},onMouseLeave:()=>{const e=setTimeout(()=>D(!1),1e3);$(e)},children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:U,onChange:e=>{const t=parseFloat(e.target.value);ue.current&&(ue.current.volume=t,P(t),0===t?(ue.current.muted=!0,y(!0)):(ue.current.muted=!1,y(!1)))},className:"w-2 h-20 bg-gray-600 rounded-lg appearance-none cursor-pointer slider-vertical",style:{background:`linear-gradient(to top, #3b82f6 0%, #3b82f6 ${100*U}%, #4b5563 ${100*U}%, #4b5563 100%)`},orient:"vertical"}),e.jsxs("span",{className:"text-white text-xs",children:[Math.round(100*U),"%"]})]})})]})]}),e.jsx("div",{className:"relative mb-4",children:e.jsxs("div",{className:"w-full h-2 bg-white/20 rounded-full cursor-pointer relative",onClick:e=>{if(ue.current){const t=e.currentTarget.getBoundingClientRect(),s=(e.clientX-t.left)/t.width*F;ue.current.currentTime=s,L(s)}},children:[e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:E/F*100+"%"}}),I&&J&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-green-500 z-10",style:{left:V/F*100+"%"}}),I&&W&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-red-500 z-10",style:{left:X/F*100+"%"}})]})}),e.jsxs("div",{className:"flex items-center justify-between text-white text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:[Ne(E)," / ",Ne(F)]}),1!==R&&e.jsxs("span",{className:"text-blue-400 font-medium",children:[R.toFixed(2),"x"]}),I&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>we("start"),className:"px-2 py-1 rounded text-xs transition-colors "+(J?"bg-green-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:["A: ",J?Ne(V):"--:--"]}),e.jsxs("button",{onClick:()=>we("end"),className:"px-2 py-1 rounded text-xs transition-colors "+(W?"bg-red-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:["B: ",W?Ne(X):"--:--"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("div",{className:"text-xs opacity-75",children:A&&(I&&J&&W?"Bucle A-B":"Bucle completo")})})]}),m.length>1&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-300 mb-1",children:[e.jsx("span",{children:"Progreso de la secuencia"}),e.jsxs("span",{children:[v+1," de ",m.length]})]}),e.jsx("div",{className:"w-full h-1 bg-gray-600 rounded-full",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300",style:{width:(v+1)/m.length*100+"%"}})})]})]})]})]}):e.jsx("div",{className:`bg-black rounded-lg flex items-center justify-center ${x}`,children:e.jsx("div",{className:"text-white text-center",children:e.jsx("p",{children:"No hay videos en la secuencia"})})})};export{m as default};
