import{j as e}from"../assets/index-_E1YfA--.js";import{r as t}from"./vendor-react-SlK7pBj5.js";import"./vendor-firebase-DVYjp8kH.js";import{LucideMinimize as s,LucideMaximize as r,LucideSkipBack as n,LucidePause as l,LucidePlay as c,LucideSkipForward as o,LucideRotateCcw as a,Download as i,LucideVolumeX as u,LucideVolume2 as d}from"./vendor-icons-BWQzNHDY.js";import"./vendor-router-UcgXoTZX.js";const m=({src:m,size:h="medium",loop:x=!1,loopSegment:f=null,showControls:b=!0,autoplay:p=!1,muted:v=!1,onTimeUpdate:w=null,onEnded:g=null,className:j="",resolutions:N=null,currentResolution:y=null,onResolutionChange:k=null,videoTitle:T="video"})=>{const S=t.useRef(null),E=t.useRef(null),[C,L]=t.useState(!1),[M,z]=t.useState(0),[R,F]=t.useState(0),[$,A]=t.useState(1),[B,D]=t.useState(v),[P,q]=t.useState(!1),[U,K]=t.useState(null),[O,X]=t.useState(!1),[V,H]=t.useState(!1),[I,W]=t.useState((null==f?void 0:f.start)||0),[G,J]=t.useState((null==f?void 0:f.end)||0),[Q,Y]=t.useState(!!f),[Z,_]=t.useState(!1),[ee,te]=t.useState(!1),[se,re]=t.useState(0),[ne,le]=t.useState(0),[ce,oe]=t.useState(b),[ae,ie]=t.useState(null),[ue,de]=t.useState(!1),[me,he]=t.useState(y||"auto"),[xe,fe]=t.useState(null),[be,pe]=t.useState(null),[ve,we]=t.useState(!1),[ge,je]=t.useState(1),[Ne,ye]=t.useState("horizontal"),ke=[.25,.5,.75,1,1.25,1.5,2];t.useEffect(()=>{if(S.current&&Q&&C&&Z&&ee){const e=S.current,t=()=>{e.currentTime>=G&&(e.currentTime=I)};return e.addEventListener("timeupdate",t),()=>e.removeEventListener("timeupdate",t)}},[Q,I,G,C,Z,ee]),t.useEffect(()=>{const e=e=>{if(!S.current)return;const t=document.activeElement;if(!t||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"true"!==t.contentEditable&&!t.classList.contains("ql-editor"))switch(e.code){case"Space":e.preventDefault(),Re();break;case"ArrowLeft":e.preventDefault(),Fe(-10);break;case"ArrowRight":e.preventDefault(),Fe(10);break;case"KeyA":e.preventDefault(),W(M);break;case"KeyB":e.preventDefault(),J(M);break;case"KeyL":e.preventDefault(),H(!V);break;case"KeyS":{e.preventDefault();const t=(ke.indexOf(ge)+1)%ke.length;Be(ke[t]);break}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[M,V,ge]),t.useEffect(()=>{if(ce&&C){const e=setTimeout(()=>{oe(!1)},4e3);return ie(e),()=>clearTimeout(e)}},[ce,C]),t.useEffect(()=>()=>{ae&&clearTimeout(ae),U&&clearTimeout(U)},[]),t.useEffect(()=>{S.current&&(S.current.volume=$,S.current.muted=B,S.current.playbackRate=ge)},[$,B,ge]),t.useEffect(()=>{"auto"===me&&xe&&pe(xe)},[me,xe]),t.useEffect(()=>{const e=e=>{ue&&de(!1),ve&&we(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[ue,ve]);const Te=()=>{oe(!0),ae&&clearTimeout(ae)},Se=()=>{Te()},[Ee,Ce]=t.useState(0),[Le,Me]=t.useState(0),ze=e=>{const t=Date.now();if(t-Ee<300){const t=e.currentTarget.getBoundingClientRect(),s=e.clientX-t.left,r=t.width;Fe(s<r/2?-10:10),Me(0),Ce(0)}else Me(1),Ce(t)},Re=()=>{S.current&&(C?S.current.pause():S.current.play(),L(!C))},Fe=e=>{if(S.current){const t=Math.max(0,Math.min(R,M+e));S.current.currentTime=t,z(t)}},$e=e=>{"start"===e?Z?(_(!1),W(0)):(_(!0),W(M),re(M)):ee?(te(!1),J(0)):(te(!0),J(M),le(M))},Ae=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,Be=e=>{S.current&&(S.current.playbackRate=e,je(e)),we(!1)},De=e=>1===e?"Normal":`${e}x`,Pe=e=>{switch(e){case"auto":return be?`Auto (${be})`:"Auto";case"4k":return"4K";case"1080p":return"1080p";case"720p":return"720p";case"480p":return"480p";case"360p":return"360p";default:return e}};return e.jsxs("div",{ref:E,className:`relative bg-black rounded-lg overflow-hidden video-player-container ${(()=>{let e="";switch(h){case"small":e="max-w-xs";break;case"medium":default:e="max-w-md";break;case"large":e="max-w-2xl";break;case"fullscreen":return"w-full h-full"}if("fullscreen"===h)return e;return`${e} ${"vertical"===Ne?"aspect-[9/16]":"aspect-video"}`})()} ${j} ${"vertical"===Ne?"video-player-vertical":""}`,onMouseMove:Te,onMouseLeave:()=>{if(C){const e=setTimeout(()=>{oe(!1)},4e3);ie(e)}},onTouchStart:Te,onTouchMove:Te,onClick:Se,onDoubleClick:ze,children:[e.jsx("video",{ref:S,src:m,className:"w-full h-full cursor-pointer "+("fullscreen"===h?"object-contain":"object-cover"),muted:B,loop:V&&!Q,onTimeUpdate:()=>{S.current&&(z(S.current.currentTime),null==w||w(S.current.currentTime))},onLoadedMetadata:()=>{if(S.current){F(S.current.duration);const e=S.current,t=e.videoWidth,s=e.videoHeight;if(t&&s){ye(s>t?"vertical":"horizontal");const e=Math.max(t,s);let r="480p";r=e>=3840?"4k":e>=1920?"1080p":e>=1280?"720p":e>=854?"480p":"360p",fe(r)}p&&(e.play(),L(!0))}},onEnded:()=>{V&&!Q?S.current&&(S.current.currentTime=0,S.current.play()):Q?S.current&&(S.current.currentTime=I,S.current.play()):L(!1),null==g||g()},onPlay:()=>L(!0),onPause:()=>L(!1),onClick:Se,onDoubleClick:ze,onTouchStart:Te,onTouchMove:Te}),ce&&e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent",onMouseMove:Te,onTouchStart:Te,onTouchMove:Te,children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-end items-center",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>{try{document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),X(!1)):(E.current.requestFullscreen?E.current.requestFullscreen():E.current.webkitRequestFullscreen?E.current.webkitRequestFullscreen():E.current.msRequestFullscreen&&E.current.msRequestFullscreen(),X(!0))}catch(e){}},onTouchStart:Te,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:O?e.jsx(s,{className:"w-4 h-4"}):e.jsx(r,{className:"w-4 h-4"})})})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>Fe(-10),onTouchStart:Te,className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(n,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm font-medium",children:"10"})]})}),e.jsx("button",{onClick:Re,onTouchStart:Te,className:"p-4 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",children:C?e.jsx(l,{className:"w-8 h-8"}):e.jsx(c,{className:"w-8 h-8"})}),e.jsx("button",{onClick:()=>Fe(10),onTouchStart:Te,className:"p-3 rounded-full bg-black/60 text-white hover:bg-black/80 transition-colors z-10 hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"10"}),e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(o,{className:"w-3 h-3"})})]})})]})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[e.jsxs("div",{className:"flex justify-end mb-2 space-x-2",children:[e.jsx("button",{onClick:()=>H(!V),onTouchStart:Te,className:"p-2 rounded-full transition-colors z-10 "+(V?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"),title:"Bucle",children:e.jsx(a,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{const e=!Q;Y(e),e?(se>0&&(_(!0),W(se)),ne>0&&(te(!0),J(ne))):(_(!1),te(!1),W(0),J(0))},onTouchStart:Te,className:"p-2 rounded-full transition-colors z-10 "+(Q?"bg-green-500 text-white":"bg-white/20 text-white hover:bg-white/30"),title:"Segmento A-B",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:"A-B"})}),N&&N.length>0&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>de(!ue),onTouchStart:Te,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Resolución",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:Pe(me)})}),ue&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",onTouchStart:Te,onTouchMove:Te,children:N.map(t=>{const s=(e=>{if(!xe)return!0;const t=["360p","480p","720p","1080p","4k"],s=t.indexOf(xe);return t.indexOf(e)<=s})(t);return e.jsxs("button",{onClick:()=>s&&(e=>{he(e),de(!1),"auto"===e&&xe?pe(xe):"auto"!==e&&pe(null),null==k||k(e)})(t),className:"w-full text-left px-3 py-1 rounded text-xs transition-colors "+(s?me===t?"bg-blue-500 text-white":"text-white hover:bg-white/20":"text-gray-500 cursor-not-allowed opacity-50"),disabled:!s,children:[Pe(t),!s&&e.jsx("span",{className:"ml-1 text-[10px] opacity-75",children:"(no disponible)"})]},t)})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>we(!ve),onTouchStart:Te,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Velocidad de reproducción",children:e.jsx("div",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-bold leading-none",children:1===ge?"1x":`${ge}x`})}),ve&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/90 rounded-lg p-2 z-20 min-w-[80px]",onTouchStart:Te,onTouchMove:Te,children:ke.map(t=>e.jsx("button",{onClick:()=>Be(t),className:"w-full text-left px-3 py-1 rounded text-xs transition-colors "+(ge===t?"bg-blue-500 text-white":"text-white hover:bg-white/20"),children:De(t)},t))})]}),e.jsx("button",{onClick:()=>{return e=void 0,t=null,s=function*(){try{if(m&&(m.includes("firebase")||m.includes("googleapis"))){const e=yield fetch(m);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=yield e.blob(),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=T||"video.mp4",r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>{URL.revokeObjectURL(s)},1e3)}else{const e=document.createElement("a");e.href=m,e.download=T||"video.mp4",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}catch(e){alert(`Error al descargar el video: ${e.message}`)}},new Promise((r,n)=>{var l=e=>{try{o(s.next(e))}catch(t){n(t)}},c=e=>{try{o(s.throw(e))}catch(t){n(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,c);o((s=s.apply(e,t)).next())});var e,t,s},onTouchStart:Te,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",title:"Descargar video",children:e.jsx(i,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>{if(S.current){const e=!B;S.current.muted=e,D(e),S.current.volume=e?0:$}},onTouchStart:Te,className:"p-2 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors z-10",onMouseEnter:()=>q(!0),onMouseLeave:()=>{const e=setTimeout(()=>q(!1),1e3);K(e)},children:B?e.jsx(u,{className:"w-4 h-4"}):e.jsx(d,{className:"w-4 h-4"})}),P&&e.jsx("div",{className:"absolute bottom-full right-0 mb-2 bg-black/80 rounded-lg p-3 z-20",onMouseEnter:()=>{U&&(clearTimeout(U),K(null))},onMouseLeave:()=>{const e=setTimeout(()=>q(!1),1e3);K(e)},onTouchStart:Te,onTouchMove:Te,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:$,onChange:e=>{const t=parseFloat(e.target.value);S.current&&(S.current.volume=t,A(t),0===t?(S.current.muted=!0,D(!0)):(S.current.muted=!1,D(!1)))},onTouchStart:Te,onTouchMove:Te,className:"w-2 h-20 bg-gray-600 rounded-lg appearance-none cursor-pointer slider-vertical",style:{background:`linear-gradient(to top, #3b82f6 0%, #3b82f6 ${100*$}%, #4b5563 ${100*$}%, #4b5563 100%)`},orient:"vertical"}),e.jsxs("span",{className:"text-white text-xs",children:[Math.round(100*$),"%"]})]})})]})]}),e.jsx("div",{className:"relative mb-4",children:e.jsxs("div",{className:"w-full h-2 bg-white/20 rounded-full cursor-pointer relative",onClick:e=>{if(S.current){const t=e.currentTarget.getBoundingClientRect(),s=(e.clientX-t.left)/t.width*R;S.current.currentTime=s,z(s)}},onTouchStart:Te,onTouchMove:Te,children:[e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:M/R*100+"%"}}),Q&&Z&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-green-500 z-10",style:{left:I/R*100+"%"}}),Q&&ee&&e.jsx("div",{className:"absolute top-0 w-1 h-full bg-red-500 z-10",style:{left:G/R*100+"%"}})]})}),e.jsxs("div",{className:"flex items-center justify-between text-white text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:[Ae(M)," / ",Ae(R)]}),1!==ge&&e.jsxs("span",{className:"text-blue-400 font-medium",children:[ge,"x"]}),Q&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>$e("start"),onTouchStart:Te,className:"px-2 py-1 rounded text-xs transition-colors "+(Z?"bg-green-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:["A: ",Z?Ae(I):"--:--"]}),e.jsxs("button",{onClick:()=>$e("end"),onTouchStart:Te,className:"px-2 py-1 rounded text-xs transition-colors "+(ee?"bg-red-500 text-white":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:["B: ",ee?Ae(G):"--:--"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("div",{className:"text-xs opacity-75",children:V&&(Q&&Z&&ee?"Bucle A-B":"Bucle completo")})})]})]})]})]})};export{m as default};
