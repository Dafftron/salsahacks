var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,d=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,c=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&d(e,r,t[r]);if(o)for(var r of o(t))n.call(t,r)&&d(e,r,t[r]);return e},l=(e,o)=>t(e,r(o)),s=(e,t,r)=>new Promise((o,a)=>{var n=e=>{try{c(r.next(e))}catch(t){a(t)}},d=e=>{try{c(r.throw(e))}catch(t){a(t)}},c=e=>e.done?o(e.value):Promise.resolve(e.value).then(n,d);c((r=r.apply(e,t)).next())});import{q as i,c as u,w as v,o as p,a as y,d as h,s as w,u as A,b as S,e as f,g as E}from"./vendor-firebase-DVYjp8kH.js";import{q as O}from"../assets/index-mYjtELNp.js";import"./vendor-react-SlK7pBj5.js";import"./vendor-router-UcgXoTZX.js";import"./vendor-icons-BWQzNHDY.js";const g="sequences",b="escuela-sequences",m="eventos-sequences",N=(e="figuras")=>{switch(e){case"escuela":return b;case"eventos":return m;default:return g}},I=(e,t="figuras")=>s(void 0,null,function*(){try{const r=l(c({},e),{createdAt:w(),updatedAt:w()}),o=N(t),a=yield S(u(O,o),r);return l(c({id:a.id},e),{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()})}catch(r){throw new Error("No se pudo crear la secuencia")}}),C=(e="figuras")=>s(void 0,null,function*(){try{const t=N(e),r=i(u(O,t),p("createdAt","desc")),o=yield E(r),a=[];return o.forEach(e=>{var t,r,o,n,d,s;const i=e.data();a.push(l(c({id:e.id},i),{createdAt:(null==(o=null==(r=null==(t=i.createdAt)?void 0:t.toDate)?void 0:r.call(t))?void 0:o.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt}))}),a}catch(t){throw new Error("No se pudieron obtener las secuencias")}}),D=e=>s(void 0,null,function*(){try{const t=i(u(O,SEQUENCES_COLLECTION),v("style","==",e),p("createdAt","desc")),r=yield E(t),o=[];return r.forEach(e=>{var t,r,a,n,d,s;const i=e.data();o.push(l(c({id:e.id},i),{createdAt:(null==(a=null==(r=null==(t=i.createdAt)?void 0:t.toDate)?void 0:r.call(t))?void 0:a.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt}))}),o}catch(t){throw new Error("No se pudieron obtener las secuencias")}}),j=(e,t)=>s(void 0,null,function*(){try{const r=h(O,SEQUENCES_COLLECTION,e),o=l(c({},t),{updatedAt:w()});return yield A(r,o),l(c({id:e},t),{updatedAt:(new Date).toISOString()})}catch(r){throw new Error("No se pudo actualizar la secuencia")}}),L=(e,t="figuras")=>s(void 0,null,function*(){try{const r=N(t),o=h(O,r,e);return yield f(o),{success:!0}}catch(r){throw new Error("No se pudo eliminar la secuencia")}}),P=(e,t="figuras")=>s(void 0,null,function*(){try{const r=N(t),o=i(u(O,r),v("name","==",e)),a=yield E(o);if(a.empty)throw new Error(`No se encontró secuencia con nombre "${e}"`);const n=a.docs[0].ref;return yield f(n),{success:!0,deletedId:a.docs[0].id}}catch(r){throw new Error("No se pudo eliminar la secuencia por nombre")}}),q=e=>{try{const t=i(u(O,SEQUENCES_COLLECTION),p("createdAt","desc"));return y(t,t=>{const r=[];t.forEach(e=>{var t,o,a,n,d,s;const i=e.data();r.push(l(c({id:e.id},i),{createdAt:(null==(a=null==(o=null==(t=i.createdAt)?void 0:t.toDate)?void 0:o.call(t))?void 0:a.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt}))}),e(r)})}catch(t){throw new Error("No se pudo suscribir a las secuencias")}},V=(e,t,r="figuras")=>{try{const o=N(r),a=i(u(O,o),v("style","==",e),p("createdAt","desc"));return y(a,e=>{const r=[];e.forEach(e=>{var t,o,a,n,d,s;const i=e.data(),u=l(c({id:e.id},i),{createdAt:(null==(a=null==(o=null==(t=i.createdAt)?void 0:t.toDate)?void 0:o.call(t))?void 0:a.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt});r.push(u)}),t(r)})}catch(o){throw new Error("No se pudo suscribir a las secuencias")}},x=e=>s(void 0,null,function*(){try{const t=yield C(),r=e.toLowerCase().trim();return t.filter(e=>{var t,o;const a=(null==(t=e.name)?void 0:t.toLowerCase())||"",n=(null==(o=e.description)?void 0:o.toLowerCase())||"";return a.includes(r)||n.includes(r)})}catch(t){throw new Error("No se pudo buscar las secuencias")}}),Q=()=>s(void 0,null,function*(){try{const e=yield C(),t={total:e.length,byStyle:{},averageVideosPerSequence:0,totalVideos:0};return e.forEach(e=>{var r;const o=e.style||"unknown";t.byStyle[o]=(t.byStyle[o]||0)+1,t.totalVideos+=(null==(r=e.videos)?void 0:r.length)||0}),t.total>0&&(t.averageVideosPerSequence=Math.round(t.totalVideos/t.total)),t}catch(e){throw new Error("No se pudieron obtener las estadísticas")}});export{I as createSequence,L as deleteSequence,P as deleteSequenceByName,Q as getSequenceStats,C as getSequences,D as getSequencesByStyle,x as searchSequences,q as subscribeToSequences,V as subscribeToSequencesByStyle,j as updateSequence};
