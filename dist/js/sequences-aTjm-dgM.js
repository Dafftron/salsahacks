var t=Object.defineProperty,e=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,d=(e,r,o)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,l=(t,e)=>{for(var r in e||(e={}))a.call(e,r)&&d(t,r,e[r]);if(o)for(var r of o(e))n.call(e,r)&&d(t,r,e[r]);return t},c=(t,o)=>e(t,r(o)),s=(t,e,r)=>new Promise((o,a)=>{var n=t=>{try{l(r.next(t))}catch(e){a(e)}},d=t=>{try{l(r.throw(t))}catch(e){a(e)}},l=t=>t.done?o(t.value):Promise.resolve(t.value).then(n,d);l((r=r.apply(t,e)).next())});import{q as i,c as u,w as v,o as p,a as h,d as y,s as S,u as A,b as w,e as E,g as f}from"./vendor-firebase-DVYjp8kH.js";import{q as O}from"../assets/index-B-R_tmV2.js";import"./vendor-react-4yEUTM44.js";import"./vendor-router-Bt5THCHr.js";import"./vendor-icons-DyUK-N1U.js";const g="sequences",b="escuela-sequences",N="eventos-sequences",I=(t="figuras")=>{switch(t){case"escuela":return b;case"eventos":return N;default:return g}},m=(t,e="figuras")=>s(void 0,null,function*(){try{const r=c(l({},t),{createdAt:S(),updatedAt:S()}),o=I(e),a=yield w(u(O,o),r);return c(l({id:a.id},t),{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()})}catch(r){throw new Error("No se pudo crear la secuencia")}}),C=(t="figuras")=>s(void 0,null,function*(){try{const e=I(t),r=i(u(O,e),p("createdAt","desc")),o=yield f(r),a=[];return o.forEach(t=>{var e,r,o,n,d,s;const i=t.data();a.push(c(l({id:t.id},i),{createdAt:(null==(o=null==(r=null==(e=i.createdAt)?void 0:e.toDate)?void 0:r.call(e))?void 0:o.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt}))}),a}catch(e){throw new Error("No se pudieron obtener las secuencias")}}),D=t=>s(void 0,null,function*(){try{const e=i(u(O,SEQUENCES_COLLECTION),v("style","==",t),p("createdAt","desc")),r=yield f(e),o=[];return r.forEach(t=>{var e,r,a,n,d,s;const i=t.data();o.push(c(l({id:t.id},i),{createdAt:(null==(a=null==(r=null==(e=i.createdAt)?void 0:e.toDate)?void 0:r.call(e))?void 0:a.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt}))}),o}catch(e){throw new Error("No se pudieron obtener las secuencias")}}),j=(t,e)=>s(void 0,null,function*(){try{const r=y(O,SEQUENCES_COLLECTION,t),o=c(l({},e),{updatedAt:S()});return yield A(r,o),c(l({id:t},e),{updatedAt:(new Date).toISOString()})}catch(r){throw new Error("No se pudo actualizar la secuencia")}}),L=t=>s(void 0,null,function*(){try{const e=y(O,SEQUENCES_COLLECTION,t);return yield E(e),{success:!0}}catch(e){throw new Error("No se pudo eliminar la secuencia")}}),P=t=>{try{const e=i(u(O,SEQUENCES_COLLECTION),p("createdAt","desc"));return h(e,e=>{const r=[];e.forEach(t=>{var e,o,a,n,d,s;const i=t.data();r.push(c(l({id:t.id},i),{createdAt:(null==(a=null==(o=null==(e=i.createdAt)?void 0:e.toDate)?void 0:o.call(e))?void 0:a.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt}))}),t(r)})}catch(e){throw new Error("No se pudo suscribir a las secuencias")}},q=(t,e,r="figuras")=>{try{const o=I(r),a=i(u(O,o),v("style","==",t),p("createdAt","desc"));return h(a,t=>{const r=[];t.forEach(t=>{var e,o,a,n,d,s;const i=t.data(),u=c(l({id:t.id},i),{createdAt:(null==(a=null==(o=null==(e=i.createdAt)?void 0:e.toDate)?void 0:o.call(e))?void 0:a.toISOString())||i.createdAt,updatedAt:(null==(s=null==(d=null==(n=i.updatedAt)?void 0:n.toDate)?void 0:d.call(n))?void 0:s.toISOString())||i.updatedAt});r.push(u)}),e(r)})}catch(o){throw new Error("No se pudo suscribir a las secuencias")}},V=t=>s(void 0,null,function*(){try{const e=yield C(),r=t.toLowerCase().trim();return e.filter(t=>{var e,o;const a=(null==(e=t.name)?void 0:e.toLowerCase())||"",n=(null==(o=t.description)?void 0:o.toLowerCase())||"";return a.includes(r)||n.includes(r)})}catch(e){throw new Error("No se pudo buscar las secuencias")}}),x=()=>s(void 0,null,function*(){try{const t=yield C(),e={total:t.length,byStyle:{},averageVideosPerSequence:0,totalVideos:0};return t.forEach(t=>{var r;const o=t.style||"unknown";e.byStyle[o]=(e.byStyle[o]||0)+1,e.totalVideos+=(null==(r=t.videos)?void 0:r.length)||0}),e.total>0&&(e.averageVideosPerSequence=Math.round(e.totalVideos/e.total)),e}catch(t){throw new Error("No se pudieron obtener las estad√≠sticas")}});export{m as createSequence,L as deleteSequence,x as getSequenceStats,C as getSequences,D as getSequencesByStyle,V as searchSequences,P as subscribeToSequences,q as subscribeToSequencesByStyle,j as updateSequence};
